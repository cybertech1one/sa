<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive OWASP Testing Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .risk-critical { background-color: #ff5252; }
        .risk-high { background-color: #ff9800; }
        .risk-medium { background-color: #ffeb3b; }
        .risk-low { background-color: #4caf50; }
        
        .category-card {
            transition: all 0.3s ease;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .task-item {
            transition: all 0.2s ease;
        }
        
        .task-item:hover {
            background-color: #f9fafb;
        }
        
        .task-checkbox:checked + span {
            text-decoration: line-through;
            color: #6b7280;
        }

        /* Print styles */
        @media print {
            .no-print {
                display: none !important;
            }
            .print-break {
                page-break-before: always;
            }
            body {
                font-size: 12pt;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation Header -->
    <header class="bg-gradient-to-r from-blue-700 to-indigo-800 text-white shadow-lg no-print">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <h1 class="text-3xl font-bold">Comprehensive OWASP Testing Checklist</h1>
                    <p class="text-blue-100">Based on the OWASP Testing Guide v4</p>
                </div>
                <div class="flex space-x-4">
                    <button class="bg-white text-blue-800 px-4 py-2 rounded-lg hover:bg-blue-100 transition" onclick="printChecklist()">
                        <i class="fas fa-print mr-2"></i>Print Checklist
                    </button>
                    <button class="bg-transparent border border-white text-white px-4 py-2 rounded-lg hover:bg-white hover:text-blue-800 transition" onclick="exportProgress()">
                        <i class="fas fa-file-export mr-2"></i>Export Progress
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Introduction Section -->
        <section class="mb-12 no-print">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Complete OWASP Web Application Security Testing</h2>
                <p class="text-gray-600 mb-4">
                    This interactive checklist is based on the OWASP Testing Guide v4, providing a comprehensive framework for web application security testing. Track your security assessment progress across all 12 main testing categories and their subcategories.
                </p>
                <p class="text-gray-600">
                    Use this checklist to ensure thorough coverage of security testing areas, record findings, and maintain a consistent testing approach aligned with industry best practices.
                </p>
                <div class="mt-4 flex flex-wrap gap-2">
                    <span class="bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Critical Risk</span>
                    <span class="bg-orange-100 text-orange-800 text-xs font-medium px-2.5 py-0.5 rounded-full">High Risk</span>
                    <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Medium Risk</span>
                    <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Low Risk</span>
                </div>
            </div>
        </section>

        <!-- Progress Overview -->
        <section class="mb-12 no-print">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Testing Progress</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="bg-blue-50 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold text-blue-800">Overall Progress</h3>
                            <span id="overall-progress" class="text-blue-800 font-bold">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div id="overall-progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-red-50 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold text-red-800">Critical Items</h3>
                            <span id="critical-progress" class="text-red-800 font-bold">0/0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div id="critical-progress-bar" class="bg-red-600 h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-orange-50 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold text-orange-800">High Priority</h3>
                            <span id="high-progress" class="text-orange-800 font-bold">0/0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div id="high-progress-bar" class="bg-orange-500 h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-yellow-50 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold text-yellow-800">Medium Priority</h3>
                            <span id="medium-progress" class="text-yellow-800 font-bold">0/0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div id="medium-progress-bar" class="bg-yellow-500 h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Category Cards Grid -->
        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12 no-print">
            <!-- 4.1 Information Gathering Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('info-gathering')">
                <div class="risk-high text-white p-2 text-center font-semibold">High Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-blue-100 text-blue-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.1 Information Gathering</h3>
                    </div>
                    <p class="text-gray-600">Discover and map the application surface through reconnaissance techniques.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="info-gathering-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.2 Configuration and Deployment Management Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('config-testing')">
                <div class="risk-critical text-white p-2 text-center font-semibold">Critical Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-red-100 text-red-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.2 Configuration Testing</h3>
                    </div>
                    <p class="text-gray-600">Identify misconfigurations in web servers, application platforms, and frameworks.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="config-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.3 Identity Management Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('identity-testing')">
                <div class="risk-high text-white p-2 text-center font-semibold">High Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-orange-100 text-orange-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-id-card"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.3 Identity Management</h3>
                    </div>
                    <p class="text-gray-600">Evaluate user registration, account provisioning, and role definitions.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="identity-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.4 Authentication Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('auth-testing')">
                <div class="risk-critical text-white p-2 text-center font-semibold">Critical Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-red-100 text-red-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-key"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.4 Authentication Testing</h3>
                    </div>
                    <p class="text-gray-600">Assess authentication mechanisms, credentials, and password policies.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="auth-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.5 Authorization Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('authz-testing')">
                <div class="risk-critical text-white p-2 text-center font-semibold">Critical Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-red-100 text-red-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-lock"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.5 Authorization Testing</h3>
                    </div>
                    <p class="text-gray-600">Identify privilege escalation vulnerabilities and access control weaknesses.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="authz-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.6 Session Management Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('session-testing')">
                <div class="risk-high text-white p-2 text-center font-semibold">High Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-orange-100 text-orange-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-cookie"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.6 Session Management</h3>
                    </div>
                    <p class="text-gray-600">Evaluate session token generation, handling, and protection mechanisms.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="session-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.7 Input Validation Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('input-testing')">
                <div class="risk-critical text-white p-2 text-center font-semibold">Critical Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-red-100 text-red-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-code"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.7 Input Validation</h3>
                    </div>
                    <p class="text-gray-600">Identify injection flaws including SQL, XSS, LDAP, and command injection vulnerabilities.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="input-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.8 Error Handling Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('error-testing')">
                <div class="risk-medium text-white p-2 text-center font-semibold">Medium Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-yellow-100 text-yellow-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.8 Error Handling</h3>
                    </div>
                    <p class="text-gray-600">Assess improper error handling and information disclosure through stack traces.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="error-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.9 Cryptography Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('crypto-testing')">
                <div class="risk-high text-white p-2 text-center font-semibold">High Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-orange-100 text-orange-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.9 Weak Cryptography</h3>
                    </div>
                    <p class="text-gray-600">Evaluate encryption implementations, TLS configurations, and sensitive data protection.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="crypto-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.10 Business Logic Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('logic-testing')">
                <div class="risk-high text-white p-2 text-center font-semibold">High Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-orange-100 text-orange-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-sitemap"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.10 Business Logic</h3>
                    </div>
                    <p class="text-gray-600">Identify flaws in application workflows, validation logic, and business process integrity.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="logic-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.11 Client-Side Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('client-testing')">
                <div class="risk-medium text-white p-2 text-center font-semibold">Medium Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-yellow-100 text-yellow-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-laptop-code"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.11 Client-Side Testing</h3>
                    </div>
                    <p class="text-gray-600">Assess DOM-based vulnerabilities, Cross-Origin issues, and client-side storage security.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="client-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>

            <!-- 4.12 API Testing Card -->
            <div class="category-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer" onclick="openCategory('api-testing')">
                <div class="risk-high text-white p-2 text-center font-semibold">High Priority</div>
                <div class="p-6">
                    <div class="flex items-center mb-4">
                        <div class="bg-orange-100 text-orange-800 rounded-full h-10 w-10 flex items-center justify-center mr-3">
                            <i class="fas fa-plug"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">4.12 API Testing</h3>
                    </div>
                    <p class="text-gray-600">Evaluate API-specific vulnerabilities including GraphQL security concerns.</p>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="api-testing-progress" class="text-sm text-gray-500">0% complete</span>
                        <button class="text-blue-600 hover:text-blue-800">View tests →</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Detailed Category Section -->
        <section id="category-details" class="bg-white rounded-xl shadow-lg mb-12 p-0 overflow-hidden hidden">
            <div class="bg-gradient-to-r from-blue-700 to-indigo-800 p-6">
                <button onclick="closeCategory()" class="text-white mb-4 no-print"><i class="fas fa-arrow-left mr-2"></i> Back to all categories</button>
                <h2 id="category-title" class="text-2xl font-bold text-white"></h2>
                <p id="category-subtitle" class="text-blue-100"></p>
            </div>
            
            <div class="p-6">
                <!-- Tabs Navigation -->
                <div class="border-b border-gray-200 mb-6 no-print">
                    <ul class="flex flex-wrap -mb-px" id="tabNavigation">
                        <li class="mr-2">
                            <a class="inline-block p-4 border-b-2 border-blue-600 text-blue-600 font-medium" id="checklist-tab" onclick="changeTab('checklist')">Checklist</a>
                        </li>
                        <li class="mr-2">
                            <a class="inline-block p-4 border-b-2 border-transparent hover:border-gray-300 text-gray-500 hover:text-gray-700" id="techniques-tab" onclick="changeTab('techniques')">Techniques</a>
                        </li>
                        <li class="mr-2">
                            <a class="inline-block p-4 border-b-2 border-transparent hover:border-gray-300 text-gray-500 hover:text-gray-700" id="tools-tab" onclick="changeTab('tools')">Tools</a>
                        </li>
                        <li class="mr-2">
                            <a class="inline-block p-4 border-b-2 border-transparent hover:border-gray-300 text-gray-500 hover:text-gray-700" id="notes-tab" onclick="changeTab('notes')">Notes</a>
                        </li>
                    </ul>
                </div>
                
                <!-- Tab Contents -->
                <div id="tabContents">
                    <div id="checklist-content" class="tab-content active">
                        <!-- Will be filled dynamically -->
                    </div>
                    <div id="techniques-content" class="tab-content">
                        <!-- Will be filled dynamically -->
                    </div>
                    <div id="tools-content" class="tab-content">
                        <!-- Will be filled dynamically -->
                    </div>
                    <div id="notes-content" class="tab-content no-print">
                        <div class="mb-4">
                            <label for="category-notes" class="block mb-2 text-sm font-medium text-gray-900">Testing Notes</label>
                            <textarea id="category-notes" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500" placeholder="Add your testing notes here..."></textarea>
                        </div>
                        <button type="button" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 focus:outline-none" onclick="saveNotes()">Save Notes</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Findings Summary Section -->
        <section class="mb-12 no-print">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Vulnerability Findings</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3">Category</th>
                                <th scope="col" class="px-6 py-3">High</th>
                                <th scope="col" class="px-6 py-3">Medium</th>
                                <th scope="col" class="px-6 py-3">Low</th>
                                <th scope="col" class="px-6 py-3">Info</th>
                                <th scope="col" class="px-6 py-3">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="findings-table">
                            <!-- Categories will be populated here -->
                        </tbody>
                    </table>
                </div>
                <div class="mt-4">
                    <button type="button" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 focus:outline-none" onclick="generateReport()">Generate Report</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Add Finding Modal -->
    <div id="finding-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50 no-print">
        <div class="relative bg-white rounded-lg shadow max-w-md w-full">
            <div class="flex items-center justify-between p-4 border-b">
                <h3 class="text-xl font-semibold text-gray-900">Add Vulnerability Finding</h3>
                <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="finding-form">
                    <div class="mb-4">
                        <label for="finding-title" class="block mb-2 text-sm font-medium text-gray-900">Title</label>
                        <input type="text" id="finding-title" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" required>
                    </div>
                    <div class="mb-4">
                        <label for="finding-severity" class="block mb-2 text-sm font-medium text-gray-900">Severity</label>
                        <select id="finding-severity" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="info">Informational</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="finding-description" class="block mb-2 text-sm font-medium text-gray-900">Description</label>
                        <textarea id="finding-description" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" required></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="finding-steps" class="block mb-2 text-sm font-medium text-gray-900">Steps to Reproduce</label>
                        <textarea id="finding-steps" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="finding-remediation" class="block mb-2 text-sm font-medium text-gray-900">Remediation</label>
                        <textarea id="finding-remediation" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"></textarea>
                    </div>
                    <button type="button" class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 focus:outline-none" onclick="saveFinding()">Save Finding</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white no-print">
        <div class="container mx-auto px-4 py-8">
            <div class="flex flex-col md:flex-row justify-between">
                <div class="mb-6 md:mb-0">
                    <h3 class="text-xl font-bold mb-2">OWASP Testing Checklist</h3>
                    <p class="text-gray-400">A comprehensive security assessment framework based on the OWASP Testing Guide v4.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-2">Additional Resources</h4>
                    <ul class="text-gray-400">
                        <li class="mb-1"><a href="https://owasp.org/www-project-web-security-testing-guide/" class="hover:text-white">OWASP Testing Guide</a></li>
                        <li class="mb-1"><a href="https://owasp.org/www-project-top-ten/" class="hover:text-white">OWASP Top Ten</a></li>
                        <li class="mb-1"><a href="https://cheatsheetseries.owasp.org/" class="hover:text-white">OWASP Cheat Sheets</a></li>
                        <li class="mb-1"><a href="https://owasp.org/www-community/" class="hover:text-white">OWASP Community</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                <p>© 2025 Comprehensive OWASP Testing Checklist. Based on OWASP Testing Guide v4.</p>
            </div>
        </div>
    </footer>

    <script>
        // Category data structure with all OWASP Testing Guide sections
        const categories = {
            'info-gathering': {
                title: '4.1 Information Gathering',
                subtitle: 'Discovering and mapping the application attack surface',
                priority: 'high',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.1.1-4.1.3 External Reconnaissance</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.1 Conduct search engine discovery for information leakage (Google dorks)</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.2 Fingerprint the web server technology and version</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.3 Review webserver metafiles (robots.txt, sitemap.xml)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.1.4-4.1.7 Application Mapping</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.4 Enumerate applications on web server</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.5 Review webpage content for information leakage</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.6 Identify application entry points (forms, parameters, APIs)</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.7 Map execution paths through the application</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.1.8-4.1.10 Framework and Architecture</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.8 Fingerprint web application framework</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.9 Fingerprint web application (identify CMS, plugins, versions)</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.1.10 Map application architecture (servers, databases, components)</span>
                            </div>
                        </div>
                    </div>
                `,
                techniques: `
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Information Gathering Techniques</h3>
                        
                        <div class="bg-white border rounded-lg p-5 mb-6 shadow-sm">
                            <h4 class="font-bold text-lg text-gray-800 mb-2">Search Engine Reconnaissance</h4>
                            <p class="text-gray-600 mb-3">
                                Effective search techniques to discover sensitive information:
                            </p>
                            <pre class="mb-3"># Find sensitive directories
site:example.com intitle:index.of

# Find potentially exposed files
site:example.com ext:xml OR ext:conf OR ext:cnf OR ext:ini

# Find login portals
site:example.com inurl:login OR inurl:admin OR inurl:portal</pre>
                        </div>
                        
                        <div class="bg-white border rounded-lg p-5 mb-6 shadow-sm">
                            <h4 class="font-bold text-lg text-gray-800 mb-2">Web Server Fingerprinting</h4>
                            <p class="text-gray-600 mb-3">
                                Techniques to identify the server technology:
                            </p>
                            <ul class="list-disc pl-6 text-gray-600 mb-3">
                                <li>Analyze HTTP response headers (Server, X-Powered-By)</li>
                                <li>Check for technology-specific cookies</li>
                                <li>Observe error pages and their format</li>
                                <li>Use banner grabbing techniques</li>
                            </ul>
                        </div>
                    </div>
                `,
                tools: `
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Information Gathering Tools</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white border rounded-lg p-5 shadow-sm">
                                <div class="flex items-center mb-3">
                                    <i class="fas fa-search text-blue-500 mr-2"></i>
                                    <h4 class="font-bold text-lg text-gray-800">Amass</h4>
                                </div>
                                <p class="text-gray-600 mb-3">
                                    In-depth subdomain enumeration tool that uses various techniques.
                                </p>
                                <a href="https://github.com/OWASP/Amass" class="text-blue-600 hover:text-blue-800 flex items-center">
                                    Learn more <i class="fas fa-external-link-alt ml-1 text-sm"></i>
                                </a>
                            </div>
                            
                            <div class="bg-white border rounded-lg p-5 shadow-sm">
                                <div class="flex items-center mb-3">
                                    <i class="fas fa-fingerprint text-blue-500 mr-2"></i>
                                    <h4 class="font-bold text-lg text-gray-800">Wappalyzer</h4>
                                </div>
                                <p class="text-gray-600 mb-3">
                                    Browser extension that identifies technologies used on websites.
                                </p>
                                <a href="https://www.wappalyzer.com/" class="text-blue-600 hover:text-blue-800 flex items-center">
                                    Learn more <i class="fas fa-external-link-alt ml-1 text-sm"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                `
            },
            'config-testing': {
                title: '4.2 Configuration and Deployment Testing',
                subtitle: 'Identifying insecure configurations and deployment issues',
                priority: 'critical',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.2.1-4.2.3 Infrastructure Configuration</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.1 Test network infrastructure configuration</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.2 Test application platform configuration</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.3 Test file extensions handling for sensitive information</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.2.4-4.2.6 File and Interface Security</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.4 Review old backup and unreferenced files for sensitive information</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.5 Enumerate infrastructure and application admin interfaces</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.6 Test HTTP methods (OPTIONS, TRACE, etc.)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.2.7-4.2.11 Security Controls</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.7 Test HTTP Strict Transport Security</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.8 Test RIA cross domain policy</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.9 Test file permissions</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.10 Test for subdomain takeover</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.2.11 Test cloud storage security</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'identity-testing': {
                title: '4.3 Identity Management Testing',
                subtitle: 'Evaluating user roles, registration, and account enumeration',
                priority: 'high',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.3.1-4.3.5 Identity Management Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.3.1 Test role definitions</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.3.2 Test user registration process</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.3.3 Test account provisioning process</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.3.4 Test for account enumeration and guessable user accounts</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.3.5 Test for weak or unenforced username policy</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'auth-testing': {
                title: '4.4 Authentication Testing',
                subtitle: 'Assessing authentication mechanisms and credential management',
                priority: 'critical',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.4.1-4.4.4 Authentication Security</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.1 Test for credentials transported over an encrypted channel</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.2 Test for default credentials</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.3 Test for weak lock out mechanism</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.4 Test for bypassing authentication schema</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.4.5-4.4.7 Credential Management</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.5 Test for vulnerable remember password functionality</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.6 Test for browser cache weaknesses</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.7 Test for weak password policy</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.4.8-4.4.10 Alternate Authentication Paths</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.8 Test for weak security question/answer</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.9 Test for weak password change or reset functionalities</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.4.10 Test for weaker authentication in alternative channel</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'authz-testing': {
                title: '4.5 Authorization Testing',
                subtitle: 'Identifying privilege escalation and access control issues',
                priority: 'critical',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.5.1-4.5.4 Authorization Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.5.1 Test directory traversal/file include</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.5.2 Test for bypassing authorization schema</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.5.3 Test for privilege escalation</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.5.4 Test for insecure direct object references</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'session-testing': {
                title: '4.6 Session Management Testing',
                subtitle: 'Evaluating session token security and management',
                priority: 'high',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.6.1-4.6.4 Session Security</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.1 Test for session management schema</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.2 Test for cookies attributes</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.3 Test for session fixation</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.4 Test for exposed session variables</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.6.5-4.6.9 Session Management Issues</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.5 Test for cross site request forgery (CSRF)</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.6 Test logout functionality</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.7 Test session timeout</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.8 Test for session puzzling</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.6.9 Test for session hijacking</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'input-testing': {
                title: '4.7 Input Validation Testing',
                subtitle: 'Identifying injection flaws and input validation vulnerabilities',
                priority: 'critical',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.7.1-4.7.4 Cross-Site Scripting and HTTP Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.1 Test for reflected cross-site scripting</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.2 Test for stored cross-site scripting</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.3 Test for HTTP verb tampering</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.4 Test for HTTP parameter pollution</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.7.5 SQL Injection Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.1 Test for Oracle SQL injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.2 Test for MySQL SQL injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.3 Test for SQL Server injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.4 Test for PostgreSQL injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.5 Test for MS Access SQL injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.6 Test for NoSQL injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.7 Test for ORM injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.5.8 Test for client-side SQL injection</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.7.6-4.7.10 Other Injection Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.6 Test for LDAP injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.7 Test for XML injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.8 Test for SSI injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.9 Test for XPath injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.10 Test for IMAP/SMTP injection</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.7.11-4.7.19 Code and HTTP Injection Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.11.1 Test for local file inclusion</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.11.2 Test for remote file inclusion</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.12 Test for command injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.13 Test for format string injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.14 Test for incubated vulnerability</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.15 Test for HTTP splitting/smuggling</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.16 Test for HTTP incoming requests</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.17 Test for host header injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.18 Test for server-side template injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.7.19 Test for server-side request forgery</span>
                            </div>
                        </div>
                    </div>
                `,
                techniques: `
                    <div class="mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Input Validation Testing Techniques</h3>
                        
                        <div class="bg-white border rounded-lg p-5 mb-6 shadow-sm">
                            <h4 class="font-bold text-lg text-gray-800 mb-2">SQL Injection Testing</h4>
                            <p class="text-gray-600 mb-3">
                                Safe examples of SQL injection detection techniques:
                            </p>
                            <ul class="list-disc pl-6 text-gray-600 mb-3">
                                <li>Test for syntax errors by inserting single quotes</li>
                                <li>Use boolean-based techniques (AND 1=1, AND 1=2)</li>
                                <li>Employ time-delay techniques to detect blind vulnerabilities</li>
                                <li>Test UNION queries with matching column counts</li>
                            </ul>
                        </div>
                        
                        <div class="bg-white border rounded-lg p-5 mb-6 shadow-sm">
                            <h4 class="font-bold text-lg text-gray-800 mb-2">XSS Testing</h4>
                            <p class="text-gray-600 mb-3">
                                Cross-site scripting detection approaches:
                            </p>
                            <ul class="list-disc pl-6 text-gray-600 mb-3">
                                <li>Insert benign test strings like <code>[TEST-TAG]</code> to see if they're reflected</li>
                                <li>Test input sanitization with harmless probes</li>
                                <li>Check for proper encoding of special characters</li>
                                <li>Verify context-appropriate encoding (HTML, JavaScript, CSS contexts)</li>
                            </ul>
                        </div>
                    </div>
                `
            },
            'error-testing': {
                title: '4.8 Error Handling Testing',
                subtitle: 'Assessing application error handling and information disclosure',
                priority: 'medium',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.8.1-4.8.2 Error Handling</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.8.1 Test for improper error handling</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.8.2 Test for stack traces</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'crypto-testing': {
                title: '4.9 Weak Cryptography Testing',
                subtitle: 'Evaluating encryption and sensitive data protection',
                priority: 'high',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.9.1-4.9.4 Cryptography Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.9.1 Test for weak transport layer security</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.9.2 Test for padding oracle</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.9.3 Test for sensitive information sent via unencrypted channels</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.9.4 Test for weak encryption</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'logic-testing': {
                title: '4.10 Business Logic Testing',
                subtitle: 'Identifying flaws in application logic and workflow',
                priority: 'high',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.10.1-4.10.5 Business Logic Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.1 Test business logic data validation</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.2 Test ability to forge requests</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.3 Test integrity checks</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.4 Test for process timing</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.5 Test number of times a function can be used limits</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.10.6-4.10.9 Workflow and Upload Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.6 Test for circumvention of workflows</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.7 Test defenses against application misuse</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.8 Test upload of unexpected file types</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.10.9 Test upload of malicious files</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'client-testing': {
                title: '4.11 Client-side Testing',
                subtitle: 'Evaluating client-side security controls and vulnerabilities',
                priority: 'medium',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.11.1-4.11.5 Client-side Injection Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.1 Test for DOM-based cross-site scripting</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.2 Test for JavaScript execution</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.3 Test for HTML injection</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.4 Test for client-side URL redirect</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.5 Test for CSS injection</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.11.6-4.11.13 Client-side Security Issues</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.6 Test for client-side resource manipulation</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.7 Test cross-origin resource sharing</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.8 Test for cross-site flashing</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.9 Test for clickjacking</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.10 Test WebSockets</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.11 Test web messaging</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.12 Test browser storage</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.11.13 Test for cross-site script inclusion</span>
                            </div>
                        </div>
                    </div>
                `
            },
            'api-testing': {
                title: '4.12 API Testing',
                subtitle: 'Testing API security and GraphQL implementations',
                priority: 'high',
                checklist: `
                    <div class="mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">4.12.1 API Tests</h3>
                        <div class="space-y-2">
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">4.12.1 Test GraphQL security</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">Test RESTful API authentication</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">Test API authorization controls</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">Test API input validation</span>
                            </div>
                            <div class="task-item p-2 rounded-lg flex items-start">
                                <input type="checkbox" class="task-checkbox mt-1 mr-2" onchange="updateProgress()">
                                <span class="text-gray-700">Test API rate limiting</span>
                            </div>
                        </div>
                    </div>
                `
            }
        };

        // Variables to store state
        let currentCategory = '';
        let currentTab = 'checklist';
        let findings = {};
        let notes = {};

        // Initialize findings table
        function initFindingsTable() {
            const table = document.getElementById('findings-table');
            table.innerHTML = '';
            
            Object.keys(categories).forEach(categoryId => {
                const category = categories[categoryId];
                findings[categoryId] = findings[categoryId] || { high: 0, medium: 0, low: 0, info: 0 };
                
                const row = document.createElement('tr');
                row.className = 'bg-white border-b';
                row.innerHTML = `
                    <td class="px-6 py-4 font-medium text-gray-900">${category.title}</td>
                    <td class="px-6 py-4">${findings[categoryId].high}</td>
                    <td class="px-6 py-4">${findings[categoryId].medium}</td>
                    <td class="px-6 py-4">${findings[categoryId].low}</td>
                    <td class="px-6 py-4">${findings[categoryId].info}</td>
                    <td class="px-6 py-4">
                        <button class="font-medium text-blue-600 hover:underline" onclick="addFinding('${categoryId}')">Add</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        // Update progress indicators
        function updateProgress() {
            const categoryPrefix = currentCategory ? currentCategory + ' ' : '';
            const checkboxes = document.querySelectorAll(categoryPrefix + '.task-checkbox');
            const checkedBoxes = document.querySelectorAll(categoryPrefix + '.task-checkbox:checked');
            
            // Update category progress if in a category view
            if (currentCategory) {
                const progressPercent = checkboxes.length > 0 ? Math.round((checkedBoxes.length / checkboxes.length) * 100) : 0;
                document.getElementById(currentCategory + '-progress').textContent = progressPercent + '% complete';
            }
            
            // Update overall progress
            const allCheckboxes = document.querySelectorAll('.task-checkbox');
            const allCheckedBoxes = document.querySelectorAll('.task-checkbox:checked');
            const overallPercent = allCheckboxes.length > 0 ? Math.round((allCheckedBoxes.length / allCheckboxes.length) * 100) : 0;
            
            document.getElementById('overall-progress').textContent = overallPercent + '%';
            document.getElementById('overall-progress-bar').style.width = overallPercent + '%';
            
            // Count by priority
            const criticalItems = document.querySelectorAll('.category-card .risk-critical + div .task-checkbox');
            const criticalChecked = document.querySelectorAll('.category-card .risk-critical + div .task-checkbox:checked');
            const highItems = document.querySelectorAll('.category-card .risk-high + div .task-checkbox');
            const highChecked = document.querySelectorAll('.category-card .risk-high + div .task-checkbox:checked');
            const mediumItems = document.querySelectorAll('.category-card .risk-medium + div .task-checkbox');
            const mediumChecked = document.querySelectorAll('.category-card .risk-medium + div .task-checkbox:checked');
            
            document.getElementById('critical-progress').textContent = criticalChecked.length + '/' + criticalItems.length;
            document.getElementById('high-progress').textContent = highChecked.length + '/' + highItems.length;
            document.getElementById('medium-progress').textContent = mediumChecked.length + '/' + mediumItems.length;
            
            const criticalPercent = criticalItems.length > 0 ? Math.round((criticalChecked.length / criticalItems.length) * 100) : 0;
            const highPercent = highItems.length > 0 ? Math.round((highChecked.length / highItems.length) * 100) : 0;
            const mediumPercent = mediumItems.length > 0 ? Math.round((mediumChecked.length / mediumItems.length) * 100) : 0;
            
            document.getElementById('critical-progress-bar').style.width = criticalPercent + '%';
            document.getElementById('high-progress-bar').style.width = highPercent + '%';
            document.getElementById('medium-progress-bar').style.width = mediumPercent + '%';
            
            // Save progress to localStorage
            saveProgressToLocalStorage();
        }

        // Save progress to localStorage
        function saveProgressToLocalStorage() {
            const checkboxes = document.querySelectorAll('.task-checkbox');
            const progress = {};
            
            checkboxes.forEach((checkbox, index) => {
                progress[index] = checkbox.checked;
            });
            
            localStorage.setItem('owasp-checklist-progress', JSON.stringify(progress));
            localStorage.setItem('owasp-checklist-findings', JSON.stringify(findings));
            localStorage.setItem('owasp-checklist-notes', JSON.stringify(notes));
        }

        // Load progress from localStorage
        function loadProgressFromLocalStorage() {
            const progressData = localStorage.getItem('owasp-checklist-progress');
            const findingsData = localStorage.getItem('owasp-checklist-findings');
            const notesData = localStorage.getItem('owasp-checklist-notes');
            
            if (progressData) {
                const progress = JSON.parse(progressData);
                const checkboxes = document.querySelectorAll('.task-checkbox');
                
                checkboxes.forEach((checkbox, index) => {
                    if (progress[index]) {
                        checkbox.checked = true;
                    }
                });
            }
            
            if (findingsData) {
                findings = JSON.parse(findingsData);
            }
            
            if (notesData) {
                notes = JSON.parse(notesData);
            }
            
            initFindingsTable();
            updateProgress();
        }

        // Open a category
        function openCategory(categoryId) {
            currentCategory = categoryId;
            document.getElementById('category-details').classList.remove('hidden');
            document.getElementById('category-title').textContent = categories[categoryId].title;
            document.getElementById('category-subtitle').textContent = categories[categoryId].subtitle;
// Load the tab contents
            document.getElementById('checklist-content').innerHTML = categories[categoryId].checklist;
            document.getElementById('techniques-content').innerHTML = categories[categoryId].techniques || '<p class="text-gray-600">No specific techniques are documented for this category.</p>';
            document.getElementById('tools-content').innerHTML = categories[categoryId].tools || '<p class="text-gray-600">No specific tools are documented for this category.</p>';
            
            // Set notes if they exist
            if (notes[categoryId]) {
                document.getElementById('category-notes').value = notes[categoryId];
            } else {
                document.getElementById('category-notes').value = '';
            }
            
            // Reset tab selection
            changeTab('checklist');
            
            // Scroll to the top of the section
            document.getElementById('category-details').scrollIntoView({ behavior: 'smooth' });
        }

        // Close the category view
        function closeCategory() {
            document.getElementById('category-details').classList.add('hidden');
            currentCategory = '';
        }

        // Change active tab
        function changeTab(tabName) {
            currentTab = tabName;
            
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName + '-content').classList.add('active');
            
            // Update tab navigation styles
            const tabs = document.querySelectorAll('#tabNavigation a');
            tabs.forEach(tab => {
                tab.classList.remove('border-blue-600', 'text-blue-600');
                tab.classList.add('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
            });
            
            document.getElementById(tabName + '-tab').classList.remove('border-transparent', 'text-gray-500', 'hover:border-gray-300', 'hover:text-gray-700');
            document.getElementById(tabName + '-tab').classList.add('border-blue-600', 'text-blue-600');
        }

        // Save notes for the current category
        function saveNotes() {
            if (currentCategory) {
                notes[currentCategory] = document.getElementById('category-notes').value;
                saveProgressToLocalStorage();
                alert('Notes saved successfully');
            }
        }

        // Add a finding
        function addFinding(categoryId) {
            // Reset form
            document.getElementById('finding-title').value = '';
            document.getElementById('finding-description').value = '';
            document.getElementById('finding-steps').value = '';
            document.getElementById('finding-remediation').value = '';
            document.getElementById('finding-severity').value = 'high';
            
            // Store the category ID for later use when saving
            document.getElementById('finding-form').setAttribute('data-category', categoryId);
            
            // Show modal
            document.getElementById('finding-modal').classList.remove('hidden');
        }

        // Save finding
        function saveFinding() {
            const categoryId = document.getElementById('finding-form').getAttribute('data-category');
            const severity = document.getElementById('finding-severity').value;
            
            // Update findings count
            findings[categoryId] = findings[categoryId] || { high: 0, medium: 0, low: 0, info: 0 };
            findings[categoryId][severity]++;
            
            // Update findings table
            initFindingsTable();
            
            // Save to localStorage
            saveProgressToLocalStorage();
            
            // Close modal
            closeModal();
            
            // Show confirmation
            alert('Finding added successfully');
        }

        // Close the modal
        function closeModal() {
            document.getElementById('finding-modal').classList.add('hidden');
        }

        // Generate a report
        function generateReport() {
            const reportWindow = window.open('', '_blank');
            
            // Build the report HTML
            let reportHtml = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>OWASP Testing Report</title>
                <style>
                    body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; color: #333; }
                    h1, h2, h3 { margin-top: 20px; }
                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #f2f2f2; }
                    .high { color: #e53e3e; }
                    .medium { color: #dd6b20; }
                    .low { color: #38a169; }
                    .info { color: #3182ce; }
                    .progress-bar { background-color: #edf2f7; height: 20px; border-radius: 10px; overflow: hidden; }
                    .progress-fill { background-color: #4299e1; height: 100%; border-radius: 10px; }
                </style>
            </head>
            <body>
                <h1>OWASP Testing Report</h1>
                <p>Generated on: ${new Date().toLocaleString()}</p>
                
                <h2>Testing Progress Summary</h2>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${document.getElementById('overall-progress').textContent};"></div>
                </div>
                <p>Overall Progress: ${document.getElementById('overall-progress').textContent}</p>
                
                <h2>Findings Summary</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>High</th>
                            <th>Medium</th>
                            <th>Low</th>
                            <th>Info</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Add findings data
            Object.keys(categories).forEach(categoryId => {
                const category = categories[categoryId];
                findings[categoryId] = findings[categoryId] || { high: 0, medium: 0, low: 0, info: 0 };
                
                reportHtml += `
                        <tr>
                            <td>${category.title}</td>
                            <td class="high">${findings[categoryId].high}</td>
                            <td class="medium">${findings[categoryId].medium}</td>
                            <td class="low">${findings[categoryId].low}</td>
                            <td class="info">${findings[categoryId].info}</td>
                        </tr>
                `;
            });
            
            reportHtml += `
                    </tbody>
                </table>
                
                <h2>Detailed Category Notes</h2>
            `;
            
            // Add notes
            Object.keys(notes).forEach(categoryId => {
                if (notes[categoryId] && notes[categoryId].trim() !== '') {
                    reportHtml += `
                        <h3>${categories[categoryId].title}</h3>
                        <pre>${notes[categoryId]}</pre>
                    `;
                }
            });
            
            reportHtml += `
            </body>
            </html>
            `;
            
            // Write to the new window
            reportWindow.document.write(reportHtml);
            reportWindow.document.close();
        }

        // Print the checklist
        function printChecklist() {
            window.print();
        }

        // Export progress data
        function exportProgress() {
            const exportData = {
                progress: JSON.parse(localStorage.getItem('owasp-checklist-progress') || '{}'),
                findings: findings,
                notes: notes,
                date: new Date().toISOString()
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(exportData));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "owasp-checklist-export.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }

        // Initialize the application
        function init() {
            initFindingsTable();
            
            // Load saved progress
            setTimeout(loadProgressFromLocalStorage, 500);
            
            // Add event listener for the modal background
            document.getElementById('finding-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
        }

        // Run initialization
        document.addEventListener('DOMContentLoaded', init);
    </script>
