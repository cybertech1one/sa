import os
import glob

def combine_iis_logs():
    # Get user input
    input_folder = input("Enter the folder path containing IIS log files: ")
    output_folder = input("Enter the folder path for the output file: ")
    output_name = input("Enter the name for the combined output file: ")
    
    # Create output folder if it doesn't exist
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)
    
    # Full path for output file
    output_file = os.path.join(output_folder, output_name)
    
    # Find all .log files in the input folder
    log_files = glob.glob(os.path.join(input_folder, "*.log"))
    
    if not log_files:
        print(f"No .log files found in {input_folder}")
        return
    
    # Open the output file for writing
    with open(output_file, 'w') as outfile:
        # Headers flag to ensure we only copy headers from the first file
        first_file = True
        
        # Process each log file
        for log_file in log_files:
            print(f"Processing {log_file}...")
            with open(log_file, 'r') as infile:
                # For first file, include everything
                if first_file:
                    outfile.write(infile.read())
                    first_file = False
                else:
                    # For subsequent files, skip lines that start with #
                    for line in infile:
                        if not line.startswith('#'):
                            outfile.write(line)
    
    print(f"Combined logs successfully saved to {output_file}")

if __name__ == "__main__":
    combine_iis_logs()
